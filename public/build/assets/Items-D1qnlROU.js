import{r as e,j as a,c as s,s as t}from"./vendor-react-CWR92fp6.js";import{B as r}from"./Base-CaFGfdNS.js";import{S as i}from"./SwitchFormGroup-CXb3EVm8.js";import{T as l}from"./TextareaFormGroup-DK6Aq4s5.js";import{S as n}from"./CartKuchara-Dv4IzV1I.js";import{I as c}from"./ItemsRest-D5b_9D9E.js";import{A as d}from"./AmenitiesRest-C1qgwALb.js";import{A as o}from"./ApplicationsRest-Boh-DAnm.js";import{A as m}from"./AttributesRest-DhSP0ye4.js";import{M as u}from"./Modal-BDEftn0t.js";import{T as p}from"./Table-BoT4Lq6u.js";import{I as h}from"./ImageFormGroup-DDW-x4gQ.js";import{I as x}from"./InputFormGroup-flZxFq2o.js";import{Q as f}from"./QuillFormGroup-GsMU20xA.js";import{S as g}from"./SelectAPIFormGroup-BR4MYKax.js";import{S as b}from"./SelectFormGroup-CpkjS3I2.js";import{D as j}from"./DxButton-C6FT_beP.js";import{C as v,F as N}from"./CreateReactScript-DEkx_UD4.js";import{C as y,N as w}from"./Number2Currency-BX4epFEo.js";import{R as k}from"./ReactAppend-BcjZMe63.js";import{S as R}from"./SetSelectValue-DCHQOIKz.js";import{t as _}from"./GoogleSignInButton-D2m9IONr.js";import{D}from"./DynamicField-BpmVoSPo.js";import"./vendor-swiper-T7yreVnW.js";import"./Global-BAGAPG-V.js";import"./TippyButton-BozxD_uD.js";import"./Logout-CvukixAi.js";import"./MenuItemContainer-CUP12Xrd.js";import"./Menu-BoHY91ba.js";import"./BasicRest-B3Vi_F9E.js";import"./BooleanLimit-q2Ad9fGY.js";import"./General-ClVW7qxN.js";import"./LaravelSession-ByQnaUD3.js";const C=new c,S=({gridRef:s,modalRef:t,excelTemplate:r})=>{const[i,l]=e.useState(null),[n,c]=e.useState(!1),[d,o]=e.useState(""),[m,u]=e.useState(!1),[p,h]=e.useState("reset");return a.jsxs("div",{className:"bg-white p-4",children:[a.jsx("div",{className:"mb-4 pb-3 border-bottom",children:a.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[a.jsx("h5",{className:"mb-0 text-dark fw-semibold",children:"Importar Productos"}),r&&a.jsxs("a",{href:`/cloud/${r}`,download:!0,className:"btn btn-sm btn-outline-secondary",children:[a.jsx("i",{className:"fas fa-download me-2"}),"Descargar Plantilla"]})]})}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"form-label text-dark fw-semibold mb-3",children:"Modo de Importación"}),a.jsxs("div",{className:"row g-3",children:[a.jsx("div",{className:"col-md-6",children:a.jsx("div",{className:"card h-100 "+("reset"===p?"border-primary":"border"),style:{cursor:"pointer",transition:"all 0.2s ease",borderWidth:"reset"===p?"2px":"1px"},onClick:()=>h("reset"),children:a.jsx("div",{className:"card-body p-3",children:a.jsxs("div",{className:"d-flex align-items-start",children:[a.jsx("input",{className:"form-check-input mt-1 me-3 flex-shrink-0",type:"radio",name:"importMode",id:"modeReset",value:"reset",checked:"reset"===p,onChange:e=>h(e.target.value),style:{width:"20px",height:"20px",borderRadius:"50%"}}),a.jsxs("label",{className:"form-check-label flex-grow-1",htmlFor:"modeReset",style:{cursor:"pointer"},children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx("div",{className:"d-flex align-items-center justify-content-center me-2",style:{width:"36px",height:"36px",borderRadius:"8px",background:"#6c757d",color:"white"},children:a.jsx("i",{className:"fas fa-redo-alt"})}),a.jsx("strong",{className:"text-dark",children:"Importar desde cero"})]}),a.jsx("small",{className:"text-muted",children:"Reemplaza todos los productos existentes con los del archivo Excel"})]})]})})})}),a.jsx("div",{className:"col-md-6",children:a.jsx("div",{className:"card h-100 "+("add_update"===p?"border-primary":"border"),style:{cursor:"pointer",transition:"all 0.2s ease",borderWidth:"add_update"===p?"2px":"1px"},onClick:()=>h("add_update"),children:a.jsx("div",{className:"card-body p-3",children:a.jsxs("div",{className:"d-flex align-items-start",children:[a.jsx("input",{className:"form-check-input mt-1 me-3 flex-shrink-0",type:"radio",name:"importMode",id:"modeAddUpdate",value:"add_update",checked:"add_update"===p,onChange:e=>h(e.target.value),style:{width:"20px",height:"20px",borderRadius:"50%"}}),a.jsxs("label",{className:"form-check-label flex-grow-1",htmlFor:"modeAddUpdate",style:{cursor:"pointer"},children:[a.jsxs("div",{className:"d-flex align-items-center mb-2",children:[a.jsx("div",{className:"d-flex align-items-center justify-content-center me-2",style:{width:"36px",height:"36px",borderRadius:"8px",background:"#0d6efd",color:"white"},children:a.jsx("i",{className:"fas fa-sync-alt"})}),a.jsx("strong",{className:"text-dark",children:"Agregar / Actualizar"})]}),a.jsx("small",{className:"text-muted",children:"Actualiza productos existentes (por SKU) o agrega nuevos sin eliminar"})]})]})})})})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"form-label text-dark fw-semibold mb-2",children:"Archivo Excel"}),a.jsx("input",{className:"form-control form-control-lg",type:"file",accept:".xlsx,.xls",onChange:e=>{l(e.target.files[0])}}),i&&a.jsxs("div",{className:"mt-2 p-2 bg-light rounded d-flex align-items-center",children:[a.jsx("i",{className:"fas fa-file-excel text-success me-2",style:{fontSize:"20px"}}),a.jsx("div",{className:"flex-grow-1",children:a.jsx("span",{className:"text-dark",children:i.name})}),a.jsx("button",{type:"button",className:"btn btn-sm btn-light",onClick:()=>l(null),children:a.jsx("i",{className:"fas fa-times"})})]})]}),a.jsx("button",{onClick:async()=>{if(!i)return o("Por favor, selecciona un archivo."),void u(!0);const e=new FormData;e.append("file",i),e.append("mode",p),c(!0);try{const a=await C.importData(e);if(a.error){const e=Array.isArray(a.error)?a.error.join("\n"):a.error;o(`Error en la importación:\n${e}`),u(!0)}else o(a.message),u(!1),$(s.current).dxDataGrid("instance").refresh(),$(t.current).modal("hide"),_.success("Importacion completada con exito",{description:"Todos tus productos han sido importados correctamente.",duration:3e3,position:"bottom-center",richColors:!0})}catch(a){o("Error al importar: "+(a.response?.data?.error||a.message)),u(!0)}c(!1)},disabled:n||!i,className:"btn btn-primary btn-lg w-100",type:"button",children:n?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Procesando..."]}):a.jsxs(a.Fragment,{children:[a.jsx("i",{className:"fas fa-upload me-2"}),"Importar Productos"]})}),d&&a.jsx("div",{className:`alert ${m?"alert-danger":"alert-success"} mt-3 mb-0`,role:"alert",children:a.jsxs("div",{className:"d-flex align-items-start",children:[a.jsx("i",{className:`fas ${m?"fa-exclamation-circle":"fa-check-circle"} me-2 mt-1`}),a.jsxs("div",{className:"flex-grow-1",children:[a.jsx("strong",{children:m?"Error":"Completado"}),a.jsx("div",{className:"mt-1",children:d})]})]})})]})},T=new c;new d;const A=new o,F=new m,E=({categories:s,brands:r,collections:c,stores:d,generals:o,attributes:m})=>{
//!FALTA EDIT AND DELETEDE GALERIA
const[v,_]=e.useState([]),C=e.useRef(),E=e.useRef(),I=e.useRef(),P=e.useRef(),M=e.useRef(),L=e.useRef(),z=e.useRef(),B=e.useRef(),G=e.useRef(),O=e.useRef(),W=e.useRef(),U=e.useRef(),q=e.useRef(),J=e.useRef(),K=e.useRef(),V=e.useRef(),H=e.useRef(),Q=e.useRef(),Y=e.useRef(),X=e.useRef(),Z=e.useRef(),ee=e.useRef([]),ae=e.useRef([]),se=e.useRef(),te=e.useRef(),re=e.useRef(),[ie,le]=e.useState(!1),[ne,ce]=e.useState(null),[de,oe]=e.useState(null),[me,ue]=e.useState(null),[pe,he]=e.useState([]),xe=e.useRef(),[fe,ge]=e.useState([]),be=e.useRef(),[je,ve]=e.useState([]),Ne=e.useRef(),[ye,we]=e.useState([]),[ke,Re]=e.useState([]),[_e,De]=e.useState(m||[]),[Ce,Se]=e.useState([]);e.useEffect(()=>{Te(),Ae()},[]);const Te=async()=>{const e=await A.paginate({page:1,pageSize:1e3});e?.data&&Re(e.data)},Ae=async()=>{const e=await F.paginate({page:1,pageSize:1e3});e?.data&&De(e.data)},[Fe,Ee]=e.useState(null),Ie=()=>{Ee(null)},$e=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},[Pe,Me]=e.useState(null),Le=()=>{Me(null)},ze=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},[Be,Ge]=e.useState(null),Oe=()=>{Ge(null)},We=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},Ue=e=>{if(_(e||null),le(!!e?.id),I.current.value=e?.id||"",$(P.current).val(e?.category_id||null).trigger("change"),$(M.current).val(e?.collection_id||null).trigger("change"),R(L.current,e?.subcategory?.id,e?.subcategory?.name),$(z.current).val(e?.brand_id||null).trigger("change"),$(Z.current).val(e?.store_id&&""!==e.store_id?e.store_id:"").trigger("change"),B.current.value=e?.name||"",Y.current.value=e?.sku||"",G.current.value=e?.color||"",O.current.value=e?.size||"",W.current.value=e?.summary||"",U.current.value=e?.price||0,q.current.value=e?.discount||0,se.current.value=e?.weight||0,R(J.current,e?.tags??[],"id","name"),K.current.value=null,V.current.value=null,K.image.src=e?.banner?`/storage/images/item/${e.banner}`:"",V.image.src=e?.image?`/storage/images/item/${e.image}`:"",H.image.src=e?.texture?`/storage/images/item/${e.texture}`:"",Q.editor.root.innerHTML=e?.description??"",e?.pdf&&Array.isArray(e.pdf)){const a=e.pdf.map(e=>({url:e.url?`/storage/images/item/${e.url}`:e,name:e.name||"Documento.pdf",order:e.order||0}));ge(a)}else ge([]);if(e?.linkvideo&&Array.isArray(e.linkvideo)?ve(e.linkvideo.map(e=>({url:e.url||e,order:e.order||0}))):ve([]),e?.images){const a=e.images.map(e=>({id:e.id,url:`/storage/images/item/${e.url}`}));he(a)}else he([]);if(He(e?.specifications?e.specifications.map(e=>({type:e.type,title:e.title,description:e.description,image:e.image||""})):[]),Ke(e?.features?.map(e=>"object"==typeof e?e:{feature:e})||[]),X.current.value=e?.stock,R(te.current,e?.amenities??[],"id","name"),e?.applications&&Array.isArray(e.applications)){const a=e.applications.map(e=>e.id||e);we(a),setTimeout(()=>{$(re.current).val(a).trigger("change")},100)}else we([]),setTimeout(()=>{$(re.current).val([]).trigger("change")},100);if(e?.attributes&&Array.isArray(e.attributes)){const a=e.attributes.map(e=>({attribute_id:e.id,value:e.pivot?.value||"",attribute:e}));Se(a)}else Se([]);K.deleteRef&&(K.deleteRef.value=""),V.deleteRef&&(V.deleteRef.value=""),H.deleteRef&&(H.deleteRef.value=""),$(E.current).modal("show")},qe=async({id:e,field:a,value:s})=>{await T.boolean({id:e,field:a,value:s})&&$(C.current).dxDataGrid("instance").refresh()},[Je,Ke]=e.useState([]),[Ve,He]=e.useState([]),[Qe,Ye]=e.useState(!1),Xe=e.useRef();return a.jsxs(a.Fragment,{children:[a.jsx(p,{gridRef:C,title:"Items",rest:T,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(C.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Agregar",hint:"Agregar",onClick:()=>Ue()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"upload",text:"Importar Datos",hint:"Importar Datos",onClick:()=>{$(Xe.current).modal("show")}}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"download",text:"Exportar Items",hint:"Exportar Items (Formato Excel)",onClick:()=>(async()=>{try{n.fire({title:"Exportando items...",text:"Por favor espere",allowOutsideClick:!1,didOpen:()=>{n.showLoading()}}),await T.exportData(),n.fire({icon:"success",title:"Exportación exitosa",text:"El archivo se ha descargado correctamente",timer:2e3})}catch(e){n.fire({icon:"error",title:"Error",text:e.message||"No se pudo exportar los items. Por favor intente nuevamente."})}})()}})},exportable:!0,exportableName:"Items",rowDragging:{allowReordering:!0,onReorder:async e=>{const a=e.toIndex;try{await T.reorder(e.itemData.id,a)&&$(C.current).dxDataGrid("instance").refresh()}catch(s){}},dropFeedbackMode:"push"},sorting:{mode:"single"},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"order_index",caption:"Orden",visible:!1,sortOrder:"asc",sortIndex:0},N.has("items","category_id")&&{dataField:"category.name",caption:"Categoría",width:"120px",cellTemplate:(e,{data:s})=>{e.html(t.renderToString(a.jsxs(a.Fragment,{children:[a.jsx("b",{className:"d-block fst-italic text-muted",children:s.collection?.name}),a.jsx("b",{className:"d-block",children:s.category?.name}),a.jsx("small",{className:"text-muted",children:s.subcategory?.name})]})))}},N.has("items","subcategory_id")&&{dataField:"subcategory.name",caption:"Subcategoría",visible:!1},N.has("items","brand_id")&&{dataField:"brand.name",caption:"Marca",width:"120px"},{dataField:"name",caption:"Nombre",minWidth:"300px",cellTemplate:(e,{data:s})=>{const r=((e,a)=>{if(!e)return"";const s=e.split(" ");return s.length>a?s.slice(0,a).join(" ")+"...":e})(s.summary,12);e.html(t.renderToString(a.jsxs(a.Fragment,{children:[a.jsx("b",{children:s.name}),a.jsx("br",{}),a.jsx("span",{children:r})]})))}},N.has("items","sku")&&{dataField:"sku",caption:"SKU",width:"120px"},{dataField:"final_price",caption:"Precio",dataType:"number",width:"75px",cellTemplate:(e,{data:s})=>{e.html(t.renderToString(a.jsxs(a.Fragment,{children:[s.discount>0&&a.jsxs("small",{className:"d-block text-muted",style:{textDecoration:"line-through"},children:[y()," ",w(s.price)]}),a.jsxs("span",{children:[y()," ",w(s.discount>0?s.discount:s.price)]})]})))}},N.has("items","weight")&&{dataField:"weight",caption:"Peso",dataType:"number",width:"75px"},{dataField:"image",caption:"Imagen",width:"90px",allowFiltering:!1,cellTemplate:(e,{data:s})=>{k(e,a.jsx("img",{src:`/storage/images/item/${s.image}`,style:{width:"80px",height:"48px",objectFit:"contain",objectPosition:"center",borderRadius:"4px"},onError:e=>e.target.src="/api/cover/thumbnail/null"}))}},N.has("items","banner")&&{dataField:"banner",caption:"Imagen Banner",width:"90px",allowFiltering:!1,cellTemplate:(e,{data:s})=>{k(e,a.jsx("img",{src:`/storage/images/item/${s.banner}`,style:{width:"80px",height:"48px",objectFit:"contain",objectPosition:"center",borderRadius:"4px"},onError:e=>e.target.src="/api/cover/thumbnail/null"}))}},N.has("items","is_new")&&{dataField:"is_new",caption:"Nuevo",dataType:"boolean",width:"80px",cellTemplate:(e,{data:s})=>{const t=1===s.is_new||"1"===s.is_new||!0===s.is_new;k(e,a.jsx(i,{checked:t,onChange:e=>qe({id:s.id,field:"is_new",value:e.target.checked?1:0})}))}},N.has("items","offering")&&{dataField:"offering",caption:"En oferta",dataType:"boolean",width:"80px",cellTemplate:(e,{data:s})=>{const t=1===s.offering||"1"===s.offering||!0===s.offering;k(e,a.jsx(i,{checked:t,onChange:e=>qe({id:s.id,field:"offering",value:e.target.checked?1:0})}))}},N.has("items","recommended")&&{dataField:"recommended",caption:"Recomendado",dataType:"boolean",width:"80px",cellTemplate:(e,{data:s})=>{const t=1===s.recommended||"1"===s.recommended||!0===s.recommended;k(e,a.jsx(i,{checked:t,onChange:e=>qe({id:s.id,field:"recommended",value:e.target.checked?1:0})}))}},N.has("items","featured")&&{dataField:"featured",caption:"Destacado",dataType:"boolean",width:"80px",cellTemplate:(e,{data:s})=>{const t=1===s.featured||"1"===s.featured||!0===s.featured;k(e,a.jsx(i,{checked:t,onChange:e=>qe({id:s.id,field:"featured",value:e.target.checked?1:0})}))}},N.has("items","views")&&{dataField:"views",caption:"Vistas",dataType:"number",width:"80px",cellTemplate:(e,{data:s})=>{const r=s.views||0;e.html(t.renderToString(a.jsxs("div",{className:"text-center",children:[a.jsx("i",{className:"fas fa-eye text-primary me-1"}),a.jsx("span",{className:"fw-bold",children:r.toLocaleString()})]})))}},N.has("items","most_view")&&{dataField:"most_view",caption:"Más visto",dataType:"boolean",width:"80px",cellTemplate:(e,{data:s})=>{const t=1===s.most_view||"1"===s.most_view||!0===s.most_view;k(e,a.jsx(i,{checked:t,onChange:e=>qe({id:s.id,field:"most_view",value:e.target.checked?1:0})}))}},N.has("items","is_detail")&&{dataField:"is_detail",caption:"Con Detalle",dataType:"boolean",width:"90px",cellTemplate:(e,{data:s})=>{const t=1===s.is_detail||"1"===s.is_detail||!0===s.is_detail;k(e,a.jsx(i,{checked:t,onChange:e=>qe({id:s.id,field:"is_detail",value:e.target.checked?1:0})}))}},N.has("items","sold_out")&&{dataField:"sold_out",caption:"Agotado",dataType:"boolean",width:"85px",cellTemplate:(e,{data:s})=>{const t=1===s.sold_out||"1"===s.sold_out||!0===s.sold_out;k(e,a.jsx(i,{checked:t,onChange:e=>qe({id:s.id,field:"sold_out",value:e.target.checked?1:0})}))}},N.has("items","visible")&&{dataField:"visible",caption:"Visible",dataType:"boolean",width:"80px",cellTemplate:(e,{data:s})=>{k(e,a.jsx(i,{checked:s.visible,onChange:e=>(async({id:e,value:a})=>{await T.boolean({id:e,field:"visible",value:a})&&$(C.current).dxDataGrid("instance").refresh()})({id:s.id,value:e.target.checked})}))}},{caption:"Acciones",width:"130px",cellTemplate:(e,{data:a})=>{e.css("text-overflow","unset"),e.append(j({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>Ue(a)})),e.append(j({className:"btn btn-xs btn-soft-info",title:"Clonar",icon:"fa fa-clone",onClick:()=>(e=>{const a={...e,id:null,name:e.name+" (Copia)",sku:e.sku?e.sku+"-COPY":"",clone_from_id:e.id,clone_image:e.image,clone_banner:e.banner,clone_texture:e.texture};Ue(a)})(a)})),e.append(j({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>(async e=>{const{isConfirmed:a}=await n.fire({title:"Eliminar item",text:"¿Estás seguro de eliminar este item?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});if(!a)return;await T.delete(e)&&$(C.current).dxDataGrid("instance").refresh()})(a.id)}))},allowFiltering:!1,allowExporting:!1}]}),a.jsx(u,{modalRef:E,title:ie?"Editar item":"Agregar item",onSubmit:async e=>{e.preventDefault();const a=Je.filter(e=>"string"==typeof e?""!==e.trim():"object"==typeof e&&""!==e.feature?.trim()),s=Ve.filter(e=>e.title&&""!==e.title.trim()||e.description&&""!==e.description.trim()),t={id:I.current.value||void 0,category_id:P.current.value,collection_id:M.current.value||null,subcategory_id:L.current.value,brand_id:z.current.value,name:B.current.value,sku:Y.current.value,color:G.current.value,size:O.current.value,summary:W.current.value,price:U.current.value,discount:q.current.value,tags:$(J.current).val(),description:Q.current.value,stock:X.current.value||0,features:a,specifications:s,weight:se.current.value||0,store_id:Z.current.value&&""!==Z.current.value?Z.current.value:null,amenities:$(te.current).val()||[],applications:$(re.current).val()||[],attributes:Ce.filter(e=>e.attribute_id&&e.value).map(e=>({id:e.attribute_id,value:e.value})),clone_from_id:v?.clone_from_id||null,clone_image:v?.clone_image||null,clone_banner:v?.clone_banner||null,clone_texture:v?.clone_texture||null},r=new FormData;for(const b in t)if("features"===b||"specifications"===b)r.append(b,JSON.stringify(t[b]));else if("tags"===b){const e=t[b];Array.isArray(e)?e.forEach((e,a)=>{r.append(`tags[${a}]`,e)}):e&&r.append("tags[0]",e)}else if("amenities"===b){const e=t[b];Array.isArray(e)&&e.length>0&&e.forEach((e,a)=>{r.append(`amenities[${a}]`,e)})}else if("applications"===b){const e=t[b];Array.isArray(e)&&e.length>0&&e.forEach((e,a)=>{r.append(`applications[${a}]`,e)})}else if("attributes"===b){const e=t[b];Array.isArray(e)&&e.length>0&&r.append("attributes",JSON.stringify(e))}else"clone_from_id"===b||"clone_image"===b||"clone_banner"===b||"clone_texture"===b?t[b]&&null!==t[b]&&"null"!==t[b]&&r.append(b,t[b]):"id"===b?t[b]&&""!==t[b]&&"undefined"!==t[b]&&r.append(b,t[b]):r.append(b,t[b]);const i=V.current.files[0];i&&r.append("image",i);const l=H.current.files[0];l&&r.append("texture",l);const n=K.current.files[0];n&&r.append("banner",n);const c=fe.filter(e=>!e.toDelete);let d=0;c.forEach(e=>{e.file&&(r.append(`pdf[${d}]`,e.file),d++)});const o=c.map((e,a)=>({index:a,order:a+1,name:e.name||"Documento.pdf"}));o.length>0&&r.append("pdf_order",JSON.stringify(o));const m=fe.map((e,a)=>e.toDelete?a:null).filter(e=>null!==e);m.length>0&&r.append("deleted_pdfs",JSON.stringify(m));const u=je.filter(e=>!e.toDelete).map((e,a)=>({url:e.url,order:a+1}));u.length>0&&r.append("linkvideo",JSON.stringify(u));const p=je.map((e,a)=>e.toDelete?a:null).filter(e=>null!==e);p.length>0&&r.append("deleted_videos",JSON.stringify(p)),K.getDeleteFlag&&K.getDeleteFlag()&&r.append("banner_delete","DELETE"),V.getDeleteFlag&&V.getDeleteFlag()&&r.append("image_delete","DELETE"),H.getDeleteFlag&&H.getDeleteFlag()&&r.append("texture_delete","DELETE");let h=0,x=0;const f=[];pe.forEach((e,a)=>{e.toDelete||(e.file?(r.append(`gallery[${h}]`,e.file),f.push({type:"new",index:h}),h++):(r.append(`gallery_ids[${x}]`,e.id),f.push({type:"existing",id:e.id,index:x}),x++))}),f.length>0&&r.append("gallery_order",JSON.stringify(f));const g=pe.filter(e=>e.toDelete).map(e=>e.id);g.length>0&&g.forEach((e,a)=>{r.append(`deleted_images[${a}]`,e)});for(let[b,j]of r.entries());await T.save(r)&&(K.resetDeleteFlag&&K.resetDeleteFlag(),V.resetDeleteFlag&&V.resetDeleteFlag(),H.resetDeleteFlag&&H.resetDeleteFlag(),$(C.current).dxDataGrid("instance").refresh(),$(E.current).modal("hide"),he([]),ge([]),ve([]))},size:"xl",children:a.jsxs("div",{id:"principal-container",children:[a.jsx("input",{ref:I,type:"hidden"}),a.jsxs("ul",{className:"nav nav-pills nav-justified mb-4",role:"tablist",style:{backgroundColor:"#f8f9fa",borderRadius:"8px",padding:"4px",border:"1px solid #e9ecef"},children:[a.jsx("li",{className:"nav-item",role:"presentation",children:a.jsxs("button",{className:"nav-link active",id:"basic-info-tab","data-bs-toggle":"pill","data-bs-target":"#basic-info",type:"button",role:"tab","aria-controls":"basic-info","aria-selected":"true",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[a.jsx("i",{className:"fas fa-info-circle me-2"}),"Información Básica"]})}),a.jsx("li",{className:"nav-item",role:"presentation",children:a.jsxs("button",{className:"nav-link",id:"pricing-tab","data-bs-toggle":"pill","data-bs-target":"#pricing",type:"button",role:"tab","aria-controls":"pricing","aria-selected":"false",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[a.jsx("i",{className:"fas fa-dollar-sign me-2"}),"Precios y Stock"]})}),a.jsx("li",{className:"nav-item",role:"presentation",children:a.jsxs("button",{className:"nav-link",id:"multimedia-tab","data-bs-toggle":"pill","data-bs-target":"#multimedia",type:"button",role:"tab","aria-controls":"multimedia","aria-selected":"false",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[a.jsx("i",{className:"fas fa-images me-2"}),"Multimedia"]})}),a.jsx("li",{className:"nav-item",role:"presentation",children:a.jsxs("button",{className:"nav-link",id:"features-tab","data-bs-toggle":"pill","data-bs-target":"#features",type:"button",role:"tab","aria-controls":"features","aria-selected":"false",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[a.jsx("i",{className:"fas fa-list-ul me-2"}),"Características"]})})]}),a.jsxs("div",{className:"tab-content",children:[a.jsx("div",{className:"tab-pane fade show active",id:"basic-info",role:"tabpanel","aria-labelledby":"basic-info-tab",children:a.jsxs("div",{className:"row g-3",children:[a.jsx("div",{className:"col-md-6",children:a.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[a.jsx("div",{className:"card-header",children:a.jsxs("h6",{className:"mb-0",children:[a.jsx("i",{className:"fas fa-tag me-2"}),"Identificación"]})}),a.jsxs("div",{className:"card-body",children:[a.jsx(x,{eRef:Y,label:"SKU",required:!0,hidden:!N.has("items","sku")}),a.jsx(x,{eRef:B,label:"Nombre del Producto",required:!0,hidden:!N.has("items","name")}),a.jsxs("div",{className:"row",children:[a.jsx("div",{className:"col-md-6",children:a.jsx(x,{eRef:G,label:"Color",required:!0,hidden:!N.has("items","color")})}),a.jsx("div",{className:"col-md-6",children:a.jsx(x,{eRef:O,label:"Talla",required:!0,hidden:!N.has("items","size")})}),a.jsx("div",{className:"col-md-6",children:a.jsx(x,{eRef:se,label:"Peso",hidden:!N.has("items","weight")})})]})]})]})}),a.jsx("div",{className:"col-md-6",children:a.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[a.jsx("div",{className:"card-header",children:a.jsxs("h6",{className:"mb-0",children:[a.jsx("i",{className:"fas fa-sitemap me-2"}),"Categorización"]})}),a.jsxs("div",{className:"card-body",children:[a.jsx(b,{eRef:P,label:"Categoría",required:!0,dropdownParent:"#principal-container",onChange:e=>ce(e.target.value),hidden:!N.has("items","category_id"),children:s.map((e,s)=>a.jsx("option",{value:e.id,children:e.name},s))}),a.jsx(b,{eRef:M,label:"Colección",dropdownParent:"#principal-container",onChange:e=>oe(e.target.value),hidden:!N.has("items","collection_id"),children:c.map((e,s)=>a.jsx("option",{value:e.id,children:e.name},s))}),a.jsx(g,{eRef:L,label:"Subcategoría",searchAPI:"/api/admin/subcategories/paginate",searchBy:"name",filter:["category_id","=",ne],dropdownParent:"#principal-container",hidden:!N.has("items","subcategory_id")}),a.jsx(b,{eRef:z,label:"Marca",dropdownParent:"#principal-container",hidden:!N.has("items","brand_id"),children:r.map((e,s)=>a.jsx("option",{value:e.id,children:e.name},s))})]})]})}),a.jsxs("div",{className:"col-12",children:[a.jsxs("div",{className:"card border-0 shadow-sm",children:[a.jsx("div",{className:"card-header",children:a.jsxs("h6",{className:"mb-0",children:[a.jsx("i",{className:"fas fa-align-left me-2"}),"Descripción"]})}),a.jsxs("div",{className:"card-body",children:[a.jsx(l,{eRef:W,label:"Resumen",rows:3,hidden:!N.has("items","summary")}),a.jsxs(b,{eRef:Z,label:"Tienda",dropdownParent:"#principal-container",onChange:e=>ue(e.target.value),hidden:!N.has("items","store_id"),children:[a.jsx("option",{value:"",children:"Seleccionar tienda (opcional)"}),d.map((e,s)=>a.jsx("option",{value:e.id,children:e.name},s))]}),a.jsx(g,{id:"tags",eRef:J,searchAPI:"/api/admin/tags/paginate",searchBy:"name",label:"Tags",hidden:!N.has("items","is_tags"),dropdownParent:"#principal-container",tags:!0,multiple:!0})]})]}),a.jsx("div",{className:"col-12",children:a.jsxs("div",{className:"card border-0 shadow-sm",children:[a.jsx("div",{className:"card-header",children:a.jsxs("h6",{className:"mb-0",children:[a.jsx("i",{className:"fas fa-edit me-2"}),"Descripción Detallada"]})}),a.jsx("div",{className:"card-body",children:a.jsx(f,{eRef:Q,label:"Descripción Completa"})})]})})]})]})}),a.jsx("div",{className:"tab-pane fade",id:"pricing",role:"tabpanel","aria-labelledby":"pricing-tab",children:a.jsxs("div",{className:"row g-3",children:[a.jsx("div",{className:"col-md-6",children:a.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[a.jsx("div",{className:"card-header",children:a.jsxs("h6",{className:"mb-0",children:[a.jsx("i",{className:"fas fa-dollar-sign me-2"}),"Precios"]})}),a.jsxs("div",{className:"card-body",children:[a.jsx(x,{eRef:U,label:"Precio Regular",type:"number",step:"0.01",required:!0,hidden:!N.has("items","price")}),a.jsx(x,{eRef:q,label:"Precio con Descuento",type:"number",step:"0.01"})]})]})}),a.jsx("div",{className:"col-md-6",children:a.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[a.jsx("div",{className:"card-header",children:a.jsxs("h6",{className:"mb-0",children:[a.jsx("i",{className:"fas fa-boxes me-2"}),"Inventario"]})}),a.jsx("div",{className:"card-body",children:a.jsx(x,{label:"Stock Disponible",eRef:X,type:"number",required:!0,hidden:!N.has("items","stock")})})]})})]})}),a.jsx("div",{className:"tab-pane fade",id:"multimedia",role:"tabpanel","aria-labelledby":"multimedia-tab",children:a.jsxs("div",{className:"row g-3",children:[a.jsx("div",{className:"col-md-6",children:a.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[a.jsx("div",{className:"card-header",children:a.jsxs("h6",{className:"mb-0",children:[a.jsx("i",{className:"fas fa-image me-2"}),"Imágenes Principales"]})}),a.jsx("div",{className:"card-body",children:a.jsxs("div",{className:"row",children:[a.jsx(h,{eRef:K,name:"banner",label:"Banner",aspect:2,col:"col-12",hidden:!N.has("items","banner")}),a.jsx(h,{eRef:V,name:"image",label:"Imagen Principal",aspect:1,col:"col-md-6",hidden:!N.has("items","image")}),a.jsx(h,{eRef:H,name:"texture",label:"Textura",aspect:1,col:"col-md-6",hidden:!N.has("items","texture")})]})})]})}),a.jsx("div",{className:"col-md-6",children:a.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[a.jsx("div",{className:"card-header",children:a.jsxs("h6",{className:"mb-0",children:[a.jsx("i",{className:"fas fa-photo-video me-2"}),"Galería y Multimedia"]})}),a.jsxs("div",{className:"card-body",children:[a.jsxs("div",{className:"mb-3",children:[a.jsxs("label",{className:"form-label fw-semibold text-dark mb-3",children:[a.jsx("i",{className:"fas fa-images me-2 text-primary"}),"Galería de Imágenes",pe.filter(e=>!e.toDelete).length>0&&a.jsx("span",{className:"badge bg-primary ms-2",children:pe.filter(e=>!e.toDelete).length})]}),a.jsx("input",{id:"input-item-gallery",ref:xe,type:"file",multiple:!0,accept:"image/*",hidden:!0,onChange:e=>{const a=Array.from(e.target.files).map(e=>({file:e,url:URL.createObjectURL(e)}));he(e=>[...e,...a])}}),a.jsxs("div",{className:"gallery-container",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"16px",padding:"16px",backgroundColor:"#f8f9fa",borderRadius:"12px",border:"2px dashed #dee2e6",minHeight:"160px"},children:[pe.filter(e=>!e.toDelete).map((e,s)=>{const t=pe.findIndex(a=>a===e),r=s+1;return a.jsxs("div",{className:"gallery-item position-relative",draggable:!0,onDragStart:e=>((e,a)=>{Ee(a),e.dataTransfer.effectAllowed="move"})(e,t),onDragEnd:Ie,onDragOver:$e,onDrop:e=>((e,a)=>{if(e.preventDefault(),null===Fe||Fe===a)return;const s=[...pe],t=s[Fe];s.splice(Fe,1),s.splice(a,0,t),he(s),Ee(null)})(e,t),style:{aspectRatio:"1",borderRadius:"12px",overflow:"hidden",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",transition:"all 0.3s ease",cursor:"grab",transform:Fe===t?"scale(1.05)":"scale(1)",opacity:Fe===t?.8:1,border:"3px solid transparent",background:"white"},onMouseEnter:e=>{null===Fe&&(e.currentTarget.style.transform="scale(1.02)",e.currentTarget.style.boxShadow="0 6px 20px rgba(0,0,0,0.15)")},onMouseLeave:e=>{null===Fe&&(e.currentTarget.style.transform="scale(1)",e.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)")},children:[a.jsx("div",{className:"position-absolute top-0 start-0 m-2",children:a.jsx("span",{className:"badge bg-primary rounded-circle d-flex align-items-center justify-content-center",style:{width:"24px",height:"24px",fontSize:"11px",fontWeight:"bold"},children:r})}),a.jsx("img",{src:e.url,alt:`Imagen ${r}`,className:"w-100 h-100",style:{objectFit:"cover",pointerEvents:"none"}}),a.jsx("div",{className:"position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{background:"rgba(0,0,0,0.7)",opacity:0,transition:"opacity 0.3s ease"},onMouseEnter:e=>e.currentTarget.style.opacity=1,onMouseLeave:e=>e.currentTarget.style.opacity=0,children:a.jsxs("div",{className:"d-flex gap-2",children:[a.jsx("button",{type:"button",className:"btn btn-light btn-sm rounded-circle d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},title:"Mover imagen",children:a.jsx("i",{className:"fas fa-arrows-alt text-dark"})}),a.jsx("button",{type:"button",className:"btn btn-danger btn-sm rounded-circle d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},onClick:e=>((e,a)=>{e.preventDefault(),pe[a].id?he(e=>e.map((e,s)=>s===a?{...e,toDelete:!0}:e)):he(e=>e.filter((e,s)=>s!==a))})(e,t),title:"Eliminar imagen",children:a.jsx("i",{className:"fas fa-trash text-white"})})]})})]},t)}),a.jsx("div",{className:"gallery-add-button d-flex flex-column align-items-center justify-content-center",style:{aspectRatio:"1",border:"3px dashed #71b6f9",borderRadius:"12px",backgroundColor:"rgba(13, 110, 253, 0.05)",cursor:"pointer",transition:"all 0.3s ease",minHeight:"120px"},onClick:()=>xe.current.click(),onDrop:e=>{e.preventDefault();const a=Array.from(e.dataTransfer.files).map(e=>({file:e,url:URL.createObjectURL(e)}));he(e=>[...e,...a])},onDragOver:e=>{e.preventDefault()},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(13, 110, 253, 0.1)",e.currentTarget.style.borderColor="#0056b3",e.currentTarget.style.transform="scale(1.02)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="rgba(13, 110, 253, 0.05)",e.currentTarget.style.borderColor="#0d6efd",e.currentTarget.style.transform="scale(1)"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"mb-2 bg-primary",style:{width:"48px",height:"48px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto"},children:a.jsx("i",{className:"fas fa-plus text-white fa-lg"})}),a.jsx("p",{className:"mb-0 text-primary fw-semibold",style:{fontSize:"12px"},children:"Agregar Imagen"}),a.jsx("small",{className:"text-muted",style:{fontSize:"10px"},children:"Arrastra o haz clic"})]})})]}),0===pe.filter(e=>!e.toDelete).length&&a.jsxs("div",{className:"text-center py-4 text-muted",children:[a.jsx("i",{className:"fas fa-images fa-3x mb-3 opacity-50"}),a.jsx("p",{className:"mb-1",children:"No hay imágenes en la galería"}),a.jsx("small",{children:'Arrastra archivos aquí o haz clic en "Agregar Imagen"'})]})]}),a.jsxs("div",{className:"mb-4",hidden:!N.has("items","pdf"),children:[a.jsxs("label",{className:"form-label fw-semibold text-dark mb-3",children:[a.jsx("i",{className:"fas fa-file-pdf me-2 text-danger"}),"Archivos PDF (Manuales / Catálogos)",fe.filter(e=>!e.toDelete).length>0&&a.jsx("span",{className:"badge bg-danger ms-2",children:fe.filter(e=>!e.toDelete).length})]}),a.jsx("input",{ref:be,type:"file",multiple:!0,accept:".pdf",hidden:!0,onChange:e=>{const a=Array.from(e.target.files).map(e=>({file:e,name:e.name,url:URL.createObjectURL(e)}));ge(e=>[...e,...a])}}),a.jsx("div",{className:"list-group mb-3",children:fe.filter(e=>!e.toDelete).map((e,s)=>{const t=fe.findIndex(a=>a===e);return a.jsxs("div",{draggable:!0,onDragStart:e=>((e,a)=>{Me(a),e.dataTransfer.effectAllowed="move"})(e,t),onDragEnd:Le,onDragOver:ze,onDrop:e=>((e,a)=>{if(e.preventDefault(),null===Pe||Pe===a)return;const s=[...fe],t=s[Pe];s.splice(Pe,1),s.splice(a,0,t),ge(s),Me(null)})(e,t),className:"list-group-item d-flex align-items-center justify-content-between",style:{cursor:"grab",opacity:Pe===t?.5:1,backgroundColor:Pe===t?"#f8f9fa":"white",transition:"all 0.2s ease"},children:[a.jsxs("div",{className:"d-flex align-items-center flex-grow-1",style:{minWidth:0},children:[a.jsx("span",{className:"badge bg-danger me-3",style:{minWidth:"28px"},children:s+1}),a.jsx("i",{className:"fas fa-grip-vertical text-muted me-3"}),a.jsx("i",{className:"fas fa-file-pdf text-danger me-2"}),a.jsx("span",{className:"text-truncate",style:{maxWidth:"250px"},children:e.name})]}),a.jsxs("div",{className:"d-flex gap-2 flex-shrink-0",children:[!e.file&&a.jsx("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-outline-primary",children:a.jsx("i",{className:"fas fa-eye"})}),a.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:e=>((e,a)=>{e.preventDefault();const s=fe[a];s.url&&!s.file?ge(e=>e.map((e,s)=>s===a?{...e,toDelete:!0}:e)):ge(e=>e.filter((e,s)=>s!==a))})(e,t),children:a.jsx("i",{className:"fas fa-trash"})})]})]},t)})}),a.jsxs("button",{type:"button",className:"btn btn-outline-danger w-100",onClick:()=>be.current.click(),children:[a.jsx("i",{className:"fas fa-plus me-2"}),"Agregar PDFs"]})]}),a.jsxs("div",{className:"mb-3",hidden:!N.has("items","linkvideo"),children:[a.jsxs("label",{className:"form-label fw-semibold text-dark mb-3",children:[a.jsx("i",{className:"fas fa-video me-2 text-success"}),"Links de Videos",je.filter(e=>!e.toDelete).length>0&&a.jsx("span",{className:"badge bg-success ms-2",children:je.filter(e=>!e.toDelete).length})]}),a.jsx("div",{className:"list-group mb-3",children:je.filter(e=>!e.toDelete).map((e,s)=>{const t=je.findIndex(a=>a===e);return a.jsxs("div",{draggable:!0,onDragStart:e=>((e,a)=>{Ge(a),e.dataTransfer.effectAllowed="move"})(e,t),onDragEnd:Oe,onDragOver:We,onDrop:e=>((e,a)=>{if(e.preventDefault(),null===Be||Be===a)return;const s=[...je],t=s[Be];s.splice(Be,1),s.splice(a,0,t),ve(s),Ge(null)})(e,t),className:"list-group-item d-flex align-items-center justify-content-between",style:{cursor:"grab",opacity:Be===t?.5:1,backgroundColor:Be===t?"#f8f9fa":"white",transition:"all 0.2s ease"},children:[a.jsxs("div",{className:"d-flex align-items-center flex-grow-1",style:{minWidth:0,overflow:"hidden"},children:[a.jsx("span",{className:"badge bg-success me-3 flex-shrink-0",style:{minWidth:"28px"},children:s+1}),a.jsx("i",{className:"fas fa-grip-vertical text-muted me-3 flex-shrink-0"}),a.jsx("i",{className:"fas fa-video text-success me-2 flex-shrink-0"}),a.jsx("span",{className:"small",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%"},title:e.url,children:e.url})]}),a.jsxs("div",{className:"d-flex gap-2 flex-shrink-0 ms-2",children:[a.jsx("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-outline-primary",children:a.jsx("i",{className:"fas fa-external-link-alt"})}),a.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:e=>((e,a)=>{e.preventDefault();const s=je[a];s.order&&!s.new?ve(e=>e.map((e,s)=>s===a?{...e,toDelete:!0}:e)):ve(e=>e.filter((e,s)=>s!==a))})(e,t),children:a.jsx("i",{className:"fas fa-trash"})})]})]},t)})}),a.jsxs("div",{className:"input-group",children:[a.jsx("input",{ref:Ne,type:"url",className:"form-control",placeholder:"https://youtube.com/watch?v=..."}),a.jsxs("button",{type:"button",className:"btn btn-success",onClick:e=>{e.preventDefault();const a=Ne.current.value.trim();a&&(ve(e=>[...e,{url:a,order:e.length+1}]),Ne.current.value="")},children:[a.jsx("i",{className:"fas fa-plus me-2"}),"Agregar"]})]})]})]})]})})]})}),a.jsx("div",{className:"tab-pane fade",id:"features",role:"tabpanel","aria-labelledby":"features-tab",children:a.jsxs("div",{className:"row g-3",children:[N.has("items","is_features")&&a.jsx("div",{className:""+(N.has("items","is_specifications")?"col-md-6":"col-12"),children:a.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[a.jsx("div",{className:"card-header",children:a.jsxs("h6",{className:"mb-0",children:[a.jsx("i",{className:"fas fa-list-ul me-2"}),"Características"]})}),a.jsx("div",{className:"card-body",children:a.jsx(D,{ref:ee,label:"Lista de Características",structure:"",value:Je,onChange:Ke})})]})}),N.has("items","is_specifications")&&a.jsx("div",{className:""+(N.has("items","is_features")?"col-md-6":"col-12"),children:a.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[a.jsx("div",{className:"card-header",children:a.jsxs("h6",{className:"mb-0",children:[a.jsx("i",{className:"fas fa-cogs me-2"}),"Especificaciones"]})}),a.jsx("div",{className:"card-body",children:a.jsx(D,{ref:ae,label:"Especificaciones Técnicas",structure:{type:"",title:"",description:""},value:Ve,onChange:He,typeOptions:["Principal","General"]})})]})}),N.has("items","is_amenities")&&a.jsx("div",{className:"col-12",children:a.jsxs("div",{className:"card border-0 shadow-sm",children:[a.jsx("div",{className:"card-header bg-light",children:a.jsxs("h6",{className:"mb-0",children:[a.jsx("i",{className:"fas fa-star-circle me-2 text-warning"}),"Cualidades"]})}),a.jsxs("div",{className:"card-body",children:[a.jsx(g,{eRef:te,searchAPI:"/api/admin/amenities/paginate",searchBy:"name",label:"Seleccionar Cualidades",dropdownParent:"#principal-container",multiple:!0}),a.jsxs("small",{className:"text-muted",children:[a.jsx("i",{className:"fas fa-info-circle me-1"}),"Selecciona las cualidades o atributos que destacan este producto"]})]})]})}),N.has("items","is_applications")&&a.jsx("div",{className:"col-12",children:a.jsxs("div",{className:"card border-0 shadow-sm",children:[a.jsx("div",{className:"card-header",children:a.jsxs("h6",{className:"mb-0",children:[a.jsx("i",{className:"fas fa-th-large me-2 text-info"}),"Aplicaciones / Usos"]})}),a.jsxs("div",{className:"card-body",children:[a.jsx(b,{eRef:re,label:"Seleccionar Aplicaciones",dropdownParent:"#principal-container",multiple:!0,children:ke.map(e=>a.jsx("option",{value:e.id,"data-image":e.image,"data-icon":e.icon,children:e.name},e.id))}),a.jsxs("small",{className:"text-muted",children:[a.jsx("i",{className:"fas fa-info-circle me-1"}),"Selecciona las industrias o usos donde se aplica este producto"]})]})]})}),N.has("items","is_attributes")&&_e.length>0&&a.jsx("div",{className:"col-12",children:a.jsxs("div",{className:"card border-0 shadow-sm overflow-hidden",children:[a.jsx("div",{className:"card-header bg-gradient",children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsxs("div",{className:"d-flex align-items-center",children:[a.jsx("div",{className:"",style:{width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsx("i",{className:"fas fa-sliders-h text-primarye"})}),a.jsxs("div",{children:[a.jsx("h6",{className:"mb-0  fw-bold",children:"Atributos Técnicos"}),a.jsx("small",{className:"",children:"Especificaciones del producto"})]})]}),a.jsxs("div",{className:"d-flex align-items-center gap-2",children:[Ce.length>0&&a.jsxs("span",{className:"badge bg-white text-primary fw-bold px-3 py-2",style:{fontSize:"0.85rem"},children:[Ce.length," ",1===Ce.length?"atributo":"atributos"]}),a.jsxs("button",{type:"button",className:"btn btn-light btn-sm fw-semibold d-flex align-items-center gap-2",onClick:()=>{Se([...Ce,{attribute_id:"",value:"",attribute:null}])},style:{borderRadius:"20px",padding:"8px 16px"},children:[a.jsx("i",{className:"fas fa-plus"}),a.jsx("span",{children:"Agregar"})]})]})]})}),a.jsx("div",{className:"card-body p-4",style:{backgroundColor:"#f8f9ff"},children:0===Ce.length?a.jsxs("div",{className:"text-center py-5",children:[a.jsx("div",{className:"mb-4",children:a.jsx("div",{className:"rounded-circle mx-auto d-flex align-items-center justify-content-center",style:{width:"80px",height:"80px",background:"linear-gradient(135deg, #667eea20 0%, #764ba220 100%)",border:"2px dashed #667eea50"},children:a.jsx("i",{className:"fas fa-layer-group fa-2x",style:{color:"#667eea"}})})}),a.jsx("h6",{className:"text-muted mb-2",children:"Sin atributos configurados"}),a.jsx("p",{className:"text-muted small mb-4",style:{maxWidth:"300px",margin:"0 auto"},children:"Agrega atributos técnicos como dimensiones, peso, material y más para detallar tu producto."}),a.jsxs("button",{type:"button",className:"btn btn-outline-primary btn-sm px-4",onClick:()=>{Se([...Ce,{attribute_id:"",value:"",attribute:null}])},style:{borderRadius:"20px"},children:[a.jsx("i",{className:"fas fa-plus me-2"}),"Agregar primer atributo"]})]}):a.jsxs("div",{className:"attributes-list",children:[Ce.map((e,s)=>{const t=_e.find(a=>a.id===e.attribute_id),r={text:"#3b82f6",number:"#10b981",select:"#f59e0b",color:"#ec4899"};return a.jsx("div",{className:"attribute-item mb-3 p-3 bg-white rounded-3 border",style:{borderColor:t?r[t.type]+"40":"#e5e7eb",borderLeftWidth:"4px",borderLeftColor:t?r[t.type]:"#e5e7eb",transition:"all 0.2s ease",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:a.jsxs("div",{className:"row g-3 align-items-center",children:[a.jsx("div",{className:"col-auto",children:a.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center fw-bold",style:{width:"32px",height:"32px",backgroundColor:t?r[t.type]+"15":"#f3f4f6",color:t?r[t.type]:"#9ca3af",fontSize:"0.85rem"},children:s+1})}),a.jsxs("div",{className:"col-md-4",children:[a.jsxs("label",{className:"form-label small text-muted mb-1 d-flex align-items-center gap-2",children:[a.jsx("i",{className:"fas fa-tag",style:{fontSize:"0.7rem"}}),"Atributo"]}),a.jsxs("select",{className:"form-select",value:e.attribute_id,onChange:e=>{const a=[...Ce],t=_e.find(a=>a.id===e.target.value);a[s]={...a[s],attribute_id:e.target.value,attribute:t,value:""},Se(a)},style:{borderRadius:"8px"},children:[a.jsx("option",{value:"",children:"Seleccionar..."}),_e.filter(e=>!Ce.some((a,t)=>t!==s&&a.attribute_id===e.id)).map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]})]}),a.jsxs("div",{className:"col",children:[a.jsxs("label",{className:"form-label small text-muted mb-1 d-flex align-items-center gap-2",children:[t&&a.jsx("i",{className:`fas ${{text:"fa-font",number:"fa-hashtag",select:"fa-list-ul",color:"fa-palette"}[t.type]}`,style:{fontSize:"0.7rem",color:r[t.type]}}),"Valor",t?.unit&&a.jsx("span",{className:"badge ms-1",style:{backgroundColor:r[t.type]+"20",color:r[t.type],fontSize:"0.7rem",fontWeight:"600"},children:t.unit})]}),"select"===t?.type&&t?.options?a.jsxs("select",{className:"form-select",value:e.value,onChange:e=>{const a=[...Ce];a[s].value=e.target.value,Se(a)},style:{borderRadius:"8px"},children:[a.jsx("option",{value:"",children:"Seleccionar opción..."}),t.options.map((e,s)=>a.jsx("option",{value:e,children:e},s))]}):"color"===t?.type?a.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[a.jsx("input",{type:"color",className:"form-control form-control-color p-1",value:e.value||"#6366f1",onChange:e=>{const a=[...Ce];a[s].value=e.target.value,Se(a)},style:{width:"50px",height:"38px",borderRadius:"8px",cursor:"pointer"}}),a.jsx("input",{type:"text",className:"form-control",value:e.value||"#6366f1",onChange:e=>{const a=[...Ce];a[s].value=e.target.value,Se(a)},placeholder:"#000000",style:{borderRadius:"8px",fontFamily:"monospace"}})]}):a.jsx("input",{type:"number"===t?.type?"number":"text",className:"form-control",placeholder:t?`Ingresa ${t.name.toLowerCase()}${t?.unit?` en ${t.unit}`:""}`:"Selecciona un atributo primero",value:e.value,disabled:!t,onChange:e=>{const a=[...Ce];a[s].value=e.target.value,Se(a)},style:{borderRadius:"8px"}})]}),a.jsx("div",{className:"col-auto",children:a.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm d-flex align-items-center justify-content-center",onClick:()=>{Se(Ce.filter((e,a)=>a!==s))},title:"Eliminar atributo",style:{width:"38px",height:"38px",borderRadius:"8px",marginTop:"24px"},children:a.jsx("i",{className:"fas fa-trash-alt"})})})]})},s)}),a.jsxs("div",{className:"add-more-btn text-center py-3 rounded-3 mt-2",style:{border:"2px dashed #667eea50",backgroundColor:"#667eea08",cursor:"pointer",transition:"all 0.2s ease"},onClick:()=>{Se([...Ce,{attribute_id:"",value:"",attribute:null}])},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#667eea15",e.currentTarget.style.borderColor="#667eea"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#667eea08",e.currentTarget.style.borderColor="#667eea50"},children:[a.jsx("i",{className:"fas fa-plus me-2",style:{color:"#667eea"}}),a.jsx("span",{style:{color:"#667eea",fontWeight:"500"},children:"Agregar otro atributo"})]})]})})]})})]})})]})]})}),a.jsx(u,{modalRef:Xe,title:"Importar Datos",size:"lg",children:a.jsx(S,{gridRef:C,modalRef:Xe,excelTemplate:Array.isArray(o)?o.find(e=>"excel_import_template"===e.correlative)?.description:null})})]})};v((e,t)=>{s.createRoot(e).render(a.jsx(r,{...t,title:"Items",children:a.jsx(E,{...t})}))});
