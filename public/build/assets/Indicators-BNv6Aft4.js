var F=Object.defineProperty;var E=(s,t,l)=>t in s?F(s,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[t]=l;var f=(s,t,l)=>E(s,typeof t!="symbol"?t+"":t,l);import{j as i}from"./AboutSimple-Cf8x2fCZ.js";import{B}from"./Base-CM9wJyDx.js";import{S as T}from"./SwitchFormGroup-DXN0cwVk.js";import{T as C}from"./TextareaFormGroup-CliirJM1.js";import{r as n}from"./index-BOnQTV8N.js";import{c as k}from"./ReactAppend-QR5TrZfj.js";import{S as I}from"./ProductCard-D9l7c7at.js";import{B as S}from"./BasicRest-BML1C-ua.js";import{M as G}from"./Modal-xDw9ufjg.js";import{D as R}from"./DxButton-DV0H-ZcL.js";import{I as x}from"./InputFormGroup-iZIO11ZN.js";import{T as _}from"./Table-CjKaEY3W.js";import{C as A}from"./CreateReactScript-ddpUFpqR.js";import{R as w}from"./ReactAppend-Vm5G2nof.js";import{I as M}from"./ImageFormGroup-40MuGzez.js";import"./index-yBjzXJbu.js";import"./Global-CazroCzF.js";import"./tippy-react.esm-DmkRJDEW.js";import"./index-pSueRYGM.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-B6ujFmsw.js";/* empty css              */import"./Logout-BpuTJ_83.js";import"./main-B6F2O9-U.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./MenuItemContainer-DcxtOi47.js";import"./index.esm-C48oHfFw.js";import"./index-ngrFHoWO.js";import"./CanAccess-CvMo-oCB.js";import"./CardProductKatya-ncpmQ0JU.js";import"./BooleanLimit-D-OsQsek.js";/* empty css               */import"./General-apRuNwp7.js";import"./LaravelSession-Dz9cpV3l.js";class q extends S{constructor(){super(...arguments);f(this,"path","admin/indicators");f(this,"hasFiles",!0)}}const a=new q,V=()=>{const s=n.useRef(),t=n.useRef(),l=n.useRef(),o=n.useRef(),m=n.useRef(),d=n.useRef(),u=n.useRef(),p=n.useRef(),[b,h]=n.useState(!1),j=e=>{e!=null&&e.id?h(!0):h(!1),o.resetDeleteFlag&&o.resetDeleteFlag(),l.current.value=(e==null?void 0:e.id)??"",m.current.value=(e==null?void 0:e.name)??"",d.current.value=(e==null?void 0:e.description)??"",u.current.value=(e==null?void 0:e.button_text)??"",p.current.value=(e==null?void 0:e.button_link)??"",o.current.value=null,o.image.src=e!=null&&e.symbol?`/storage/images/indicator/${e.symbol}`:"",$(t.current).modal("show")},N=async e=>{e.preventDefault();const r={id:l.current.value||void 0,name:m.current.value,description:d.current.value,button_text:u.current.value,button_link:p.current.value},c=new FormData;for(const v in r)c.append(v,r[v]);const g=o.current.files[0];g&&c.append("symbol",g),o.getDeleteFlag&&o.getDeleteFlag()&&c.append("symbol_delete","DELETE"),await a.save(c)&&(o.resetDeleteFlag&&o.resetDeleteFlag(),$(s.current).dxDataGrid("instance").refresh(),$(t.current).modal("hide"))},y=async({id:e,value:r})=>{await a.boolean({id:e,field:"visible",value:r})&&$(s.current).dxDataGrid("instance").refresh()},D=async e=>{const{isConfirmed:r}=await I.fire({title:"Eliminar indicador",text:"¿Estas seguro de eliminar este indicador?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});!r||!await a.delete(e)||$(s.current).dxDataGrid("instance").refresh()};return i.jsxs(i.Fragment,{children:[i.jsx(_,{gridRef:s,title:"Indicadores",rest:a,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(s.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo indicador",hint:"Nuevo indicador",onClick:()=>j()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"symbol",caption:"Símbolo",width:100,cellTemplate:(e,{data:r})=>{w(e,i.jsx("img",{src:`/storage/images/indicator/${r.symbol}`,style:{width:"60px",height:"60px",objectFit:"contain",objectPosition:"center",borderRadius:"4px"},onError:c=>c.target.src="/api/cover/thumbnail/null"}))}},{dataField:"name",caption:"Número",width:100},{dataField:"description",caption:"Descripción"},{dataField:"button_text",caption:"Texto del Botón",width:150},{dataField:"visible",caption:"Visible",width:80,dataType:"boolean",cellTemplate:(e,{data:r})=>{$(e).empty(),w(e,i.jsx(T,{checked:r.visible==1,onChange:()=>y({id:r.id,value:!r.visible})}))}},{caption:"Acciones",width:120,cellTemplate:(e,{data:r})=>{e.append(R({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>j(r)})),e.append(R({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>D(r.id)}))},allowFiltering:!1,allowExporting:!1}]}),i.jsx(G,{modalRef:t,title:b?"Editar indicador":"Agregar indicador",onSubmit:N,size:"lg",children:i.jsxs("div",{className:"row",id:"indicators-container",children:[i.jsx("input",{ref:l,type:"hidden"}),i.jsx("div",{className:"col-md-7 mb-3",children:i.jsx("div",{className:"card border-0 shadow-sm h-100",children:i.jsxs("div",{className:"card-body",children:[i.jsx(x,{eRef:m,label:"Título",col:"col-12",required:!0,placeholder:"Ej: 100+"}),i.jsx(C,{eRef:d,label:"Descripción",col:"col-12",rows:4,placeholder:"Descripción del indicador"})]})})}),i.jsx("div",{className:"col-md-5 mb-3",children:i.jsx("div",{className:"card border-0 shadow-sm h-100",children:i.jsxs("div",{className:"card-body d-flex flex-column",children:[i.jsx("div",{className:"flex-grow-1 d-flex align-items-center justify-content-center",children:i.jsx(M,{eRef:o,name:"symbol",label:"Imagen del símbolo",col:"col-12",required:!b,aspect:"1/1"})}),i.jsxs("small",{className:"text-muted mt-2",children:[i.jsx("i",{className:"mdi mdi-information me-1"}),"Recomendado: imagen cuadrada (1:1)"]})]})})}),i.jsx("div",{className:"col-12",children:i.jsx("div",{className:"card border-0 shadow-sm",children:i.jsxs("div",{className:"card-body",children:[i.jsxs("h6",{className:"card-title text-muted mb-3",children:[i.jsx("i",{className:"mdi mdi-link-variant me-2"}),"Botón de Acción (Opcional)"]}),i.jsxs("div",{className:"row",children:[i.jsx(x,{eRef:u,label:"Texto del Botón",col:"col-md-6",placeholder:"Ej: Ver más"}),i.jsx(x,{eRef:p,label:"Enlace del Botón",col:"col-md-6",placeholder:"Ej: /productos"})]}),i.jsxs("small",{className:"text-muted",children:[i.jsx("i",{className:"mdi mdi-information me-1"}),"El botón solo se mostrará si ambos campos están completos"]})]})})})]})})]})};A((s,t)=>{k.createRoot(s).render(i.jsx(B,{...t,title:"Indicadores",children:i.jsx(V,{...t})}))});
