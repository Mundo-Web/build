import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as c}from"./index-BH53Isel.js";import{N as p}from"./Number2Currency-e57Tgsuk.js";import{B as q,a as R}from"./OptionCard-BDHfVt8o.js";import{T as C}from"./trash-2-DK1wnsDn.js";import{M as F}from"./CartItemRow-4VUVjpPz.js";import{P}from"./plus-Bot15Khs.js";import{S as O}from"./CheckoutStepsSF-Bprf3oGX.js";import{m as N}from"./main-BvVILmTO.js";import{G as k}from"./Global-ErywZRdd.js";import"./ProductNavigation-BHdBC-H-.js";import"./ProductCard-erObE6pO.js";import"./index-CMHsc23u.js";/* empty css              */import"./BlogCarousel-DpjB9swg.js";/* empty css               */import"./InfiniteCategory-BwYXk1Kq.js";import"./index-yBjzXJbu.js";import"./useStateManager-7e1e8489.esm-oj4m82YY.js";import"./hoist-non-react-statics.cjs-kbdZbs82.js";import"./index-rimy3MAc.js";import"./index-fNjTmf9T.js";import"./createLucideIcon-Cy5Ya80P.js";import"./tippy-react.esm-BWiGTO87.js";import"./proxy-BTYtmp9V.js";import"./InputForm-ZnsQvLid.js";import"./server.browser-Bf4gQIc7.js";import"./lodash-CblvOeJM.js";import"./PaymentModal-Bxx5p2o_.js";import"./index-Chjiymov.js";import"./General-BmbBKdsB.js";import"./CouponsRest-HOU-mdfQ.js";import"./VoucherUpload-B2OWX0t6.js";import"./filepond-plugin-image-preview-B3bH-pD8.js";import"./SalesRest-D5kqWNYk.js";import"./BasicRest-B3rfI5GY.js";import"./chevron-up-D78jyEhP.js";import"./chevron-down-DS-mdh9v.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./ItemsRest-DGjwRLrz.js";import"./HeaderSearch-B_41BEro.js";import"./index-CFtDjG4d.js";import"./eye-CKCH9ORv.js";const E=({setCart:l,...s})=>{const n=()=>{l(d=>d.filter(r=>r.id!==s.id))},o=()=>{l(d=>d.map(r=>r.id===s.id?{...r,quantity:(r.quantity||1)+1}:r))},t=()=>{l(d=>d.map(r=>{if(r.id===s.id){const a=(r.quantity||1)-1;return a<=0?(n(s.id),null):{...r,quantity:a}}return r}).filter(Boolean))};return console.log(s),e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"hidden md:table-row border-b bg-gray-50 font-font-general",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:`/storage/images/item/${s.image}`,alt:s.name,className:"w-16 h-16 object-cover rounded mr-4"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm 2xl:text-base font-semibold customtext-neutral-dark",children:s.name}),e.jsxs("div",{className:"text-[12px] 2xl:text-sm customtext-neutral-dark space-y-1 mt-1",children:[e.jsxs("p",{children:["Color: ",s.color]}),e.jsx("button",{onClick:n,className:" text-red-500 transition-colors duration-200 rounded-full hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-200","aria-label":"Remove item",children:e.jsx(C,{size:18})})]})]})]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"flex items-center border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[e.jsx("button",{type:"button",onClick:t,className:"p-2 text-gray-600 hover:bg-gray-100 transition-colors","aria-label":"Decrease quantity",children:e.jsx(F,{size:16})}),e.jsx("div",{className:"w-8 h-8 flex justify-center items-center bg-white",children:e.jsx("span",{className:"font-semibold text-sm",children:s.quantity||1})}),e.jsx("button",{type:"button",onClick:o,className:"p-2 text-gray-600 hover:bg-gray-100 transition-colors","aria-label":"Increase quantity",children:e.jsx(P,{size:16})})]})})}),e.jsxs("td",{className:"px-4 py-4 text-right min-w-32",children:[e.jsxs("div",{className:"text-xs text-gray-500 line-through",children:["S/ ",Number(s.price).toFixed(2)]}),e.jsxs("div",{className:"font-bold",children:["S/ ",Number(s.final_price).toFixed(2)]})]}),e.jsxs("td",{className:"px-4 py-4 text-right font-bold",children:["S/ ",Number(s.final_price*s.quantity).toFixed(2)]})]},s.id),e.jsx("div",{className:"md:hidden bg-gray-50  rounded-lg shadow p-4 mb-4 w-full font-font-general",children:e.jsxs("div",{className:"flex items-start gap-4 relative",children:[e.jsx("img",{src:`/storage/images/item/${s.image}`,alt:s.name,className:"w-20 h-20 object-cover rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg mb-1 leading-tight customtext-neutral-dark",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Color: ",s.color]}),e.jsxs("div",{className:"mt-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-center border border-gray-200 rounded-lg overflow-hidden shadow-sm w-20",children:[e.jsx("button",{onClick:t,className:"p-2 text-gray-600 hover:bg-gray-100",children:e.jsx(F,{size:16})}),e.jsx("div",{className:"w-12 h-8 flex justify-center items-center bg-white",children:e.jsx("span",{className:"font-semibold text-sm",children:s.quantity||1})}),e.jsx("button",{onClick:o,className:"p-2 text-gray-600 hover:bg-gray-100",children:e.jsx(P,{size:16})})]}),e.jsxs("div",{className:"text-right mt-2",children:[e.jsxs("div",{className:"text-xs text-gray-500 line-through",children:["S/ ",Number(s.price).toFixed(2)]}),e.jsxs("div",{className:"font-bold",children:["S/ ",Number(s.final_price).toFixed(2)]}),e.jsxs("div",{className:"text-sm font-bold mt-1",children:["Subtotal: S/ ",Number(s.final_price*s.quantity).toFixed(2)]})]})]})]}),e.jsx("button",{onClick:n,className:"absolute -top-2 -right-2 text-red-500 transition-colors duration-200 rounded-full hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-200","aria-label":"Remove item",children:e.jsx(C,{size:18})})]})})]})};function I({cart:l,setCart:s,onContinue:n,subTotal:o,envio:t,igv:d,totalFinal:r}){return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-y-8 md:gap-8",children:[e.jsxs("div",{className:"lg:col-span-3 flex flex-row w-full",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto rounded-lg w-full",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{className:"!font-font-general",children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-sm 2xl:text-base font-semibold customtext-neutral-dark",children:"Producto"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-sm 2xl:text-base font-semibold customtext-neutral-dark",children:"Cantidad"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-sm 2xl:text-base font-semibold customtext-neutral-dark",children:"Precio"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-sm 2xl:text-base font-semibold customtext-neutral-dark",children:"Subtotal"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map((a,m)=>e.jsx(E,{...a,setCart:s},m))})]})}),e.jsx("div",{className:"md:hidden space-y-4 w-full",children:l.map((a,m)=>e.jsx(E,{...a,setCart:s},m))})]}),e.jsxs("div",{className:"bg-[#F7F9FB] rounded-xl shadow-lg p-6 col-span-2 h-max font-font-general",children:[e.jsx("h3",{className:"text-2xl font-bold pb-6 customtext-neutral-dark",children:"Resumen de compra"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",p(o)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",p(d)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Envío"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",p(t)]})]}),e.jsx("div",{className:"py-3 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",p(r)]})]})}),e.jsxs("div",{className:"space-y-2 pt-4",children:[e.jsx(q,{className:"rounded-2xl xl:rounded-3xl",onClick:n,children:"  Continuar"}),e.jsx(R,{className:"rounded-2xl xl:rounded-3xl",href:"/",children:" Cancelar"})]}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Al realizar tu pedido, aceptas los ",e.jsx("a",{className:"customtext-primary font-bold",children:"Términos y Condiciones"}),", y que nosotros usaremos sus datos personales de acuerdo con nuestra ",e.jsx("a",{className:"customtext-primary font-bold",children:"Política de Privacidad"}),"."]})})]})]})]})}const L=({code:l})=>new Promise(async(s,n)=>{try{console.log("Codigo de venta:",l);const{status:o,result:t}=await N.Fetch("./api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:l})});if(!o||!t.order){N.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:(t==null?void 0:t.message)||"Error no se pudo cargar la orden",type:"danger"}),n((t==null?void 0:t.message)||"Error no se pudo cargar la orde");return}s(t)}catch(o){console.error("Error en processMercadoPagoPayment:",o),N.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:o.message||"Error en la integración con MercadoPago",type:"danger"}),n(o.message||"Error en la integración con MercadoPago")}});function M({setCart:l,cart:s,code:n,delivery:o}){var f;const[t,d]=c.useState(null),[r,a]=c.useState(!0),[m,w]=c.useState(null);if(c.useEffect(()=>{n&&((async()=>{try{const x=await L({code:n});d(x.order)}catch(x){w(x.message)}finally{a(!1)}})(),N.Local.delete(`${k.APP_CORRELATIVE}_cart`),N.Local.set(`${k.APP_CORRELATIVE}_cart`,[]))},[n]),r)return e.jsx("div",{className:"mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6 font-font-general text-center",children:e.jsx("p",{children:"Cargando detalles de la orden..."})})});if(m)return e.jsx("div",{className:"mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6 font-font-general text-center text-red-500",children:e.jsxs("p",{children:["Error al cargar la orden: ",m]})})});if(!t)return e.jsx("div",{className:"mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6 font-font-general text-center",children:e.jsx("p",{children:"No se encontraron datos de la orden"})})});const y=((((f=t==null?void 0:t.items)==null?void 0:f.reduce((i,x)=>{const g=x.price||0,v=x.quantity||0;return i+g*v},0))||0)/1.18).toFixed(2),h=(y*.18).toFixed(2),j=parseFloat(y)+parseFloat(h)+parseFloat(t.delivery);return e.jsx("div",{className:"mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6 font-font-general",children:e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-base xl:text-xl customtext-neutral-light",children:"Gracias por tu compra 🎉"}),e.jsx("p",{className:"customtext-neutral-dark text-2xl xl:text-5xl font-semibold",children:"Tu orden ha sido recibida"}),e.jsxs("div",{className:"py-4",children:[e.jsx("div",{className:" customtext-neutral-light",children:"Código de pedido"}),e.jsxs("div",{className:"customtext-neutral-dark text-lg font-semibold",children:["#",t.code]})]}),e.jsxs("div",{className:"space-y-4 max-w-lg bg-[#F7F9FB] mx-auto p-8 rounded-xl",children:[e.jsx("div",{className:"space-y-6 border-b-2 pb-6",children:t.items.map((i,x)=>e.jsx("div",{className:"rounded-lg",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"bg-white rounded-xl w-max",children:e.jsx("img",{src:i.image?`/storage/images/item/${i.image}`:"/assets/img/noimage/no_img.jpg",alt:i.name,className:"w-20 h-20 object-cover rounded",onError:g=>g.target.src="/assets/img/noimage/no_img.jpg"})}),e.jsxs("div",{className:"text-start",children:[e.jsx("h3",{className:"font-medium text-lg",children:i.name}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Color: ",e.jsx("span",{className:"customtext-neutral-dark",children:i.color})]}),e.jsxs("p",{className:"text-sm customtext-neutral-light",children:["Cantidad: ",e.jsx("span",{className:"customtext-neutral-dark",children:parseInt(i.quantity)})," - Precio: ",e.jsxs("span",{className:"customtext-neutral-dark",children:[" S/ ",p(i.price)]})]})]})]})},x))}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",p(y)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",p(h)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Envío"}),e.jsxs("span",{className:"font-semibold",children:["S/ ",p(t.delivery)]})]}),e.jsx("div",{className:"py-3 border-y-2 mt-6",children:e.jsxs("div",{className:"flex justify-between font-bold text-[20px] items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["S/ ",p(j)]})]})})]}),e.jsx("div",{className:"pt-3",children:e.jsx(q,{href:"/catalogo",children:"  Seguir Comprando"})})]})]})})})}function Pe({cart:l,setCart:s,user:n,prefixes:o,ubigeos:t,items:d,contacts:r}){const[a,m]=c.useState(1),w=l.reduce((S,u)=>{const $=u.final_price;return S+$*u.quantity},0),[b,y]=c.useState(0),h=w/1.18,j=(h*.18).toFixed(2),f=(parseFloat(h)+parseFloat(j)+parseFloat(b)).toFixed(2),[i,x]=c.useState([]),[g,v]=c.useState([]),[T,_]=c.useState([]);return c.useEffect(()=>{const u=new URLSearchParams(window.location.search).get("code");u&&(v(u),m(3))},[window.location.search]),c.useEffect(()=>{g&&N.Local.delete(`${k.APP_CORRELATIVE}_cart`)},[g]),c.useEffect(()=>{(()=>{const u=document.createElement("script");u.src="https://sdk.mercadopago.com/js/v2",u.async=!0,document.body.appendChild(u)})()},[]),e.jsx("div",{className:"min-h-screen bg-white pt-6 px-primary lg:-mb-10",children:e.jsxs("div",{className:"bg-white pt-8 sm:p-8 rounded-xl",children:[e.jsxs("div",{className:`mb-4 xl:mb-8 grid lg:grid-cols-5 !font-font-general ${a===3?"mx-auto max-w-3xl":""} `,children:[e.jsxs("div",{className:`flex items-center justify-between  mx-1 gap-2 lg:mx-5 ${a===3?"lg:col-span-5":"lg:col-span-3"}  text-center`,children:[e.jsx("div",{className:`text-sm sm:text-base 2xl:text-lg tracking-tight ${a===1?"customtext-primary font-semibold":"customtext-neutral-dark"}`,children:"Carrito de compra"}),e.jsx("div",{className:`text-sm sm:text-base 2xl:text-lg tracking-tight ${a===2?"customtext-primary font-semibold":"customtext-neutral-dark"}`,children:"Detalles de envío"}),e.jsx("div",{className:`text-sm sm:text-base 2xl:text-lg tracking-tight ${a===3?"customtext-primary font-semibold":"customtext-neutral-dark"}`,children:"Orden confirmada"})]}),e.jsx("div",{className:`mt-4 h-1 max-w-3xl bg-gray-200 ${a===3?"lg:col-span-5":"lg:col-span-3"} `,children:e.jsx("div",{className:"h-1 bg-primary transition-all duration-500",style:{width:`${(a-1)/2*100}%`}})})]}),a===1&&e.jsx(I,{cart:l,setCart:s,onContinue:()=>m(2),subTotal:h,envio:b,igv:j,totalFinal:f}),a===2&&e.jsx(O,{setCode:v,setDelivery:_,cart:l,setSale:x,setCart:s,onContinue:()=>m(3),noContinue:()=>m(1),subTotal:h,envio:b,setEnvio:y,igv:j,totalFinal:f,user:n,prefixes:o,contacts:r,ubigeos:t,items:d}),a===3&&e.jsx(M,{code:g,setCart:s,delivery:T,cart:i,subTotal:h,envio:b,igv:j,totalFinal:f})]})})}export{Pe as default};
