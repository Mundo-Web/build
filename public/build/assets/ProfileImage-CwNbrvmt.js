import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as a}from"./index-BOnQTV8N.js";import R from"./MenuSimple-CkH2_-UM.js";import{X as T}from"./x-fof_H3Vv.js";import{S as $}from"./search-BQ59Robe.js";import{C as L}from"./chevron-left-JcR9Fe4w.js";import{C as b}from"./chevron-right-Cug7tVUE.js";import{C as U}from"./door-closed-OXb-qp6H.js";function X({search:r,setSearch:m,pages:f,items:u,onClose:c}){const[n,h]=a.useState("main"),[o,x]=a.useState(null),[v,j]=a.useState(null),[l,g]=a.useState([]),[p,w]=a.useState("right"),N=a.useRef(null),C=t=>{if(t.preventDefault(),r.trim()){const s=r.trim();window.location.href=`/catalogo?search=${encodeURIComponent(s)}`}return!1},S=t=>{if(t.key==="Enter"&&(t.preventDefault(),r.trim())){const s=r.trim();window.location.href=`/catalogo?search=${encodeURIComponent(s)}`}},d=(t,s="right",i=null)=>{w(s),i&&x(i),setTimeout(()=>{h(t)},50)},k=t=>{j(t.name),g([...l,{level:n,name:"Categorías"}]),d("subcategories","right",t.name)},I=()=>{if(l.length>0){const t=l[l.length-1];d(t.level,"left"),g(l.slice(0,-1))}else n==="subcategories"?d("categories","left"):n==="categories"&&d("main","left")},M=t=>{d("categories","right")},E=()=>"Menú principal",D=()=>{if(n==="main")return e.jsxs("div",{className:"animate-fade animate-duration-300",children:[e.jsxs("button",{className:"px-4 py-2 mb-3 w-full flex justify-between items-center hover:bg-gray-50 active:bg-primary transition-all  rounded-xl",onClick:()=>M(),children:[e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"font-medium",children:"Categorías"})}),e.jsx(b,{className:"h-5 w-5 customtext-neutral-light"})]}),e.jsx("div",{className:"space-y-2",children:f.map((t,s)=>t.menuable&&e.jsx("a",{href:t.path,className:"p-4 py-2 flex justify-between items-center w-full hover:bg-gray-50 active:bg-primary transition-all  rounded-xl",children:e.jsx("span",{className:"font-medium",children:t.name})},s))})]});if(n==="categories"){const t=[...u].sort((s,i)=>s.name.localeCompare(i.name,"es",{sensitivity:"base"}));return e.jsx("div",{className:p==="right"?"animate-fade-left animate-duration-300":"animate-fade-right animate-duration-300",children:e.jsx("div",{className:"space-y-2",children:t.map(s=>e.jsxs("div",{className:"px-4 py-2  rounded-xl flex justify-between items-center cursor-pointer hover:bg-gray-50 active:bg-primary transition-all",onClick:()=>k(s),children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsx(b,{className:"h-5 w-5 customtext-neutral-light"})]},s.id))})})}else if(n==="subcategories"&&o){const t=u.find(i=>i.name===o),s=t.subcategories?[...t.subcategories].sort((i,y)=>i.name.localeCompare(y.name,"es",{sensitivity:"base"})):[];return e.jsx("div",{className:p==="right"?"animate-fade-left animate-duration-300":"animate-fade-right animate-duration-300",children:e.jsx("div",{className:"space-y-2",children:s.map((i,y)=>e.jsxs("a",{href:`/catalogo?subcategory=${i.slug}`,className:"flex w-full px-4  py-2 rounded-xl justify-between items-center hover:bg-gray-50 active:bg-primary transition-all",children:[e.jsx("span",{className:"font-medium",children:i.name}),e.jsx(b,{className:"h-5 w-5 customtext-neutral-light"})]},y))})})}};return a.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"}),[]),a.useEffect(()=>{const t=s=>{s.key==="Escape"&&(r.trim()?m(""):c())};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[r,c,m]),e.jsxs("div",{className:"fixed inset-0 z-[99999] flex flex-col touch-none overscroll-none",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:c}),e.jsx("div",{className:"relative w-full md:w-[400px] md:mx-auto flex flex-col h-[100dvh]  ",children:e.jsxs("div",{className:"mt-auto bg-white  shadow-xl flex flex-col max-h-[80vh] rounded-t-2xl overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-white flex justify-between items-center border-b border-gray-200 sticky top-0 z-[9999]",children:[e.jsx("h1",{className:"text-lg font-bold",children:E()}),e.jsx("button",{className:"p-2 rounded-full hover:bg-gray-100",onClick:c,children:e.jsx(T,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"overflow-y-auto flex-1 p-4 overscroll-contain",children:[e.jsx("div",{className:"mb-5",children:e.jsxs("form",{onSubmit:C,role:"search",className:"relative w-full",children:[e.jsx("input",{ref:N,type:"search",name:"search",placeholder:"Buscar productos",value:r,onChange:t=>m(t.target.value),onKeyDown:S,className:"w-full pr-12 py-3 pl-4 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-primary/20 focus:outline-none",enterKeyHint:"search",inputMode:"search",autoComplete:"off",role:"searchbox","aria-label":"Buscar productos"}),e.jsx("button",{type:"submit",className:"absolute right-3 top-1/2 transform -translate-y-1/2 p-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors","aria-label":"Buscar",children:e.jsx($,{className:"h-4 w-4"})})]})}),n!=="main"&&e.jsxs("button",{onClick:I,className:"flex items-center customtext-primary mb-4 font-medium",children:[e.jsx(L,{className:"h-5 w-5 mr-1"}),e.jsx("span",{children:n==="categories"?"Categorías":o})]}),e.jsx("div",{className:"pb-16",children:D()}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0  flex justify-center",children:e.jsx(R,{visible:!0})})]})]})})]})}const q=({uuid:r,name:m,lastname:f,className:u})=>{const[c,n]=a.useState(!1),[h,o]=a.useState(!1),[x,v]=a.useState("");return a.useEffect(()=>{if(!r){n(!0);return}(async()=>{try{const l=`/api/profile/thumbnail/${r}?v=${new Date().getTime()}`;(await fetch(l,{method:"HEAD"})).headers.get("content-type").includes("svg")?o(!1):(v(l),o(!0))}catch{o(!1)}finally{n(!0)}})()},[r]),c?e.jsx(e.Fragment,{children:h?e.jsx("img",{src:x,alt:`${m} ${f}`,className:u,onError:()=>o(!1)}):e.jsx(U,{className:" !w-7 !h-7 customtext-primary border-primary rounded-full ring-secondary transition-all duration-300"})}):e.jsx("div",{className:"!w-7 !h-7  bg-secondary rounded-full animate-pulse flex items-center justify-center",children:e.jsx("div",{className:"w-3 h-3 bg-primary rounded-full"})})};export{X as M,q as P};
