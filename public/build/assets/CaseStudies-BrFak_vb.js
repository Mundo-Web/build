var E=Object.defineProperty;var I=(r,a,n)=>a in r?E(r,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[a]=n;var h=(r,a,n)=>I(r,typeof a!="symbol"?a+"":a,n);import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{B as k}from"./Base-ShiKkDpP.js";import{S as V}from"./SwitchFormGroup-DXN0cwVk.js";import{T as B}from"./TextareaFormGroup-CliirJM1.js";import{r as o}from"./index-BOnQTV8N.js";import{c as G}from"./ReactAppend-QR5TrZfj.js";import{S as y}from"./CartKuchara-D9l7c7at.js";import{B as P}from"./BasicRest-BML1C-ua.js";import{I as _}from"./ImageFormGroup-40MuGzez.js";import{I as R}from"./InputFormGroup-iZIO11ZN.js";import{M as z}from"./Modal-xDw9ufjg.js";import{T as M}from"./Table-BBh2JpCs.js";import{D as b}from"./DxButton-DV0H-ZcL.js";import{C as U}from"./CreateReactScript-C-lKJ7Gs.js";import{R as C}from"./ReactAppend-Vm5G2nof.js";import{g as m}from"./getYTVideoId-BoKZ01zP.js";import"./index-yBjzXJbu.js";import"./Global-Bz6gVLc5.js";import"./tippy-react.esm-DmkRJDEW.js";import"./index-pSueRYGM.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-B6ujFmsw.js";/* empty css              */import"./Logout-BpuTJ_83.js";import"./main-B6F2O9-U.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./MenuItemContainer-DcxtOi47.js";import"./index.esm-C48oHfFw.js";import"./index-ngrFHoWO.js";import"./CanAccess-UkN68hbD.js";import"./CardProductKatya-ncpmQ0JU.js";import"./BooleanLimit-D-OsQsek.js";/* empty css               */import"./General-CE1RDd44.js";import"./LaravelSession-Dz9cpV3l.js";class q extends P{constructor(){super(...arguments);h(this,"path","admin/case-studies");h(this,"hasFiles",!0)}}const d=new q,Y=()=>{const r=o.useRef(),a=o.useRef(),n=o.useRef(),u=o.useRef(),p=o.useRef(),f=o.useRef(),l=o.useRef(),[g,v]=o.useState(!1),[x,j]=o.useState(""),w=s=>{s!=null&&s.id?v(!0):v(!1),l.resetDeleteFlag&&l.resetDeleteFlag(),n.current.value=(s==null?void 0:s.id)??"",u.current.value=(s==null?void 0:s.name)??"",p.current.value=(s==null?void 0:s.description)??"",f.current.value=(s==null?void 0:s.video_url)??"",j(m(s==null?void 0:s.video_url)||""),l.image.src=s!=null&&s.image?`/storage/images/case_study/${s.image}`:"",l.current.value=null,$(a.current).modal("show")},F=async s=>{s.preventDefault();const i={id:n.current.value||void 0,name:u.current.value,description:p.current.value,video_url:f.current.value},t=new FormData;for(const N in i)t.append(N,i[N]);const c=l.current.files[0];c&&t.append("image",c),l.getDeleteFlag&&l.getDeleteFlag()&&t.append("image_delete","DELETE"),await d.save(t)&&(l.resetDeleteFlag&&l.resetDeleteFlag(),$(r.current).dxDataGrid("instance").refresh(),$(a.current).modal("hide"))},T=async({id:s,value:i})=>{await d.boolean({id:s,field:"visible",value:i})&&$(r.current).dxDataGrid("instance").refresh()},D=async s=>{const{isConfirmed:i}=await y.fire({title:"Eliminar registro",text:"¿Estas seguro de eliminar este registro?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});!i||!await d.delete(s.id)||$(r.current).dxDataGrid("instance").refresh()},S=async s=>{const i=s.toIndex;try{await d.reorder(s.itemData.id,i)&&await s.component.refresh()}catch(t){console.error("Error reordering case study:",t)}};return e.jsxs(e.Fragment,{children:[e.jsx(M,{gridRef:r,title:"Casos Reales (Videos)",rest:d,rowDragging:{allowReordering:!0,onReorder:S,dropFeedbackMode:"push"},sorting:{mode:"single"},toolBar:s=>{s.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(r.current).dxDataGrid("instance").refresh()}}),s.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo video",hint:"Nuevo video",onClick:()=>w()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"order_index",caption:"Orden",visible:!1,sortOrder:"asc",sortIndex:0},{dataField:"image",caption:"Imagen",width:"120px",allowFiltering:!1,cellTemplate:(s,{data:i})=>{const t=m(i.video_url),c=i.image?`/storage/images/case_study/${i.image}`:t?`https://img.youtube.com/vi/${t}/mqdefault.jpg`:null;c?C(s,e.jsx("img",{src:c,style:{width:"100px",height:"56px",objectFit:"cover",borderRadius:"4px"},alt:i.name})):s.text("Sin imagen")}},{dataField:"video_url",caption:"Video",width:"80px",allowFiltering:!1,cellTemplate:(s,{data:i})=>{const t=m(i.video_url);t||i.video_url?s.append(b({className:"btn btn-xs btn-soft-success",title:"Reproducir video",icon:"fa fa-play",onClick:()=>{const c=`https://www.youtube.com/embed/${t}?autoplay=1`;y.fire({html:`
                                                    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
                                                        <iframe 
                                                            src="${c}"
                                                            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0;"
                                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                                            allowfullscreen
                                                        ></iframe>
                                                    </div>
                                                `,title:i.name,width:"800px",showCloseButton:!0,showConfirmButton:!1})}})):s.text("Sin video")}},{dataField:"name",caption:"Título",width:"30%"},{dataField:"description",caption:"Descripción",width:"40%"},{dataField:"visible",caption:"Visible",dataType:"boolean",cellTemplate:(s,{data:i})=>{$(s).empty(),C(s,e.jsx(V,{checked:i.visible==1,onChange:()=>T({id:i.id,value:!i.visible})}))}},{caption:"Acciones",cellTemplate:(s,{data:i})=>{s.css("text-overflow","unset"),s.append(b({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>w(i)})),s.append(b({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>D(i)}))},allowFiltering:!1,allowExporting:!1}]}),e.jsxs(z,{modalRef:a,title:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:`fas ${g?"fa-edit":"fa-plus-circle"} me-2 text-primary`}),g?"Editar Caso Real":"Nuevo Caso Real"]}),onSubmit:F,size:"xl",children:[e.jsx("input",{ref:n,type:"hidden"}),e.jsxs("ul",{className:"nav nav-pills nav-justified bg-light rounded mb-3 p-2",role:"tablist",children:[e.jsx("li",{className:"nav-item",children:e.jsxs("a",{className:"nav-link active","data-bs-toggle":"tab",href:"#info-tab",role:"tab",children:[e.jsx("i",{className:"fas fa-info-circle me-1"}),e.jsx("span",{className:"d-none d-sm-inline",children:"Información"})]})}),e.jsx("li",{className:"nav-item",children:e.jsxs("a",{className:"nav-link","data-bs-toggle":"tab",href:"#video-tab",role:"tab",children:[e.jsx("i",{className:"fas fa-video me-1"}),e.jsx("span",{className:"d-none d-sm-inline",children:"Video"})]})}),e.jsx("li",{className:"nav-item",children:e.jsxs("a",{className:"nav-link","data-bs-toggle":"tab",href:"#image-tab",role:"tab",children:[e.jsx("i",{className:"fas fa-image me-1"}),e.jsx("span",{className:"d-none d-sm-inline",children:"Thumbnail"})]})})]}),e.jsxs("div",{className:"tab-content",children:[e.jsx("div",{className:"tab-pane fade show active",id:"info-tab",role:"tabpanel",children:e.jsxs("div",{className:"card border-0 shadow-sm mb-3",children:[e.jsxs("div",{className:"card-header bg-primary text-white",children:[e.jsx("i",{className:"fas fa-file-alt me-2"}),"Datos del Caso"]}),e.jsxs("div",{className:"card-body",children:[e.jsx(R,{eRef:u,label:e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-heading text-primary me-1"}),"Título del Caso"]}),required:!0,placeholder:"Ej: Manga Gástrica - María perdió 45kg en 8 meses",helpText:"Un título descriptivo y atractivo para el caso de éxito"}),e.jsx(B,{eRef:p,label:e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-align-left text-primary me-1"}),"Descripción del Caso"]}),rows:4,placeholder:"Describe la historia del paciente, procedimiento realizado, resultados obtenidos...",helpText:"Una descripción detallada ayuda a inspirar confianza en futuros pacientes"})]})]})}),e.jsx("div",{className:"tab-pane fade",id:"video-tab",role:"tabpanel",children:e.jsxs("div",{className:"card border-0 shadow-sm mb-3",children:[e.jsxs("div",{className:"card-header bg-danger text-white",children:[e.jsx("i",{className:"fab fa-youtube me-2"}),"Video Testimonio"]}),e.jsxs("div",{className:"card-body",children:[e.jsx(R,{eRef:f,label:e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-link text-danger me-1"}),"URL del Video"]}),placeholder:"https://www.youtube.com/watch?v=...",onChange:s=>j(m(s.target.value)||""),helpText:"Pega la URL completa del video de YouTube o Vimeo (opcional si subes imagen)"}),x&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("label",{className:"form-label fw-bold",children:[e.jsx("i",{className:"fas fa-eye text-info me-1"}),"Vista Previa del Video"]}),e.jsx("div",{className:"ratio ratio-16x9 rounded overflow-hidden shadow-sm border",children:e.jsx("iframe",{src:`https://www.youtube.com/embed/${x}`,title:"Vista previa del video",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})]}),!x&&e.jsxs("div",{className:"alert alert-info mt-3",children:[e.jsx("i",{className:"fas fa-info-circle me-2"}),"Ingresa una URL de video para ver la vista previa"]})]})]})}),e.jsx("div",{className:"tab-pane fade",id:"image-tab",role:"tabpanel",children:e.jsxs("div",{className:"card border-0 shadow-sm mb-3",children:[e.jsxs("div",{className:"card-header bg-success text-white",children:[e.jsx("i",{className:"fas fa-image me-2"}),"Imagen Personalizada"]}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"alert alert-warning",children:[e.jsx("i",{className:"fas fa-lightbulb me-2"}),e.jsx("strong",{children:"Recomendación:"})," Sube una imagen de alta calidad (1280x720px) para mejorar la presentación del caso"]}),e.jsx(_,{eRef:l,label:e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-upload text-success me-1"}),"Thumbnail Personalizado"]}),helpText:"Esta imagen se mostrará en lugar del thumbnail de YouTube. Formato recomendado: JPG o PNG, 1280x720px",aspect:16/9}),e.jsxs("div",{className:"mt-3 p-3 bg-light rounded",children:[e.jsxs("h6",{className:"text-muted mb-2",children:[e.jsx("i",{className:"fas fa-question-circle me-1"}),"¿Cuándo usar imagen personalizada?"]}),e.jsxs("ul",{className:"small text-muted mb-0",children:[e.jsx("li",{children:"Cuando quieras un thumbnail más profesional que el de YouTube"}),e.jsx("li",{children:"Para mantener consistencia visual en tu sitio"}),e.jsx("li",{children:"Si el thumbnail automático de YouTube no se ve bien"}),e.jsx("li",{children:"Para casos sin video (solo testimonial con foto)"})]})]})]})]})})]}),e.jsxs("div",{className:"alert alert-secondary border-0 shadow-sm",children:[e.jsx("i",{className:"mdi mdi-information-outline me-2"}),e.jsx("strong",{children:"Nota:"})," Puedes agregar solo video, solo imagen, o ambos. La imagen personalizada tendrá prioridad sobre el thumbnail de YouTube."]})]})]})};U((r,a)=>{G.createRoot(r).render(e.jsx(k,{...a,title:"Casos Reales (Videos)",children:e.jsx(Y,{...a})}))});
