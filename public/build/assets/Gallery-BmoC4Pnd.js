import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as x}from"./index-BOnQTV8N.js";import{c as L}from"./ReactAppend-DTVVXReZ.js";import{B as G}from"./Base-Dgrs-FZD.js";import{C as P}from"./CreateReactScript-BuAKasVo.js";import{G as T}from"./GalleryRest-e3DwqTSB.js";import{B as _}from"./BasicRest-BCYKfs4R.js";import{T as U,t as o}from"./index-DRg3WPTA.js";import"./index-yBjzXJbu.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-fNjTmf9T.js";import"./Global-ErywZRdd.js";import"./tippy-react.esm-Ce0cOK54.js";import"./index-C0Swrixi.js";/* empty css              */import"./Logout-W0zm0J8x.js";import"./main-DKOTUah5.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./MenuItemContainer-CryEU9TY.js";import"./index.esm-0RgdCKj2.js";import"./index-Dq7h7Pqt.js";/* empty css               */import"./General-BmbBKdsB.js";import"./LaravelSession-Dz9cpV3l.js";class B extends _{constructor(){super(),this.path="admin/gallery/config"}}function M(g){return g.toString().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s-]/g,"").trim().replace(/\s+/g,"-").replace(/-+/g,"-")}const w=new T,C=new B,O=({images:g=[],isDevelopment:v=!1,canEdit:E=!1})=>{const[j,y]=x.useState(g.map(s=>(s.uuid=crypto.randomUUID(),s))),[A,f]=x.useState(!1),[c,I]=x.useState(null),[a,u]=x.useState({name:"",description:"",src:"",fit:"contain",aspect:"1",file:null}),[i,h]=x.useState(!1),b=(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname.includes("local")||window.location.port==="8000")&&(v||E);x.useEffect(()=>{$(".image-popup").magnificPopup({type:"image",closeOnContentClick:!0,mainClass:"mfp-fade",gallery:{enabled:!0,navigateByImgClick:!0,preload:[0,1]}})},[j]);const S=async s=>{var t;const l=((t=s.target.files)==null?void 0:t[0])??null;if(!l)return;s.target.value=null;const r=s.target.name;h(!0);try{const d=new FormData;if(d.append("image",l),d.append("name",r),!await w.save(d))return;y(p=>p.map(m=>(m.src==r&&(m.uuid=crypto.randomUUID()),m))),o.success("Imagen actualizada correctamente")}catch(d){o.error("Error al actualizar la imagen"),console.error("Error updating image:",d)}finally{h(!1)}},R=()=>{u({name:"",description:"",src:"",fit:"contain",aspect:"1",file:null}),I(null),f(!0)},F=(s,l)=>{u({...s,file:null}),I(l),f(!0)},D=s=>{var r;const l=((r=s.target.files)==null?void 0:r[0])??null;if(l){if(!l.type.startsWith("image/")){o.error("Por favor selecciona un archivo de imagen válido"),s.target.value=null;return}u(t=>({...t,file:l,src:l.name}))}},k=async()=>{if(!a.name){o.error("Por favor completa el nombre de la imagen");return}if(c===null&&!a.file){o.error("Por favor selecciona un archivo de imagen");return}h(!0);try{let s=a.src;if(a.file){const n=new FormData;n.append("image",a.file);const p=a.file.name.split(".").pop(),m=`${a.name.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")}.${p}`;if(n.append("name",m),!await w.save(n)){o.error("Error al subir la imagen");return}s=m}const l=[...j],r={name:a.name,description:a.description,src:s,fit:a.fit,aspect:a.aspect,uuid:crypto.randomUUID()};c!==null?l[c]=r:l.push(r);const t=l.filter(n=>!n.is_system).map(n=>{const{uuid:p,is_system:m,...N}=n;return N});await C.save(t)&&(y(l),f(!1),o.success(c!==null?"Imagen actualizada correctamente":"Nueva imagen agregada correctamente"))}catch(s){o.error("Error al guardar la configuración de la imagen"),console.error("Error saving image config:",s)}finally{h(!1)}},z=async s=>{if(j[s].is_system){o.error("No se pueden eliminar las imágenes del sistema");return}if(confirm("¿Estás seguro de que quieres eliminar esta imagen?")){h(!0);try{const r=j.filter((n,p)=>p!==s),t=r.filter(n=>!n.is_system).map(n=>{const{uuid:p,is_system:m,...N}=n;return N});await C.save(t)&&(y(r),o.success("Imagen eliminada correctamente"))}catch(r){o.error("Error al eliminar la imagen"),console.error("Error deleting image:",r)}finally{h(!1)}}};return e.jsxs("div",{className:"port",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"header-title",children:"Galería de Imágenes"}),e.jsx("p",{className:"text-muted mb-0",children:'Gestiona todas las imágenes del sistema. Las imágenes marcadas como "SISTEMA" son esenciales (icono, logo, logo-footer) y solo se puede cambiar su archivo.'})]}),b&&e.jsxs("button",{type:"button",className:"btn btn-primary",onClick:R,disabled:i,children:[e.jsx("i",{className:"mdi mdi-plus me-1"}),"Agregar Nueva Imagen"]})]}),e.jsx("div",{className:"row portfolioContainer",children:j.map((s,l)=>{const r=M(s.name),t=s.is_system===!0;return e.jsx("div",{className:"col-xl-3 col-lg-4 col-md-6 natural personal",children:e.jsxs("div",{className:"gal-detail thumb",children:[t&&e.jsx("div",{style:{position:"absolute",top:"8px",left:"8px",zIndex:10,backgroundColor:"rgba(13, 110, 253, 0.9)",color:"white",padding:"2px 6px",borderRadius:"3px",fontSize:"10px",fontWeight:"bold"},children:"SISTEMA"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("img",{src:`/assets/resources/${s.src}?v=${s.uuid}`,className:"thumb-img img-fluid",alt:"work-thumbnail",onError:d=>d.target.src="/assets/resources/cover-404.svg",style:{aspectRatio:s.aspect,objectFit:s.fit,objectPosition:"center",width:"100%"}}),e.jsxs("div",{className:"d-flex px-2 py-1 justify-content-center gap-1",style:{backgroundColor:"rgba(0, 0, 0, .25)",position:"absolute",bottom:0,width:"100%",borderRadius:"0 0 3px 3px"},children:[e.jsxs("a",{href:`/assets/resources/${s.src}`,className:"btn btn-xs btn-primary image-popup",title:s.name,children:[e.jsx("i",{className:"mdi mdi-eye me-1"}),"Abrir"]}),e.jsx("input",{type:"file",name:s.src,id:`image-${r}`,onChange:S,hidden:!0,accept:"image/*",disabled:i}),e.jsxs("label",{htmlFor:`image-${r}`,className:`btn btn-xs btn-dark ${i?"disabled":""}`,children:[e.jsx("i",{className:"mdi mdi-image-edit me-1"}),"Cambiar"]}),b&&!t&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",className:"btn btn-xs btn-info",onClick:()=>F(s,l),disabled:i,children:[e.jsx("i",{className:"mdi mdi-pencil me-1"}),"Editar"]}),e.jsxs("button",{type:"button",className:"btn btn-xs btn-danger",onClick:()=>z(l),disabled:i,children:[e.jsx("i",{className:"mdi mdi-delete me-1"}),"Eliminar"]})]}),b&&t&&e.jsxs("button",{type:"button",className:"btn btn-xs btn-secondary",title:"Imagen del sistema - Solo se puede cambiar el archivo",disabled:!0,children:[e.jsx("i",{className:"mdi mdi-information me-1"}),"Sistema"]})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("h4",{children:[s.name,t&&e.jsx("span",{className:"badge bg-primary ms-2",style:{fontSize:"10px"},children:"SISTEMA"})]}),e.jsx("p",{className:"font-13 text-muted mb-2",children:s.description}),b&&e.jsxs("small",{className:"text-muted",children:["Aspect: ",s.aspect," | Fit: ",s.fit,t&&e.jsx("span",{className:"text-primary",children:" | Imagen del sistema"})]})]})]})},l)})}),b&&A&&e.jsx("div",{className:"modal show d-block",tabIndex:"-1",style:{backgroundColor:"rgba(0,0,0,0.5)"},children:e.jsx("div",{className:"modal-dialog modal-lg",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:c!==null?"Editar Imagen":"Agregar Nueva Imagen"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>f(!1),disabled:i})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Nombre de la imagen *"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Ej: Logo de login, Imagen de signup, etc.",value:a.name,onChange:s=>u({...a,name:s.target.value}),disabled:i})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:c!==null?"Cambiar archivo (opcional)":"Archivo de imagen *"}),e.jsx("input",{type:"file",className:"form-control",accept:"image/*",onChange:D,disabled:i}),a.src&&e.jsx("small",{className:"text-muted",children:c!==null?`Actual: ${a.src}`:`Seleccionado: ${a.src}`})]})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Descripción"}),e.jsx("textarea",{className:"form-control",rows:"3",placeholder:"Descripción de dónde y cómo se usa esta imagen",value:a.description,onChange:s=>u({...a,description:s.target.value}),disabled:i})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Aspect Ratio"}),e.jsxs("select",{className:"form-select",value:a.aspect,onChange:s=>u({...a,aspect:s.target.value}),disabled:i,children:[e.jsx("option",{value:"1",children:"1:1 (Cuadrado)"}),e.jsx("option",{value:"4/3",children:"4:3 (Estándar)"}),e.jsx("option",{value:"16/9",children:"16:9 (Panorámico)"}),e.jsx("option",{value:"3/2",children:"3:2 (Fotografía)"}),e.jsx("option",{value:"13/4",children:"13:4 (Logo horizontal)"}),e.jsx("option",{value:"auto",children:"Auto (Original)"})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Object Fit"}),e.jsxs("select",{className:"form-select",value:a.fit,onChange:s=>u({...a,fit:s.target.value}),disabled:i,children:[e.jsx("option",{value:"contain",children:"Contain (Imagen completa)"}),e.jsx("option",{value:"cover",children:"Cover (Recortar si es necesario)"}),e.jsx("option",{value:"fill",children:"Fill (Estirar)"}),e.jsx("option",{value:"scale-down",children:"Scale Down (Reducir si es necesario)"})]})]})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Ejemplos de nombres e imágenes:"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("ul",{className:"list-unstyled small text-muted",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Logo de login"})," - Archivo: logo-login.png"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Fondo de registro"})," - Archivo: bg-signup.jpg"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Recuperar contraseña"})," - Archivo: forgot-password.svg"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Header de emails"})," - Archivo: email-header.png"]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("ul",{className:"list-unstyled small text-muted",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Hero del dashboard"})," - Archivo: dashboard-hero.jpg"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Placeholder de perfil"})," - Archivo: profile-placeholder.png"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Página de mantenimiento"})," - Archivo: maintenance.svg"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Error 404"})," - Archivo: 404-error.png"]})]})})]}),e.jsxs("small",{className:"text-info",children:[e.jsx("i",{className:"mdi mdi-information me-1"}),"El archivo se guardará automáticamente en la carpeta /assets/resources/ con un nombre basado en el nombre de la imagen."]})]})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>f(!1),disabled:i,children:"Cancelar"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:k,disabled:i||!a.name||c===null&&!a.file,children:i?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-1",role:"status"}),"Guardando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-content-save me-1"}),c!==null?"Actualizar":"Agregar"]})})]})]})})}),e.jsx(U,{})]})};P((g,v)=>{L.createRoot(g).render(e.jsx(G,{...v,title:"Galeria",children:e.jsx(O,{...v})}))});
