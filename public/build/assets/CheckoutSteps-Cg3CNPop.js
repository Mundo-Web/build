import{r as e,j as t,i as s,c0 as a,c1 as r,by as i,bz as o,c2 as n,f as l,X as c}from"./vendor-react-CtPXetfm.js";import{C as d,N as m}from"./Number2Currency-BX4epFEo.js";import{B as u,p,C as x}from"./culqiPayment-CvIIYH4f.js";import{D as h,B as g,P as f,a as b,O as j,S as v}from"./StorePickupSelector-BAOZ00jp.js";import{C as y}from"./CardItem-CAsXYTw8.js";import{I as N}from"./InputForm-DnrrqDOu.js";import{S as w}from"./SelectForm-CMhMaJUO.js";import{l as C}from"./ShippingStep-DsTnA0_3.js";import{t as _}from"./OpenPayCardModal-CbSnHq7o.js";import{G as k}from"./Footer-coriRrmf.js";import{m as T}from"./vendor-motion-CThzL09Q.js";import"./ProductDetailB-YKQDJdz1.js";import"./CartKuchara-Bi-J8T1O.js";import"./TippyButton-Dqi9Vaf_.js";import"./vendor-swiper-Cr_RrIb_.js";import{H as S}from"./HtmlContent-CjqdSt4A.js";import{u as E}from"./useEcommerceTracking-DxOzY97m.js";import"./General-ClVW7qxN.js";import"./StoresRest-PEQU8Mt2.js";import"./BasicRest-DtgqEuc9.js";import"./BooleanLimit-q2Ad9fGY.js";import"./CartModal-CVzP9hNx.js";import"./CartItemRow-DGY_lV8-.js";import"./ItemsRest-ChbvlPS2.js";function D({data:a,cart:r,setCart:i,onContinue:o,subTotal:n,envio:l,igv:c,fleteTotal:p,seguroImportacionTotal:x,derechoArancelarioTotal:b,totalFinal:j,openModal:v,categorias:N,automaticDiscounts:w,setAutomaticDiscounts:C,automaticDiscountTotal:_,setAutomaticDiscountTotal:k,totalWithoutDiscounts:T,generals:S}){const[E,D]=e.useState(w||[]),[q,F]=e.useState(_||0),[I,P]=e.useState(!1),[L,$]=e.useState([]),[A,B]=e.useState([]),[M,U]=e.useState(!1),[R,O]=e.useState(null),[z,V]=e.useState(null),H=0===r.length;e.useEffect(()=>{if(r.filter(e=>"combo"===e.type),r.length>0&&n>0)Q();else{const e=[],t=0;D(e),F(t),$([]),B([]),C&&C(e),k&&k(t)}},[r,n]);const Q=async()=>{P(!0);try{r.reduce((e,t)=>e+(t.quantity||0),0),r.filter(e=>"combo"===e.type);const e=await h.applyToCart(r,T);if(e.success&&e.data){const t=h.formatDiscounts(e.data.applied_discounts),s=e.data.total_discount||0,a=h.getFreeItems(e.data.applied_discounts),r=[];e.data.applied_discounts.forEach(e=>{e.suggested_items&&Array.isArray(e.suggested_items)&&r.push(...e.suggested_items)}),D(t),F(s),$(a),B(r),C&&C(t),k&&k(s)}else{const e=[],t=0;D(e),F(t),$([]),B([]),C&&C(e),k&&k(t)}}catch(e){const t=[],s=0;D(t),F(s),$([]),B([]),C&&C(t),k&&k(s)}finally{P(!1)}},W=e=>{const t=(s=e.id,A.find(e=>e.item_id===s||e.triggering_item_id===s));var s;t&&(O(t),V(e),U(!0))};return t.jsxs("div",{className:"grid lg:grid-cols-5 gap-4 md:gap-8",children:[t.jsx("div",{className:"lg:col-span-3 space-y-4 md:space-y-6",children:H?t.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center animate-fade-in",children:[t.jsx("svg",{className:"w-24 h-24 text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),t.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"Tu carrito estÃ¡ vacÃ­o"}),t.jsx("p",{className:"text-gray-500",children:"Â¡Explora nuestros productos y encuentra algo especial!"})]}):r.map((e,s)=>{return t.jsx(y,{...e,setCart:i,categorias:N,hasPromotion:(a=e.id,A.some(e=>e.item_id===a||e.triggering_item_id===a)),onPromotionClick:W},s);var a})}),t.jsxs("div",{className:"lg:col-span-2 bg-[#F7F9FB] rounded-xl shadow-lg p-4 md:p-6 h-max mt-4 md:mt-0",children:[t.jsx("h3",{className:"text-xl md:text-2xl font-bold pb-4 md:pb-6",children:"Resumen"}),t.jsxs("div",{className:"space-y-3 md:space-y-4",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),t.jsxs("span",{className:"font-semibold",children:[d(),m(n)]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"customtext-neutral-dark",children:["IGV (",Number(S?.find(e=>"igv_checkout"===e.correlative)?.description||18),"%)"]}),t.jsxs("span",{className:"font-semibold",children:[d(),m(c)]})]}),Number(S?.find(e=>"importation_seguro"===e.correlative)?.description)>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"customtext-neutral-dark",children:["Seguro (",Number(S?.find(e=>"importation_seguro"===e.correlative)?.description||0).toFixed(2),"%)"]}),t.jsxs("span",{className:"font-semibold",children:[d(),m(x)]})]}),Number(S?.find(e=>"importation_derecho_arancelario"===e.correlative)?.description)>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"customtext-neutral-dark",children:["Derecho arancelario",S?.find(e=>"importation_derecho_arancelario_descripcion"===e.correlative)?.description&&t.jsx(s,{content:t.jsx("p",{className:"whitespace-pre-line",children:S?.find(e=>"importation_derecho_arancelario_descripcion"===e.correlative)?.description}),allowHTML:!0,children:t.jsx("i",{className:"mdi mdi-information ms-1"})})]}),t.jsxs("span",{className:"font-semibold",children:[d(),m(b)]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"customtext-neutral-dark",children:"EnvÃ­o"}),t.jsxs("span",{className:"font-semibold",children:[d(),m(l)]})]}),I&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"customtext-neutral-dark",children:"Verificando descuentos..."}),t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"})]}),!I&&E.length>0&&t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"text-xl md:text-2xl font-bold pb-4 md:pb-6  customtext-neutral-dark mb-2",children:"ðŸŽ‰ Descuentos aplicados:"}),E.map((e,s)=>t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsxs("span",{className:"customtext-neutral-dark",children:[e.name,e.description&&t.jsx("span",{className:"text-xs font-semibold block",children:e.description})]}),t.jsxs("span",{className:"customtext-neutral-dark font-semibold",children:["-",d(),m(e.amount)]})]},s)),t.jsxs("div",{className:"flex justify-between text-sm font-semibold customtext-neutral-dark pt-1",children:[t.jsx("span",{children:"Total descuentos:"}),t.jsxs("span",{children:["-",d(),m(q)]})]})]}),t.jsxs("div",{className:"py-3 border-y-2 mt-4 md:mt-6",children:[t.jsxs("div",{className:"flex justify-between font-bold text-lg md:text-[20px] items-center",children:[t.jsx("span",{children:"Total"}),t.jsxs("span",{children:[d(),m(j)]})]}),q>0&&t.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[t.jsxs("span",{className:"line-through",children:[d(),m(T||j+q)]}),t.jsxs("span",{className:"ml-2 customtext-neutral-dark font-semibold",children:["Ahorras ",d(),m(q)]})]})]}),t.jsxs("div",{className:"space-y-2 pt-3 md:pt-4",children:[t.jsx(u,{onClick:o,disabled:H,className:`w-full ${a?.class_button||"text-white"}`,children:H?"Carrito VacÃ­o":"Continuar Compra"}),t.jsx(g,{href:"/",className:"w-full",children:H?"Ir a Comprar":"Cancelar"})]}),t.jsx("div",{children:t.jsxs("p",{className:"text-xs md:text-sm customtext-neutral-dark",children:["Al realizar tu pedido, aceptas losÂ ",t.jsx("a",{href:"#",onClick:()=>v(1),className:"customtext-primary font-bold",children:"TÃ©rminos y Condiciones"}),", y que nosotros usaremos sus datos personales de acuerdo con nuestraÂ ",t.jsx("a",{href:"#",onClick:()=>v(0),className:"customtext-primary font-bold",children:"PolÃ­tica de Privacidad"}),"."]})})]})]}),t.jsx(f,{isOpen:M,onClose:()=>U(!1),suggestion:R,onAddToCart:async e=>{try{i(t=>{const s=t.findIndex(t=>(t.item_id||t.id)===e.item_id);if(-1!==s){const a=[...t],r=e.quantity||e.suggested_quantity||1;return a[s].quantity+=r,a}{const s={id:e.item_id,name:e.item_name,quantity:e.quantity||e.suggested_quantity||1,price:e.value||0,final_price:e.value||0,image:e.item_image||"default.jpg",brand:{name:e.item_brand||"N/A"},sku:e.item_sku||"PROMO",stock:999};return[...t,s]}}),setTimeout(()=>{Q()},100)}catch(t){}},productName:z?.name||""})]})}function q({data:l,cart:c,setSale:h,setCode:f,setDelivery:y,setCart:T,onContinue:S,noContinue:E,subTotal:D,igv:q,fleteTotal:F,seguroImportacionTotal:I,derechoArancelarioTotal:P,totalFinal:L,user:$,setEnvio:A,envio:B,ubigeos:M=[],openModal:U,categorias:R,setCouponDiscount:O,setCouponCode:z,automaticDiscounts:V=[],automaticDiscountTotal:H=0,setAutomaticDiscounts:Q,setAutomaticDiscountTotal:W,totalWithoutDiscounts:K,conversionScripts:G,setConversionScripts:Y,onPurchaseComplete:X,generals:J}){const[Z,ee]=e.useState(null),[te,se]=e.useState(null);V.reduce((e,t)=>t.free_items&&Array.isArray(t.free_items)?[...e,...t.free_items]:e,[]);const[ae,re]=e.useState({name:$?.name||"",lastname:$?.lastname||"",email:$?.email||"",phone:$?.phone||"",documentType:$?.document_type?.toLowerCase()||"",document:$?.document_number||"",department:$?.department||"",province:$?.province||"",district:$?.district||"",address:$?.address||"",number:$?.number||"",comment:"",reference:$?.reference||"",ubigeo:$?.ubigeo||null});e.useEffect(()=>{if($?.ubigeo)if($?.district&&$?.province&&$?.department){const e={value:$.ubigeo,label:`${$.district}, ${$.province}, ${$.department}`,data:{reniec:$.ubigeo,departamento:$.department,provincia:$.province,distrito:$.district}};se(e),ee(e),Be(e)}else fetch(`/api/ubigeo/find/${$.ubigeo}`).then(e=>e.json()).then(e=>{if(e&&e.distrito){const t={value:$.ubigeo,label:`${e.distrito}, ${e.provincia}, ${e.departamento}`,data:{reniec:$.ubigeo,departamento:e.departamento,provincia:e.provincia,distrito:e.distrito}};se(t),ee(t),Be(t)}}).catch(e=>{})},[$]),e.useEffect(()=>{$&&re(e=>({...e,name:$.name||e.name,lastname:$.lastname||e.lastname,email:$.email||e.email,phone:$.phone||e.phone,documentType:$.document_type?.toLowerCase()||e.documentType,document:$.document_number||e.document,department:$.department||e.department,province:$.province||e.province,district:$.district||e.district,address:$.address||e.address,number:$.number||e.number,reference:$.reference||e.reference,ubigeo:$.ubigeo||e.ubigeo}))},[$]);const[ie,oe]=e.useState(!1),[ne,le]=e.useState(!1),[ce,de]=e.useState([]),[me,ue]=e.useState(null),[pe,xe]=e.useState(null),[he,ge]=e.useState({}),[fe,be]=e.useState(""),[je,ve]=e.useState(!1),[ye,Ne]=e.useState(""),[we,Ce]=e.useState(null),[_e,ke]=e.useState(0),[Te,Se]=e.useState(!1),[Ee,De]=e.useState(""),[qe,Fe]=e.useState(null),[Ie,Pe]=e.useState(!1),[Le,$e]=e.useState(!1),Ae=e=>{if(!e)return;const t=document.createElement("div");if(t.style.cssText="\n            position: absolute;\n            top: -2px;\n            left: -2px;\n            right: -2px;\n            bottom: -2px;\n            border: 2px solid #ef4444;\n            border-radius: 8px;\n            pointer-events: none;\n            z-index: 1000;\n            animation: pulse 0.6s ease-in-out;\n            box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.2);\n        ",!document.querySelector("#error-highlight-styles")){const e=document.createElement("style");e.id="error-highlight-styles",e.textContent="\n                @keyframes pulse {\n                    0% { transform: scale(1); opacity: 1; }\n                    50% { transform: scale(1.02); opacity: 0.8; }\n                    100% { transform: scale(1); opacity: 1; }\n                }\n            ",document.head.appendChild(e)}const s=e.style.position;s&&"static"!==s||(e.style.position="relative"),e.appendChild(t),setTimeout(()=>{t.parentNode&&(t.parentNode.removeChild(t),s&&"static"!==s||(e.style.position=s))},1200)},Be=async e=>{if(!e)return;ge(e=>({...e,ubigeo:""}));const{data:s}=e;re(e=>({...e,department:s.departamento,province:s.provincia,district:s.distrito,ubigeo:s.reniec})),oe(!0);try{const e=c.reduce((e,t)=>e+t.final_price*t.quantity,0),t=await b.getShippingCost({ubigeo:s.reniec,cart_total:e}),a=[];let r=!1;if(t.data.is_free&&t.data.qualifies_free_shipping&&a.push({type:"free",price:0,description:t.data.standard.description,deliveryType:t.data.standard.type,characteristics:t.data.standard.characteristics}),t.data.standard&&(!t.data.is_free||t.data.is_free&&!t.data.qualifies_free_shipping)){let e=t.data.standard.description;t.data.is_free||(e=e.replace(/envÃ­o gratis.*?/gi,"").replace(/envio gratis.*?/gi,"").replace(/gratis.*?compras.*?/gi,"").replace(/mayor.*?200.*?/gi,"").replace(/200.*?mayor.*?/gi,"").replace(/\s+/g," ").trim(),e||(e="Delivery a domicilio")),a.push({type:"standard",price:t.data.standard.price,description:e,deliveryType:t.data.standard.type,characteristics:t.data.standard.characteristics})}if(t.data.express&&t.data.express.price>0&&a.push({type:"express",price:t.data.express.price,description:t.data.express.description,deliveryType:t.data.express.type,characteristics:t.data.express.characteristics}),t.data.is_agency&&t.data.agency&&a.push({type:"agency",price:t.data.agency.price||0,description:t.data.agency.description,deliveryType:t.data.agency.type,characteristics:t.data.agency.characteristics}),t.data.is_store_pickup&&(r=!0),r||t.data.is_store_pickup){a.some(e=>"store_pickup"===e.type)||(t.data.store_pickup?a.push({type:"store_pickup",price:t.data.store_pickup.price,description:t.data.store_pickup.description,deliveryType:t.data.store_pickup.type,characteristics:t.data.store_pickup.characteristics}):a.push({type:"store_pickup",price:0,description:"Retira tu pedido en una de nuestras tiendas",deliveryType:"Retiro en Tienda",characteristics:["Sin costo de envÃ­o","Horarios flexibles","AtenciÃ³n personalizada"]})),Pe(!0)}else Pe(!1),Fe(null);de(a),ue(a[0]?.type||null),A(a[0]?.price||0),ve(!1)}catch(r){_.error("Sin cobertura",{description:"No realizamos envÃ­os a esta ubicaciÃ³n.",icon:t.jsx(a,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"bottom-center"}),de([]),ue(null),A(0),ve(!1)}oe(!1)},Me=async e=>{if(e.preventDefault(),ne)return;if(!$)return void $e(!0);const s={};if(ae.name.trim()||(s.name="Nombre es requerido"),ae.lastname.trim()||(s.lastname="Apellido es requerido"),ae.documentType.trim()||(s.documentType="Tipo de documento es requerido"),ae.document.trim()||(s.document="NÃºmero de documento es requerido"),ae.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(ae.email)||(s.email="Email invÃ¡lido"):s.email="Email es requerido",ae.phone.trim()?/^[0-9]{9}$/.test(ae.phone.trim())||(s.phone="TelÃ©fono debe tener exactamente 9 dÃ­gitos"):s.phone="TelÃ©fono es requerido",ae.ubigeo||(s.ubigeo="UbicaciÃ³n es requerida"),ae.address||(s.address="DirecciÃ³n es requerida"),me||(s.shipping="Seleccione un mÃ©todo de envÃ­o"),Object.keys(s).length>0){ge(s);const e=Object.keys(s)[0],a={name:"Por favor ingrese su nombre",lastname:"Por favor ingrese su apellido",documentType:"Por favor seleccione el tipo de documento",document:"Por favor ingrese su nÃºmero de documento",email:s.email?.includes("invÃ¡lido")?"Por favor ingrese un correo electrÃ³nico vÃ¡lido":"Por favor ingrese su correo electrÃ³nico",phone:s.phone?.includes("9 dÃ­gitos")?"El telÃ©fono debe tener exactamente 9 dÃ­gitos":"Por favor ingrese su nÃºmero de telÃ©fono",ubigeo:"Por favor seleccione su ubicaciÃ³n de entrega",address:"Por favor ingrese su direcciÃ³n de entrega",shipping:"Por favor seleccione un mÃ©todo de envÃ­o"};return _.error("Complete el campo requerido",{description:a[e],icon:t.jsx(o,{className:"h-5 w-5 text-red-500"}),duration:4e3,position:"top-center"}),void(e=>{const t=["name","lastname","documentType","document","email","phone","ubigeo","address","shipping"];for(const s of t)if(e[s]){let e=null,t=!1;if("ubigeo"===s?e=document.querySelector('[name="ubigeo"]')?.parentElement?.parentElement||document.querySelector(".css-1s2u09g-control")||document.querySelector('[class*="react-select"]'):"shipping"===s?e=document.querySelector('input[name="shipping"]')?.closest(".space-y-4")||document.querySelector(".space-y-4 h3")||document.querySelector("h3"):(e=document.querySelector(`[name="${s}"]`),t=!0),e){e.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),t&&setTimeout(()=>{try{e.focus(),"INPUT"===e.tagName&&"text"===e.type&&e.select()}catch(t){}},600),Ae(e);break}}})(s)}le(!0);try{if(!k.CULQI_ENABLED)return _.error("MÃ©todo de pago no disponible",{description:"El procesamiento de pagos con tarjeta estÃ¡ temporalmente deshabilitado",icon:t.jsx(o,{className:"h-5 w-5 text-red-500"}),duration:4e3,position:"top-center"}),void le(!1);if(!k.CULQI_PUBLIC_KEY)return _.error("Error de configuraciÃ³n",{description:"El sistema de pagos no estÃ¡ configurado correctamente",icon:t.jsx(o,{className:"h-5 w-5 text-red-500"}),duration:4e3,position:"top-center"}),void le(!1);const e={user_id:$.id,...ae,fullname:`${ae.name} ${ae.lastname}`,country:"PerÃº",document_type:ae.documentType,amount:Re(Ve),delivery:Re(B),seguro_importacion_total:Re(I||0),derecho_arancelario_total:Re(P||0),flete_total:Re(F||0),delivery_type:me,store_id:"store_pickup"===me?qe?.id:null,cart:c,coupon_id:we?.id||null,coupon_code:we?.code||null,coupon_discount:Re(_e||0),applied_promotions:V||[],promotion_discount:Re(H||0)},s=await p(e);if(s.status){if(h(s.sale),y(s.delivery),f(s.code),s.conversion_scripts&&(Y(s.conversion_scripts),X))try{await X(s.sale_id,s.conversion_scripts)}catch(r){}T([]),S()}else _.error("Error en el pago",{description:s.message||"Pago rechazado",icon:t.jsx(a,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"bottom-center"})}catch(i){_.error("Lo sentimos, no puede continuar con la compra",{description:`OcurriÃ³ un error al procesar el pedido: ${i.message}`,icon:t.jsx(a,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"bottom-center"})}finally{le(!1)}},Ue=e.useCallback(C.debounce((e,t)=>{e.length<3?t([]):fetch(`/api/ubigeo/search?q=${encodeURIComponent(e)}`).then(e=>{if(!e.ok)throw new Error("Error en la respuesta");return e.json()}).then(e=>{const s=e.map(e=>({value:e.reniec,label:`${e.distrito}, ${e.provincia}, ${e.departamento}`,data:{inei:e.inei,reniec:e.reniec,departamento:e.departamento,provincia:e.provincia,distrito:e.distrito}}));t(s)}).catch(e=>{t([])})},300),[]);e.useEffect(()=>{ge(e=>{const t={...e};if(ae.name.trim()&&delete t.name,ae.lastname.trim()&&delete t.lastname,ae.documentType.trim()&&delete t.documentType,ae.document.trim()&&delete t.document,ae.email.trim()){/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(ae.email)&&delete t.email}if(ae.phone.trim()){/^[0-9]{9}$/.test(ae.phone.trim())&&delete t.phone}return ae.address.trim()&&delete t.address,ae.ubigeo&&delete t.ubigeo,me&&delete t.shipping,t})},[ae,me]);const Re=e=>{const t="string"==typeof e?parseFloat(e):e;return parseFloat(t.toFixed(2))},Oe=Re(D)+Re(q)+Re(B)+Re(I)+Re(P)-Re(H);let ze=0;we&&("percentage"===we.type||"percent"===we.type?ze=Oe*Number(we.value)/100:"fixed"===we.type&&(ze=Number(we.value))),e.useEffect(()=>{ke(Re(ze)),O&&O(Re(ze))},[we,D,q,B,H]);const Ve=Math.max(0,Re(Oe-ze)),He=()=>{if(!Le)return null;return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:e=>{e.target===e.currentTarget&&$e(!1)},children:t.jsx("div",{className:"bg-white rounded-xl p-6 max-w-md w-full shadow-2xl transform transition-all",children:t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-blue-100 mb-4",children:t.jsx(n,{className:"h-8 w-8 customtext-primary"})}),t.jsx("h2",{className:"text-2xl font-bold customtext-neutral-dark mb-3",children:"Acceso requerido"}),t.jsx("p",{className:"customtext-neutral-light text-sm leading-relaxed",children:"Para continuar con su compra necesita iniciar sesiÃ³n o crear una cuenta nueva."})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("button",{onClick:()=>{window.location.href="/iniciar-sesion"},className:"w-full py-3 px-6 bg-primary text-white font-semibold rounded-lg  focus:outline-none focus:ring-2  focus:ring-offset-2 transition duration-200 transform hover:scale-[1.02]",children:"Iniciar sesiÃ³n"}),t.jsx("button",{onClick:()=>{window.location.href="/crear-cuenta"},className:"w-full py-3 px-6 bg-accent text-white font-semibold rounded-lg  focus:outline-none focus:ring-2  focus:ring-offset-2 transition duration-200 transform hover:scale-[1.02]",children:"Crear cuenta nueva"}),t.jsx("button",{onClick:()=>$e(!1),className:"w-full py-3 px-6 customtext-neutral-light hover:customtext-neutral-dark border border-secondary rounded-lg hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition duration-200",children:"Cancelar"})]})]})})})};return t.jsxs(t.Fragment,{children:[t.jsx(He,{}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 md:gap-8",children:[t.jsx("div",{className:"lg:col-span-3",children:t.jsxs("form",{className:"space-y-4 md:space-y-6 bg-white p-4 md:p-6 rounded-xl shadow-sm",onSubmit:Me,children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx(N,{name:"name",label:"Nombres",value:ae.name,error:he.name,onChange:e=>{re(t=>({...t,name:e.target.value})),e.target.value.trim()&&he.name&&ge(e=>({...e,name:""}))},required:!0,className:"border-gray-200 "+(he.name?"border-red-500 bg-red-50":"")}),t.jsx(N,{name:"lastname",label:"Apellidos",value:ae.lastname,error:he.lastname,onChange:e=>{re(t=>({...t,lastname:e.target.value})),e.target.value.trim()&&he.lastname&&ge(e=>({...e,lastname:""}))},required:!0,className:"border-gray-200 "+(he.lastname?"border-red-500 bg-red-50":"")})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx("div",{className:"space-y-2",children:t.jsx(w,{label:"Tipo de documento",options:[{value:"dni",label:"DNI"},{value:"ruc",label:"RUC"},{value:"ce",label:"CE"},{value:"pasaporte",label:"Pasaporte"}],placeholder:"Selecciona tu documento",labelClass:"block text-sm 2xl:!text-base mb-1 customtext-neutral-dark",value:ae.documentType,error:he.documentType,onChange:e=>{re(t=>({...t,documentType:e})),e&&he.documentType&&ge(e=>({...e,documentType:""}))},required:!0})}),t.jsx(N,{name:"document",label:"NÃºmero de documento",value:ae.document,error:he.document,onChange:e=>{re(t=>({...t,document:e.target.value})),e.target.value.trim()&&he.document&&ge(e=>({...e,document:""}))},placeholder:"Ej: 12345678",required:!0,className:"border-gray-200 "+(he.document?"border-red-500 bg-red-50":"")})]}),t.jsx(N,{name:"email",label:"Correo electrÃ³nico",type:"email",value:ae.email,error:he.email,onChange:e=>{if(re(t=>({...t,email:e.target.value})),e.target.value.trim()&&he.email){/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.target.value)&&ge(e=>({...e,email:""}))}},required:!0,className:"border-gray-200 "+(he.email?"border-red-500 bg-red-50":"")}),t.jsx(N,{name:"phone",label:"TelÃ©fono",type:"tel",value:ae.phone,error:he.phone,onChange:e=>{const t=e.target.value.replace(/\D/g,"");re(e=>({...e,phone:t})),9===t.length&&he.phone&&ge(e=>({...e,phone:""}))},maxLength:"9",placeholder:"Ej: 987654321",required:!0,className:"border-gray-200 "+(he.phone?"border-red-500 bg-red-50":"")}),t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{className:"block text-sm 2xl:text-base mb-2 font-medium customtext-neutral-dark",children:["Distrito / Provincia / Departamento (UbicaciÃ³n de entrega)",t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx(r,{name:"ubigeo",cacheOptions:!0,value:Z,loadOptions:Ue,onChange:e=>{ee(e),Be(e),be("")},inputValue:fe,onInputChange:(e,{action:t})=>{"input-change"===t&&be(e)},onFocus:()=>{ee(null),be("")},onMenuOpen:()=>{Z&&(ee(null),be(""))},placeholder:"Buscar por Distrito ...",loadingMessage:()=>"Buscando ubicaciones...",noOptionsMessage:({inputValue:e})=>e.length<3?"Buscar por Distrito ...":"No se encontraron resultados",isLoading:ie,styles:(Qe=!!he.ubigeo,{control:e=>({...e,border:"1px solid "+(Qe?"#ef4444":"#e5e7eb"),boxShadow:"none",minHeight:"50px","&:hover":{borderColor:Qe?"#ef4444":"#6b7280"},borderRadius:"0.75rem",padding:"2px 8px"}),menu:e=>({...e,zIndex:9999,marginTop:"4px",borderRadius:"8px"}),option:e=>({...e,color:"#1f2937",backgroundColor:"white","&:hover":{backgroundColor:"#f3f4f6"},padding:"12px 16px"})}),formatOptionLabel:({data:e})=>t.jsxs("div",{className:"text-sm py-1",children:[t.jsx("div",{className:"font-medium",children:e.distrito}),t.jsxs("div",{className:"text-gray-500",children:[e.provincia,", ",e.departamento]})]}),className:"w-full rounded-xl transition-all duration-300",menuPortalTarget:document.body,isClearable:!0}),he.ubigeo&&t.jsx("div",{className:"text-red-500 text-sm mt-1",children:he.ubigeo})]}),t.jsx(N,{name:"address",label:"DirecciÃ³n ",value:ae.address,error:he.address,onChange:e=>{re(t=>({...t,address:e.target.value})),e.target.value.trim()&&he.address&&ge(e=>({...e,address:""}))},required:!0,className:"border-gray-200 "+(he.address?"border-red-500 bg-red-50":"")}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx(N,{label:"NÃºmero",value:ae.number,onChange:e=>re(t=>({...t,number:e.target.value})),className:"border-gray-200"}),t.jsx(N,{label:"Referencia",value:ae.reference,onChange:e=>re(t=>({...t,reference:e.target.value})),className:"border-gray-200"})]}),ce.length>0&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"MÃ©todo de envÃ­o"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ce.map(e=>t.jsx(j,{title:e.deliveryType,price:e.price,description:e.description,selected:me===e.type,onSelect:()=>{ue(e.type),A(e.price),ge(e=>({...e,shipping:"",store:""})),ve(!1),"store_pickup"!==e.type&&Fe(null)}},e.type))}),me&&ce.length>0&&t.jsx("div",{className:"space-y-3 mt-4",children:(()=>{const e=ce.find(e=>e.type===me)?.characteristics||[],s=e.length>1,a=s&&!je?e.slice(0,1):e;return t.jsxs(t.Fragment,{children:[a.map((e,s)=>t.jsxs("div",{className:"flex items-start gap-3 bg-gray-50 p-4 rounded-xl",children:[t.jsx("div",{className:"w-5 flex-shrink-0",children:t.jsx(i,{className:"customtext-primary"})}),t.jsx("div",{className:"flex-1",children:t.jsx("p",{className:"text-sm font-medium customtext-neutral-dark",children:e})})]},`char-${s}`)),s&&t.jsx("div",{className:"flex justify-center mt-3",children:t.jsxs("button",{type:"button",onClick:()=>ve(!je),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium customtext-primary hover:bg-blue-50 rounded-lg transition-colors duration-200",children:[t.jsx("span",{children:je?"Ver menos informaciÃ³n":`Ver mÃ¡s informaciÃ³n (${e.length-1} mÃ¡s)`}),t.jsx("svg",{className:"w-4 h-4 transition-transform duration-200 "+(je?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})})]})})()})]}),"store_pickup"===me&&Ie&&t.jsxs("div",{className:"space-y-4 mt-6",children:[t.jsx(v,{ubigeoCode:ae.ubigeo,onStoreSelect:e=>{Fe(e),ge(e=>({...e,store:""}))},selectedStore:qe,className:"border border-gray-200 rounded-xl p-4"}),he.store&&t.jsxs("div",{className:"text-red-500 text-sm mt-2 flex items-center gap-2",children:[t.jsx(o,{className:"h-4 w-4"}),he.store]})]}),!E&&t.jsxs("div",{className:"flex flex-col md:flex-row justify-end gap-3 md:gap-4 mt-6",children:[t.jsx(g,{type:"button",onClick:()=>window.history.back(),className:"w-full md:w-auto",children:"Regresar"}),t.jsx(u,{type:"submit",loading:ie,className:"w-full md:w-auto",children:"Continuar"})]})]})}),t.jsxs("div",{className:"bg-[#F7F9FB] rounded-xl shadow-lg p-6 col-span-2 h-max",children:[t.jsx("h3",{className:"text-2xl font-bold pb-6",children:"Resumen"}),t.jsx("div",{className:"space-y-4 border-b-2 pb-6",children:c.map(e=>t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("img",{src:"combo"===e.type?`/storage/images/combo/${e.image}`:`/storage/images/item/${e.image}`,alt:e.name,className:"w-16 h-16 object-cover rounded-lg",onError:e=>e.target.src="/api/cover/thumbnail/null"}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium",children:e.name}),t.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Cantidad: ",e.quantity]}),t.jsxs("p",{className:"text-sm customtext-neutral-dark",children:[d(),m(e.final_price)]})]})]},e.id))}),t.jsxs("div",{className:"space-y-4 mt-6",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Subtotal:"}),t.jsxs("span",{children:[d(),m(Re(D))]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{children:["IGV (",Number(J?.find(e=>"igv_checkout"===e.correlative)?.description||18),"%):"]}),t.jsxs("span",{children:[d(),m(Re(q))]})]}),Number(J?.find(e=>"importation_seguro"===e.correlative)?.description)>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{children:["Seguro (",Number(J?.find(e=>"importation_seguro"===e.correlative)?.description||0).toFixed(2),"%):"]}),t.jsxs("span",{children:[d(),m(Re(I))]})]}),Number(J?.find(e=>"importation_derecho_arancelario"===e.correlative)?.description)>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{children:["Derecho arancelario",J?.find(e=>"importation_derecho_arancelario_descripcion"===e.correlative)?.description&&t.jsx(s,{content:t.jsx("p",{className:"whitespace-pre-line",children:J?.find(e=>"importation_derecho_arancelario_descripcion"===e.correlative)?.description}),allowHTML:!0,children:t.jsx("i",{className:"mdi mdi-information ms-1"})})]}),t.jsxs("span",{children:[d(),m(Re(P))]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"EnvÃ­o:"}),t.jsx("span",{className:"font-semibold",children:"free"===me||"store_pickup"===me||0===B?t.jsx("span",{className:"customtext-neutral-dark",children:"Gratis"}):`${d()} ${m(B)}`})]}),t.jsx("div",{className:"space-y-4 border-t pt-4",children:t.jsxs("div",{className:"space-y-3",children:[t.jsx("label",{className:"block text-sm font-medium customtext-neutral-dark",children:"Â¿Tienes un cupÃ³n de descuento?"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx("input",{type:"text",placeholder:"Ingresa tu cÃ³digo de cupÃ³n",value:ye,onChange:e=>Ne(e.target.value.toUpperCase()),className:`w-full px-4 py-3 border customtext-neutral-dark  border-gray-100 rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300 ${Ee?"border-red-300 bg-red-50 text-red-900 focus:border-red-500 focus:ring-red-200":we?"border-gray-200 bg-white customtext-neutral-dark focus:ring-blue-200":" bg-white border-neutral-light focus:ring-0 focus:outline-0"} `,disabled:!!we||Te}),Te&&t.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:t.jsx("div",{className:"w-4 h-4 border-2 border-primary border-t-transparent rounded-full animate-spin"})})]}),we?t.jsx("button",{type:"button",onClick:()=>{Ce(null),ke(0),Ne(""),De(""),O&&O(0),z&&z(""),_.success("CupÃ³n removido",{description:"El cupÃ³n ha sido removido de su pedido",duration:2e3,position:"top-center"})},className:"px-4 py-3 bg-gray-200 customtext-neutral-dark text-sm rounded-xl hover:bg-gray-300 transition-colors duration-200",title:"Remover cupÃ³n",children:t.jsx(o,{className:"h-4 w-4"})}):t.jsx("button",{type:"button",onClick:async()=>{if(ye.trim()){Se(!0),De("");try{const e=[...new Set(c.map(e=>e.category_id).filter(Boolean))],s=c.map(e=>e.id),a=await x.validateCoupon({code:ye.trim(),cart_total:D,category_ids:e,product_ids:s}),r=a.data||a;if(r&&r.valid){Ce(r.coupon);const e=Math.round(100*r.discount)/100;ke(e),O&&O(e),z&&z(r.coupon?.code||ye.trim()),_.success("CupÃ³n aplicado",{description:r.message||"CupÃ³n aplicado correctamente",duration:3e3,position:"top-center"})}else{const e=r?.message||"CupÃ³n no vÃ¡lido";De(e),_.error("CupÃ³n no vÃ¡lido",{description:e,icon:t.jsx(o,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-center"})}}catch(e){De("Error al validar el cupÃ³n"),_.error("Error",{description:e.message||"No se pudo validar el cupÃ³n. Intente nuevamente.",icon:t.jsx(o,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-center"})}finally{Se(!1)}}else De("Ingrese un cÃ³digo de cupÃ³n")},disabled:Te||!ye.trim(),className:"px-6 py-3 bg-primary text-white text-sm font-medium rounded-xl hover:opacity-90 disabled:bg-gray-300 disabled:cursor-not-allowed transition-all duration-200 whitespace-nowrap",children:Te?"Validando...":"Aplicar"})]}),Ee&&t.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[t.jsx(o,{className:"h-4 w-4 flex-shrink-0"}),t.jsx("span",{children:Ee})]}),we&&t.jsx("div",{className:"bg-gray-50 border-2  rounded-xl p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3 w-8/12",children:[t.jsx("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center flex-shrink-0",children:t.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),t.jsxs("div",{children:[t.jsxs("p",{className:"customtext-primary font-semibold text-sm",children:["Descto. ","percentage"===we.type?`${we.value}%`:`${d()}${m(we.value)}`]}),t.jsx("p",{className:"customtext-primary text-xs mt-1",children:we.code})]})]}),t.jsx("div",{className:"text-right w-4/12",children:t.jsxs("span",{className:"customtext-primary font-bold text-base",children:["-",d(),m(Re(_e))]})})]})})]})}),V&&V.length>0&&t.jsx("div",{className:"space-y-4 border-t pt-4",children:t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"text-sm font-medium customtext-neutral-dark mb-2",children:"ðŸŽ‰ Descuentos automÃ¡ticos aplicados:"}),V.map((e,s)=>t.jsx("div",{className:" border-2  rounded-xl p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3 w-8/12",children:[t.jsx("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center flex-shrink-0",children:t.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),t.jsxs("div",{children:[t.jsx("p",{className:"customtext-neutral-dark font-semibold text-sm",children:e.name}),e.description&&t.jsx("p",{className:"customtext-neutral-dark text-xs mt-1",children:e.description})]})]}),t.jsx("div",{className:"text-right w-4/12",children:t.jsxs("span",{className:"customtext-neutral-dark font-bold text-base",children:["-",d(),m(e.amount)]})})]})},s)),H>0&&t.jsx("div",{className:"l p-3",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"customtext-neutral-dark font-semibold",children:"Total descuentos automÃ¡ticos:"}),t.jsxs("span",{className:"customtext-neutral-dark font-bold text-lg",children:["-",d(),m(H)]})]})})]})}),t.jsx("div",{className:"pt-4 border-t-2",children:t.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[t.jsx("span",{children:"Total:"}),t.jsxs("span",{children:[d(),m(Re(Ve))]})]})}),!k.CULQI_ENABLED&&t.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(i,{className:"h-5 w-5 text-yellow-600 mr-2"}),t.jsx("span",{className:"text-sm text-yellow-800",children:"El procesamiento de pagos con tarjeta estÃ¡ temporalmente deshabilitado"})]})}),k.CULQI_ENABLED&&!k.CULQI_PUBLIC_KEY&&t.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(o,{className:"h-5 w-5 text-red-600 mr-2"}),t.jsx("span",{className:"text-sm text-red-800",children:"Error de configuraciÃ³n: Sistema de pagos no configurado"})]})}),t.jsx(u,{onClick:Me,disabled:ne||!k.CULQI_ENABLED||!k.CULQI_PUBLIC_KEY,loading:ne,className:`w-full mt-6 ${l?.class_button||"text-white"} ${k.CULQI_ENABLED&&k.CULQI_PUBLIC_KEY?"":"opacity-50 cursor-not-allowed"}`,children:ne?"Procesando...":k.CULQI_ENABLED?k.CULQI_PUBLIC_KEY?`Pagar ${d()}${m(Re(Ve))}`:"ConfiguraciÃ³n pendiente":"Pago no disponible"}),t.jsx(g,{onClick:E,className:"w-full mt-3",disabled:ne,children:"Regresar al carrito"}),t.jsxs("p",{className:"text-xs md:text-sm customtext-neutral-dark",children:["Al realizar tu pedido, aceptas losÂ ",t.jsx("a",{href:"#",onClick:()=>U(1),className:"customtext-primary font-bold",children:"TÃ©rminos y Condiciones"}),", y que nosotros usaremos sus datos personales de acuerdo con nuestraÂ ",t.jsx("a",{href:"#",onClick:()=>U(0),className:"customtext-primary font-bold",children:"PolÃ­tica de Privacidad"}),"."]})]})]})]})]});var Qe}function F({cart:s,code:a,delivery:r,subTotal:i,igv:o,fleteTotal:n=0,seguroImportacionTotal:l=0,derechoArancelarioTotal:c=0,totalFinal:p,couponDiscount:x=0,couponCode:h=null,conversionScripts:g=null,automaticDiscounts:f=[],automaticDiscountTotal:b=0,generals:j}){const v=s.reduce((e,t)=>e+("combo"===t.type?t.final_price||t.price:t.final_price)*t.quantity,0),y=i>0?i:parseFloat((v/1.18).toFixed(2)),N=i>0?o:parseFloat((v-y).toFixed(2)),w=s.reduce((e,t)=>e+(parseFloat(t.weight)||0)*t.quantity,0),C=Number(j?.find(e=>"importation_flete"===e.correlative)?.description)||0,_=n>0?n:C>0?w*C:0,k=(Number(j?.find(e=>"importation_seguro"===e.correlative)?.description)||0)/100,S=l>0?l:y*k,E=parseFloat(y)+parseFloat(_)+parseFloat(S),D=(Number(j?.find(e=>"importation_derecho_arancelario"===e.correlative)?.description)||0)/100,q=c>0?c:E*D,F=y+N+(r||0)+S+q-(x||0)-(b||0);return e.useEffect(()=>{if(g)try{if(g.head){const e=document.createElement("script");e.innerHTML=g.head,document.head.appendChild(e)}if(g.body){const e=document.createElement("script");e.innerHTML=g.body,document.body.appendChild(e)}}catch(e){}},[g]),t.jsx(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"mx-auto max-w-3xl px-4 sm:px-6 lg:px-8 py-12",children:t.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-10",children:t.jsxs(T.div,{initial:{scale:.9},animate:{scale:1},transition:{delay:.3},className:"text-center space-y-6",children:[t.jsx(T.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.5},className:"w-20 h-20 bg-secondary rounded-full mx-auto flex items-center justify-center",children:t.jsx("span",{className:"text-4xl",children:"âœ“"})}),t.jsx("h2",{className:"text-2xl md:text-3xl customtext-neutral-light animate-bounce",children:"Â¡Gracias por tu compra! ðŸŽ‰"}),t.jsx("p",{className:"customtext-neutral-dark text-3xl md:text-5xl font-bold",children:"Tu orden ha sido recibida"}),t.jsxs(T.div,{whileHover:{scale:1.05},className:"py-6 px-4 bg-secondary rounded-xl inline-block",children:[t.jsx("div",{className:"customtext-neutral-light",children:"CÃ³digo de pedido"}),t.jsx("div",{className:"customtext-neutral-dark text-xl font-bold",children:`#${a}`})]}),t.jsxs("div",{className:"space-y-6 bg-[#F7F9FB] p-6 md:p-8 rounded-xl shadow-inner",children:[t.jsx("div",{className:"space-y-6 border-b-2 pb-6",children:s.map((e,s)=>t.jsx(T.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2*s},className:"bg-white rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow duration-300",children:t.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 items-center sm:items-start",children:[t.jsx("div",{className:"bg-gray-50 p-3 rounded-xl",children:t.jsx("img",{src:"combo"===e?.type?`/storage/images/combo/${e?.image}`:`/storage/images/item/${e?.image}`,alt:e?.name,className:"w-24 h-24 object-cover rounded-lg",onError:e=>e.target.src="/api/cover/thumbnail/null",loading:"lazy"})}),t.jsxs("div",{className:"text-center sm:text-left flex-1",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between mb-3",children:[t.jsxs("div",{className:"lg:w-8/12",children:[t.jsx("h3",{className:"font-semibold text-xl line-clamp-3 mb-2",children:e?.name}),"combo"===e.type&&t.jsxs("div",{className:"mt-2",children:[t.jsx("div",{className:"mb-2",children:t.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded-full",children:"COMBO"})}),t.jsxs("div",{className:"text-sm text-gray-600",children:[t.jsx("span",{className:"font-medium",children:"Contiene:"}),t.jsx("div",{className:"mt-1",children:e.combo_items&&e.combo_items.length>0?e.combo_items.map((e,s)=>t.jsxs("div",{className:"text-xs text-gray-500",children:["â€¢ ",e.quantity||1,"x ",e.name]},s)):e.items&&e.items.length>0?e.items.map((e,s)=>t.jsxs("div",{className:"text-xs text-gray-500",children:["â€¢ ",e.quantity||1,"x ",e.name]},s)):t.jsx("span",{className:"text-xs text-gray-400",children:"InformaciÃ³n de combo no disponible"})})]})]})]}),t.jsx("div",{className:"mt-2 sm:mt-0 text-center lg:text-right lg:w-4/12",children:t.jsxs("div",{className:"font-bold text-lg customtext-primary",children:[d(),m(("combo"===e.type?e.final_price||e.price:e.final_price)*e?.quantity)]})})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[e?.brand?.name&&t.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Marca: ",t.jsx("span",{className:"customtext-neutral-dark font-medium",children:e?.brand?.name||"N/A"})]}),t.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Cantidad: ",t.jsx("span",{className:"customtext-neutral-dark font-medium",children:e?.quantity})]}),e?.sku&&t.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["SKU: ",t.jsx("span",{className:"customtext-neutral-dark font-medium",children:e?.sku||"N/A"})]})]})]})]})},s))}),t.jsxs(T.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"space-y-4 mt-6",children:[[{label:"Subtotal",value:y},{label:"IGV",value:N},...S>0?[{label:"Seguro de ImportaciÃ³n",value:S}]:[],...q>0?[{label:"Derecho Arancelario",value:q}]:[],{label:"EnvÃ­o",value:r}].map((e,s)=>t.jsxs("div",{className:"flex justify-between items-center py-2",children:[t.jsx("span",{className:"customtext-neutral-dark",children:e.label}),t.jsxs("span",{className:"font-semibold",children:[d(),m(e.value)]})]},s)),x>0&&h&&t.jsxs("div",{className:"flex justify-between items-center py-2",children:[t.jsxs("span",{className:"customtext-neutral-dark text-start",children:["CupÃ³n: ",t.jsx("br",{className:"lg:hidden"}),t.jsxs("span",{className:"font-semibold text-xs lg:text-base",children:["(",h,")"]})]}),t.jsxs("span",{className:"font-semibold",children:["-",d(),m(x)]})]}),b>0&&f.length>0&&t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"text-xl md:text-2xl font-bold pb-4 md:pb-6 customtext-neutral-dark mb-2",children:"ðŸŽ‰ Descuentos aplicados:"}),f.map((e,s)=>t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsxs("span",{className:"customtext-neutral-dark",children:[e.name,e.description&&t.jsx("span",{className:"text-xs font-semibold block",children:e.description})]}),t.jsxs("span",{className:"customtext-neutral-dark font-semibold",children:["-",d(),m(e.amount)]})]},s)),t.jsxs("div",{className:"flex justify-between text-sm font-semibold customtext-neutral-dark pt-1",children:[t.jsx("span",{children:"Total descuentos:"}),t.jsxs("span",{children:["-",d(),m(b)]})]})]}),t.jsx("div",{className:"py-4 border-y-2 mt-6",children:t.jsxs("div",{className:"flex justify-between font-bold text-xl md:text-2xl items-center",children:[t.jsx("span",{children:"Total"}),t.jsxs("span",{children:[d(),m(F)]})]})})]}),t.jsx(T.div,{className:"pt-6",whileHover:{scale:1.02},whileTap:{scale:.98},children:t.jsx(u,{href:"/catalogo",className:"w-full mx-auto md:w-auto text-white",children:"Seguir Comprando"})})]})]})})})}function I({cart:s,setCart:a,user:r,ubigeos:i=[],items:o,generals:n,data:d,categorias:m}){const[u,p]=e.useState(1);e.useEffect(()=>{0===s.filter(e=>"combo"===e.type).length&&s.length},[s,u]);const x=s.reduce((e,t)=>{const s=(e=>"combo"===e.type?e.final_price||e.price:e.final_price)(t);return e+s*t.quantity},0),{trackCheckoutPageView:h,trackInitiateCheckout:g,trackPurchase:f,resetTracking:b}=E(),j=parseFloat((x/1.18).toFixed(2)),v=parseFloat((x-j).toFixed(2)),[y,N]=e.useState(0),w=s.reduce((e,t)=>e+(Number(t.weight)||0)*t.quantity,0),C=Number(n?.find(e=>"importation_flete"===e.correlative)?.description)||0,_=C>0?w*C:0,k=j*((Number(n?.find(e=>"importation_seguro"===e.correlative)?.description)||0)/100),T=(parseFloat(j)+parseFloat(_)+parseFloat(k))*((Number(n?.find(e=>"importation_derecho_arancelario"===e.correlative)?.description)||0)/100),[I,P]=e.useState(0),[L,$]=e.useState(null),[A,B]=e.useState([]),[M,U]=e.useState(0),R=j+v+parseFloat(y)+parseFloat(k)+parseFloat(T),O=I+M,z=Math.max(0,R-O),[V,H]=e.useState([]),[Q,W]=e.useState([]),[K,G]=e.useState([]),[Y,X]=e.useState(null);e.useEffect(()=>(h(u,s),()=>b()),[]),e.useEffect(()=>{h(u,s),2===u&&g(s,z)},[u]);const J=e=>{p(e),window.scrollTo({top:0,behavior:"smooth"})},Z={privacy_policy:"PolÃ­ticas de privacidad",terms_conditions:"TÃ©rminos y condiciones",saleback_policy:"PolÃ­ticas de devolucion y cambio"},[ee,te]=e.useState(null),se=e=>te(e),ae=()=>te(null);return t.jsxs("div",{id:d?.element_id||null,className:"min-h-screen bg-[#F7F9FB] py-4 md:py-12 px-2 sm:px-primary 2xl:px-0 2xl:max-w-7xl mx-auto",children:[t.jsxs("div",{className:"bg-white p-3 md:p-8 rounded-lg md:rounded-xl shadow-sm",children:[t.jsx("div",{className:"mb-4 md:mb-8",children:t.jsxs("div",{className:"flex items-center justify-between gap-1 md:gap-4 max-w-3xl mx-auto",children:[t.jsxs("div",{className:`flex flex-col items-center md:flex-row md:items-center gap-1 md:gap-2 ${1===u?"customtext-primary font-medium":"customtext-neutral-dark"} ${2===u?"cursor-pointer hover:opacity-80 transition-opacity":""}`,onClick:()=>2===u&&J(1),children:[t.jsx("span",{className:"bg-primary text-white w-8 h-8 rounded-full border-2 flex items-center justify-center text-xs md:text-sm",children:"1"}),t.jsx("span",{className:"text-[10px] md:text-sm text-center",children:"Carrito"})]}),t.jsx("div",{className:"mb-4 lg:mb-0 flex-1 h-[2px] bg-gray-200 relative",children:t.jsx("div",{className:"absolute inset-0 bg-primary transition-all duration-500",style:{width:u>1?"100%":"0%"}})}),t.jsxs("div",{className:"flex flex-col items-center md:flex-row md:items-center gap-1 md:gap-2 "+(u>1?"customtext-primary font-medium":"customtext-neutral-dark"),children:[t.jsx("span",{className:"w-8 h-8 rounded-full border-2 flex items-center justify-center text-xs md:text-sm "+(u>1?"bg-primary text-white":"bg-white customtext-primary"),children:"2"}),t.jsx("span",{className:"text-[10px] md:text-sm text-center",children:"EnvÃ­o"})]}),t.jsx("div",{className:"mb-4 lg:mb-0 flex-1 h-[2px] bg-gray-200 relative",children:t.jsx("div",{className:"absolute inset-0 bg-primary transition-all duration-500",style:{width:u>2?"100%":"0%"}})}),t.jsxs("div",{className:"flex flex-col items-center md:flex-row md:items-center gap-1 md:gap-2 "+(3===u?"customtext-primary font-medium":"customtext-neutral-dark"),children:[t.jsx("span",{className:"w-8 h-8 rounded-full border-2 flex items-center justify-center text-xs md:text-sm "+(3===u?"bg-primary text-white":"bg-white customtext-primary"),children:"3"}),t.jsx("span",{className:"text-[10px] md:text-sm text-center",children:"ConfirmaciÃ³n"})]})]})}),1===u&&t.jsx(D,{data:d,cart:s,setCart:a,onContinue:()=>J(2),subTotal:j,envio:y,igv:v,fleteTotal:_,seguroImportacionTotal:k,derechoArancelarioTotal:T,totalFinal:z,openModal:se,categorias:m,automaticDiscounts:A,setAutomaticDiscounts:B,automaticDiscountTotal:M,setAutomaticDiscountTotal:U,totalWithoutDiscounts:R,generals:n}),2===u&&t.jsx(q,{data:d,items:o,setCode:W,setDelivery:G,cart:s,setSale:H,setCart:a,onContinue:()=>J(3),noContinue:()=>J(1),subTotal:j,envio:y,setEnvio:N,igv:v,fleteTotal:_,seguroImportacionTotal:k,derechoArancelarioTotal:T,totalFinal:z,user:r,ubigeos:i,categorias:m,openModal:se,setCouponDiscount:P,setCouponCode:$,automaticDiscounts:A,setAutomaticDiscounts:B,automaticDiscountTotal:M,setAutomaticDiscountTotal:U,totalWithoutDiscounts:R,conversionScripts:Y,setConversionScripts:X,onPurchaseComplete:(e,t)=>{f(e,t)},generals:n}),3===u&&t.jsx(F,{code:Q,delivery:K,cart:V,subTotal:j,envio:y,igv:v,fleteTotal:_,seguroImportacionTotal:k,derechoArancelarioTotal:T,totalFinal:z,couponDiscount:I,couponCode:L,automaticDiscounts:A,automaticDiscountTotal:M,totalWithoutDiscounts:R,conversionScripts:Y,setConversionScripts:X,onPurchaseComplete:(e,t)=>{f(e,t)},generals:n})]}),Object.keys(Z).map((e,s)=>{const a=Z[e],r=n.find(t=>t.correlative==e)?.description??"";return t.jsx(l,{isOpen:ee===s,onRequestClose:ae,contentLabel:a,className:"fixed top-0 left-0 right-0 bottom-0 flex items-center justify-center p-4 z-50",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 z-[999]",ariaHideApp:!1,children:t.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 pr-4",children:a}),t.jsx("button",{onClick:ae,className:"flex-shrink-0 text-gray-400 hover:text-red-500 transition-colors duration-200 p-1 hover:bg-gray-100 rounded-full","aria-label":"Cerrar modal",children:t.jsx(c,{size:24,strokeWidth:2})})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:t.jsx("div",{className:"prose prose-gray max-w-none",children:t.jsx(S,{html:r})})}),t.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200",children:t.jsx("button",{onClick:ae,className:"px-6 py-2 bg-primary text-white rounded-lg  transition-colors duration-200 font-medium",children:"Cerrar"})})]})},s)})]})}export{I as default};
