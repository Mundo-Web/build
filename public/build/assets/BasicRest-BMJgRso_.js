var t=Object.defineProperty,e=(e,r,o)=>((e,r,o)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o)(e,"symbol"!=typeof r?r+"":r,o);import{m as r}from"./vendor-react-CZUvQwNQ.js";import{t as o}from"./OpenPayCardModal-BHkRoVZ6.js";import{B as s}from"./BooleanLimit-q2Ad9fGY.js";class i{constructor(){e(this,"is_use_notify",!0),e(this,"path",null),e(this,"hasFiles",!1),e(this,"controller",null),e(this,"booleanLimitKey",null),e(this,"resolveBooleanLimitKey",()=>{if(this.booleanLimitKey)return this.booleanLimitKey;if(!this.path)return null;const t=this.path.split("/").filter(Boolean);if(0===t.length)return null;const e=t[t.length-1];return e?e.replace(/-/g,"_"):null}),e(this,"simpleGet",async(t,e,s=!0)=>{try{const{status:o,result:s}=await r.Fetch(t,e);if(!o)throw new Error(s?.message||"Ocurrio un error inesperado");return s.data??!0}catch(i){return s&&o.error("¡Error!",{description:i.message,duration:3e3,position:"bottom-center",richColors:!0}),null}}),e(this,"paginate",async t=>{this.controller.abort("Nothing"),this.controller=new AbortController;const e=this.controller.signal,o=await fetch(`/api/${this.path}/paginate`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-Xsrf-Token":decodeURIComponent(r.Cookies.get("XSRF-TOKEN"))},body:JSON.stringify(t),signal:e});return await o.json()}),e(this,"save",async(t,e=()=>{})=>{try{let s=!1,i={};if(this.hasFiles){const e=await fetch(`/api/${this.path}`,{method:"POST",headers:{"X-Xsrf-Token":decodeURIComponent(r.Cookies.get("XSRF-TOKEN"))},body:t});s=e.ok,i=JSON.parseable(await e.text())}else{const e=await r.Fetch(`/api/${this.path}`,{method:"POST",body:JSON.stringify(t)});s=e.status,i=e.result}if(!s)throw new Error(i?.message||"Ocurrio un error inesperado");return this.is_use_notify&&o.success("¡Excelente!",{description:i.message,duration:3e3,position:"bottom-center",richColors:!0}),e?.(),i?.data??!0}catch(s){return o.error("¡Error!",{description:s.message,duration:3e3,position:"bottom-center",richColors:!0}),null}}),e(this,"status",async({id:t,status:e})=>{try{const{status:s,result:i}=await r.Fetch(`/api/${this.path}/status`,{method:"PATCH",body:JSON.stringify({id:t,status:e})});if(!s)throw new Error(i?.message??"Ocurrio un error inesperado");return o.success("¡Excelente!",{description:i.message,duration:3e3,position:"bottom-center",richColors:!0}),!0}catch(s){return o.error("¡Error!",{description:s.message,duration:3e3,position:"bottom-center",richColors:!0}),!1}}),e(this,"boolean",async({id:t,field:e,value:i})=>{try{const{status:n,result:a}=await r.Fetch(`/api/${this.path}/boolean`,{method:"PATCH",body:JSON.stringify({id:t,field:e,value:i})}),c=this.resolveBooleanLimitKey();if(c&&a?.data?.limit&&s.updateFromServer(c,a.data),!n)throw new Error(a?.message??"Ocurrio un error inesperado");return o.success("¡Excelente!",{description:a.message,duration:3e3,position:"bottom-center",richColors:!0}),a?.data??!0}catch(n){return o.error("¡Error!",{description:n.message,duration:3e3,position:"bottom-center",richColors:!0}),!1}}),e(this,"delete",async t=>{try{const{status:e,result:s}=await r.Fetch(`/api/${this.path}/${t}`,{method:"DELETE"});if(!e)throw new Error(s?.message??"Ocurrio un error inesperado");return o.success("¡Excelente!",{description:s.message,duration:3e3,position:"bottom-center",richColors:!0}),!0}catch(e){return o.error("¡Error!",{description:e.message,duration:3e3,position:"bottom-center",richColors:!0}),!1}}),e(this,"get",async(t={},e=[])=>{try{let o=`/api/${this.path}`;if("string"==typeof t||"number"==typeof t)o+=`/${t}`;else if("object"==typeof t&&Object.keys(t).length>0){o+=`?${new URLSearchParams(t).toString()}`}if(e.length>0){const t=e.join(",");o+=`${o.includes("?")?"&":"?"}with=${t}`}const s=await fetch(o,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","X-Xsrf-Token":decodeURIComponent(r.Cookies.get("XSRF-TOKEN"))}});if(!s.ok)throw new Error(`Error ${s.status}: ${s.statusText}`);return await s.json()}catch(s){return o.error("¡Error!",{description:s.message,duration:3e3,position:"bottom-center",richColors:!0}),null}}),e(this,"reorder",async(t,e)=>{try{const s=await fetch(`/api/${this.path}/${t}/reorder`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json","X-Xsrf-Token":decodeURIComponent(r.Cookies.get("XSRF-TOKEN"))},body:JSON.stringify({order_index:e})});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=await s.json();return this.is_use_notify&&i.success&&o.success("¡Excelente!",{description:i.message,duration:3e3,position:"bottom-center",richColors:!0}),i}catch(s){return this.is_use_notify&&o.error("¡Error!",{description:s.message,duration:3e3,position:"bottom-center",richColors:!0}),!1}}),this.controller=new AbortController}}export{i as B};
