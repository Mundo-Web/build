import{j as m}from"./AboutSimple-Cf8x2fCZ.js";import{r as l}from"./index-BOnQTV8N.js";import{G as p}from"./General-BmbBKdsB.js";class d{static shouldShow(t){if(typeof t=="string")return t.trim()!=="";if(!t||t.enabled===!1||!t.text||t.text.trim()==="")return!1;if(!t.schedule)return!0;const s=new Date,a=this.getCurrentDayKey(s),r=this.getCurrentTimeString(s),e=t.schedule[a];return!e||!e.enabled?!1:this.isTimeInRange(r,e.start,e.end)}static getCurrentDayKey(t=new Date){return["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][t.getDay()]}static getCurrentTimeString(t=new Date){return t.toTimeString().slice(0,5)}static isTimeInRange(t,s,a){if(!s||!a)return!0;const r=this.timeToMinutes(t),e=this.timeToMinutes(s),n=this.timeToMinutes(a);return n<e?r>=e||r<=n:r>=e&&r<=n}static timeToMinutes(t){const[s,a]=t.split(":").map(Number);return s*60+a}static filterActiveCintillos(t){return Array.isArray(t)?t.filter(s=>this.shouldShow(s)):[]}static getText(t){return typeof t=="string"?t:(t==null?void 0:t.text)||""}static getDebugInfo(t){var n;const s=new Date,a=this.getCurrentDayKey(s),r=this.getCurrentTimeString(s);if(typeof t=="string")return{type:"legacy",shouldShow:t.trim()!=="",text:t,currentDay:a,currentTime:r};const e=(n=t.schedule)==null?void 0:n[a];return{type:"scheduled",enabled:t.enabled,hasText:!!(t.text&&t.text.trim()),currentDay:a,currentTime:r,dayEnabled:(e==null?void 0:e.enabled)||!1,daySchedule:e||null,timeInRange:e?this.isTimeInRange(r,e.start,e.end):!0,shouldShow:this.shouldShow(t)}}static getNextSchedule(t){if(typeof t=="string"||!t.schedule)return null;const s=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],a=["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo"];for(let r=0;r<7;r++){const e=s[r],n=t.schedule[e];if(n&&n.enabled)return`${a[r]}: ${n.start} - ${n.end}`}return"Sin programación activa"}}const x=({className:o=""})=>{const[t,s]=l.useState(0),[a,r]=l.useState(!0),[e,n]=l.useState([]),u=()=>{try{const i=p.get("cintillo");console.log(i,"cintilloData");let c=[];if(i)try{c=JSON.parse(i)}catch{c=i.split(",").map(f=>f.trim()).filter(f=>f.length>0)}const g=d.filterActiveCintillos(c);n(g),s(h=>h>=g.length?0:h)}catch(i){console.warn("Error al procesar cintillos:",i),n([])}};if(l.useEffect(()=>{u();const i=setInterval(u,6e4);return()=>clearInterval(i)},[]),l.useEffect(()=>{if(e.length<=1)return;const i=setInterval(()=>{r(!1),setTimeout(()=>{s(c=>(c+1)%e.length),r(!0)},300)},4e3);return()=>clearInterval(i)},[e.length]),e.length===0)return null;if(e.length===1){const i=d.getText(e[0]);return m.jsx("span",{className:o,children:i})}const y=e[t]?d.getText(e[t]):"";return m.jsx("span",{className:`
                ${o} 
                transition-all duration-300 ease-in-out
                ${a?"opacity-100 transform translate-y-0":"opacity-0 transform -translate-y-2"}
            `,style:{display:"inline-block",minHeight:"1.2em"},title:`Cintillo ${t+1} de ${e.length}`,children:y})},T=()=>{const[o,t]=l.useState(!1),[s,a]=l.useState([]),r=()=>{try{const e=p.get("cintillo");let n=[];if(e)try{n=JSON.parse(e)}catch{n=e.split(",").map(i=>i.trim()).filter(i=>i.length>0)}const u=d.filterActiveCintillos(n);a(u),t(u.length>0)}catch(e){console.warn("Error al procesar cintillos en hook:",e),a([]),t(!1)}};return l.useEffect(()=>{r();const e=setInterval(r,6e4);return()=>clearInterval(e)},[]),{hasActiveCintillos:o,activeCintillos:s,updateActiveCintillos:r}};export{x as A,T as u};
