import{r as e,j as a,R as t,I as s}from"./System-Bybt2Brn.js";import{L as i}from"./Loading-B56-7KDx.js";import{N as r}from"./NoResult-m-3gmVGS.js";import{S as n}from"./SelectForm-ChOsm-KR.js";import{C as l}from"./CardProductBananaLab-oDawj799.js";import{m as c}from"./proxy-BmPRG09w.js";import{C as o}from"./chevron-down-r_B4RFE6.js";import{A as d}from"./index-Da4AP4wO.js";import{S as m}from"./search--TD4pUuj.js";import{C as p}from"./chevron-left-DoRUFD_L.js";import{C as u}from"./chevron-right-jU6kkjiT.js";import"./vendor-BiOv2i5T.js";import"./check-BqyWwvbE.js";import"./createLucideIcon-oahCLV50.js";import"./sweetalert2.esm.all-DbJpIAEg.js";import"./CartModal-Db_dBOJN.js";import"./index-Cmhjy_Bv.js";import"./index-Bx5UHif0.js";import"./CartItemRow-CLpuTcvn.js";import"./Number2Currency-DExzICY3.js";import"./tippy-react.esm-Cpb4mDDh.js";import"./trash-2-CDXts6on.js";import"./minus-BhdGy6sP.js";import"./plus-4JHYG4O1.js";import"./CartModalBananaLab-CzbnPykF.js";import"./x-DWgXNABc.js";import"./shopping-cart-D6rW5WdX.js";import"./arrow-right-CoVebBW_.js";import"./heart-CyPg-ZZw.js";import"./circle-check-big-BzpJOupm.js";const h=new s,x=({items:s,data:x,filteredData:g,cart:f,setCart:y})=>{const{collections:b,categories:j,brands:v,priceRanges:w}=g,[N,P]=e.useState([]),[C,_]=e.useState({collection:!0,marca:!0,precio:!0,categoria:!0,subcategoria:!1,colores:!1}),[k,S]=e.useState({collection_id:[],category_id:[],subcategory_id:[],brand_id:[],price:null,name:null,sort_by:"created_at",order:"desc"}),[H,M]=e.useState([]),[L,A]=e.useState(!1),[I,R]=e.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:21,from:0,to:0}),T={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{duration:.3}}};e.useEffect((()=>{(async()=>{if(k.category_id.length>0)try{const e=await h.getSubcategories({category_id:k.category_id[0]});P(e),_((e=>({...e,subcategoria:!0})))}catch(e){}else P([]),S((e=>({...e,subcategory_id:[]}))),_((e=>({...e,subcategoria:!1})))})()}),[k.category_id]);const E=async(e=1)=>{A(!0);try{const a={filter:(e=>{const a=[];if(e.collection_id.length>0){const t=e.collection_id.map((e=>["collection_id","=",e]));a.push(["or",...t])}if(e.category_id.length>0){const t=e.category_id.map((e=>["category_id","=",e]));a.push(["or",...t])}if(e.subcategory_id.length>0){const t=e.subcategory_id.map((e=>["subcategory_id","=",e]));a.push(["or",...t])}if(e.brand_id.length>0){const t=e.brand_id.map((e=>["brand_id","=",e]));a.push(["or",...t])}return e.price&&a.push(["and",[["final_price",">=",e.price.min],"and",["final_price","<=",e.price.max]]]),e.name&&a.push(["name","contains",e.name]),a})(k),sort:k.sort,skip:(e-1)*I.itemsPerPage,take:I.itemsPerPage,requireTotalCount:!0},t=await h.paginate(a);M(t.data),R({currentPage:e,totalPages:Math.ceil(t.totalCount/I.itemsPerPage),totalItems:t.totalCount,itemsPerPage:I.itemsPerPage,from:(e-1)*I.itemsPerPage+1,to:Math.min(e*I.itemsPerPage,t.totalCount)})}catch(a){}finally{A(!1)}};e.useEffect((()=>{E(I.currentPage)}),[k]);const $=e=>{e>=1&&e<=I.totalPages&&E(e)},B=()=>{const e=[],a=I.totalPages,t=I.currentPage;for(let s=1;s<=a;s++)1===s||s===a||s>=t-2&&s<=t+2?e.push(s):s!==t-2-1&&s!==t+2+1||e.push("...");return e.filter(((e,a,t)=>"..."!==e||"..."!==t[a-1]))};e.useEffect((()=>{const e=new URLSearchParams(window.location.search),a=e.get("category"),t=e.get("collection"),s=e.get("search");if(a){const e=j.find((e=>e.slug===a));e&&S((a=>({...a,category_id:[e.id]})))}if(t){const e=b.find((e=>e.slug===t));e&&S((a=>({...a,collection_id:[e.id]})))}s&&S((e=>({...e,name:s})))}),[s]);const F=(e,a)=>{S((t=>{if("price"===e)return{...t,price:t.price&&t.price.min===a.min&&t.price.max===a.max?null:a};const s=Array.isArray(t[e])?t[e]:[],i=s.includes(a)?s.filter((e=>e!==a)):[...s,a];return{...t,[e]:i}}))},z=e=>{_((a=>({...a,[e]:!a[e]})))},[K,q]=e.useState(""),[D,Z]=e.useState(""),[G,O]=e.useState(""),U=j.filter((e=>e.name.toLowerCase().includes(K.toLowerCase()))),Y=v.filter((e=>e.name.toLowerCase().includes(G.toLowerCase())));return a.jsx(c.section,{initial:"hidden",animate:"visible",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{duration:.5}}},className:"py-6 customtext-neutral-dark font-paragraph",children:a.jsx("div",{className:"mx-auto px-primary",children:a.jsxs("div",{className:"relative flex flex-col sm:flex-row gap-4",children:[a.jsxs(c.div,{className:"w-full sm:w-1/5 bg-white p-4 rounded-lg h-max shadow-sm",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2},children:[a.jsx("p",{className:"customtext-neutral-dark text-2xl font-bold pb-4 mb-4 border-b",children:"Escoge el regalo y personaliza"}),a.jsxs(c.div,{className:"mb-6",variants:T,children:[a.jsxs(c.button,{onClick:()=>z("categoria"),className:"flex items-center justify-between w-full mb-4",whileHover:{x:3},children:[a.jsx("span",{className:"font-medium",children:"Categorías"}),a.jsx(o,{className:"h-5 w-5 transform transition-transform "+(C.categoria?"":"-rotate-180")})]}),a.jsx(d,{children:C.categoria&&a.jsxs(c.div,{className:"space-y-1",initial:"hidden",animate:"visible",exit:"hidden",variants:{hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto",transition:{staggerChildren:.1}}},children:[a.jsxs(c.div,{className:"relative",variants:T,children:[a.jsx(m,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0 transition-all duration-300",value:K,onChange:e=>q(e.target.value)})]}),U.map((e=>{var t;const s=null==(t=k.category_id)?void 0:t.includes(e.id);return a.jsx(c.div,{className:"group py-2 rounded-md "+(s?"bg-primary brightness-125":"bg-transparent"),variants:T,children:a.jsxs("label",{className:"flex items-center justify-between space-x-3 px-4 cursor-pointer",children:[a.jsx("input",{type:"checkbox",className:"hidden",onChange:()=>F("category_id",e.id),checked:s}),a.jsx("img",{src:`/storage/images/category/${e.image}`,onError:e=>e.target.src="assets/img/noimage/no_imagen_circular.png",alt:e.name,className:"w-8 h-8 rounded-full object-cover order-1",loading:"lazy"}),a.jsx("span",{className:""+(s?"text-white":"text-gray-700"),children:e.name})]})},e.id)}))]})})]}),N.length>0&&a.jsxs(c.div,{className:"mb-6",variants:T,children:[a.jsxs(c.button,{onClick:()=>z("subcategoria"),className:"flex items-center justify-between w-full mb-4",whileHover:{x:3},children:[a.jsx("span",{className:"font-medium",children:"Subcategorías"}),a.jsx(o,{className:"h-5 w-5 transform transition-transform "+(C.subcategoria?"":"-rotate-180")})]}),a.jsx(d,{children:C.subcategoria&&a.jsx(c.div,{className:"space-y-1 pl-8",initial:"hidden",animate:"visible",exit:"hidden",variants:{hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto",transition:{staggerChildren:.1}}},children:N.map((e=>{var t;const s=null==(t=k.subcategory_id)?void 0:t.includes(e.id);return a.jsx(c.div,{className:"group py-2 rounded-md "+(s?"bg-primary/10":"bg-transparent"),variants:T,children:a.jsxs("label",{className:"flex items-center space-x-3 px-4 cursor-pointer",children:[a.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",onChange:()=>F("subcategory_id",e.id),checked:s}),a.jsx("span",{className:""+(s?"font-medium text-primary":"text-gray-600"),children:e.name})]})},e.id)}))})})]}),a.jsxs(c.div,{className:"mb-6",variants:T,children:[a.jsxs(c.button,{onClick:()=>z("precio"),className:"flex items-center justify-between w-full mb-4",whileHover:{x:3},children:[a.jsx("span",{className:"font-medium",children:"Precio"}),a.jsx(o,{className:"h-5 w-5 transform transition-transform "+(C.precio?"":"-rotate-180")})]}),a.jsx(d,{children:C.precio&&a.jsx(c.div,{className:"space-y-3",initial:"hidden",animate:"visible",exit:"hidden",variants:{hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto",transition:{staggerChildren:.1}}},children:w.map((e=>{const t=k.price&&k.price.min===e.min&&k.price.max===e.max;return a.jsxs(c.label,{className:"flex items-center space-x-3 cursor-pointer",variants:T,whileHover:{x:3},children:[a.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",onChange:()=>F("price",e),checked:t}),a.jsx("span",{className:""+(t?"font-medium text-primary":"text-gray-600"),children:`S/ ${e.min} - S/ ${e.max}`})]},`${e.min}-${e.max}`)}))})})]}),a.jsxs(c.div,{className:"mb-6",variants:T,children:[a.jsxs(c.button,{onClick:()=>z("marca"),className:"flex items-center justify-between w-full mb-4",whileHover:{x:3},children:[a.jsx("span",{className:"font-medium",children:"Marcas"}),a.jsx(o,{className:"h-5 w-5 transform transition-transform "+(C.marca?"":"-rotate-180")})]}),a.jsx(d,{children:C.marca&&a.jsxs(c.div,{className:"space-y-1",initial:"hidden",animate:"visible",exit:"hidden",variants:{hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto",transition:{staggerChildren:.1}}},children:[a.jsxs(c.div,{className:"relative",variants:T,children:[a.jsx(m,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0 transition-all duration-300",value:G,onChange:e=>O(e.target.value)})]}),Y.map((e=>{var t;const s=null==(t=k.brand_id)?void 0:t.includes(e.id);return a.jsx(c.div,{className:"group py-2 rounded-md "+(s?"bg-primary/10":"bg-transparent"),variants:T,children:a.jsxs("label",{className:"flex items-center space-x-3 px-4 cursor-pointer",children:[a.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",onChange:()=>F("brand_id",e.id),checked:s}),a.jsx("span",{className:""+(s?"font-medium text-primary":"text-gray-600"),children:e.name})]})},e.id)}))]})})]})]}),a.jsxs(c.div,{className:"w-full sm:w-4/5 py-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[a.jsxs(c.div,{className:"flex flex-col lg:flex-row lg:justify-between items-center mb-4 w-full",variants:T,children:[a.jsxs("div",{className:"flex gap-4 items-center mb-4 lg:mb-0",children:[a.jsx("label",{className:"font-semibold text-sm w-[150px]",children:"Ordenar por"}),a.jsx(n,{options:[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],placeholder:"Recomendados",onChange:e=>{const[a,t]=e.split(":"),s=[{selector:a,desc:"desc"===t}];S((e=>({...e,sort:s})))},labelKey:"label",valueKey:"value",className:"border-primary rounded-full customtext-primary"})]}),a.jsx("div",{className:"customtext-primary font-semibold",children:a.jsxs("div",{className:"flex justify-between items-center w-full",children:[a.jsx("div",{className:"customtext-primary font-semibold",children:a.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[a.jsx(c.button,{className:"p-4 inline-flex items-center "+(1===I.currentPage?"opacity-50 cursor-not-allowed":""),onClick:()=>$(I.currentPage-1),disabled:1===I.currentPage,whileHover:{scale:1.1},whileTap:{scale:.9},children:a.jsx(p,{})}),B().map(((e,s)=>a.jsx(t.Fragment,{children:"..."===e?a.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):a.jsx(c.button,{className:"w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 \n                                                                "+(e===I.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"),onClick:()=>$(e),whileHover:{scale:1.05},whileTap:{scale:.95},children:e})},s))),a.jsx(c.button,{className:"p-4 inline-flex items-center "+(I.currentPage===I.totalPages?"opacity-50 cursor-not-allowed":""),onClick:()=>$(I.currentPage+1),disabled:I.currentPage===I.totalPages,whileHover:{scale:1.1},whileTap:{scale:.9},children:a.jsx(u,{})})]})}),a.jsx("div",{children:a.jsxs("p",{className:"font-semibold",children:[I.from," - ",I.to," de ",I.totalItems," Resultados"]})})]})})]}),L?a.jsx(i,{}):a.jsx(c.div,{className:"flex items-center flex-wrap gap-y-2 lg:gap-y-3 transition-all duration-300 ease-in-out",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"visible",children:Array.isArray(H)&&H.length>0?H.map(((e,t)=>a.jsx(c.div,{custom:t,variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:100,delay:.03*t}}},whileHover:{y:-5},className:"w-full md:w-1/2 lg:w-1/3 px-2",children:a.jsx(l,{product:e,cart:f,setCart:y})},e.id))):a.jsx(r,{})}),a.jsxs(c.div,{className:"flex justify-between items-center mb-4 w-full mt-8",variants:T,children:[a.jsx("div",{className:"customtext-primary font-semibold",children:a.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[a.jsx(c.button,{className:"p-4 inline-flex items-center "+(1===I.currentPage?"opacity-50 cursor-not-allowed":""),onClick:()=>$(I.currentPage-1),disabled:1===I.currentPage,whileHover:{scale:1.1},whileTap:{scale:.9},children:a.jsx(p,{})}),B().map(((e,s)=>a.jsx(t.Fragment,{children:"..."===e?a.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):a.jsx(c.button,{className:"w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 \n                                                        "+(e===I.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"),onClick:()=>$(e),whileHover:{scale:1.05},whileTap:{scale:.95},children:e})},s))),a.jsx(c.button,{className:"p-4 inline-flex items-center "+(I.currentPage===I.totalPages?"opacity-50 cursor-not-allowed":""),onClick:()=>$(I.currentPage+1),disabled:I.currentPage===I.totalPages,whileHover:{scale:1.1},whileTap:{scale:.9},children:a.jsx(u,{})})]})}),a.jsx("div",{children:a.jsxs("p",{className:"font-semibold",children:[I.from," - ",I.to," de ",I.totalItems," Resultados"]})})]})]})]})})})};export{x as default};
