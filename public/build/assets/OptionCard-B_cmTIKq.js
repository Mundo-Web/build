var me=Object.defineProperty;var he=(r,s,t)=>s in r?me(r,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[s]=t;var q=(r,s,t)=>he(r,typeof s!="symbol"?s+"":s,t);import{c as F}from"./createLucideIcon-DfjclApS.js";import{j as a}from"./AboutSimple-Cf8x2fCZ.js";import{r as n}from"./index-BOnQTV8N.js";import{S as y}from"./sparkles-DvmvZ6mJ.js";import{M as ye}from"./CartItemRow-taHZ3DMg.js";import{P as ge}from"./plus-CTIomuuF.js";import{T as be}from"./trash-2-DU7LB6-f.js";import{a as ve}from"./index-t--hEgTQ.js";import{X as je}from"./x-fof_H3Vv.js";import{a as Ne,b as f,h as we,c as _,d as Se,u as _e,S as ke,_ as Oe}from"./useStateManager-7e1e8489.esm-TobOj1LE.js";import"./index-C0Swrixi.js";import{m as O}from"./main-HRI4Q8Xk.js";import"./index-Bq3gMMRU.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=F("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=F("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=F("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Qe=({children:r,className:s="",loading:t=!1,disabled:e=!1,...i})=>a.jsxs("button",{type:"button",disabled:e||t,className:`w-full bg-primary font-bold  py-3 px-4 hover:opacity-90 hover:shadow-md transition-all duration-300 focus:outline-none active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed rounded-xl flex items-center justify-center gap-2 ${s}`,...i,children:[t&&a.jsx(Ce,{className:"w-4 h-4 animate-spin"}),r]}),We=({children:r,className:s="",...t})=>a.jsx("a",{className:`w-full block border-primary cursor-pointer border-2 text-center font-bold customtext-primary py-3 px-4  hover:opacity-90 hover:shadow-md transition-all duration-300 focus:outline-none active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed rounded-xl ${s}`,...t,children:r});function Ae({onClick:r,className:s=""}){return a.jsxs("div",{className:`relative ${s}`,children:[a.jsx(y,{size:12,className:"absolute -top-1 -left-1 text-yellow-400 animate-ping",style:{animationDelay:"0s"}}),a.jsx(y,{size:10,className:"absolute -top-2 -right-1 text-pink-400 animate-ping",style:{animationDelay:"0.5s"}}),a.jsx(y,{size:8,className:"absolute -bottom-1 -left-2 text-blue-400 animate-ping",style:{animationDelay:"1s"}}),a.jsx(y,{size:14,className:"absolute -bottom-2 -right-2 text-purple-400 animate-ping",style:{animationDelay:"1.5s"}}),a.jsxs("button",{onClick:r,className:"relative group bg-primary p-2 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 animate-bounce cursor-pointer",style:{animationDuration:"2s",animationIterationCount:"infinite"},children:[a.jsx("div",{className:"absolute inset-0 bg-primary rounded-xl opacity-0 group-hover:opacity-50 transition-opacity duration-300 blur-lg"}),a.jsx(k,{size:24,className:"text-white relative z-10 drop-shadow-sm"}),a.jsx("div",{className:"absolute inset-0 bg-primary rounded-xl animate-pulse opacity-30"})]}),a.jsx("div",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-20",children:"Â¡PromociÃ³n disponible!"})]})}const Xe=({setCart:r,hasPromotion:s,onPromotionClick:t,...e})=>{var l,p,g,N;const i=()=>{r(x=>x.filter(c=>c.id!==(e==null?void 0:e.id)))},o=()=>{r(x=>x.map(c=>c.id===(e==null?void 0:e.id)?{...c,quantity:(c.quantity||1)+1}:c))},u=()=>{r(x=>x.map(c=>{if(c.id===(e==null?void 0:e.id)){const m=(c.quantity||1)-1;return m<=0?(i(e==null?void 0:e.id),null):{...c,quantity:m}}return c}).filter(Boolean))};return a.jsx("div",{className:"w-full bg-white rounded-lg shadow p-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center  justify-between gap-4 w-full",children:[a.jsxs("div",{className:"flex items-center gap-4 flex-grow",children:[a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:`/storage/images/item/${e==null?void 0:e.image}`,alt:e==null?void 0:e.name,className:"w-20 h-20 object-cover rounded flex-shrink-0",onError:x=>x.target.src="/api/cover/thumbnail/null"}),s&&a.jsx("div",{className:"absolute -top-2 -right-2",children:a.jsx(Ae,{onClick:()=>t(e),className:"group"})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-medium text-lg mb-2 line-clamp-2",children:e==null?void 0:e.name}),a.jsxs("p",{className:"text-sm customtext-neutral-dark",children:[(l=e==null?void 0:e.brand)!=null&&l.name?"Marca: ":"CategorÃ­a: ",a.jsx("span",{className:"customtext-neutral-dark",children:(p=e==null?void 0:e.brand)!=null&&p.name?(g=e==null?void 0:e.brand)==null?void 0:g.name:(N=e==null?void 0:e.category)==null?void 0:N.name})]}),a.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Disponibilidad: ",a.jsxs("span",{className:"customtext-neutral-dark",children:[(e==null?void 0:e.stock)>=(e==null?void 0:e.quantity)?"En stock":"Agotado"," "]})]}),a.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["SKU: ",a.jsx("span",{className:"customtext-neutral-dark",children:e==null?void 0:e.sku})]})]})]}),a.jsxs("div",{className:"flex flex-row justify-between md:flex-col items-end md:items-end gap-4 mt-4 md:mt-0 flex-shrink-0",children:[a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-xs text-gray-500 line-through",children:["S/ ",Number((e==null?void 0:e.price)*(e==null?void 0:e.quantity)).toFixed(2)]}),a.jsxs("div",{className:"font-bold text-lg",children:["S/ ",Number((e==null?void 0:e.final_price)*(e==null?void 0:e.quantity)).toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"flex items-center border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[a.jsx("button",{type:"button",onClick:u,className:"p-2 text-gray-600 hover:bg-gray-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Decrease quantity",children:a.jsx(ye,{size:16})}),a.jsx("div",{className:"w-12 h-8 flex justify-center items-center bg-white",children:a.jsx("span",{className:"font-semibold text-sm",children:(e==null?void 0:e.quantity)||1})}),a.jsx("button",{type:"button",onClick:o,className:"p-2 text-gray-600 hover:bg-gray-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Increase quantity",children:a.jsx(ge,{size:16})})]}),a.jsx("button",{onClick:i,className:"p-2 text-gray-400 hover:text-red-500 transition-colors duration-200 rounded-full hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-200","aria-label":"Remove item",children:a.jsx(be,{size:18})})]})]})]})},e==null?void 0:e.id)},Ee="/api";class Ye{static async applyToCart(s,t,e=null){var i;try{if(console.log("ðŸ›’ Applying discount rules to cart:",{cartItems:s,totalAmount:t,customerEmail:e}),!Array.isArray(s)||s.length===0)return{success:!1,error:"Carrito vacÃ­o o invÃ¡lido",data:null};const o={cart_items:s.map(l=>{const p={item_id:String(l.item_id||l.id||""),quantity:parseInt(l.quantity)||1,price:parseFloat(l.price||l.final_price||0),name:String(l.name||l.description||"Producto sin nombre"),category_id:l.category_id?String(l.category_id):null};return console.log("ðŸ“¦ Processing cart item:",p),p}),total_amount:parseFloat(t)||0,customer_email:e||null};console.log("ðŸ“¤ Sending payload to API:",o);const u=await ve.post(`${Ee}/discount-rules/apply-to-cart`,o);return u.data.status===200?{success:!0,data:u.data.data,message:u.data.message}:{success:!1,error:u.data.message||"Error al aplicar descuentos",data:null}}catch(o){return console.error("Error applying discount rules:",o),(i=o.response)!=null&&i.data?{success:!1,error:o.response.data.message||"Error del servidor",data:o.response.data.data||null}:{success:!1,error:"Error de conexiÃ³n",data:null}}}static formatDiscounts(s){return!s||!Array.isArray(s)?[]:s.map(t=>({id:t.rule_id,name:t.rule_name||"Descuento automÃ¡tico",description:t.description||"",amount:parseFloat(t.discount_amount||0),type:t.discount_type||"fixed",promotion_type:t.promotion_type||null,free_items:t.free_items||[],formatted_amount:t.discount_type==="percentage"?`${t.discount_amount}%`:`S/ ${parseFloat(t.discount_amount||0).toFixed(2)}`}))}static getFreeItems(s){if(!s||!Array.isArray(s))return[];const t=[];return s.forEach(e=>{e.free_items&&Array.isArray(e.free_items)&&t.push(...e.free_items)}),t}static calculateTotalDiscount(s){return!s||!Array.isArray(s)?0:s.reduce((t,e)=>t+parseFloat(e.discount_amount||0),0)}}function Ze({isOpen:r,onClose:s,suggestion:t,onAddToCart:e,productName:i}){const[o,u]=n.useState(!1);if(!r||!t)return null;const l=async()=>{u(!0);try{console.log("Modal - suggestion data:",t),await e(t),s()}catch(p){console.error("Error adding promotional item:",p)}finally{u(!1)}};return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity duration-300",onClick:s}),a.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:a.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-md w-full mx-auto transform transition-all duration-300 scale-100",children:[a.jsx("button",{onClick:s,className:"absolute top-4 right-4 p-2 text-gray-400 hover:text-gray-600 transition-colors rounded-full hover:bg-gray-100",children:a.jsx(je,{size:20})}),a.jsxs("div",{className:"text-center pt-8 pb-6 px-6",children:[a.jsxs("div",{className:"relative inline-block mb-4",children:[a.jsx("div",{className:"animate-bounce",children:a.jsx(k,{size:48,className:"customtext-primary mx-auto"})}),a.jsx(y,{size:20,className:"absolute -top-2 -right-2 text-yellow-400 animate-pulse"}),a.jsx(y,{size:16,className:"absolute -bottom-1 -left-2 text-yellow-400 animate-pulse delay-300"})]}),a.jsx("h2",{className:"text-2xl font-bold customtext-neutral-dark mb-2",children:"ðŸŽ‰ Â¡PromociÃ³n Especial!"}),a.jsx("p",{className:"text-gray-600",children:"Tienes un producto que califica para una promociÃ³n"})]}),a.jsxs("div",{className:"px-6 pb-6",children:[a.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-4 mb-6",children:a.jsxs("div",{className:"text-center",children:[a.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Al tener  ",a.jsxs("span",{className:"font-semibold customtext-primary",children:[t.current_quantity," ",i]})," en tu carrito"]}),a.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[a.jsx("p",{className:"font-bold text-lg customtext-primary mb-1",children:t.rule_name}),a.jsx("p",{className:"text-sm customtext-neutral-light",children:t.description||"ObtÃ©n un producto gratis"})]})]})}),a.jsx("div",{className:"border-2 border-dashed rounded-xl p-4 mb-6 bg-green-50",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3 w-9/12",children:[a.jsx("div",{className:"w-12 h-12  rounded-full flex items-center justify-center",children:a.jsx(k,{className:"customtext-primary",size:24})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold customtext-neutral-dark",children:t.item_name}),a.jsxs("p",{className:"text-sm customtext-primary",children:["Cantidad: ",t.suggested_quantity]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-lg font-bold customtext-primary",children:"Â¡GRATIS!"}),a.jsxs("p",{className:"text-xs text-gray-500 line-through",children:["S/ ",Number(t.value||0).toFixed(2)]})]})]})}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("button",{onClick:l,disabled:o,className:"w-full bg-primary text-white font-semibold py-3 px-6 rounded-xl hover:from-green-600 hover:to-green-700 transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:transform-none shadow-lg",children:o?a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a.jsx("span",{children:"Agregando..."})]}):a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx(k,{size:20}),a.jsx("span",{children:"Â¡Agregar Regalo!"})]})}),a.jsx("button",{onClick:s,className:"w-full bg-gray-100 customtext-neutral-light font-medium py-3 px-6 rounded-xl hover:bg-gray-200 transition-colors duration-200",children:"Tal vez despuÃ©s"})]}),a.jsx("p",{className:"text-xs text-gray-500 text-center mt-4",children:"* PromociÃ³n vÃ¡lida mientras tengas los productos requeridos en tu carrito"})]})]})})]})}var Ie=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"];function Pe(r){var s=r.defaultOptions,t=s===void 0?!1:s,e=r.cacheOptions,i=e===void 0?!1:e,o=r.loadOptions;r.options;var u=r.isLoading,l=u===void 0?!1:u,p=r.onInputChange,g=r.filterOption,N=g===void 0?null:g,x=Ne(r,Ie),c=x.inputValue,m=n.useRef(void 0),w=n.useRef(!1),Q=n.useState(Array.isArray(t)?t:void 0),L=f(Q,2),W=L[0],M=L[1],X=n.useState(typeof c<"u"?c:""),T=f(X,2),$=T[0],C=T[1],Y=n.useState(t===!0),R=f(Y,2),Z=R[0],b=R[1],ee=n.useState(void 0),D=f(ee,2),A=D[0],E=D[1],ae=n.useState([]),V=f(ae,2),te=V[0],I=V[1],se=n.useState(!1),B=f(se,2),re=B[0],S=B[1],ne=n.useState({}),G=f(ne,2),v=G[0],J=G[1],oe=n.useState(void 0),U=f(oe,2),le=U[0],ie=U[1],ce=n.useState(void 0),H=f(ce,2),de=H[0],ue=H[1];i!==de&&(J({}),ue(i)),t!==le&&(M(Array.isArray(t)?t:void 0),ie(t)),n.useEffect(function(){return w.current=!0,function(){w.current=!1}},[]);var P=n.useCallback(function(j,h){if(!o)return h();var d=o(j,h);d&&typeof d.then=="function"&&d.then(h,function(){return h()})},[o]);n.useEffect(function(){t===!0&&P($,function(j){w.current&&(M(j||[]),b(!!m.current))})},[]);var pe=n.useCallback(function(j,h){var d=we(j,h,p);if(!d){m.current=void 0,C(""),E(""),I([]),b(!1),S(!1);return}if(i&&v[d])C(d),E(d),I(v[d]),b(!1),S(!1);else{var fe=m.current={};C(d),b(!0),S(!A),P(d,function(z){w&&fe===m.current&&(m.current=void 0,b(!1),E(d),I(z||[]),S(!1),J(z?_(_({},v),{},Se({},d,z)):v))})}},[i,P,A,v,p]),xe=re?[]:$&&A?te:W||[];return _(_({},x),{},{options:xe,isLoading:Z||l,onInputChange:pe,filterOption:N})}var ze=n.forwardRef(function(r,s){var t=Pe(r),e=_e(t);return n.createElement(ke,Oe({ref:s},e))}),ea=ze;class K{}q(K,"getShippingCost",async s=>{try{const{status:t,result:e}=await O.Fetch("./api/delivery-prices",{method:"POST",body:JSON.stringify(s)});if(!t)throw new Error((e==null?void 0:e.message)||"Error al obtener datos");return e}catch{return!1}}),q(K,"getCosts",async s=>{try{const{status:t,result:e}=await O.Fetch("./api/prices-type",{method:"POST"});if(!t)throw new Error((e==null?void 0:e.message)||"Error al obtener datos");return e}catch{return!1}});class aa{static async validateCoupon(s){try{const{status:t,result:e}=await O.Fetch("./api/coupons/validate",{method:"POST",body:JSON.stringify(s)});if(!t)throw new Error((e==null?void 0:e.message)||"Error al validar cupÃ³n");return e}catch(t){throw t}}static async generateCode(){try{const{status:s,result:t}=await O.Fetch("./api/coupons/generate-code",{method:"GET"});if(!s)throw new Error((t==null?void 0:t.message)||"Error al generar cÃ³digo");return t}catch(s){throw s}}}const ta=({title:r,description:s,selected:t,onSelect:e,disabled:i})=>a.jsxs("div",{className:`flex w-full items-center gap-3 p-4 border rounded-xl cursor-pointer transition-all duration-300 customtext-neutral-dark 
                }`,onClick:e,children:[a.jsx("div",{className:`w-5 h-5 border-2 rounded-full flex items-center justify-center ${t?"border-primary":""}`,children:t&&a.jsx("div",{className:"w-3 h-3 bg-primary rounded-full"})}),a.jsxs("div",{className:"customtext-neutral-light",children:[a.jsx("h4",{className:"text-sm ",children:r}),a.jsx("p",{className:"text-xs",children:s})]})]});export{ea as A,Qe as B,Xe as C,Ye as D,Ke as I,ta as O,Ze as P,We as a,K as b,aa as c};
