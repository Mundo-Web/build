var e=Object.defineProperty,a=(a,s,t)=>((a,s,t)=>s in a?e(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t)(a,"symbol"!=typeof s?s+"":s,t);import{c as s,j as t,r as i}from"./vendor-react-DD0uBW7s.js";import{B as r}from"./Base-DQk4WKCZ.js";import{C as n}from"./CreateReactScript-C92mMLGn.js";import{T as l}from"./Table-CUZG9nUs.js";import{I as c}from"./InputFormGroup-DY-ZEW8l.js";import{R as d}from"./ReactAppend-D5wf6JB3.js";import{D as o}from"./DxButton-C6FT_beP.js";import{S as m}from"./SwitchFormGroup-Dk6WRclX.js";import{I as p}from"./ImageFormGroup-DBShHzxF.js";import{S as u}from"./CartKuchara-BG_NtHiU.js";import{B as x}from"./BasicRest-BuuGWTMX.js";import{T as f}from"./TextareaFormGroup-4KXpt4Nc.js";import{M as h}from"./Modal-CfnJHMl_.js";import"./vendor-swiper-BQwfPLwm.js";import"./Global-BAGAPG-V.js";import"./TippyButton-BXJTBPrK.js";import"./Logout-CJj-4dQc.js";import"./MenuItemContainer--0h9gV_W.js";import"./Menu-Cmvatiox.js";import"./General-ClVW7qxN.js";import"./LaravelSession-ByQnaUD3.js";import"./BooleanLimit-q2Ad9fGY.js";import"./GoogleSignInButton-BciphYP2.js";const j=new class extends x{constructor(){super(...arguments),a(this,"path","admin/ads"),a(this,"hasFiles",!0)}},v=({})=>{const e=i.useRef(),a=i.useRef(),s=i.useRef(),r=i.useRef(),n=i.useRef(),x=i.useRef(),v=i.useRef(),b=i.useRef(),g=i.useRef(),N=i.useRef(),w=i.useRef(),y=i.useRef(),[R,k]=i.useState(!1),D=e=>{k(!!e?.id),x.resetDeleteFlag&&x.resetDeleteFlag(),s.current.value=e?.id??"",r.current.value=e?.name??"",n.current.value=e?.description??"",x.image.src=`/api/ads/media/${e?.image}`,x.current.value=null,v.current.value=e?.date_begin??"",b.current.value=e?.date_end??"",g.current.value=e?.seconds??0,N.current.value=e?.link??"",w.current.value=e?.button_text??"Ver más",e?.invasivo?$(y.current).prop("checked",!1).trigger("click"):$(y.current).prop("checked",!0).trigger("click"),$(a.current).modal("show")};return t.jsxs(t.Fragment,{children:[t.jsx(l,{gridRef:e,title:"Anuncios",rest:j,toolBar:a=>{a.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(e.current).dxDataGrid("instance").refresh()}}),a.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo anuncio",hint:"Nuevo anuncio",onClick:()=>D()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"image",caption:"Imagen",width:"90px",allowFiltering:!1,cellTemplate:(e,{data:a})=>{d(e,t.jsx("div",{className:"d-flex align-items-center justify-content-center",children:t.jsx("img",{src:`/api/ads/media/${a.image}`,style:{width:"80px",height:"80px",objectFit:"cover",objectPosition:"center"}})}))}},{dataField:"name",caption:"Contenido",width:"35%",cellTemplate:(e,{data:a})=>{d(e,a.name||a.description?t.jsxs("div",{style:{width:"100%"},children:[t.jsx("p",{className:"mb-1 font-weight-bold",style:{fontSize:"14px"},children:a.name}),t.jsx("p",{className:"mb-0 text-muted",style:{overflow:"hidden",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,fontSize:"12px",lineHeight:"1.4"},children:a.description})]}):t.jsx("span",{className:"text-muted font-italic",children:"- Sin contenido -"}))}},{dataField:"date_begin",caption:"Configuración",width:"25%",cellTemplate:(e,{data:a})=>{d(e,t.jsxs("div",{className:"small",children:[t.jsxs("div",{className:"d-flex align-items-center mb-1",children:[t.jsx("i",{className:"fas fa-calendar-alt text-primary mr-2",style:{width:"14px"}}),a.date_begin&&a.date_end?t.jsxs("span",{children:[moment(a.date_begin).format("DD/MM")," - ",moment(a.date_end).format("DD/MM/YY")]}):t.jsx("span",{className:"text-success",children:"Siempre visible"})]}),t.jsxs("div",{className:"d-flex align-items-center mb-1",children:[t.jsx("i",{className:"fas fa-clock text-info mr-2",style:{width:"14px"}}),t.jsx("span",{children:a.seconds>0?`${a.seconds}s de delay`:"Sin delay"})]}),t.jsxs("div",{className:"d-flex align-items-center",children:[t.jsx("i",{className:`fas fa-${a.invasivo?"exclamation-triangle text-warning":"check-circle text-success"} mr-2`,style:{width:"14px"}}),t.jsx("span",{children:a.invasivo?"Invasivo":"Normal"})]})]}))}},{dataField:"link",caption:"Enlace",cellTemplate:(e,{data:a})=>{d(e,a.link?t.jsxs("div",{children:[t.jsxs("a",{href:a.link,target:"_blank",rel:"noopener noreferrer",className:"text-primary d-block text-truncate",style:{maxWidth:"200px"},children:[t.jsx("i",{className:"fas fa-external-link-alt mr-1"}),a.link]}),a.button_text&&t.jsxs("small",{className:"text-muted",children:[t.jsx("i",{className:"fas fa-mouse-pointer mr-1"}),'"',a.button_text,'"']})]}):t.jsx("span",{className:"text-muted font-italic",children:"- Sin enlace -"}))}},{dataField:"visible",caption:"Visible",dataType:"boolean",width:"90px",alignment:"center",cellTemplate:(a,{data:s})=>{d(a,t.jsx(m,{checked:s.visible,onChange:a=>(async({id:a,value:s})=>{await j.boolean({id:a,field:"visible",value:s})&&$(e.current).dxDataGrid("instance").refresh()})({id:s.id,value:a.target.checked})}))}},{caption:"Acciones",width:"100px",alignment:"center",cellTemplate:(a,{data:s})=>{a.css("text-overflow","unset"),a.append(o({className:"btn btn-xs btn-soft-primary mr-1",title:"Editar",icon:"fa fa-pen",onClick:()=>D(s)})),a.append(o({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>(async a=>{const{isConfirmed:s}=await u.fire({title:"Eliminar anuncio",text:"¿Estás seguro de eliminar este anuncio?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});if(!s)return;await j.delete(a)&&$(e.current).dxDataGrid("instance").refresh()})(s.id)}))},allowFiltering:!1,allowExporting:!1}]}),t.jsx(h,{modalRef:a,title:R?"Editar anuncio":"Nuevo anuncio",onSubmit:async t=>{t.preventDefault();const i={id:s.current.value||void 0,name:r.current.value,description:n.current.value,date_begin:v.current.value,date_end:b.current.value,seconds:g.current.value||0,link:N.current.value,button_text:w.current.value||"Ver más",invasivo:y.current.checked?1:0},l=new FormData;for(const e in i)l.append(e,i[e]);const c=x.current.files[0];c&&l.append("image",c),x.getDeleteFlag&&x.getDeleteFlag()&&l.append("image_delete","DELETE");await j.save(l)&&(x.resetDeleteFlag&&x.resetDeleteFlag(),$(e.current).dxDataGrid("instance").refresh(),$(a.current).modal("hide"))},size:"lg",children:t.jsxs("div",{className:"row",id:"principal-container",children:[t.jsx("input",{ref:s,type:"hidden"}),t.jsxs("div",{className:"col-md-5",children:[t.jsx(p,{eRef:x,name:"image",label:"Imagen del anuncio",col:"col-12",aspect:1,fit:"cover",required:!0}),t.jsxs("div",{className:"alert alert-light border small mt-2",children:[t.jsx("i",{className:"fas fa-info-circle text-info mr-1"}),"Tamaño recomendado: 800x800px (1:1)"]})]}),t.jsxs("div",{className:"col-md-7",children:[t.jsxs("div",{className:"card border-0 shadow-sm mb-3",children:[t.jsx("div",{className:"card-header bg-light py-2",children:t.jsxs("h6",{className:"mb-0",children:[t.jsx("i",{className:"fas fa-align-left mr-2"}),"Contenido"]})}),t.jsxs("div",{className:"card-body py-3",children:[t.jsx(c,{eRef:r,label:"Título",placeholder:"Ej: ¡Gran Oferta!"}),t.jsx(f,{eRef:n,label:"Descripción",rows:3,placeholder:"Descripción del anuncio..."})]})]}),t.jsxs("div",{className:"card border-0 shadow-sm mb-3",children:[t.jsx("div",{className:"card-header bg-light py-2",children:t.jsxs("h6",{className:"mb-0",children:[t.jsx("i",{className:"fas fa-link mr-2"}),"Enlace"]})}),t.jsx("div",{className:"card-body py-3",children:t.jsxs("div",{className:"row",children:[t.jsx("div",{className:"col-md-7",children:t.jsx(c,{eRef:N,label:"URL de destino",placeholder:"https://ejemplo.com/oferta"})}),t.jsx("div",{className:"col-md-5",children:t.jsx(c,{eRef:w,label:"Texto del botón",placeholder:"Ver más"})})]})})]}),t.jsxs("div",{className:"card border-0 shadow-sm",children:[t.jsx("div",{className:"card-header bg-light py-2",children:t.jsxs("h6",{className:"mb-0",children:[t.jsx("i",{className:"fas fa-cog mr-2"}),"Configuración"]})}),t.jsxs("div",{className:"card-body py-3",children:[t.jsxs("div",{className:"row",children:[t.jsx("div",{className:"col-md-6",children:t.jsx(c,{eRef:v,label:"Mostrar desde",type:"date"})}),t.jsx("div",{className:"col-md-6",children:t.jsx(c,{eRef:b,label:"Mostrar hasta",type:"date"})})]}),t.jsx(c,{eRef:g,label:"Delay de aparición (segundos)",type:"number",col:"col-12",placeholder:"0 = aparece inmediatamente"}),t.jsx("div",{className:"mt-2",children:t.jsx(m,{eRef:y,label:"Anuncio invasivo",specification:"No se puede cerrar haciendo clic fuera del modal"})})]})]})]})]})})]})};n((e,a)=>{s.createRoot(e).render(t.jsx(r,{...a,title:"Pop-ups",children:t.jsx(v,{...a})}))});
