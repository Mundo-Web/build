var e,a=Object.defineProperty;import{m as t,c as r,j as s,r as o,i}from"./vendor-react-CWR92fp6.js";import"./TippyButton-BozxD_uD.js";import{C as n}from"./CreateReactScript-DEkx_UD4.js";import{I as c}from"./InputFormGroup-nxjFOPEg.js";import{B as l}from"./Base-CaFGfdNS.js";import"./vendor-swiper-T7yreVnW.js";import"./Global-BAGAPG-V.js";import"./General-ClVW7qxN.js";import"./LaravelSession-ByQnaUD3.js";import"./Menu-BoHY91ba.js";import"./BooleanLimit-q2Ad9fGY.js";import"./Logout-CvukixAi.js";import"./MenuItemContainer-CUP12Xrd.js";class m{}((e,t,r)=>{t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(m,"symbol"!=typeof(e="save")?e+"":e,async e=>{try{const{status:a,result:r}=await t.Fetch("/api/profile",{method:"PATCH",body:JSON.stringify(e)});if(!a)throw new Error(r?.message||"Ocurrio un error inesperado");return t.Notify.add({icon:"/assets/img/icon.svg",title:"Correcto",body:r.message,type:"success"}),!0}catch(a){return t.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:a.message,type:"danger"}),!1}});const d=e=>{const a=o.useRef(),r=o.useRef(),[n,l]=o.useState(e.session);return s.jsx("div",{className:"row justify-content-center align-items-center",style:{height:"calc(100vh - 135px)"},children:s.jsx("div",{className:"col-xl-3 col-lg-4 col-md-6 col-sm-8 col-xs-12",children:s.jsxs("form",{className:"card",onSubmit:async e=>{e.preventDefault();const t={name:a.current.value,lastname:r.current.value};if(!(await m.save(t)))return;const s=structuredClone(n);s.name=t.name,s.lastname=t.lastname,s.birthdate=t.birthdate,l(s),setTimeout(()=>{window.location.reload()},1e3)},children:[s.jsx("div",{className:"card-header",children:s.jsx("h4",{className:"card-title mb-0",children:"Perfil"})}),s.jsxs("div",{className:"card-body",children:[s.jsx(i,{content:"Cambiar foto de perfil",arrow:!0,children:s.jsxs("label",{htmlFor:"avatar",className:"rounded-circle mx-auto d-block",style:{cursor:"pointer",width:"max-content"},children:[s.jsx("input",{className:"d-none",type:"file",name:"avatar",id:"avatar",accept:"image/*",onChange:async e=>{const a=e.target.files[0];if(a)try{const{full:e,thumbnail:r,type:s,ok:o}=await File.compress(a);if(!o)throw new Error("Ocurrio un error al comprimir la imagen. Intenta con otra.");const i=new FormData;i.append("thumbnail",await File.fromURL(`data:${s};base64,${r}`)),i.append("full",await File.fromURL(`data:${s};base64,${e}`));const c=await fetch("/api/profile",{method:"POST",headers:{"X-Xsrf-Token":decodeURIComponent(t.Cookies.get("XSRF-TOKEN"))},body:i}),m=t.JSON.parseable(await c.text());if(!c.ok)throw new Error(m?.message??"Ocurrio un error inesperado");const d=structuredClone(n);d.uuid=m.data.uuid,l(d),t.Notify.add({icon:"/assets/img/icon.svg",title:"Correcto",body:"La imagen de perfil se actualizo correctamente",type:"success"}),setTimeout(()=>{window.location.reload()},1500)}catch(r){t.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:r.message,type:"danger"})}}}),s.jsx("img",{className:"avatar-xl rounded-circle",src:`/api/profile/${n.uuid}`,alt:`Perfil de ${n.name} ${n.lastname}`,style:{objectFit:"cover",objectPosition:"center"},onError:e=>e.target.src="/api/cover/thumbnail/null"})]})}),s.jsx("hr",{className:"mt-3 mb-2"}),s.jsx(c,{eRef:a,label:"Nombres",value:n.name,required:!0}),s.jsx(c,{eRef:r,label:"Apellidos",value:n.lastname,required:!0}),s.jsx("div",{className:"text-center",children:s.jsxs("button",{className:"btn btn-primary btn-block",type:"submit",children:[s.jsx("i",{className:"fa fa-save"})," Actualizar"]})}),s.jsx("hr",{className:"mt-3 mb-2"}),s.jsx("p",{className:"card-text text-center",children:s.jsxs("small",{className:"text-muted",children:["Ultima actualizacion"," ",moment(n.updated_at).fromNow()]})})]})]})})})};n((e,a)=>{r.createRoot(e).render(s.jsx(l,{...a,title:"Perfil de usuario",children:s.jsx(d,{...a})}))});
