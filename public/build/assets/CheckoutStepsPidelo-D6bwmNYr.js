import{r as e,j as t,i as s,c2 as a,c3 as i,by as r,bz as n,c4 as o,f as l,X as c}from"./vendor-react-CIhVE-fi.js";import{C as d,N as m}from"./Number2Currency-BX4epFEo.js";import{B as u,p,C as x}from"./culqiPayment-BMG5IXhT.js";import{D as h,B as f,P as g,a as b,O as j,S as v}from"./StorePickupSelector-CBPoxADU.js";import{C as y}from"./CardItem-DAURfJTo.js";import{t as N}from"./OpenPayCardModal-K84_M_7u.js";import{G as w}from"./Footer-hpJm2-lL.js";import{l as _}from"./ShippingStep-BKnmUQIh.js";import{I as C}from"./InputForm-B2kWx2lq.js";import{S as k}from"./SelectForm-C3zOV1L3.js";import{m as T}from"./vendor-motion-iF4wNZTr.js";import"./ProductDetailB-3k-URiSY.js";import"./CartKuchara-Dxib2Hfv.js";import"./TippyButton-Cw7YfGyL.js";import"./vendor-swiper-Cr_RrIb_.js";import{H as S}from"./HtmlContent-C_NL2quq.js";import{u as D}from"./useEcommerceTracking-HDcqBbLz.js";import"./General-ClVW7qxN.js";import"./StoresRest-r6aViFPL.js";import"./BasicRest-CNjqr-ae.js";import"./BooleanLimit-q2Ad9fGY.js";import"./CartModal-DEGaGNoe.js";import"./CartItemRow-COcyJucy.js";import"./ItemsRest-3tin5YGG.js";function E({data:a,cart:i,setCart:r,onContinue:n,subTotal:o,envio:l,igv:c,fleteTotal:p,seguroImportacionTotal:x,derechoArancelarioTotal:b,totalFinal:j,openModal:v,categorias:N,automaticDiscounts:w,setAutomaticDiscounts:_,automaticDiscountTotal:C,setAutomaticDiscountTotal:k,totalWithoutDiscounts:T,generals:S,valorCIF:D,advDisplay:E,ipmDisplay:F,subTotalConDescuentos:I}){const[L,q]=e.useState(w||[]),[P,A]=e.useState(C||0),[M,$]=e.useState(!1),[B,U]=e.useState([]),[R,H]=e.useState([]),[O,z]=e.useState(!1),[Q,V]=e.useState(null),[W,K]=e.useState(null),G=0===i.length;e.useEffect(()=>{if(i.filter(e=>"combo"===e.type),i.length>0&&o>0)Y();else{const e=[],t=0;q(e),A(t),U([]),H([]),_&&_(e),k&&k(t)}},[i,o]);const Y=async()=>{$(!0);try{i.reduce((e,t)=>e+(t.quantity||0),0),i.filter(e=>"combo"===e.type);const e=await h.applyToCart(i,T);if(e.success&&e.data){const t=h.formatDiscounts(e.data.applied_discounts),s=e.data.total_discount||0,a=h.getFreeItems(e.data.applied_discounts),i=[];e.data.applied_discounts.forEach(e=>{e.suggested_items&&Array.isArray(e.suggested_items)&&i.push(...e.suggested_items)}),q(t),A(s),U(a),H(i),_&&_(t),k&&k(s)}else{const e=[],t=0;q(e),A(t),U([]),H([]),_&&_(e),k&&k(t)}}catch(e){const t=[],s=0;q(t),A(s),U([]),H([]),_&&_(t),k&&k(s)}finally{$(!1)}},J=e=>{const t=(s=e.id,R.find(e=>e.item_id===s||e.triggering_item_id===s));var s;t&&(V(t),K(e),z(!0))};return t.jsxs("div",{className:"grid lg:grid-cols-5 gap-4 md:gap-8",children:[t.jsx("div",{className:"lg:col-span-3 space-y-4 md:space-y-6",children:G?t.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center animate-fade-in",children:[t.jsx("svg",{className:"w-24 h-24 text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),t.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"Tu carrito estÃ¡ vacÃ­o"}),t.jsx("p",{className:"text-gray-500",children:"Â¡Explora nuestros productos y encuentra algo especial!"})]}):i.map((e,s)=>{return t.jsx(y,{...e,setCart:r,categorias:N,hasPromotion:(a=e.id,R.some(e=>e.item_id===a||e.triggering_item_id===a)),onPromotionClick:J},s);var a})}),t.jsxs("div",{className:"lg:col-span-2 bg-[#F7F9FB] rounded-xl shadow-lg p-4 md:p-6 h-max mt-4 md:mt-0",children:[t.jsx("h3",{className:"text-xl md:text-2xl font-bold pb-4 md:pb-6",children:"Resumen"}),t.jsxs("div",{className:"space-y-3 md:space-y-4",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),t.jsxs("span",{className:"font-semibold",children:[d(),m(o)]})]}),P>0&&t.jsxs("div",{className:"flex justify-between text-green-600",children:[t.jsx("span",{className:"customtext-neutral-dark",children:"Descuentos aplicados"}),t.jsxs("span",{className:"font-semibold",children:["-",d(),m(P)]})]}),P>0&&t.jsxs("div",{className:"flex justify-between border-t pt-2",children:[t.jsx("span",{className:"customtext-neutral-dark font-semibold",children:"Subtotal con descuentos"}),t.jsxs("span",{className:"font-semibold",children:[d(),m(I||o-P)]})]}),o>200&&x>0&&Number(S?.find(e=>"importation_seguro"===e.correlative)?.description)>0&&t.jsxs("div",{hidden:!0,className:"flex justify-between !hidden",children:[t.jsxs("span",{className:"customtext-neutral-dark",children:["Seguro (",Number(S?.find(e=>"importation_seguro"===e.correlative)?.description||0).toFixed(2),"%)"]}),t.jsxs("span",{className:"font-semibold",children:[d(),m(x)]})]}),o>200&&b>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"customtext-neutral-dark",children:["Impuestos PerÃº (",S?.find(e=>"importation_derecho_arancelario"===e.correlative)?.description,"%)",S?.find(e=>"importation_derecho_arancelario_descripcion"===e.correlative)?.description&&t.jsx(s,{content:t.jsx("p",{className:"whitespace-pre-line",children:S?.find(e=>"importation_derecho_arancelario_descripcion"===e.correlative)?.description}),allowHTML:!0,children:t.jsx("i",{className:"mdi mdi-information ms-1"})})]}),t.jsxs("span",{className:"font-semibold",children:[d(),m(b)]})]}),p>0&&t.jsxs("div",{className:"flex justify-between ",children:[t.jsxs("span",{className:"customtext-neutral-dark",children:["Flete de Envio Internacional",S?.find(e=>"importation_flete_descripcion"===e.correlative)?.description&&t.jsx(s,{content:t.jsx("p",{className:"whitespace-pre-line",children:S?.find(e=>"importation_flete_descripcion"===e.correlative)?.description}),allowHTML:!0,children:t.jsx("i",{className:"mdi mdi-information ms-1"})})]}),t.jsxs("span",{className:"font-semibold",children:[d(),m(p)]})]}),M&&t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"customtext-neutral-dark",children:"Verificando descuentos..."}),t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"})]}),t.jsxs("div",{className:"py-3 border-y-2 mt-4 md:mt-6",children:[t.jsxs("div",{className:"flex justify-between font-bold text-lg md:text-[20px] items-center",children:[t.jsxs("span",{children:["Total",S?.find(e=>"total_descripcion"===e.correlative)?.description&&t.jsx(s,{content:t.jsx("p",{className:"whitespace-pre-line",children:S?.find(e=>"total_descripcion"===e.correlative)?.description}),allowHTML:!0,children:t.jsx("i",{className:"mdi mdi-information ms-1"})})]}),t.jsxs("span",{children:[d(),m(j)]})]}),P>0&&t.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[t.jsxs("span",{className:"line-through",children:[d(),m(T||j+P)]}),t.jsxs("span",{className:"ml-2 customtext-neutral-dark font-semibold",children:["Ahorras ",d(),m(P)]})]})]}),t.jsxs("div",{className:"space-y-2 pt-3 md:pt-4",children:[t.jsx(u,{onClick:n,disabled:G,className:`w-full ${a?.class_button||"text-white"}`,children:G?"Carrito VacÃ­o":"Continuar Compra"}),t.jsx(f,{href:"/",className:"w-full",children:G?"Ir a Comprar":"Cancelar"})]}),t.jsx("div",{children:t.jsxs("p",{className:"text-xs md:text-sm customtext-neutral-dark",children:["Al realizar tu pedido, aceptas losÂ ",t.jsx("a",{href:"#",onClick:()=>v(1),className:"customtext-primary font-bold",children:"TÃ©rminos y Condiciones"}),", y que nosotros usaremos sus datos personales de acuerdo con nuestraÂ ",t.jsx("a",{href:"#",onClick:()=>v(0),className:"customtext-primary font-bold",children:"PolÃ­tica de Privacidad"}),"."]})})]})]}),t.jsx(g,{isOpen:O,onClose:()=>z(!1),suggestion:Q,onAddToCart:async e=>{try{r(t=>{const s=t.findIndex(t=>(t.item_id||t.id)===e.item_id);if(-1!==s){const a=[...t],i=e.quantity||e.suggested_quantity||1;return a[s].quantity+=i,a}{const s={id:e.item_id,name:e.item_name,quantity:e.quantity||e.suggested_quantity||1,price:e.value||0,final_price:e.value||0,image:e.item_image||"default.jpg",brand:{name:e.item_brand||"N/A"},sku:e.item_sku||"PROMO",stock:999};return[...t,s]}}),setTimeout(()=>{Y()},100)}catch(t){}},productName:W?.name||""})]})}function F({data:l,cart:c,setSale:h,setCode:g,setDelivery:y,setCart:T,onContinue:S,noContinue:D,subTotal:E,igv:F,fleteTotal:I,seguroImportacionTotal:L,derechoArancelarioTotal:q,totalFinal:P,user:A,setEnvio:M,envio:$,ubigeos:B=[],openModal:U,categorias:R,setCouponDiscount:H,setCouponCode:O,automaticDiscounts:z=[],automaticDiscountTotal:Q=0,setAutomaticDiscounts:V,setAutomaticDiscountTotal:W,totalWithoutDiscounts:K,conversionScripts:G,setConversionScripts:Y,onPurchaseComplete:J,generals:X,valorCIF:Z,advDisplay:ee,ipmDisplay:te,subTotalConDescuentos:se}){const[ae,ie]=e.useState(null),[re,ne]=e.useState(null);z.reduce((e,t)=>t.free_items&&Array.isArray(t.free_items)?[...e,...t.free_items]:e,[]);const[oe,le]=e.useState({name:A?.name||"",lastname:A?.lastname||"",email:A?.email||"",phone:A?.phone||"",documentType:A?.document_type?.toLowerCase()||"",document:A?.document_number||"",department:A?.department||"",province:A?.province||"",district:A?.district||"",address:A?.address||"",number:A?.number||"",comment:"",reference:A?.reference||"",ubigeo:A?.ubigeo||null});e.useEffect(()=>{if(A?.ubigeo&&A?.district&&A?.province&&A?.department){const e={value:A.ubigeo,label:`${A.district}, ${A.province}, ${A.department}`,data:{reniec:A.ubigeo,departamento:A.department,provincia:A.province,distrito:A.district}};ne(e),ie(e),He(e)}},[A]),e.useEffect(()=>{A&&le(e=>({...e,name:A.name||e.name,lastname:A.lastname||e.lastname,email:A.email||e.email,phone:A.phone||e.phone,documentType:A.document_type?.toLowerCase()||e.documentType,document:A.document_number||e.document,department:A.department||e.department,province:A.province||e.province,district:A.district||e.district,address:A.address||e.address,number:A.number||e.number,reference:A.reference||e.reference,ubigeo:A.ubigeo||e.ubigeo}))},[A]);const[ce,de]=e.useState(!1),[me,ue]=e.useState(!1),[pe,xe]=e.useState([]),[he,fe]=e.useState(null),[ge,be]=e.useState(null),[je,ve]=e.useState({}),[ye,Ne]=e.useState(""),[we,_e]=e.useState(!1),[Ce,ke]=e.useState(""),[Te,Se]=e.useState(null),[De,Ee]=e.useState(0),[Fe,Ie]=e.useState(!1),[Le,qe]=e.useState(""),[Pe,Ae]=e.useState(null),[Me,$e]=e.useState(!1),[Be,Ue]=e.useState(!1),Re=e=>{if(!e)return;const t=document.createElement("div");if(t.style.cssText="\n            position: absolute;\n            top: -2px;\n            left: -2px;\n            right: -2px;\n            bottom: -2px;\n            border: 2px solid #ef4444;\n            border-radius: 8px;\n            pointer-events: none;\n            z-index: 1000;\n            animation: pulse 0.6s ease-in-out;\n            box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.2);\n        ",!document.querySelector("#error-highlight-styles")){const e=document.createElement("style");e.id="error-highlight-styles",e.textContent="\n                @keyframes pulse {\n                    0% { transform: scale(1); opacity: 1; }\n                    50% { transform: scale(1.02); opacity: 0.8; }\n                    100% { transform: scale(1); opacity: 1; }\n                }\n            ",document.head.appendChild(e)}const s=e.style.position;s&&"static"!==s||(e.style.position="relative"),e.appendChild(t),setTimeout(()=>{t.parentNode&&(t.parentNode.removeChild(t),s&&"static"!==s||(e.style.position=s))},1200)},He=async e=>{if(!e)return;ve(e=>({...e,ubigeo:""}));const{data:s}=e;le(e=>({...e,department:s.departamento,province:s.provincia,district:s.distrito,ubigeo:s.reniec})),de(!0);try{const e=c.reduce((e,t)=>e+t.final_price*t.quantity,0),t=await b.getShippingCost({ubigeo:s.reniec,cart_total:e}),a=[];let i=!1;if(t.data.is_free&&t.data.qualifies_free_shipping&&a.push({type:"free",price:0,description:t.data.standard.description,deliveryType:t.data.standard.type,characteristics:t.data.standard.characteristics}),t.data.standard&&(!t.data.is_free||t.data.is_free&&!t.data.qualifies_free_shipping)){let e=t.data.standard.description;t.data.is_free||(e=e.replace(/envÃ­o gratis.*?/gi,"").replace(/envio gratis.*?/gi,"").replace(/gratis.*?compras.*?/gi,"").replace(/mayor.*?200.*?/gi,"").replace(/200.*?mayor.*?/gi,"").replace(/\s+/g," ").trim(),e||(e="Delivery a domicilio")),a.push({type:"standard",price:t.data.standard.price,description:e,deliveryType:t.data.standard.type,characteristics:t.data.standard.characteristics})}if(t.data.express&&t.data.express.price>0&&a.push({type:"express",price:t.data.express.price,description:t.data.express.description,deliveryType:t.data.express.type,characteristics:t.data.express.characteristics}),t.data.is_agency&&t.data.agency&&a.push({type:"agency",price:t.data.agency.price||0,description:t.data.agency.description,deliveryType:t.data.agency.type,characteristics:t.data.agency.characteristics}),t.data.is_store_pickup&&(i=!0),i||t.data.is_store_pickup){a.some(e=>"store_pickup"===e.type)||(t.data.store_pickup?a.push({type:"store_pickup",price:t.data.store_pickup.price,description:t.data.store_pickup.description,deliveryType:t.data.store_pickup.type,characteristics:t.data.store_pickup.characteristics}):a.push({type:"store_pickup",price:0,description:"Retira tu pedido en una de nuestras tiendas",deliveryType:"Retiro en Tienda",characteristics:["Sin costo de envÃ­o","Horarios flexibles","AtenciÃ³n personalizada"]})),$e(!0)}else $e(!1),Ae(null);xe(a),fe(a[0]?.type||null),M(a[0]?.price||0),_e(!1)}catch(i){N.error("Sin cobertura",{description:"No realizamos envÃ­os a esta ubicaciÃ³n.",icon:t.jsx(a,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"bottom-center"}),xe([]),fe(null),M(0),_e(!1)}de(!1)},Oe=async e=>{if(e.preventDefault(),me)return;if(!A)return void Ue(!0);const s={};if(oe.name.trim()||(s.name="Nombre es requerido"),oe.lastname.trim()||(s.lastname="Apellido es requerido"),oe.documentType.trim()||(s.documentType="Tipo de documento es requerido"),oe.document.trim()||(s.document="NÃºmero de documento es requerido"),oe.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(oe.email)||(s.email="Email invÃ¡lido"):s.email="Email es requerido",oe.phone.trim()?/^[0-9]{9}$/.test(oe.phone.trim())||(s.phone="TelÃ©fono debe tener exactamente 9 dÃ­gitos"):s.phone="TelÃ©fono es requerido",oe.ubigeo||(s.ubigeo="UbicaciÃ³n es requerida"),oe.address||(s.address="DirecciÃ³n es requerida"),he||(s.shipping="Seleccione un mÃ©todo de envÃ­o"),Object.keys(s).length>0){ve(s);const e=Object.keys(s)[0],a={name:"Por favor ingrese su nombre",lastname:"Por favor ingrese su apellido",documentType:"Por favor seleccione el tipo de documento",document:"Por favor ingrese su nÃºmero de documento",email:s.email?.includes("invÃ¡lido")?"Por favor ingrese un correo electrÃ³nico vÃ¡lido":"Por favor ingrese su correo electrÃ³nico",phone:s.phone?.includes("9 dÃ­gitos")?"El telÃ©fono debe tener exactamente 9 dÃ­gitos":"Por favor ingrese su nÃºmero de telÃ©fono",ubigeo:"Por favor seleccione su ubicaciÃ³n de entrega",address:"Por favor ingrese su direcciÃ³n de entrega",shipping:"Por favor seleccione un mÃ©todo de envÃ­o"};return N.error("Complete el campo requerido",{description:a[e],icon:t.jsx(n,{className:"h-5 w-5 text-red-500"}),duration:4e3,position:"top-center"}),void(e=>{const t=["name","lastname","documentType","document","email","phone","ubigeo","address","shipping"];for(const s of t)if(e[s]){let e=null,t=!1;if("ubigeo"===s?e=document.querySelector('[name="ubigeo"]')?.parentElement?.parentElement||document.querySelector(".css-1s2u09g-control")||document.querySelector('[class*="react-select"]'):"shipping"===s?e=document.querySelector('input[name="shipping"]')?.closest(".space-y-4")||document.querySelector(".space-y-4 h3")||document.querySelector("h3"):(e=document.querySelector(`[name="${s}"]`),t=!0),e){e.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),t&&setTimeout(()=>{try{e.focus(),"INPUT"===e.tagName&&"text"===e.type&&e.select()}catch(t){}},600),Re(e);break}}})(s)}ue(!0);try{if(!w.CULQI_ENABLED)return N.error("MÃ©todo de pago no disponible",{description:"El procesamiento de pagos con tarjeta estÃ¡ temporalmente deshabilitado",icon:t.jsx(n,{className:"h-5 w-5 text-red-500"}),duration:4e3,position:"top-center"}),void ue(!1);if(!w.CULQI_PUBLIC_KEY)return N.error("Error de configuraciÃ³n",{description:"El sistema de pagos no estÃ¡ configurado correctamente",icon:t.jsx(n,{className:"h-5 w-5 text-red-500"}),duration:4e3,position:"top-center"}),void ue(!1);const e={user_id:A.id,...oe,fullname:`${oe.name} ${oe.lastname}`,country:"PerÃº",document_type:oe.documentType,amount:Qe(Ke),delivery:Qe($),seguro_importacion_total:E>200?Qe(L||0):0,derecho_arancelario_total:E>200?Qe(q||0):0,flete_total:Qe(I||0),delivery_type:he,store_id:"store_pickup"===he?Pe?.id:null,cart:c,coupon_id:Te?.id||null,coupon_code:Te?.code||null,coupon_discount:Qe(De||0),applied_promotions:z||[],promotion_discount:Qe(Q||0)},s=await p(e);if(s.status){if(h(s.sale),y(s.delivery),g(s.code),s.conversion_scripts&&(Y(s.conversion_scripts),J))try{await J(s.sale_id,s.conversion_scripts)}catch(i){}T([]),S()}else N.error("Error en el pago",{description:s.message||"Pago rechazado",icon:t.jsx(a,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"bottom-center"})}catch(r){N.error("Lo sentimos, no puede continuar con la compra",{description:`OcurriÃ³ un error al procesar el pedido: ${r.message}`,icon:t.jsx(a,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"bottom-center"})}finally{ue(!1)}},ze=e.useCallback(_.debounce((e,t)=>{e.length<3?t([]):fetch(`/api/ubigeo/search?q=${encodeURIComponent(e)}`).then(e=>{if(!e.ok)throw new Error("Error en la respuesta");return e.json()}).then(e=>{const s=e.map(e=>({value:e.reniec,label:`${e.distrito}, ${e.provincia}, ${e.departamento}`,data:{inei:e.inei,reniec:e.reniec,departamento:e.departamento,provincia:e.provincia,distrito:e.distrito}}));t(s)}).catch(e=>{t([])})},300),[]);e.useEffect(()=>{ve(e=>{const t={...e};if(oe.name.trim()&&delete t.name,oe.lastname.trim()&&delete t.lastname,oe.documentType.trim()&&delete t.documentType,oe.document.trim()&&delete t.document,oe.email.trim()){/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(oe.email)&&delete t.email}if(oe.phone.trim()){/^[0-9]{9}$/.test(oe.phone.trim())&&delete t.phone}return oe.address.trim()&&delete t.address,oe.ubigeo&&delete t.ubigeo,he&&delete t.shipping,t})},[oe,he]);const Qe=e=>{const t="string"==typeof e?parseFloat(e):e;return parseFloat(t.toFixed(2))},Ve=Qe(P)-Qe(Q);let We=0;Te&&("percentage"===Te.type||"percent"===Te.type?We=Ve*Number(Te.value)/100:"fixed"===Te.type&&(We=Number(Te.value))),e.useEffect(()=>{Ee(Qe(We)),H&&H(Qe(We))},[Te,E,F,$,Q]);const Ke=Math.max(0,Qe(Ve-We)),Ge=()=>{if(!Be)return null;return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:e=>{e.target===e.currentTarget&&Ue(!1)},children:t.jsx("div",{className:"bg-white rounded-xl p-6 max-w-md w-full shadow-2xl transform transition-all",children:t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-blue-100 mb-4",children:t.jsx(o,{className:"h-8 w-8 customtext-primary"})}),t.jsx("h2",{className:"text-2xl font-bold customtext-neutral-dark mb-3",children:"Acceso requerido"}),t.jsx("p",{className:"customtext-neutral-light text-sm leading-relaxed",children:"Para continuar con su compra necesita iniciar sesiÃ³n o crear una cuenta nueva."})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("button",{onClick:()=>{window.location.href="/iniciar-sesion"},className:"w-full py-3 px-6 bg-primary text-white font-semibold rounded-lg  focus:outline-none focus:ring-2  focus:ring-offset-2 transition duration-200 transform hover:scale-[1.02]",children:"Iniciar sesiÃ³n"}),t.jsx("button",{onClick:()=>{window.location.href="/crear-cuenta"},className:"w-full py-3 px-6 bg-accent text-white font-semibold rounded-lg  focus:outline-none focus:ring-2  focus:ring-offset-2 transition duration-200 transform hover:scale-[1.02]",children:"Crear cuenta nueva"}),t.jsx("button",{onClick:()=>Ue(!1),className:"w-full py-3 px-6 customtext-neutral-light hover:customtext-neutral-dark border border-secondary rounded-lg hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition duration-200",children:"Cancelar"})]})]})})})};return t.jsxs(t.Fragment,{children:[t.jsx(Ge,{}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 md:gap-8",children:[t.jsx("div",{className:"lg:col-span-3",children:t.jsxs("form",{className:"space-y-4 md:space-y-6 bg-white p-4 md:p-6 rounded-xl shadow-sm",onSubmit:Oe,children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx(C,{name:"name",label:"Nombres",value:oe.name,error:je.name,onChange:e=>{le(t=>({...t,name:e.target.value})),e.target.value.trim()&&je.name&&ve(e=>({...e,name:""}))},required:!0,className:"border-gray-200 "+(je.name?"border-red-500 bg-red-50":"")}),t.jsx(C,{name:"lastname",label:"Apellidos",value:oe.lastname,error:je.lastname,onChange:e=>{le(t=>({...t,lastname:e.target.value})),e.target.value.trim()&&je.lastname&&ve(e=>({...e,lastname:""}))},required:!0,className:"border-gray-200 "+(je.lastname?"border-red-500 bg-red-50":"")})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx("div",{className:"space-y-2",children:t.jsx(k,{label:"Tipo de documento",options:[{value:"dni",label:"DNI"},{value:"ruc",label:"RUC"},{value:"ce",label:"CE"},{value:"pasaporte",label:"Pasaporte"}],placeholder:"Selecciona tu documento",labelClass:"block text-sm 2xl:!text-base mb-1 customtext-neutral-dark",value:oe.documentType,error:je.documentType,onChange:e=>{le(t=>({...t,documentType:e})),e&&je.documentType&&ve(e=>({...e,documentType:""}))},required:!0})}),t.jsx(C,{name:"document",label:"NÃºmero de documento",value:oe.document,error:je.document,onChange:e=>{le(t=>({...t,document:e.target.value})),e.target.value.trim()&&je.document&&ve(e=>({...e,document:""}))},placeholder:"Ej: 12345678",required:!0,className:"border-gray-200 "+(je.document?"border-red-500 bg-red-50":"")})]}),t.jsx(C,{name:"email",label:"Correo electrÃ³nico",type:"email",value:oe.email,error:je.email,onChange:e=>{if(le(t=>({...t,email:e.target.value})),e.target.value.trim()&&je.email){/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.target.value)&&ve(e=>({...e,email:""}))}},required:!0,className:"border-gray-200 "+(je.email?"border-red-500 bg-red-50":"")}),t.jsx(C,{name:"phone",label:"TelÃ©fono",type:"tel",value:oe.phone,error:je.phone,onChange:e=>{const t=e.target.value.replace(/\D/g,"");le(e=>({...e,phone:t})),9===t.length&&je.phone&&ve(e=>({...e,phone:""}))},maxLength:"9",placeholder:"Ej: 987654321",required:!0,className:"border-gray-200 "+(je.phone?"border-red-500 bg-red-50":"")}),t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{className:"block text-sm 2xl:text-base mb-2 font-medium customtext-neutral-dark",children:["Distrito / Provincia / Departamento (UbicaciÃ³n de entrega)",t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx(i,{name:"ubigeo",cacheOptions:!0,value:ae,loadOptions:ze,onChange:e=>{ie(e),He(e),Ne("")},inputValue:ye,onInputChange:(e,{action:t})=>{"input-change"===t&&Ne(e)},onFocus:()=>{ie(null),Ne("")},onMenuOpen:()=>{ae&&(ie(null),Ne(""))},placeholder:"Buscar por Distrito ...",loadingMessage:()=>"Buscando ubicaciones...",noOptionsMessage:({inputValue:e})=>e.length<3?"Buscar por Distrito ...":"No se encontraron resultados",isLoading:ce,styles:(Ye=!!je.ubigeo,{control:e=>({...e,border:"1px solid "+(Ye?"#ef4444":"#e5e7eb"),boxShadow:"none",minHeight:"50px","&:hover":{borderColor:Ye?"#ef4444":"#6b7280"},borderRadius:"0.75rem",padding:"2px 8px"}),menu:e=>({...e,zIndex:9999,marginTop:"4px",borderRadius:"8px"}),option:e=>({...e,color:"#1f2937",backgroundColor:"white","&:hover":{backgroundColor:"#f3f4f6"},padding:"12px 16px"})}),formatOptionLabel:({data:e})=>t.jsxs("div",{className:"text-sm py-1",children:[t.jsx("div",{className:"font-medium",children:e.distrito}),t.jsxs("div",{className:"text-gray-500",children:[e.provincia,", ",e.departamento]})]}),className:"w-full rounded-xl transition-all duration-300",menuPortalTarget:document.body,isClearable:!0}),je.ubigeo&&t.jsx("div",{className:"text-red-500 text-sm mt-1",children:je.ubigeo})]}),t.jsx(C,{name:"address",label:"DirecciÃ³n ",value:oe.address,error:je.address,onChange:e=>{le(t=>({...t,address:e.target.value})),e.target.value.trim()&&je.address&&ve(e=>({...e,address:""}))},required:!0,className:"border-gray-200 "+(je.address?"border-red-500 bg-red-50":"")}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx(C,{label:"NÃºmero",value:oe.number,onChange:e=>le(t=>({...t,number:e.target.value})),className:"border-gray-200"}),t.jsx(C,{label:"Referencia",value:oe.reference,onChange:e=>le(t=>({...t,reference:e.target.value})),className:"border-gray-200"})]}),pe.length>0&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"MÃ©todo de envÃ­o"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:pe.map(e=>t.jsx(j,{title:e.deliveryType,price:e.price,description:e.description,selected:he===e.type,onSelect:()=>{fe(e.type),M(e.price),ve(e=>({...e,shipping:"",store:""})),_e(!1),"store_pickup"!==e.type&&Ae(null)}},e.type))}),he&&pe.length>0&&t.jsx("div",{className:"space-y-3 mt-4",children:(()=>{const e=pe.find(e=>e.type===he)?.characteristics||[],s=e.length>1,a=s&&!we?e.slice(0,1):e;return t.jsxs(t.Fragment,{children:[a.map((e,s)=>t.jsxs("div",{className:"flex items-start gap-3 bg-gray-50 p-4 rounded-xl",children:[t.jsx("div",{className:"w-5 flex-shrink-0",children:t.jsx(r,{className:"customtext-primary"})}),t.jsx("div",{className:"flex-1",children:t.jsx("p",{className:"text-sm font-medium customtext-neutral-dark",children:e})})]},`char-${s}`)),s&&t.jsx("div",{className:"flex justify-center mt-3",children:t.jsxs("button",{type:"button",onClick:()=>_e(!we),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium customtext-primary hover:bg-blue-50 rounded-lg transition-colors duration-200",children:[t.jsx("span",{children:we?"Ver menos informaciÃ³n":`Ver mÃ¡s informaciÃ³n (${e.length-1} mÃ¡s)`}),t.jsx("svg",{className:"w-4 h-4 transition-transform duration-200 "+(we?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})})]})})()})]}),"store_pickup"===he&&Me&&t.jsxs("div",{className:"space-y-4 mt-6",children:[t.jsx(v,{ubigeoCode:oe.ubigeo,onStoreSelect:e=>{Ae(e),ve(e=>({...e,store:""}))},selectedStore:Pe,className:"border border-gray-200 rounded-xl p-4"}),je.store&&t.jsxs("div",{className:"text-red-500 text-sm mt-2 flex items-center gap-2",children:[t.jsx(n,{className:"h-4 w-4"}),je.store]})]}),!D&&t.jsxs("div",{className:"flex flex-col md:flex-row justify-end gap-3 md:gap-4 mt-6",children:[t.jsx(f,{type:"button",onClick:()=>window.history.back(),className:"w-full md:w-auto",children:"Regresar"}),t.jsx(u,{type:"submit",loading:ce,className:"w-full md:w-auto",children:"Continuar"})]})]})}),t.jsxs("div",{className:"bg-[#F7F9FB] rounded-xl shadow-lg p-6 col-span-2 h-max",children:[t.jsx("h3",{className:"text-2xl font-bold pb-6",children:"Resumen"}),t.jsx("div",{className:"space-y-4 border-b-2 pb-6",children:c.map(e=>t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("img",{src:"combo"===e.type?`/storage/images/combo/${e.image}`:`/storage/images/item/${e.image}`,alt:e.name,className:"w-16 h-16 object-cover rounded-lg",onError:e=>e.target.src="/api/cover/thumbnail/null"}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium",children:e.name}),t.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Cantidad: ",e.quantity]}),t.jsxs("p",{className:"text-sm customtext-neutral-dark",children:[d(),m(e.final_price)]})]})]},e.id))}),t.jsxs("div",{className:"space-y-4 mt-6",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Subtotal:"}),t.jsxs("span",{children:[d(),m(Qe(E))]})]}),Q>0&&t.jsxs("div",{className:"flex justify-between text-green-600",children:[t.jsx("span",{children:"Descuentos aplicados:"}),t.jsxs("span",{children:["-",d(),m(Qe(Q))]})]}),E>200&&L>0&&Number(X?.find(e=>"importation_seguro"===e.correlative)?.description)>0&&t.jsxs("div",{className:"flex justify-between !hidden",children:[t.jsxs("span",{children:["Seguro (",Number(X?.find(e=>"importation_seguro"===e.correlative)?.description||0).toFixed(2),"%):"]}),t.jsxs("span",{children:[d(),m(Qe(L))]})]}),E>200&&q>0&&Number(X?.find(e=>"importation_derecho_arancelario"===e.correlative)?.description)>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{children:["Impuestos PerÃº (",X?.find(e=>"importation_derecho_arancelario"===e.correlative)?.description,"%)",X?.find(e=>"importation_derecho_arancelario_descripcion"===e.correlative)?.description&&t.jsx(s,{content:t.jsx("p",{className:"whitespace-pre-line",children:X?.find(e=>"importation_derecho_arancelario_descripcion"===e.correlative)?.description}),allowHTML:!0,children:t.jsx("i",{className:"mdi mdi-information ms-1"})})]}),t.jsxs("span",{children:[d(),m(Qe(q))]})]}),I>0&&t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{children:["Flete de Envio Internacional",X?.find(e=>"importation_flete_descripcion"===e.correlative)?.description&&t.jsx(s,{content:t.jsx("p",{className:"whitespace-pre-line",children:X?.find(e=>"importation_flete_descripcion"===e.correlative)?.description}),allowHTML:!0,children:t.jsx("i",{className:"mdi mdi-information ms-1"})})]}),t.jsxs("span",{children:[d(),m(Qe(I))]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{children:["EnvÃ­o Local",X?.find(e=>"envio"===e.correlative)?.description&&t.jsx(s,{content:t.jsx("p",{className:"whitespace-pre-line",children:X?.find(e=>"envio"===e.correlative)?.description}),allowHTML:!0,children:t.jsx("i",{className:"mdi mdi-information ms-1"})})]}),t.jsxs("span",{children:[d(),m(Qe($))]})]}),t.jsx("div",{className:"space-y-4 border-t pt-4",children:t.jsxs("div",{className:"space-y-3",children:[t.jsx("label",{className:"block text-sm font-medium customtext-neutral-dark",children:"Â¿Tienes un cupÃ³n de descuento?"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx("input",{type:"text",placeholder:"Ingresa tu cÃ³digo de cupÃ³n",value:Ce,onChange:e=>ke(e.target.value.toUpperCase()),className:`w-full px-4 py-3 border customtext-neutral-dark  border-gray-100 rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300 ${Le?"border-red-300 bg-red-50 text-red-900 focus:border-red-500 focus:ring-red-200":Te?"border-gray-200 bg-white customtext-neutral-dark focus:ring-blue-200":" bg-white border-neutral-light focus:ring-0 focus:outline-0"} `,disabled:!!Te||Fe}),Fe&&t.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:t.jsx("div",{className:"w-4 h-4 border-2 border-primary border-t-transparent rounded-full animate-spin"})})]}),Te?t.jsx("button",{type:"button",onClick:()=>{Se(null),Ee(0),ke(""),qe(""),H&&H(0),O&&O(""),N.success("CupÃ³n removido",{description:"El cupÃ³n ha sido removido de su pedido",duration:2e3,position:"top-center"})},className:"px-4 py-3 bg-gray-200 customtext-neutral-dark text-sm rounded-xl hover:bg-gray-300 transition-colors duration-200",title:"Remover cupÃ³n",children:t.jsx(n,{className:"h-4 w-4"})}):t.jsx("button",{type:"button",onClick:async()=>{if(Ce.trim()){Ie(!0),qe("");try{const e=[...new Set(c.map(e=>e.category_id).filter(Boolean))],s=c.map(e=>e.id),a=await x.validateCoupon({code:Ce.trim(),cart_total:E,category_ids:e,product_ids:s}),i=a.data||a;if(i&&i.valid){Se(i.coupon);const e=Math.round(100*i.discount)/100;Ee(e),H&&H(e),O&&O(i.coupon?.code||Ce.trim()),N.success("CupÃ³n aplicado",{description:i.message||"CupÃ³n aplicado correctamente",duration:3e3,position:"top-center"})}else{const e=i?.message||"CupÃ³n no vÃ¡lido";qe(e),N.error("CupÃ³n no vÃ¡lido",{description:e,icon:t.jsx(n,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-center"})}}catch(e){qe("Error al validar el cupÃ³n"),N.error("Error",{description:e.message||"No se pudo validar el cupÃ³n. Intente nuevamente.",icon:t.jsx(n,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-center"})}finally{Ie(!1)}}else qe("Ingrese un cÃ³digo de cupÃ³n")},disabled:Fe||!Ce.trim(),className:"px-6 py-3 bg-primary text-white text-sm font-medium rounded-xl hover:opacity-90 disabled:bg-gray-300 disabled:cursor-not-allowed transition-all duration-200 whitespace-nowrap",children:Fe?"Validando...":"Aplicar"})]}),Le&&t.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[t.jsx(n,{className:"h-4 w-4 flex-shrink-0"}),t.jsx("span",{children:Le})]}),Te&&t.jsx("div",{className:"bg-gray-50 border-2  rounded-xl p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3 w-8/12",children:[t.jsx("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center flex-shrink-0",children:t.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),t.jsxs("div",{children:[t.jsxs("p",{className:"customtext-primary font-semibold text-sm",children:["Descto. ","percentage"===Te.type?`${Te.value}%`:`${d()}${m(Te.value)}`]}),t.jsx("p",{className:"customtext-primary text-xs mt-1",children:Te.code})]})]}),t.jsx("div",{className:"text-right w-4/12",children:t.jsxs("span",{className:"customtext-primary font-bold text-base",children:["-",d(),m(Qe(De))]})})]})})]})}),z&&z.length>0&&t.jsx("div",{className:"space-y-4 border-t pt-4",children:t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"text-sm font-medium customtext-neutral-dark mb-2",children:"ðŸŽ‰ Descuentos automÃ¡ticos aplicados:"}),z.map((e,s)=>t.jsx("div",{className:" border-2  rounded-xl p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3 w-8/12",children:[t.jsx("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center flex-shrink-0",children:t.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),t.jsxs("div",{children:[t.jsx("p",{className:"customtext-neutral-dark font-semibold text-sm",children:e.name}),e.description&&t.jsx("p",{className:"customtext-neutral-dark text-xs mt-1",children:e.description})]})]}),t.jsx("div",{className:"text-right w-4/12",children:t.jsxs("span",{className:"customtext-neutral-dark font-bold text-base",children:["-",d(),m(e.amount)]})})]})},s)),Q>0&&t.jsx("div",{className:"l p-3",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"customtext-neutral-dark font-semibold",children:"Total descuentos automÃ¡ticos:"}),t.jsxs("span",{className:"customtext-neutral-dark font-bold text-lg",children:["-",d(),m(Q)]})]})})]})}),t.jsx("div",{className:"pt-4 border-t-2",children:t.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[t.jsx("span",{children:"Total:"}),t.jsxs("span",{children:[d(),m(Qe(Te?Ke:P))]})]})}),!w.CULQI_ENABLED&&t.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(r,{className:"h-5 w-5 text-yellow-600 mr-2"}),t.jsx("span",{className:"text-sm text-yellow-800",children:"El procesamiento de pagos con tarjeta estÃ¡ temporalmente deshabilitado"})]})}),w.CULQI_ENABLED&&!w.CULQI_PUBLIC_KEY&&t.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(n,{className:"h-5 w-5 text-red-600 mr-2"}),t.jsx("span",{className:"text-sm text-red-800",children:"Error de configuraciÃ³n: Sistema de pagos no configurado"})]})}),t.jsx(u,{onClick:Oe,disabled:me||!w.CULQI_ENABLED||!w.CULQI_PUBLIC_KEY,loading:me,className:`w-full mt-6 ${l?.class_button||"text-white"} ${w.CULQI_ENABLED&&w.CULQI_PUBLIC_KEY?"":"opacity-50 cursor-not-allowed"}`,children:me?"Procesando...":w.CULQI_ENABLED?w.CULQI_PUBLIC_KEY?`Pagar ${d()}${m(Qe(Te?Ke:P))}`:"ConfiguraciÃ³n pendiente":"Pago no disponible"}),t.jsx(f,{onClick:D,className:"w-full mt-3",disabled:me,children:"Regresar al carrito"}),t.jsxs("p",{className:"text-xs md:text-sm customtext-neutral-dark",children:["Al realizar tu pedido, aceptas losÂ ",t.jsx("a",{href:"#",onClick:()=>U(1),className:"customtext-primary font-bold",children:"TÃ©rminos y Condiciones"}),", y que nosotros usaremos sus datos personales de acuerdo con nuestraÂ ",t.jsx("a",{href:"#",onClick:()=>U(0),className:"customtext-primary font-bold",children:"PolÃ­tica de Privacidad"}),"."]})]})]})]})]});var Ye}function I({cart:a,code:i,delivery:r,subTotal:n,igv:o,fleteTotal:l=0,seguroImportacionTotal:c=0,derechoArancelarioTotal:p=0,totalFinal:x,couponDiscount:h=0,couponCode:f=null,conversionScripts:g=null,automaticDiscounts:b=[],automaticDiscountTotal:j=0,generals:v,valorCIF:y,advDisplay:N,ipmDisplay:w,subTotalConDescuentos:_}){const C=n,k=_||n-(h||0)-(j||0),S=c,D=p,E=x;return e.useEffect(()=>{if(g)try{if(g.head){const e=document.createElement("script");e.innerHTML=g.head,document.head.appendChild(e)}if(g.body){const e=document.createElement("script");e.innerHTML=g.body,document.body.appendChild(e)}}catch(e){}},[g]),t.jsx(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"mx-auto max-w-3xl px-4 sm:px-6 lg:px-8 py-12",children:t.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-10",children:t.jsxs(T.div,{initial:{scale:.9},animate:{scale:1},transition:{delay:.3},className:"text-center space-y-6",children:[t.jsx(T.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.5},className:"w-20 h-20 bg-secondary rounded-full mx-auto flex items-center justify-center",children:t.jsx("span",{className:"text-4xl",children:"âœ“"})}),t.jsx("h2",{className:"text-2xl md:text-3xl customtext-neutral-light animate-bounce",children:"Â¡Gracias por tu compra! ðŸŽ‰"}),t.jsx("p",{className:"customtext-neutral-dark text-3xl md:text-5xl font-bold",children:"Tu orden ha sido recibida"}),t.jsxs(T.div,{whileHover:{scale:1.05},className:"py-6 px-4 bg-secondary rounded-xl inline-block",children:[t.jsx("div",{className:"customtext-neutral-light",children:"CÃ³digo de pedido"}),t.jsx("div",{className:"customtext-neutral-dark text-xl font-bold",children:`#${i}`})]}),t.jsxs("div",{className:"space-y-6 bg-[#F7F9FB] p-6 md:p-8 rounded-xl shadow-inner",children:[t.jsx("div",{className:"space-y-6 border-b-2 pb-6",children:a.map((e,s)=>t.jsx(T.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2*s},className:"bg-white rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow duration-300",children:t.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 items-center sm:items-start",children:[t.jsx("div",{className:"bg-gray-50 p-3 rounded-xl",children:t.jsx("img",{src:"combo"===e?.type?`/storage/images/combo/${e?.image}`:`/storage/images/item/${e?.image}`,alt:e?.name,className:"w-24 h-24 object-cover rounded-lg",onError:e=>e.target.src="/api/cover/thumbnail/null",loading:"lazy"})}),t.jsxs("div",{className:"text-center sm:text-left flex-1",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between mb-3",children:[t.jsxs("div",{className:"lg:w-8/12",children:[t.jsx("h3",{className:"font-semibold text-xl line-clamp-3 mb-2",children:e?.name}),"combo"===e.type&&t.jsxs("div",{className:"mt-2",children:[t.jsx("div",{className:"mb-2",children:t.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded-full",children:"COMBO"})}),t.jsxs("div",{className:"text-sm text-gray-600",children:[t.jsx("span",{className:"font-medium",children:"Contiene:"}),t.jsx("div",{className:"mt-1",children:e.combo_items&&e.combo_items.length>0?e.combo_items.map((e,s)=>t.jsxs("div",{className:"text-xs text-gray-500",children:["â€¢ ",e.quantity||1,"x ",e.name]},s)):e.items&&e.items.length>0?e.items.map((e,s)=>t.jsxs("div",{className:"text-xs text-gray-500",children:["â€¢ ",e.quantity||1,"x ",e.name]},s)):t.jsx("span",{className:"text-xs text-gray-400",children:"InformaciÃ³n de combo no disponible"})})]})]})]}),t.jsx("div",{className:"mt-2 sm:mt-0 text-center lg:text-right lg:w-4/12",children:t.jsxs("div",{className:"font-bold text-lg customtext-primary",children:[d(),m(("combo"===e.type?e.final_price||e.price:e.final_price)*e?.quantity)]})})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[e?.brand?.name&&t.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Marca: ",t.jsx("span",{className:"customtext-neutral-dark font-medium",children:e?.brand?.name||"N/A"})]}),t.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Cantidad: ",t.jsx("span",{className:"customtext-neutral-dark font-medium",children:e?.quantity})]}),e?.sku&&t.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["SKU: ",t.jsx("span",{className:"customtext-neutral-dark font-medium",children:e?.sku||"N/A"})]})]})]})]})},s))}),t.jsxs(T.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"space-y-4 mt-6",children:[t.jsxs("div",{className:"flex justify-between items-center py-2",children:[t.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),t.jsxs("span",{className:"font-semibold",children:[d(),m(C)]})]}),(h>0||j>0)&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex justify-between items-center py-2 text-green-600",children:[t.jsx("span",{className:"customtext-neutral-dark",children:"Descuentos aplicados"}),t.jsxs("span",{className:"font-semibold",children:["-",d(),m((h||0)+(j||0))]})]}),t.jsxs("div",{className:"flex justify-between items-center py-2 border-t pt-2",children:[t.jsx("span",{className:"customtext-neutral-dark font-semibold",children:"Subtotal con descuentos"}),t.jsxs("span",{className:"font-semibold",children:[d(),m(k)]})]})]}),Number(v?.find(e=>"importation_seguro"===e.correlative)?.description)>0&&t.jsxs("div",{className:"flex justify-between items-center py-2",children:[t.jsxs("span",{className:"customtext-neutral-dark",children:["Seguro (",Number(v?.find(e=>"importation_seguro"===e.correlative)?.description||0).toFixed(2),"%)"]}),t.jsxs("span",{className:"font-semibold",children:[d(),m(S)]})]}),l>0&&t.jsxs("div",{className:"flex justify-between items-center py-2",children:[t.jsxs("span",{className:"customtext-neutral-dark",children:["Flete",v?.find(e=>"importation_flete_descripcion"===e.correlative)?.description&&t.jsx(s,{content:t.jsx("p",{className:"whitespace-pre-line",children:v?.find(e=>"importation_flete_descripcion"===e.correlative)?.description}),allowHTML:!0,children:t.jsx("i",{className:"mdi mdi-information ms-1"})})]}),t.jsxs("span",{className:"font-semibold",children:[d(),m(l)]})]}),Number(v?.find(e=>"importation_derecho_arancelario"===e.correlative)?.description)>0&&t.jsxs("div",{className:"flex justify-between items-center py-2",children:[t.jsxs("span",{className:"customtext-neutral-dark",children:["Derecho Arancelario",v?.find(e=>"importation_derecho_arancelario_descripcion"===e.correlative)?.description&&t.jsx(s,{content:t.jsx("p",{className:"whitespace-pre-line",children:v?.find(e=>"importation_derecho_arancelario_descripcion"===e.correlative)?.description}),allowHTML:!0,children:t.jsx("i",{className:"mdi mdi-information ms-1"})})]}),t.jsxs("span",{className:"font-semibold",children:[d(),m(D)]})]}),t.jsxs("div",{className:"flex justify-between items-center py-2",children:[t.jsxs("span",{className:"customtext-neutral-dark",children:["EnvÃ­o",v?.find(e=>"envio_descripcion"===e.correlative)?.description&&t.jsx(s,{content:t.jsx("p",{className:"whitespace-pre-line",children:v?.find(e=>"envio_descripcion"===e.correlative)?.description}),allowHTML:!0,children:t.jsx("i",{className:"mdi mdi-information ms-1"})})]}),t.jsxs("span",{className:"font-semibold",children:[d(),m(r)]})]}),t.jsx("div",{className:"py-4 border-y-2 mt-6",children:t.jsxs("div",{className:"flex justify-between font-bold text-xl md:text-2xl items-center",children:[t.jsxs("span",{children:["Total",v?.find(e=>"total_descripcion"===e.correlative)?.description&&t.jsx(s,{content:t.jsx("p",{className:"whitespace-pre-line",children:v?.find(e=>"total_descripcion"===e.correlative)?.description}),allowHTML:!0,children:t.jsx("i",{className:"mdi mdi-information ms-1"})})]}),t.jsxs("span",{children:[d(),m(E)]})]})})]}),t.jsx(T.div,{className:"pt-6",whileHover:{scale:1.02},whileTap:{scale:.98},children:t.jsx(u,{href:"/catalogo",className:"w-full mx-auto md:w-auto text-white",children:"Seguir Comprando"})})]})]})})})}function L({cart:s,setCart:a,user:i,ubigeos:r=[],items:n,generals:o,data:d,categorias:m}){const[u,p]=e.useState(1);e.useEffect(()=>{0===s.filter(e=>"combo"===e.type).length&&s.length},[s,u]);const x=s.reduce((e,t)=>{const s=(e=>"combo"===e.type?e.final_price||e.price:e.final_price)(t);return e+s*t.quantity},0),{trackCheckoutPageView:h,trackInitiateCheckout:f,trackPurchase:g,resetTracking:b}=D(),[j,v]=e.useState(0),[y,N]=e.useState(null),[w,_]=e.useState([]),[C,k]=e.useState(0),T=x,L=j+C,q=Math.max(0,T-L),[P,A]=e.useState(0),M=s.reduce((e,t)=>e+(Number(t.weight)||0)*t.quantity,0),$=Number(o?.find(e=>"importation_flete"===e.correlative)?.description)||0,B=$>0?M*$:0,U=q*(T>200?(Number(o?.find(e=>"importation_seguro"===e.correlative)?.description)||0)/100:0),R=parseFloat(q)+parseFloat(B)+parseFloat(U),H=R*(T>200?(Number(o?.find(e=>"importation_derecho_arancelario"===e.correlative)?.description)||0)/100:0),O=T<=200?q+B+parseFloat(P):q+H+parseFloat(P)+B,z=T<=200?T+parseFloat(P)+parseFloat(B):T+parseFloat(P)+parseFloat(U)+parseFloat(H)+parseFloat(B),Q=B,V=U,W=H,[K,G]=e.useState([]),[Y,J]=e.useState([]),[X,Z]=e.useState([]),[ee,te]=e.useState(null);e.useEffect(()=>(h(u,s),()=>b()),[]),e.useEffect(()=>{h(u,s),2===u&&f(s,O)},[u]);const se=e=>{p(e),window.scrollTo({top:0,behavior:"smooth"})},ae={privacy_policy:"PolÃ­ticas de privacidad",terms_conditions:"TÃ©rminos y condiciones",saleback_policy:"PolÃ­ticas de devolucion y cambio"},[ie,re]=e.useState(null),ne=e=>re(e),oe=()=>re(null);return t.jsxs("div",{id:d?.element_id||null,className:"min-h-screen bg-[#F7F9FB] py-4 md:py-12 px-2 sm:px-primary 2xl:px-0 2xl:max-w-7xl mx-auto",children:[t.jsxs("div",{className:"bg-white p-3 md:p-8 rounded-lg md:rounded-xl shadow-sm",children:[t.jsx("div",{className:"mb-4 md:mb-8",children:t.jsxs("div",{className:"flex items-center justify-between gap-1 md:gap-4 max-w-3xl mx-auto",children:[t.jsxs("div",{className:"flex flex-col items-center md:flex-row md:items-center gap-1 md:gap-2 "+(1===u?"customtext-primary font-medium":"customtext-neutral-dark"),children:[t.jsx("span",{className:" bg-primary text-white w-8 h-8 rounded-full border-2 flex items-center justify-center text-xs md:text-sm",children:"1"}),t.jsx("span",{className:"text-[10px] md:text-sm text-center",children:"Carrito"})]}),t.jsx("div",{className:"mb-4 lg:mb-0  flex-1 h-[2px] bg-gray-200 relative",children:t.jsx("div",{className:"absolute inset-0 bg-primary transition-all duration-500",style:{width:u>1?"100%":"0%"}})}),t.jsxs("div",{className:"flex flex-col items-center md:flex-row md:items-center gap-1 md:gap-2 "+(u>1?"customtext-primary font-medium":"customtext-neutral-dark"),children:[t.jsx("span",{className:"w-8 h-8 rounded-full border-2 flex items-center justify-center text-xs md:text-sm "+(u>1?"bg-primary text-white":"bg-white customtext-primary"),children:"2"}),t.jsx("span",{className:"text-[10px] md:text-sm text-center",children:"EnvÃ­o"})]}),t.jsx("div",{className:"mb-4 lg:mb-0  flex-1 h-[2px] bg-gray-200 relative",children:t.jsx("div",{className:"absolute inset-0 bg-primary transition-all duration-500",style:{width:u>2?"100%":"0%"}})}),t.jsxs("div",{className:"flex flex-col items-center md:flex-row md:items-center gap-1 md:gap-2 "+(3===u?"customtext-primary  font-medium":"customtext-neutral-dark"),children:[t.jsx("span",{className:"w-8 h-8 rounded-full border-2 flex items-center justify-center text-xs md:text-sm "+(3===u?"bg-primary text-white":"bg-white customtext-primary"),children:"3"}),t.jsx("span",{className:"text-[10px] md:text-sm text-center",children:"ConfirmaciÃ³n"})]})]})}),1===u&&t.jsx(E,{data:d,cart:s,setCart:a,onContinue:()=>p(2),subTotal:T,envio:P,igv:0,fleteTotal:Q,seguroImportacionTotal:V,derechoArancelarioTotal:H,totalFinal:O,openModal:ne,categorias:m,automaticDiscounts:w,setAutomaticDiscounts:_,automaticDiscountTotal:C,setAutomaticDiscountTotal:k,totalWithoutDiscounts:z,generals:o,valorCIF:R,advDisplay:W,ipmDisplay:0,subTotalConDescuentos:q}),2===u&&t.jsx(F,{data:d,items:n,setCode:J,setDelivery:Z,cart:s,setSale:G,setCart:a,onContinue:()=>se(3),noContinue:()=>se(1),subTotal:T,envio:P,setEnvio:A,igv:0,fleteTotal:Q,seguroImportacionTotal:V,derechoArancelarioTotal:H,totalFinal:O,user:i,ubigeos:r,categorias:m,openModal:ne,setCouponDiscount:v,setCouponCode:N,automaticDiscounts:w,setAutomaticDiscounts:_,valorCIF:R,advDisplay:W,ipmDisplay:0,subTotalConDescuentos:q,automaticDiscountTotal:C,setAutomaticDiscountTotal:k,totalWithoutDiscounts:z,conversionScripts:ee,setConversionScripts:te,onPurchaseComplete:(e,t)=>{g(e,t)},generals:o}),3===u&&t.jsx(I,{code:Y,delivery:X,cart:K,subTotal:T,envio:P,igv:0,fleteTotal:Q,seguroImportacionTotal:V,derechoArancelarioTotal:H,totalFinal:O,couponDiscount:j,couponCode:y,automaticDiscounts:w,automaticDiscountTotal:C,totalWithoutDiscounts:z,conversionScripts:ee,setConversionScripts:te,onPurchaseComplete:(e,t)=>{g(e,t)},generals:o,valorCIF:R,advDisplay:W,ipmDisplay:0,subTotalConDescuentos:q})]}),Object.keys(ae).map((e,s)=>{const a=ae[e],i=o.find(t=>t.correlative==e)?.description??"";return t.jsx(l,{isOpen:ie===s,onRequestClose:oe,contentLabel:a,className:"fixed top-0 left-0 right-0 bottom-0 flex items-center justify-center p-4 z-50",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 z-[999]",ariaHideApp:!1,children:t.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 pr-4",children:a}),t.jsx("button",{onClick:oe,className:"flex-shrink-0 text-gray-400 hover:text-red-500 transition-colors duration-200 p-1 hover:bg-gray-100 rounded-full","aria-label":"Cerrar modal",children:t.jsx(c,{size:24,strokeWidth:2})})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:t.jsx("div",{className:"prose prose-gray max-w-none",children:t.jsx(S,{html:i})})}),t.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200",children:t.jsx("button",{onClick:oe,className:"px-6 py-2 bg-primary text-white rounded-lg  transition-colors duration-200 font-medium",children:"Cerrar"})})]})},s)})]})}export{L as default};
