import{j as s}from"./AboutSimple-Cf8x2fCZ.js";import{r as o}from"./index-BOnQTV8N.js";import"./BlogCarousel-DCQ9UYu0.js";/* empty css               */import"./BlogCarrusel-klwTVD05.js";import"./thumbs-l0sNRNKZ.js";/* empty css                  */import{t as te}from"./CardProductKatya-ncpmQ0JU.js";import{I as oe}from"./ItemsRest-Dp5IKigO.js";import"./ProductMakita-CuTJk-0k.js";import"./ProductNavigation-DQ1LQk6t.js";import re from"./ProductMultivet-BPxhylaG.js";import{Z as ne}from"./zoom-out-DUAqyJbD.js";import{Z as le}from"./zoom-in-DjAbuZ1Y.js";import{S as ce}from"./share-2-DAFE7yVK.js";import{C as ie}from"./circle-check-big-CYWUGR3Z.js";import{C as de}from"./chevron-right-Cug7tVUE.js";import{Q as A}from"./quote-Dsy8RbQK.js";import{A as pe}from"./index-BZvh78jk.js";import{m as D}from"./proxy-B0QLMKEh.js";import{X as ue}from"./x-fof_H3Vv.js";import{S as xe}from"./star-DU-S9B50.js";import"./index-yBjzXJbu.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-pSueRYGM.js";import"./index-B6ujFmsw.js";import"./main-B6F2O9-U.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./BasicRest-BML1C-ua.js";import"./BooleanLimit-D-OsQsek.js";import"./ProductCard-D_AgkLlk.js";import"./HeaderSearch-j9L8kXPt.js";import"./PolicyModal-C80IvD61.js";import"./index-Chjiymov.js";import"./CartItemRow-Dd2JdCJX.js";import"./Number2Currency-jIsa99f9.js";import"./General-apRuNwp7.js";import"./tippy-react.esm-DmkRJDEW.js";import"./package-DBFPPBi1.js";import"./createLucideIcon-DfjclApS.js";import"./trash-2-DU7LB6-f.js";import"./minus-Db6MFKEO.js";import"./plus-CTIomuuF.js";import"./eye-ScgfreHn.js";import"./CardProductMultivet-DEJJ6aW6.js";import"./circle-chevron-right-Cragr8lM.js";import"./CardProductKatya-qM0TNgEn.js";import"./use-in-view-DtBxy-1R.js";const fs=({item:e,data:me,setCart:L,cart:O,generals:f,favorites:g,setFavorites:he})=>{const E=new oe,[d,Z]=o.useState({url:e==null?void 0:e.image,type:"main"}),[c,M]=o.useState(!1),[S,b]=o.useState({x:50,y:50}),[p,j]=o.useState(!1),[v,I]=o.useState({x:0,y:0}),R=o.useRef(null),[n,u]=o.useState(1),[x,y]=o.useState([]),[fe,ge]=o.useState(!1),[m,T]=o.useState(!1),[be,X]=o.useState(!1),N=o.useRef(null),w=o.useRef(null),[je,q]=o.useState(!1),[H,U]=o.useState(!1),[Y,F]=o.useState(!1);o.useRef(null),o.useRef(null);const[ve,ye]=o.useState(null),k=f==null?void 0:f.find(a=>a.correlative==="phone_whatsapp"),W=k==null?void 0:k.description;o.useEffect(()=>{g&&e&&X(g.some(a=>a.id===e.id))},[g,e]),o.useEffect(()=>{e!=null&&e.id&&(G(e),J(e))},[e]),o.useEffect(()=>{const t=setTimeout(()=>{if(N.current){const r=N.current.scrollHeight>150;q(r)}if(w.current){const r=w.current.scrollHeight>150;U(r)}},100);return()=>clearTimeout(t)},[e,e==null?void 0:e.specifications]);const B=()=>{c?(M(!1),b({x:50,y:50})):M(!0)},Q=a=>{c&&(j(!0),I({x:a.clientX,y:a.clientY}))},C=a=>{if(c&&!p){const t=R.current.getBoundingClientRect(),r=(a.clientX-t.left)/t.width*100,l=(a.clientY-t.top)/t.height*100;b({x:Math.max(0,Math.min(100,r)),y:Math.max(0,Math.min(100,l))})}else if(p&&c){const t=a.clientX-v.x,r=a.clientY-v.y;b(l=>({x:Math.max(0,Math.min(100,l.x-t/3)),y:Math.max(0,Math.min(100,l.y-r/3))})),I({x:a.clientX,y:a.clientY})}},_=()=>{j(!1)},V=()=>{j(!1)};o.useEffect(()=>{if(p)return document.addEventListener("mousemove",C),document.addEventListener("mouseup",_),()=>{document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",_)}},[p,c,v]);const G=async a=>{try{await E.viewUpdate(a.id)}catch(t){console.error("Error updating view:",t)}},J=async a=>{try{console.log("Buscando productos relacionados para item:",a.id);const t={id:a==null?void 0:a.id},r=await E.productsRelations(t);if(console.log("Respuesta de productos relacionados:",r),!r){console.log("No se encontró respuesta de productos relacionados"),y([]);return}const z=Object.values(r);console.log("Productos relacionados encontrados:",z),y(z)}catch(t){console.error("Error fetching related products:",t),y([])}},K=encodeURIComponent(`¡Hola! Me gustaría cotizar este producto para mi mascota: ${e==null?void 0:e.name}

Cantidad: ${n} unidades

¿Podrían enviarme más información y precios?`);encodeURIComponent(`¡Hola! Tengo consultas sobre este producto: ${e==null?void 0:e.name}

¿Me pueden ayudar con más información?`);const ee=`https://wa.me/${W}?text=${K}`,$=()=>{window.open(ee,"_blank")},i=a=>a?new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN",minimumFractionDigits:2}).format(a):"Consultar precio",se=a=>{const t=parseFloat(a)||0;return Array.from({length:5},(r,l)=>s.jsx(xe,{className:`w-4 h-4 ${l<Math.floor(t)?"text-yellow-400 fill-current":"text-gray-300"}`},l))},h=(e==null?void 0:e.price)&&(e==null?void 0:e.final_price)&&parseFloat(e.price)>parseFloat(e.final_price),ae=h?Math.round((parseFloat(e.price)-parseFloat(e.final_price))/parseFloat(e.price)*100):0,P=[{url:e==null?void 0:e.image,type:"main",alt:"Imagen principal"},...((e==null?void 0:e.images)||[]).filter((a,t,r)=>t===r.findIndex(l=>l.url===a.url)).map((a,t)=>({url:a.url,type:"gallery",index:t,alt:`Imagen ${t+1}`}))];return s.jsxs("div",{className:"bg-gray-50 min-h-screen overflow-x-hidden",children:[s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4 lg:py-8",children:[s.jsxs("div",{className:"grid lg:grid-cols-2 gap-6 lg:gap-12",children:[s.jsxs("div",{className:"space-y-3 lg:space-y-4",children:[s.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg overflow-hidden",children:[s.jsxs("div",{className:`aspect-square flex items-center justify-center p-4 lg:p-8 relative ${c?"cursor-zoom-out":"cursor-zoom-in"}`,onClick:B,onMouseDown:Q,onMouseMove:C,onMouseLeave:V,children:[s.jsx("img",{ref:R,src:d.url?`/storage/images/item/${d.url}`:"/api/cover/thumbnail/null",alt:(e==null?void 0:e.name)||"Producto",className:`w-full h-full object-contain transition-transform duration-300 ${c?"scale-150":"scale-100"}`,style:c?{transformOrigin:`${S.x}% ${S.y}%`}:{},onError:a=>{a.target.src="/api/cover/thumbnail/null"}}),s.jsx("div",{className:"absolute top-4 left-4 bg-black bg-opacity-50 text-white px-2 py-2 rounded text-sm",children:c?s.jsx(ne,{className:"w-4 h-4"}):s.jsx(le,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"absolute top-4 right-4 space-y-2",children:[h&&s.jsxs("div",{className:"bg-red-500 text-white px-3 py-2 rounded-full text-sm font-bold",children:["-",ae,"% OFF"]}),(e==null?void 0:e.is_new)&&s.jsx("div",{className:"bg-accent customtext-primary px-3 py-2 rounded-full text-sm font-bold",children:"¡Nuevo!"})]}),s.jsx("div",{className:"absolute bottom-4 right-4 flex space-x-2",children:s.jsx("button",{onClick:()=>{var a;(a=navigator.share)!=null&&a.call(navigator,{title:e==null?void 0:e.name,text:e==null?void 0:e.description,url:window.location.href})||navigator.clipboard.writeText(window.location.href),te.success("Enlace copiado al portapapeles")},className:"w-10 h-10 bg-secondary  backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-opacity-100 transition-all shadow-lg",children:s.jsx(ce,{className:"w-5 h-5 text-white"})})})]}),P.length>1&&s.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 gap-2",children:P.map((a,t)=>s.jsx("button",{onClick:()=>Z(a),className:`aspect-square bg-white rounded-lg overflow-hidden border-2 transition-all hover:border-primary ${d.url===a.url?"border-primary":"border-gray-200"}`,children:s.jsx("img",{src:`/storage/images/item/${a.url}`,alt:a.alt,className:"w-full h-full object-contain p-2",onError:r=>{r.target.src="/api/cover/thumbnail/null"}})},t))})]}),s.jsx("div",{className:"lg:hidden ",children:s.jsxs("div",{className:"text-start",children:[s.jsx("div",{className:"text-3xl sm:text-4xl font-bold font-title customtext-neutral-dark",children:i((e==null?void 0:e.final_price)||(e==null?void 0:e.price))}),h&&s.jsxs("div",{className:"flex items-center justify-start space-x-2 mt-2",children:[s.jsx("span",{className:"text-base customtext-neutral-light line-through",children:i(e.price)}),s.jsxs("span",{className:"bg-red-100 customtext-secondary px-2 py-1 rounded-full text-xs font-bold",children:["Ahorras ",i(parseFloat(e.price)-parseFloat(e.final_price))]})]})]})}),s.jsxs("div",{className:"space-y-4 lg:space-y-6 pb-20 lg:pb-0",children:[s.jsxs("div",{className:"flex flex-row  items-center justify-between gap-3",children:[(e==null?void 0:e.category)&&s.jsx("span",{className:"bg-accent bg-opacity-10 customtext-primary font-bold px-3 py-1 sm:px-4 sm:py-2 rounded-full text-xs sm:text-sm",children:e.category.name}),(e==null?void 0:e.brand)&&s.jsx("img",{src:e.brand.image?`/api/brands/media/${e.brand.image}`:"/assets/img/noimage/no_img.jpg",alt:e.brand.name||"Marca",className:"max-h-12 sm:max-h-16 lg:max-h-20 max-w-24 lg:max-w-40 object-contain",onError:a=>{a.target.src="/assets/img/noimage/no_img.jpg"}})]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl sm:text-2xl lg:text-3xl xl:text-4xl font-title font-bold customtext-neutral-dark mb-3",children:e==null?void 0:e.name}),s.jsx("div",{className:"flex items-center space-x-4 mb-4",children:(e==null?void 0:e.rating)&&s.jsxs("div",{className:"flex items-center space-x-1",children:[se(e.rating),s.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["(",parseFloat(e.rating).toFixed(1),")"]})]})})]}),s.jsx("div",{className:" ",children:s.jsx("div",{ref:N,className:"prose max-w-none customtext-neutral-light transition-all duration-300 ",dangerouslySetInnerHTML:{__html:(e==null?void 0:e.description)||"<p>Sin descripción disponible.</p>"}})}),(e==null?void 0:e.specifications)&&Array.isArray(e.specifications)&&e.specifications.length>0&&s.jsxs("div",{className:"",children:[s.jsx("div",{ref:w,className:`space-y-3 transition-all duration-300 ${m?"":"max-h-40 overflow-hidden"}`,children:e.specifications.map((a,t)=>a.type==="general"&&s.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[s.jsx(ie,{className:"customtext-secondary w-4 h-4 flex-shrink-0"}),s.jsxs("span",{className:"font-bold customtext-neutral-dark",children:[a.title||"Especificación",":"]}),s.jsx("span",{className:"customtext-neutral-light",children:a.description||a.value||"No especificado"})]},t))}),H&&s.jsxs("button",{onClick:()=>T(!m),className:"mt-4 customtext-secondary hover:customtext-neutral-dark font-medium transition-colors flex items-center gap-2 text-sm",children:[m?"Ver menos":"Ver más características",s.jsx(de,{className:`w-4 h-4 transform transition-transform ${m?"rotate-90":""}`})]})]}),s.jsxs("div",{className:"hidden lg:block bg-white rounded-lg p-6 shadow-xl",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-4xl font-bold font-title customtext-neutral-dark",children:i((e==null?void 0:e.final_price)||(e==null?void 0:e.price))}),h&&s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsx("span",{className:"text-lg customtext-neutral-light line-through",children:i(e.price)}),s.jsxs("span",{className:"bg-red-100 customtext-secondary px-2 py-1 rounded-full text-sm font-bold",children:["Ahorras ",i(parseFloat(e.price)-parseFloat(e.final_price))]})]})]}),s.jsx("div",{className:"space-y-4 mt-4",children:s.jsx("div",{className:"flex items-center gap-3",children:s.jsxs("div",{className:"flex items-center bg-gray-50 rounded-xl border border-gray-200 p-1",children:[s.jsx("button",{onClick:()=>u(Math.max(1,n-1)),className:"w-10 h-10 flex items-center justify-center rounded-lg hover:bg-white hover:shadow-sm active:scale-95 transition-all duration-200 customtext-neutral-dark font-bold text-xl",disabled:n<=1,children:"−"}),s.jsx("div",{className:"w-16 h-10 flex items-center justify-center",children:s.jsx("span",{className:"customtext-neutral-dark font-bold text-lg",children:n})}),s.jsx("button",{onClick:()=>u(Math.min(10,n+1)),className:"w-10 h-10 flex items-center justify-center rounded-lg hover:bg-white hover:shadow-sm active:scale-95 transition-all duration-200 customtext-neutral-dark font-bold text-xl",disabled:n>=10,children:"+"})]})})})]}),s.jsx("div",{className:"space-y-3 mt-6",children:s.jsxs("button",{onClick:$,className:"w-full bg-secondary text-white py-4 px-6 rounded-xl font-bold flex items-center justify-center space-x-2 hover:bg-accent hover:customtext-primary transition-all shadow-lg hover:shadow-xl transform duration-500",children:[s.jsx(A,{className:"w-5 h-5"}),s.jsx("span",{children:"Solicitar Cotización"})]})})]})]})]}),console.log("RelationsItems en render:",x),x&&x.length>0&&s.jsx(re,{items:x,data:{title:"Productos relacionados",description:"Descubre otros productos cuidadosamente seleccionados que complementan perfectamente tu compra. Nuestra selección incluye productos de alta calidad de las mejores marcas veterinarias para el cuidado integral de tu mascota.",link_catalog:"/catalogo",class_content:"",class_header:"",class_button:"bg-secondary text-white hover:bg-accent hover:customtext-primary"},setCart:L,cart:O})]}),s.jsx("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 z-40 shadow-lg",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"flex items-center bg-gray-50 rounded-xl border border-gray-200 p-1",children:[s.jsx("button",{onClick:()=>u(Math.max(1,n-1)),className:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-white hover:shadow-sm active:scale-95 transition-all duration-200 customtext-neutral-dark font-bold text-lg",disabled:n<=1,children:"−"}),s.jsx("div",{className:"w-12 h-8 flex items-center justify-center",children:s.jsx("span",{className:"customtext-neutral-dark font-bold text-sm",children:n})}),s.jsx("button",{onClick:()=>u(Math.min(10,n+1)),className:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-white hover:shadow-sm active:scale-95 transition-all duration-200 customtext-neutral-dark font-bold text-lg",disabled:n>=10,children:"+"})]}),s.jsxs("button",{onClick:$,className:"flex-1 bg-secondary text-white py-3 px-4 rounded-xl font-bold flex items-center justify-center space-x-2 hover:bg-accent hover:customtext-primary transition-all shadow-lg active:scale-95",children:[s.jsx(A,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",children:"Solicitar Cotización"})]})]})}),s.jsx(pe,{children:Y&&s.jsx(D.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",onClick:()=>F(!1),children:s.jsxs(D.div,{initial:{scale:.8},animate:{scale:1},exit:{scale:.8},className:"relative max-w-4xl max-h-full",onClick:a=>a.stopPropagation(),children:[s.jsx("button",{onClick:()=>F(!1),className:"absolute top-4 right-4 text-white bg-black bg-opacity-50 rounded-full p-2 hover:bg-opacity-75 transition-all z-10",children:s.jsx(ue,{className:"w-6 h-6"})}),s.jsx("img",{src:d.url?`/storage/images/item/${d.url}`:"/api/cover/thumbnail/null",alt:e==null?void 0:e.name,className:"max-w-full max-h-full object-contain rounded-lg",onError:a=>{a.target.src="/api/cover/thumbnail/null"}})]})})})]})};export{fs as default};
