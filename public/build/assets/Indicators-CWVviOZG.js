var E=Object.defineProperty;var B=(o,i,c)=>i in o?E(o,i,{enumerable:!0,configurable:!0,writable:!0,value:c}):o[i]=c;var f=(o,i,c)=>B(o,typeof i!="symbol"?i+"":i,c);import{j as r}from"./AboutSimple-Cf8x2fCZ.js";import{B as T}from"./Base-DVB0gmMQ.js";import{S as I}from"./SwitchFormGroup-DXN0cwVk.js";import{T as k}from"./TextareaFormGroup-CliirJM1.js";import{r as l}from"./index-BOnQTV8N.js";import{c as C}from"./ReactAppend-QR5TrZfj.js";import{S}from"./ProductCard-D9l7c7at.js";import{B as G}from"./BasicRest-BML1C-ua.js";import{M as _}from"./Modal-xDw9ufjg.js";import{D as R}from"./DxButton-DV0H-ZcL.js";import{I as x}from"./InputFormGroup-iZIO11ZN.js";import{T as M}from"./Table-CjKaEY3W.js";import{C as O}from"./CreateReactScript-ddpUFpqR.js";import{R as w}from"./ReactAppend-Vm5G2nof.js";import{I as A}from"./ImageFormGroup-40MuGzez.js";import"./index-yBjzXJbu.js";import"./Global-CazroCzF.js";import"./tippy-react.esm-DmkRJDEW.js";import"./index-pSueRYGM.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-B6ujFmsw.js";/* empty css              */import"./Logout-BpuTJ_83.js";import"./main-B6F2O9-U.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./MenuItemContainer-DcxtOi47.js";import"./index.esm-C48oHfFw.js";import"./index-ngrFHoWO.js";import"./CanAccess-CvMo-oCB.js";import"./CardProductKatya-ncpmQ0JU.js";import"./BooleanLimit-D-OsQsek.js";/* empty css               */import"./General-apRuNwp7.js";import"./LaravelSession-Dz9cpV3l.js";class q extends G{constructor(){super(...arguments);f(this,"path","admin/indicators");f(this,"hasFiles",!0)}}const a=new q,V=()=>{const o=l.useRef(),i=l.useRef(),c=l.useRef(),n=l.useRef(),d=l.useRef(),m=l.useRef(),u=l.useRef(),p=l.useRef(),[h,b]=l.useState(!1),g=e=>{e!=null&&e.id?b(!0):b(!1),n.resetDeleteFlag&&n.resetDeleteFlag(),c.current.value=(e==null?void 0:e.id)??"",d.current.value=(e==null?void 0:e.name)??"",m.current.value=(e==null?void 0:e.description)??"",u.current.value=(e==null?void 0:e.button_text)??"",p.current.value=(e==null?void 0:e.button_link)??"",n.current.value=null,n.image.src=e!=null&&e.symbol?`/storage/images/indicator/${e.symbol}`:"",$(i.current).modal("show")},y=async e=>{e.preventDefault();const t={id:c.current.value||void 0,name:d.current.value,description:m.current.value,button_text:u.current.value,button_link:p.current.value},s=new FormData;for(const v in t)s.append(v,t[v]);const j=n.current.files[0];j&&s.append("symbol",j),n.getDeleteFlag&&n.getDeleteFlag()&&s.append("symbol_delete","DELETE"),await a.save(s)&&(n.resetDeleteFlag&&n.resetDeleteFlag(),$(o.current).dxDataGrid("instance").refresh(),$(i.current).modal("hide"))},D=async({id:e,value:t})=>{await a.boolean({id:e,field:"visible",value:t})&&$(o.current).dxDataGrid("instance").refresh()},F=async e=>{const{isConfirmed:t}=await S.fire({title:"Eliminar indicador",text:"¿Estas seguro de eliminar este indicador?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});!t||!await a.delete(e)||$(o.current).dxDataGrid("instance").refresh()},N=async e=>{const t=e.toIndex;try{await a.reorder(e.itemData.id,t)&&await e.component.refresh()}catch(s){console.error("Error reordering indicator:",s)}};return r.jsxs(r.Fragment,{children:[r.jsx(M,{gridRef:o,title:"Indicadores",rest:a,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(o.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo indicador",hint:"Nuevo indicador",onClick:()=>g()}})},rowDragging:{allowReordering:!0,onReorder:N,dropFeedbackMode:"push"},sorting:{mode:"single"},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"order_index",caption:"Orden",visible:!1,sortOrder:"asc",sortIndex:0},{dataField:"symbol",caption:"Símbolo",width:100,cellTemplate:(e,{data:t})=>{w(e,r.jsx("img",{src:`/storage/images/indicator/${t.symbol}`,style:{width:"60px",height:"60px",objectFit:"contain",objectPosition:"center",borderRadius:"4px"},onError:s=>s.target.src="/api/cover/thumbnail/null"}))}},{dataField:"name",caption:"Número",width:100},{dataField:"description",caption:"Descripción"},{dataField:"button_text",caption:"Texto del Botón",width:150},{dataField:"visible",caption:"Visible",width:80,dataType:"boolean",cellTemplate:(e,{data:t})=>{$(e).empty(),w(e,r.jsx(I,{checked:t.visible==1,onChange:()=>D({id:t.id,value:!t.visible})}))}},{caption:"Acciones",width:120,cellTemplate:(e,{data:t})=>{e.append(R({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>g(t)})),e.append(R({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>F(t.id)}))},allowFiltering:!1,allowExporting:!1}]}),r.jsx(_,{modalRef:i,title:h?"Editar indicador":"Agregar indicador",onSubmit:y,size:"lg",children:r.jsxs("div",{className:"row",id:"indicators-container",children:[r.jsx("input",{ref:c,type:"hidden"}),r.jsx("div",{className:"col-md-7 mb-3",children:r.jsx("div",{className:"card border-0 shadow-sm h-100",children:r.jsxs("div",{className:"card-body",children:[r.jsx(x,{eRef:d,label:"Título",col:"col-12",required:!0,placeholder:"Ej: 100+"}),r.jsx(k,{eRef:m,label:"Descripción",col:"col-12",rows:4,placeholder:"Descripción del indicador"})]})})}),r.jsx("div",{className:"col-md-5 mb-3",children:r.jsx("div",{className:"card border-0 shadow-sm h-100",children:r.jsxs("div",{className:"card-body d-flex flex-column",children:[r.jsx("div",{className:"flex-grow-1 d-flex align-items-center justify-content-center",children:r.jsx(A,{eRef:n,name:"symbol",label:"Imagen del símbolo",col:"col-12",required:!h,aspect:"1/1"})}),r.jsxs("small",{className:"text-muted mt-2",children:[r.jsx("i",{className:"mdi mdi-information me-1"}),"Recomendado: imagen cuadrada (1:1)"]})]})})}),r.jsx("div",{className:"col-12",children:r.jsx("div",{className:"card border-0 shadow-sm",children:r.jsxs("div",{className:"card-body",children:[r.jsxs("h6",{className:"card-title text-muted mb-3",children:[r.jsx("i",{className:"mdi mdi-link-variant me-2"}),"Botón de Acción (Opcional)"]}),r.jsxs("div",{className:"row",children:[r.jsx(x,{eRef:u,label:"Texto del Botón",col:"col-md-6",placeholder:"Ej: Ver más"}),r.jsx(x,{eRef:p,label:"Enlace del Botón",col:"col-md-6",placeholder:"Ej: /productos"})]}),r.jsxs("small",{className:"text-muted",children:[r.jsx("i",{className:"mdi mdi-information me-1"}),"El botón solo se mostrará si ambos campos están completos"]})]})})})]})})]})};O((o,i)=>{C.createRoot(o).render(r.jsx(T,{...i,title:"Indicadores",children:r.jsx(V,{...i})}))});
