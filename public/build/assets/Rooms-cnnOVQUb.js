import{j as i}from"./AboutSimple-Cf8x2fCZ.js";import{r as t}from"./index-BOnQTV8N.js";import{c as J}from"./ReactAppend-QR5TrZfj.js";import{B as V}from"./Base-GfEhzAjp.js";import{I as K}from"./ItemsRest-BelP-LFB.js";import{A as L}from"./AmenitiesRest-CxHKy3lz.js";import{T as U}from"./Table-Cv1BshIS.js";import{M as Q}from"./Modal-xDw9ufjg.js";import{I as o}from"./InputFormGroup-iZIO11ZN.js";import{S as T}from"./SelectFormGroup-X8WqJHHl.js";import{T as _}from"./TextareaFormGroup-CliirJM1.js";import{I as W}from"./ImageFormGroup-40MuGzez.js";import{S as E}from"./SwitchFormGroup-DXN0cwVk.js";import{D as C}from"./DxButton-DV0H-ZcL.js";import{C as X,F as k}from"./CreateReactScript-Bqovr-Zn.js";import{R as c}from"./ReactAppend-Vm5G2nof.js";import{S as Y}from"./ProductCard-D9l7c7at.js";import"./index-yBjzXJbu.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-B6ujFmsw.js";import"./Global-CazroCzF.js";import"./tippy-react.esm-DmkRJDEW.js";import"./index-pSueRYGM.js";/* empty css              */import"./Logout-BpuTJ_83.js";import"./main-B6F2O9-U.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./MenuItemContainer-DcxtOi47.js";import"./index.esm-C48oHfFw.js";import"./index-ngrFHoWO.js";import"./CanAccess-BlvzCYjQ.js";import"./BasicRest-BML1C-ua.js";import"./CardProductKatya-ncpmQ0JU.js";import"./BooleanLimit-D-OsQsek.js";/* empty css               */import"./General-apRuNwp7.js";import"./LaravelSession-Dz9cpV3l.js";const Z=()=>{const l=t.useRef(),a=t.useRef(),p=t.useRef(),d=t.useRef(),f=t.useRef(),x=t.useRef(),h=t.useRef(),b=t.useRef(),g=t.useRef(),v=t.useRef(),j=t.useRef(),R=t.useRef(),y=t.useRef(),N=t.useRef(),r=t.useRef(),w=t.useRef(),[A,D]=t.useState(!1),[B,G]=t.useState([]),m=new K,I=new L;t.useEffect(()=>{q()},[]);const q=async()=>{const e=await I.paginate({page:1,per_page:100,filters:JSON.stringify([["status","=",1]])});G(e.data||[])},S=e=>{var n;e!=null&&e.id?D(!0):D(!1),r.current&&r.resetDeleteFlag&&r.resetDeleteFlag(),p.current.value=(e==null?void 0:e.id)??"",d.current.value=(e==null?void 0:e.name)??"",f.current.value=(e==null?void 0:e.sku)??"",h.current.value=(e==null?void 0:e.summary)??"",b.current.value=(e==null?void 0:e.description)??"",g.current.value=(e==null?void 0:e.max_occupancy)??2,v.current.value=(e==null?void 0:e.beds_count)??1,j.current.value=(e==null?void 0:e.size_m2)??0,R.current.value=(e==null?void 0:e.total_rooms)??1,y.current.value=(e==null?void 0:e.price)??0,N.current.value=(e==null?void 0:e.discount)??0,r.current&&r.image&&(r.image.src=e!=null&&e.image?`/storage/images/item/${e.image}`:"",r.current.value=null),setTimeout(()=>{$(x.current).val((e==null?void 0:e.room_type)||"standard").trigger("change")},100);const s=((n=e==null?void 0:e.amenities)==null?void 0:n.map(F=>F.id.toString()))||[];setTimeout(()=>{$(w.current).val(s).trigger("change")},100),$(a.current).modal("show")},P=async e=>{e.preventDefault();const s={id:p.current.value||void 0,type:"room",name:d.current.value,sku:f.current.value,room_type:$(x.current).val(),summary:h.current.value,description:b.current.value,max_occupancy:g.current.value,beds_count:v.current.value,size_m2:j.current.value,total_rooms:R.current.value,price:y.current.value,discount:N.current.value},n=new FormData;for(const u in s)n.append(u,s[u]);if(r.current){const u=r.current.files[0];u&&n.append("image",u),r.getDeleteFlag&&r.getDeleteFlag()&&n.append("image_delete","DELETE")}const F=$(w.current).val()||[];n.append("amenities",JSON.stringify(F)),await m.save(n)&&(r.current&&r.resetDeleteFlag&&r.resetDeleteFlag(),$(l.current).dxDataGrid("instance").refresh(),$(a.current).modal("hide"))},z=async({id:e,value:s})=>{await m.boolean({id:e,field:"visible",value:s})&&$(l.current).dxDataGrid("instance").refresh()},H=async({id:e,value:s})=>{await m.boolean({id:e,field:"status",value:s})&&$(l.current).dxDataGrid("instance").refresh()},M=async e=>{const{isConfirmed:s}=await Y.fire({title:"Eliminar habitación",text:"¿Estás seguro de eliminar esta habitación? Se eliminarán también las reservas asociadas.",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!s||!await m.delete(e)||$(l.current).dxDataGrid("instance").refresh()},O={standard:"Estándar",suite:"Suite",deluxe:"Deluxe",presidential:"Presidencial",family:"Familiar",executive:"Ejecutiva"};return i.jsxs(i.Fragment,{children:[i.jsx(U,{gridRef:l,title:"Habitaciones",rest:m,restParams:{filters:JSON.stringify([["type","=","room"]])},toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(l.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nueva habitación",hint:"Nueva habitación",onClick:()=>S()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"image",caption:"Imagen",width:"80px",allowFiltering:!1,cellTemplate:(e,{data:s})=>{s.image?c(e,i.jsx("img",{src:`/storage/images/item/${s.image}`,alt:s.name,style:{width:"60px",height:"60px",objectFit:"cover",borderRadius:"8px"},onError:n=>n.target.src="/api/cover/thumbnail/null"})):c(e,i.jsx("div",{className:"bg-light d-flex align-items-center justify-content-center",style:{width:"60px",height:"60px",borderRadius:"8px"},children:i.jsx("i",{className:"mdi mdi-bed-double text-muted",style:{fontSize:"32px"}})}))}},{dataField:"name",caption:"Habitación",width:"20%",cellTemplate:(e,{data:s})=>{c(e,i.jsxs("div",{children:[i.jsx("strong",{children:s.name}),i.jsxs("div",{className:"small text-muted",children:[i.jsx("span",{className:"badge badge-soft-secondary",children:s.sku}),s.room_type&&i.jsx("span",{className:"badge badge-soft-info ml-1",children:O[s.room_type]||s.room_type})]})]}))}},{dataField:"max_occupancy",caption:"Capacidad",width:"15%",cellTemplate:(e,{data:s})=>{c(e,i.jsxs("div",{children:[i.jsxs("div",{className:"small",children:[i.jsx("i",{className:"mdi mdi-account-multiple text-primary mr-1"}),s.max_occupancy||0," personas"]}),i.jsxs("div",{className:"small",children:[i.jsx("i",{className:"mdi mdi-bed text-success mr-1"}),s.beds_count||0," cama",s.beds_count!==1?"s":""]}),s.size_m2>0&&i.jsxs("div",{className:"small",children:[i.jsx("i",{className:"mdi mdi-ruler-square text-info mr-1"}),s.size_m2," m²"]})]}))}},{dataField:"total_rooms",caption:"Disponibles",width:"10%",cellTemplate:(e,{data:s})=>{c(e,i.jsxs("div",{className:"text-center",children:[i.jsx("h5",{className:"mb-0",children:i.jsx("span",{className:"badge badge-soft-primary",children:s.total_rooms||0})}),i.jsx("small",{className:"text-muted",children:"habitaciones"})]}))}},{dataField:"price",caption:"Precio/Noche",width:"12%",cellTemplate:(e,{data:s})=>{c(e,i.jsxs("div",{children:[i.jsxs("strong",{className:"text-success",children:["S/ ",Number(s.price||0).toFixed(2)]}),s.discount>0&&i.jsx("div",{className:"small",children:i.jsxs("span",{className:"badge badge-soft-danger",children:["-",s.discount,"%"]})})]}))}},{dataField:"visible",caption:"Visible",dataType:"boolean",cellTemplate:(e,{data:s})=>{$(e).empty(),c(e,i.jsx(E,{checked:s.visible==1,onChange:()=>z({id:s.id,value:!s.visible})}))}},{dataField:"status",caption:"Activo",dataType:"boolean",cellTemplate:(e,{data:s})=>{$(e).empty(),c(e,i.jsx(E,{checked:s.status==1,onChange:()=>H({id:s.id,value:!s.status})}))}},{caption:"Acciones",cellTemplate:(e,{data:s})=>{e.css("text-overflow","unset"),e.append(C({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>S(s)})),e.append(C({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>M(s.id)}))},allowFiltering:!1,allowExporting:!1}].filter(e=>!(!e||e.dataField==="image"&&!k.has("items","image")))}),i.jsxs(Q,{modalRef:a,title:A?"Editar habitación":"Nueva habitación",onSubmit:P,size:"xl",children:[i.jsx("input",{ref:p,type:"hidden"}),i.jsxs("div",{className:"row",id:"rooms-container",children:[k.has("items","image")&&i.jsx("div",{className:"col-md-12 mb-3",children:i.jsx(W,{eRef:r,name:"image",label:"Imagen Principal",col:"col-md-12",aspect:16/9})}),i.jsx(o,{eRef:d,label:"Nombre de la Habitación",col:"col-md-6",required:!0,placeholder:"Ej: Habitación Doble Standard"}),i.jsx(o,{eRef:f,label:"SKU",col:"col-md-3",required:!0,placeholder:"Ej: ROOM-001"}),i.jsxs("div",{className:"col-md-3",children:[i.jsxs("label",{className:"form-label",children:["Tipo de Habitación ",i.jsx("span",{className:"text-danger",children:"*"})]}),i.jsxs(T,{eRef:x,dropdownParent:"#rooms-container",required:!0,children:[i.jsx("option",{value:"standard",children:"Estándar"}),i.jsx("option",{value:"suite",children:"Suite"}),i.jsx("option",{value:"deluxe",children:"Deluxe"}),i.jsx("option",{value:"presidential",children:"Presidencial"}),i.jsx("option",{value:"family",children:"Familiar"}),i.jsx("option",{value:"executive",children:"Ejecutiva"})]})]}),i.jsx(_,{eRef:h,label:"Resumen",col:"col-md-12",rows:2,placeholder:"Breve descripción..."}),i.jsx(_,{eRef:b,label:"Descripción Completa",col:"col-md-12",rows:4,placeholder:"Descripción detallada de la habitación..."}),i.jsx(o,{eRef:g,label:"Capacidad Máxima",type:"number",col:"col-md-3",required:!0,min:"1",max:"10",specification:"Número máximo de huéspedes"}),i.jsx(o,{eRef:v,label:"Número de Camas",type:"number",col:"col-md-3",required:!0,min:"1",max:"5"}),i.jsx(o,{eRef:j,label:"Tamaño (m²)",type:"number",col:"col-md-3",min:"0",step:"0.1"}),i.jsx(o,{eRef:R,label:"Total de Habitaciones",type:"number",col:"col-md-3",required:!0,min:"1",specification:"Cantidad disponible de este tipo"}),i.jsx(o,{eRef:y,label:"Precio por Noche (S/)",type:"number",col:"col-md-6",required:!0,min:"0",step:"0.01"}),i.jsx(o,{eRef:N,label:"Descuento (%)",type:"number",col:"col-md-6",min:"0",max:"100",step:"0.01"}),i.jsxs("div",{className:"col-md-12 mt-3",children:[i.jsx("label",{className:"form-label",children:"Amenidades"}),i.jsx(T,{eRef:w,dropdownParent:"#rooms-container",multiple:!0,children:B.map(e=>i.jsx("option",{value:e.id,children:e.name},e.id))}),i.jsx("small",{className:"text-muted",children:"Selecciona las amenidades incluidas en esta habitación"})]})]})]})]})};X((l,a)=>{J.createRoot(l).render(i.jsx(V,{...a,title:"Habitaciones",children:i.jsx(Z,{...a})}))});
