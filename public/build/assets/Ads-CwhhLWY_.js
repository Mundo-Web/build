var S=Object.defineProperty;var _=(n,r,c)=>r in n?S(n,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):n[r]=c;var b=(n,r,c)=>_(n,typeof r!="symbol"?r+"":r,c);import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as t}from"./index-BOnQTV8N.js";import{c as B}from"./ReactAppend-QR5TrZfj.js";import{B as M}from"./Base-B7OhQLEN.js";import{C as G}from"./CreateReactScript-d60iGIqA.js";import{T as I}from"./Table-hR1LHIgy.js";import{I as o}from"./InputFormGroup-iZIO11ZN.js";import{R as m}from"./ReactAppend-Vm5G2nof.js";import{D as k}from"./DxButton-DV0H-ZcL.js";import{S as D}from"./SwitchFormGroup-DXN0cwVk.js";import{I as A}from"./ImageFormGroup-40MuGzez.js";import{S as V}from"./CartKuchara-D9l7c7at.js";import{B as z}from"./BasicRest-BML1C-ua.js";import"./server.browser-Bf4gQIc7.js";import{T as L}from"./TextareaFormGroup-CliirJM1.js";import{M as O}from"./Modal-xDw9ufjg.js";import"./index-yBjzXJbu.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-B6ujFmsw.js";import"./Global-Bz6gVLc5.js";import"./tippy-react.esm-DmkRJDEW.js";import"./index-pSueRYGM.js";/* empty css              */import"./Logout-BpuTJ_83.js";import"./main-B6F2O9-U.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./MenuItemContainer-DcxtOi47.js";import"./index.esm-C48oHfFw.js";import"./index-ngrFHoWO.js";import"./CanAccess-D2C6GWbm.js";/* empty css               */import"./General-CE1RDd44.js";import"./LaravelSession-Dz9cpV3l.js";import"./BooleanLimit-D-OsQsek.js";import"./CardProductKatya-ncpmQ0JU.js";class W extends z{constructor(){super(...arguments);b(this,"path","admin/ads");b(this,"hasFiles",!0)}}const p=new W,q=({})=>{const n=t.useRef(),r=t.useRef(),c=t.useRef(),f=t.useRef(),u=t.useRef(),l=t.useRef(),x=t.useRef(),h=t.useRef(),v=t.useRef(),j=t.useRef(),g=t.useRef(),d=t.useRef(),[F,N]=t.useState(!1),R=s=>{s!=null&&s.id?N(!0):N(!1),l.resetDeleteFlag&&l.resetDeleteFlag(),c.current.value=(s==null?void 0:s.id)??"",f.current.value=(s==null?void 0:s.name)??"",u.current.value=(s==null?void 0:s.description)??"",l.image.src=`/api/ads/media/${s==null?void 0:s.image}`,l.current.value=null,x.current.value=(s==null?void 0:s.date_begin)??"",h.current.value=(s==null?void 0:s.date_end)??"",v.current.value=(s==null?void 0:s.seconds)??0,j.current.value=(s==null?void 0:s.link)??"",g.current.value=(s==null?void 0:s.button_text)??"Ver más",s!=null&&s.invasivo?$(d.current).prop("checked",!1).trigger("click"):$(d.current).prop("checked",!0).trigger("click"),$(r.current).modal("show")},E=async s=>{s.preventDefault();const i={id:c.current.value||void 0,name:f.current.value,description:u.current.value,date_begin:x.current.value,date_end:h.current.value,seconds:v.current.value||0,link:j.current.value,button_text:g.current.value||"Ver más",invasivo:d.current.checked?1:0},a=new FormData;for(const y in i)a.append(y,i[y]);const w=l.current.files[0];w&&a.append("image",w),l.getDeleteFlag&&l.getDeleteFlag()&&a.append("image_delete","DELETE"),await p.save(a)&&(l.resetDeleteFlag&&l.resetDeleteFlag(),$(n.current).dxDataGrid("instance").refresh(),$(r.current).modal("hide"))},T=async({id:s,value:i})=>{await p.boolean({id:s,field:"visible",value:i})&&$(n.current).dxDataGrid("instance").refresh()},C=async s=>{const{isConfirmed:i}=await V.fire({title:"Eliminar anuncio",text:"¿Estás seguro de eliminar este anuncio?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!i||!await p.delete(s)||$(n.current).dxDataGrid("instance").refresh()};return e.jsxs(e.Fragment,{children:[e.jsx(I,{gridRef:n,title:"Anuncios",rest:p,toolBar:s=>{s.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(n.current).dxDataGrid("instance").refresh()}}),s.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo anuncio",hint:"Nuevo anuncio",onClick:()=>R()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"image",caption:"Imagen",width:"90px",allowFiltering:!1,cellTemplate:(s,{data:i})=>{m(s,e.jsx("div",{className:"d-flex align-items-center justify-content-center",children:e.jsx("img",{src:`/api/ads/media/${i.image}`,style:{width:"80px",height:"80px",objectFit:"cover",objectPosition:"center"}})}))}},{dataField:"name",caption:"Contenido",width:"35%",cellTemplate:(s,{data:i})=>{m(s,i.name||i.description?e.jsxs("div",{style:{width:"100%"},children:[e.jsx("p",{className:"mb-1 font-weight-bold",style:{fontSize:"14px"},children:i.name}),e.jsx("p",{className:"mb-0 text-muted",style:{overflow:"hidden",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,fontSize:"12px",lineHeight:"1.4"},children:i.description})]}):e.jsx("span",{className:"text-muted font-italic",children:"- Sin contenido -"}))}},{dataField:"date_begin",caption:"Configuración",width:"25%",cellTemplate:(s,{data:i})=>{m(s,e.jsxs("div",{className:"small",children:[e.jsxs("div",{className:"d-flex align-items-center mb-1",children:[e.jsx("i",{className:"fas fa-calendar-alt text-primary mr-2",style:{width:"14px"}}),i.date_begin&&i.date_end?e.jsxs("span",{children:[moment(i.date_begin).format("DD/MM")," - ",moment(i.date_end).format("DD/MM/YY")]}):e.jsx("span",{className:"text-success",children:"Siempre visible"})]}),e.jsxs("div",{className:"d-flex align-items-center mb-1",children:[e.jsx("i",{className:"fas fa-clock text-info mr-2",style:{width:"14px"}}),e.jsx("span",{children:i.seconds>0?`${i.seconds}s de delay`:"Sin delay"})]}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:`fas fa-${i.invasivo?"exclamation-triangle text-warning":"check-circle text-success"} mr-2`,style:{width:"14px"}}),e.jsx("span",{children:i.invasivo?"Invasivo":"Normal"})]})]}))}},{dataField:"link",caption:"Enlace",cellTemplate:(s,{data:i})=>{m(s,i.link?e.jsxs("div",{children:[e.jsxs("a",{href:i.link,target:"_blank",rel:"noopener noreferrer",className:"text-primary d-block text-truncate",style:{maxWidth:"200px"},children:[e.jsx("i",{className:"fas fa-external-link-alt mr-1"}),i.link]}),i.button_text&&e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-mouse-pointer mr-1"}),'"',i.button_text,'"']})]}):e.jsx("span",{className:"text-muted font-italic",children:"- Sin enlace -"}))}},{dataField:"visible",caption:"Visible",dataType:"boolean",width:"90px",alignment:"center",cellTemplate:(s,{data:i})=>{m(s,e.jsx(D,{checked:i.visible,onChange:a=>T({id:i.id,value:a.target.checked})}))}},{caption:"Acciones",width:"100px",alignment:"center",cellTemplate:(s,{data:i})=>{s.css("text-overflow","unset"),s.append(k({className:"btn btn-xs btn-soft-primary mr-1",title:"Editar",icon:"fa fa-pen",onClick:()=>R(i)})),s.append(k({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>C(i.id)}))},allowFiltering:!1,allowExporting:!1}]}),e.jsx(O,{modalRef:r,title:F?"Editar anuncio":"Nuevo anuncio",onSubmit:E,size:"lg",children:e.jsxs("div",{className:"row",id:"principal-container",children:[e.jsx("input",{ref:c,type:"hidden"}),e.jsxs("div",{className:"col-md-5",children:[e.jsx(A,{eRef:l,name:"image",label:"Imagen del anuncio",col:"col-12",aspect:4/5,fit:"cover",required:!0}),e.jsxs("div",{className:"alert alert-light border small mt-2",children:[e.jsx("i",{className:"fas fa-info-circle text-info mr-1"}),"Tamaño recomendado: 800x1000px (4:5)"]})]}),e.jsxs("div",{className:"col-md-7",children:[e.jsxs("div",{className:"card border-0 shadow-sm mb-3",children:[e.jsx("div",{className:"card-header bg-light py-2",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-align-left mr-2"}),"Contenido"]})}),e.jsxs("div",{className:"card-body py-3",children:[e.jsx(o,{eRef:f,label:"Título",placeholder:"Ej: ¡Gran Oferta!"}),e.jsx(L,{eRef:u,label:"Descripción",rows:3,placeholder:"Descripción del anuncio..."})]})]}),e.jsxs("div",{className:"card border-0 shadow-sm mb-3",children:[e.jsx("div",{className:"card-header bg-light py-2",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-link mr-2"}),"Enlace"]})}),e.jsx("div",{className:"card-body py-3",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-7",children:e.jsx(o,{eRef:j,label:"URL de destino",placeholder:"https://ejemplo.com/oferta"})}),e.jsx("div",{className:"col-md-5",children:e.jsx(o,{eRef:g,label:"Texto del botón",placeholder:"Ver más"})})]})})]}),e.jsxs("div",{className:"card border-0 shadow-sm",children:[e.jsx("div",{className:"card-header bg-light py-2",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-cog mr-2"}),"Configuración"]})}),e.jsxs("div",{className:"card-body py-3",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsx(o,{eRef:x,label:"Mostrar desde",type:"date"})}),e.jsx("div",{className:"col-md-6",children:e.jsx(o,{eRef:h,label:"Mostrar hasta",type:"date"})})]}),e.jsx(o,{eRef:v,label:"Delay de aparición (segundos)",type:"number",col:"col-12",placeholder:"0 = aparece inmediatamente"}),e.jsx("div",{className:"mt-2",children:e.jsx(D,{eRef:d,label:"Anuncio invasivo",specification:"No se puede cerrar haciendo clic fuera del modal"})})]})]})]})]})})]})};G((n,r)=>{B.createRoot(n).render(e.jsx(M,{...r,title:"Pop-ups",children:e.jsx(q,{...r})}))});
