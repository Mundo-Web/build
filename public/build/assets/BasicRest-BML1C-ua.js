var p=Object.defineProperty;var l=(h,e,o)=>e in h?p(h,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):h[e]=o;var i=(h,e,o)=>l(h,typeof e!="symbol"?e+"":e,o);import{m as c}from"./main-B6F2O9-U.js";import{t as n}from"./CardProductKatya-ncpmQ0JU.js";import{B as d}from"./BooleanLimit-D-OsQsek.js";class w{constructor(){i(this,"is_use_notify",!0);i(this,"path",null);i(this,"hasFiles",!1);i(this,"controller",null);i(this,"booleanLimitKey",null);i(this,"resolveBooleanLimitKey",()=>{if(this.booleanLimitKey)return this.booleanLimitKey;if(!this.path)return null;const e=this.path.split("/").filter(Boolean);if(e.length===0)return null;const o=e[e.length-1];return o?o.replace(/-/g,"_"):null});i(this,"simpleGet",async(e,o,t=!0)=>{try{const{status:r,result:s}=await c.Fetch(e,o);if(!r)throw new Error((s==null?void 0:s.message)||"Ocurrio un error inesperado");return s.data??!0}catch(r){return t&&n.error("¡Error!",{description:r.message,duration:3e3,position:"bottom-center",richColors:!0}),null}});i(this,"paginate",async e=>{this.controller.abort("Nothing"),this.controller=new AbortController;const o=this.controller.signal;return await(await fetch(`/api/${this.path}/paginate`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-Xsrf-Token":decodeURIComponent(c.Cookies.get("XSRF-TOKEN"))},body:JSON.stringify(e),signal:o})).json()});i(this,"save",async(e,o=()=>{})=>{try{let t=!1,r={};if(this.hasFiles){const s=await fetch(`/api/${this.path}`,{method:"POST",headers:{"X-Xsrf-Token":decodeURIComponent(c.Cookies.get("XSRF-TOKEN"))},body:e});t=s.ok,r=JSON.parseable(await s.text())}else{const s=await c.Fetch(`/api/${this.path}`,{method:"POST",body:JSON.stringify(e)});t=s.status,r=s.result}if(!t)throw new Error((r==null?void 0:r.message)||"Ocurrio un error inesperado");return this.is_use_notify&&n.success("¡Excelente!",{description:r.message,duration:3e3,position:"bottom-center",richColors:!0}),o==null||o(),(r==null?void 0:r.data)??!0}catch(t){return n.error("¡Error!",{description:t.message,duration:3e3,position:"bottom-center",richColors:!0}),null}});i(this,"status",async({id:e,status:o})=>{try{const{status:t,result:r}=await c.Fetch(`/api/${this.path}/status`,{method:"PATCH",body:JSON.stringify({id:e,status:o})});if(!t)throw new Error((r==null?void 0:r.message)??"Ocurrio un error inesperado");return n.success("¡Excelente!",{description:r.message,duration:3e3,position:"bottom-center",richColors:!0}),!0}catch(t){return n.error("¡Error!",{description:t.message,duration:3e3,position:"bottom-center",richColors:!0}),!1}});i(this,"boolean",async({id:e,field:o,value:t})=>{var r;try{const{status:s,result:a}=await c.Fetch(`/api/${this.path}/boolean`,{method:"PATCH",body:JSON.stringify({id:e,field:o,value:t})}),u=this.resolveBooleanLimitKey();if(u&&((r=a==null?void 0:a.data)!=null&&r.limit)&&d.updateFromServer(u,a.data),!s)throw new Error((a==null?void 0:a.message)??"Ocurrio un error inesperado");return n.success("¡Excelente!",{description:a.message,duration:3e3,position:"bottom-center",richColors:!0}),(a==null?void 0:a.data)??!0}catch(s){return n.error("¡Error!",{description:s.message,duration:3e3,position:"bottom-center",richColors:!0}),!1}});i(this,"delete",async e=>{try{const{status:o,result:t}=await c.Fetch(`/api/${this.path}/${e}`,{method:"DELETE"});if(!o)throw new Error((t==null?void 0:t.message)??"Ocurrio un error inesperado");return n.success("¡Excelente!",{description:t.message,duration:3e3,position:"bottom-center",richColors:!0}),!0}catch(o){return n.error("¡Error!",{description:o.message,duration:3e3,position:"bottom-center",richColors:!0}),!1}});i(this,"get",async(e={},o=[])=>{try{let t=`/api/${this.path}`;if(typeof e=="string"||typeof e=="number")t+=`/${e}`;else if(typeof e=="object"&&Object.keys(e).length>0){const s=new URLSearchParams(e).toString();t+=`?${s}`}if(o.length>0){const s=o.join(",");t+=`${t.includes("?")?"&":"?"}with=${s}`}const r=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","X-Xsrf-Token":decodeURIComponent(c.Cookies.get("XSRF-TOKEN"))}});if(!r.ok)throw new Error(`Error ${r.status}: ${r.statusText}`);return await r.json()}catch(t){return n.error("¡Error!",{description:t.message,duration:3e3,position:"bottom-center",richColors:!0}),null}});i(this,"reorder",async(e,o)=>{try{const t=await fetch(`/api/${this.path}/${e}/reorder`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json","X-Xsrf-Token":decodeURIComponent(c.Cookies.get("XSRF-TOKEN"))},body:JSON.stringify({order_index:o})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();return this.is_use_notify&&r.success&&n.success("¡Excelente!",{description:r.message,duration:3e3,position:"bottom-center",richColors:!0}),r}catch(t){return this.is_use_notify&&n.error("¡Error!",{description:t.message,duration:3e3,position:"bottom-center",richColors:!0}),console.error("Error reordering:",t),!1}});this.controller=new AbortController}}export{w as B};
