var k=Object.defineProperty;var B=(r,i,a)=>i in r?k(r,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[i]=a;var w=(r,i,a)=>B(r,typeof i!="symbol"?i+"":i,a);import{j as t}from"./AboutSimple-Cf8x2fCZ.js";import{r as o}from"./index-BOnQTV8N.js";import{c as E}from"./ReactAppend-QR5TrZfj.js";import{C as A}from"./CreateReactScript-ddpUFpqR.js";import{B as M}from"./Base-DVB0gmMQ.js";import{T as G}from"./Table-CjKaEY3W.js";import{M as I}from"./Modal-xDw9ufjg.js";import{D as g}from"./DxButton-DV0H-ZcL.js";import{S as q}from"./SwitchFormGroup-DXN0cwVk.js";import{R as O}from"./ReactAppend-Vm5G2nof.js";import{S as P}from"./ProductCard-D9l7c7at.js";import{B as J}from"./BasicRest-BML1C-ua.js";import{I as p}from"./InputFormGroup-iZIO11ZN.js";import{T as _}from"./TextareaFormGroup-CliirJM1.js";import"./index-yBjzXJbu.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-B6ujFmsw.js";import"./index.esm-C48oHfFw.js";import"./index-ngrFHoWO.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./main-B6F2O9-U.js";import"./Global-CazroCzF.js";/* empty css               *//* empty css              */import"./General-apRuNwp7.js";import"./LaravelSession-Dz9cpV3l.js";import"./CanAccess-CvMo-oCB.js";import"./BooleanLimit-D-OsQsek.js";import"./tippy-react.esm-DmkRJDEW.js";import"./index-pSueRYGM.js";import"./Logout-BpuTJ_83.js";import"./MenuItemContainer-DcxtOi47.js";import"./CardProductKatya-ncpmQ0JU.js";class X extends J{constructor(){super(...arguments);w(this,"path","admin/job-applications");w(this,"hasFiles",!0)}}const u=new X,z=()=>{const r=o.useRef(),i=o.useRef(),a=o.useRef(),f=o.useRef(),x=o.useRef(),h=o.useRef(),b=o.useRef(),v=o.useRef(),j=o.useRef(),[y,R]=o.useState(!1),[c,F]=o.useState(null),[l,D]=o.useState(!1),C=(e,s=!1)=>{D(s),e!=null&&e.id?R(!0):R(!1),a.current.value=(e==null?void 0:e.id)??"",f.current.value=(e==null?void 0:e.name)??"",x.current.value=(e==null?void 0:e.email)??"",h.current.value=(e==null?void 0:e.phone)??"",b.current.value=(e==null?void 0:e.position)??"",v.current.value=(e==null?void 0:e.message)??"",j.current.value=null,F((e==null?void 0:e.cv)??null),$(i.current).modal("show")},T=async e=>{e.preventDefault();const s={id:a.current.value||void 0,name:f.current.value,email:x.current.value,phone:h.current.value,position:b.current.value,message:v.current.value},n=new FormData;for(const d in s)s[d]!==void 0&&s[d]!==null&&n.append(d,s[d]);const m=j.current.files[0];m&&n.append("cv",m),await u.save(n)&&($(r.current).dxDataGrid("instance").refresh(),$(i.current).modal("hide"))},V=async({id:e,value:s})=>{await u.boolean({id:e,field:"reviewed",value:s})&&$(r.current).dxDataGrid("instance").refresh()},S=async e=>{const{isConfirmed:s}=await P.fire({title:"¿Estás seguro?",text:"¡No podrás revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminarlo",cancelButtonText:"Cancelar"});!s||!await u.delete(e.id)||$(r.current).dxDataGrid("instance").refresh()},N=e=>{e&&window.open(`/api/job-applications/media/${e}`,"_blank")};return t.jsxs(t.Fragment,{children:[t.jsx(G,{gridRef:r,title:"Solicitudes de Trabajo",rest:u,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(r.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Agregar solicitud",hint:"Agregar solicitud",onClick:()=>C()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"name",caption:"Nombre",width:"20%"},{dataField:"email",caption:"Email",width:"18%"},{dataField:"phone",caption:"Teléfono",width:"12%"},{dataField:"position",caption:"Posición",width:"15%"},{dataField:"message",caption:"Mensaje",width:"20%",cellTemplate:(e,{data:s})=>{const n=s.message||"",m=n.length>50?n.substring(0,50)+"...":n;e.text(m),n.length>50&&e.attr("title",n)}},{dataField:"cv",caption:"CV",width:"80px",allowFiltering:!1,cellTemplate:(e,{data:s})=>{s.cv?e.append(g({className:"btn btn-xs btn-soft-info",title:"Descargar CV",icon:"fa fa-download",onClick:()=>N(s.cv)})):e.text("Sin CV")}},{dataField:"reviewed",caption:"Revisado",dataType:"boolean",width:"100px",cellTemplate:(e,{data:s})=>{$(e).empty(),O(e,t.jsx(q,{checked:s.reviewed==1,onChange:()=>V({id:s.id,value:!s.reviewed})}))}},{dataField:"created_at",caption:"Fecha",dataType:"date",width:"120px",format:"dd/MM/yyyy"},{caption:"Acciones",width:"100px",cellTemplate:(e,{data:s})=>{e.css("text-overflow","unset"),e.append(g({className:"btn btn-xs btn-soft-info",title:"Ver detalles",icon:"fa fa-eye",onClick:()=>C(s,!0)})),e.append(g({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>S(s)}))},allowFiltering:!1,allowExporting:!1}]}),t.jsxs(I,{modalRef:i,title:l?"Ver solicitud":y?"Editar solicitud":"Agregar solicitud",onSubmit:T,hideFooter:l,children:[t.jsx("input",{ref:a,type:"hidden"}),t.jsxs("div",{className:"row",children:[t.jsx("div",{className:"col-md-6",children:t.jsx(p,{eRef:f,label:"Nombre completo",required:!0,disabled:l})}),t.jsx("div",{className:"col-md-6",children:t.jsx(p,{eRef:x,label:"Email",type:"email",required:!0,disabled:l})}),t.jsx("div",{className:"col-md-6",children:t.jsx(p,{eRef:h,label:"Teléfono",type:"tel",disabled:l})}),t.jsx("div",{className:"col-md-6",children:t.jsx(p,{eRef:b,label:"Posición deseada",disabled:l})}),t.jsx("div",{className:"col-md-12",children:t.jsx(_,{eRef:v,label:"Mensaje",rows:3,disabled:l})}),!l&&t.jsx("div",{className:"col-md-12",children:t.jsxs("div",{className:"mb-3",children:[t.jsxs("label",{className:"form-label",children:["CV (PDF, DOC, DOCX)",c&&t.jsxs("span",{className:"text-muted ms-2",children:["(Actual: ",c,")"]})]}),t.jsx("input",{ref:j,type:"file",className:"form-control",accept:".pdf,.doc,.docx"})]})}),l&&c&&t.jsx("div",{className:"col-md-12",children:t.jsxs("div",{className:"mb-3",children:[t.jsxs("label",{className:"form-label d-flex justify-content-between align-items-center",children:[t.jsx("span",{children:"Curriculum Vitae"}),t.jsxs("button",{type:"button",className:"btn btn-sm btn-primary",onClick:()=>N(c),children:[t.jsx("i",{className:"fa fa-download me-2"}),"Descargar CV"]})]}),t.jsx("div",{className:"border rounded",style:{height:"600px"},children:t.jsx("iframe",{src:`/api/job-applications/media/${c}`,className:"w-100 h-100",style:{border:"none"},title:"Vista previa del CV"})})]})}),l&&t.jsx("div",{className:"col-md-12 text-end",children:t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>$(i.current).modal("hide"),children:"Cerrar"})})]})]})]})};A((r,i)=>{E.createRoot(r).render(t.jsx(M,{...i,title:"Solicitudes de Trabajo",children:t.jsx(z,{...i})}))});
