var e=Object.defineProperty,a=(a,s,t)=>((a,s,t)=>s in a?e(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t)(a,"symbol"!=typeof s?s+"":s,t);import{c as s,j as t,r}from"./vendor-react-CZUvQwNQ.js";import{B as i}from"./Base-DiYyKRe5.js";import{S as l}from"./CartKuchara-C7vqSevl.js";import{B as o}from"./BasicRest-BMJgRso_.js";import{B as n}from"./BasicEditing-BCg7nE-w.js";import{I as c}from"./ImageFormGroup-DlJufE2S.js";import{I as d}from"./InputFormGroup-BuXn3s3l.js";import{Q as m}from"./QuillFormGroup-DwUYKWvB.js";import{S as p}from"./SelectAPIFormGroup-Dmb18ATV.js";import{M as u}from"./Modal-MmI0jF6v.js";import{T as g}from"./Table-DXr0fbw5.js";import{D as h}from"./DxButton-C6FT_beP.js";import{C as j,F as x}from"./CreateReactScript-CQzKJRc_.js";import{h as b}from"./html2string-Xrf4P-xU.js";import{R as f}from"./ReactAppend-Db2K6xCH.js";import{S as v}from"./SetSelectValue-DCHQOIKz.js";import{T as N}from"./TextareaFormGroup-dfKTDx8M.js";import{G as R}from"./Footer-DAm0kDL9.js";import"./vendor-swiper-Cr_RrIb_.js";import"./TippyButton-Gia9IjJq.js";import"./Logout-D6byb_Ua.js";import"./MenuItemContainer-BaCqn8PU.js";import"./Menu-EkCXeLHq.js";import"./OpenPayCardModal-BHkRoVZ6.js";import"./BooleanLimit-q2Ad9fGY.js";import"./ArrayDetails2Object-BtdyATqd.js";import"./em-D8U_Sxjb.js";import"./HtmlContent-DI-wF5u8.js";import"./WebDetailsRest-D9dWQLpR.js";import"./General-ClVW7qxN.js";import"./LaravelSession-ByQnaUD3.js";const y=new class extends o{constructor(){super(...arguments),a(this,"path","admin/posts"),a(this,"hasFiles",!0)}},w=({details:e})=>{const a=r.useRef(),s=r.useRef(),i=r.useRef(),o=r.useRef(),j=r.useRef(),w=r.useRef(),F=r.useRef(),_=r.useRef(),S=r.useRef(),C=r.useRef(),D=r.useRef(),B=r.useRef(),E=r.useRef(),T=r.useRef(),[k,I]=r.useState(!1),[M,P]=r.useState(""),[q,L]=r.useState(0),[G,O]=r.useState(0),A=e=>{I(!!e?.id),_.resetDeleteFlag&&_.resetDeleteFlag(),i.current.value=e?.id??"",o.current.value=e?.name??"",v(j.current,e?.category?.id,e?.category?.name),w.editor.root.innerHTML=e?.description??"",_.image.src=e?.image?`/storage/images/post/${e.image}`:"",_.current.value=null,v(F.current,e?.tags??[],"id","name"),S.current.value=e?.post_date??moment().format("YYYY-MM-DD"),C.current.value=e?.slug??"",D.current.value=e?.meta_title??"",B.current.value=e?.meta_description??"",E.current.value=e?.meta_keywords??"",T.current.value=e?.canonical_url??"",P(e?.slug??""),L((e?.meta_title??"").length),O((e?.meta_description??"").length),$(s.current).modal("show")},H=e=>x.has("posts",e)&&x.get("posts",e)?.required;return t.jsxs(t.Fragment,{children:[t.jsx(g,{gridRef:a,title:t.jsx(n,{correlative:"blog",details:e}),rest:y,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(a.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo registro",hint:"Nuevo registro",onClick:()=>A()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"category.name",caption:"Categoría"},{dataField:"name",caption:"Título",cellTemplate:(e,{data:a})=>{f(e,t.jsxs(t.Fragment,{children:[a.name,t.jsx("br",{}),a.tags?.map((e,a)=>t.jsx("span",{className:"badge badge-soft-success me-1",children:e.name},a))]}))}},{dataField:"image",caption:"Imagen",width:"90px",cellTemplate:(e,{data:a})=>{f(e,t.jsx("img",{src:`/storage/images/post/${a.image}`,style:{width:"80px",height:"48px",objectFit:"cover",objectPosition:"center",borderRadius:"4px"},onError:e=>e.target.src="/api/cover/thumbnail/null"}))}},{caption:"Acciones",cellTemplate:(e,{data:s})=>{e.append(h({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>A(s)})),e.append(h({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>(async e=>{const{isConfirmed:s}=await l.fire({title:"Eliminar registro",text:"¿Estas seguro de eliminar este registro?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});if(!s)return;await y.delete(e)&&$(a.current).dxDataGrid("instance").refresh()})(s.id)}))},allowFiltering:!1,allowExporting:!1}]}),t.jsxs(u,{modalRef:s,title:k?"Editar post":"Agregar post",onSubmit:async e=>{e.preventDefault();const t={id:i.current.value||void 0,name:o.current.value,category_id:j.current.value,summary:b(w.current.value),description:w.current.value,tags:$(F.current).val(),post_date:S.current.value,slug:C.current.value,meta_title:D.current.value,meta_description:B.current.value,meta_keywords:E.current.value,canonical_url:T.current.value},r=new FormData;for(const a in t)r.append(a,t[a]);const l=_.current.files[0];l&&r.append("image",l),_.getDeleteFlag&&_.getDeleteFlag()&&r.append("image_delete","DELETE");await y.save(r)&&(_.resetDeleteFlag&&_.resetDeleteFlag(),$(a.current).dxDataGrid("instance").refresh(),$(s.current).modal("hide"))},size:"lg",children:[t.jsx("input",{ref:i,type:"hidden"}),t.jsxs("div",{id:"posts-container",children:[t.jsxs("ul",{className:"nav nav-pills nav-justified mb-4",role:"tablist",style:{backgroundColor:"#f8f9fa",borderRadius:"8px",padding:"4px",border:"1px solid #e9ecef"},children:[t.jsx("li",{className:"nav-item",role:"presentation",children:t.jsxs("button",{className:"nav-link active",id:"basic-info-tab","data-bs-toggle":"pill","data-bs-target":"#basic-info",type:"button",role:"tab","aria-controls":"basic-info","aria-selected":"true",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[t.jsx("i",{className:"fas fa-info-circle me-2"}),"Información Básica"]})}),t.jsx("li",{className:"nav-item",role:"presentation",children:t.jsxs("button",{className:"nav-link",id:"multimedia-tab","data-bs-toggle":"pill","data-bs-target":"#multimedia",type:"button",role:"tab","aria-controls":"multimedia","aria-selected":"false",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[t.jsx("i",{className:"fas fa-images me-2"}),"Multimedia"]})}),t.jsx("li",{className:"nav-item",role:"presentation",children:t.jsxs("button",{className:"nav-link",id:"seo-tab","data-bs-toggle":"pill","data-bs-target":"#seo",type:"button",role:"tab","aria-controls":"seo","aria-selected":"false",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[t.jsx("i",{className:"fas fa-search me-2"}),"SEO"]})})]}),t.jsxs("div",{className:"tab-content",children:[t.jsx("div",{className:"tab-pane fade show active",id:"basic-info",role:"tabpanel","aria-labelledby":"basic-info-tab",children:t.jsx("div",{className:"row g-3",children:t.jsx("div",{className:"col-12",children:t.jsxs("div",{className:"card border-0 shadow-sm",children:[t.jsx("div",{className:"card-header bg-light",children:t.jsxs("h6",{className:"mb-0",children:[t.jsx("i",{className:"fas fa-tag me-2 text-primary"}),"Identificación"]})}),t.jsx("div",{className:"card-body",children:t.jsxs("div",{className:"row",children:[x.has("posts","name")&&t.jsx("div",{className:"col-md-12",children:t.jsx(d,{eRef:o,label:"Título del Post",placeholder:"Ej: Cómo mejorar tu SEO",required:H("name")})}),x.has("posts","post_date")&&t.jsx("div",{className:"col-md-6",children:t.jsx(d,{eRef:S,label:"Fecha de publicación",type:"date",required:H("post_date")})}),x.has("posts","category_id")&&t.jsx("div",{className:"col-md-6",children:t.jsx(p,{eRef:j,searchAPI:"/api/admin/blog-categories/paginate",searchBy:"name",label:"Categoría",required:H("category_id"),dropdownParent:"#posts-container"})}),x.has("posts","summary")&&t.jsx("div",{className:"col-12",children:t.jsx(N,{eRef:w,label:"Resumen",rows:2,placeholder:"Resumen breve del post...",required:H("summary")})}),x.has("posts","is_tags")&&t.jsx("div",{className:"col-md-12",children:t.jsx(p,{id:"tags",eRef:F,searchAPI:"/api/admin/post-tags/paginate",searchBy:"name",label:"Tags",dropdownParent:"#posts-container",tags:!0,multiple:!0})}),x.has("posts","description")&&t.jsx("div",{className:"col-12",children:t.jsx(m,{eRef:w,label:"Contenido",required:H("description")})})]})})]})})})}),t.jsx("div",{className:"tab-pane fade",id:"multimedia",role:"tabpanel","aria-labelledby":"multimedia-tab",children:t.jsx("div",{className:"row g-3",children:t.jsx("div",{className:"col-12",children:t.jsxs("div",{className:"card border-0 shadow-sm",children:[t.jsx("div",{className:"card-header bg-light",children:t.jsxs("h6",{className:"mb-0",children:[t.jsx("i",{className:"fas fa-images me-2 text-success"}),"Imágenes"]})}),t.jsx("div",{className:"card-body",children:t.jsx("div",{className:"row g-3",children:x.has("posts","image")&&t.jsx("div",{className:"col-md-12",children:t.jsx(c,{eRef:_,name:"image",label:"Imagen",col:"col-12",aspect:"16/9"})})})})]})})})}),t.jsx("div",{className:"tab-pane fade",id:"seo",role:"tabpanel","aria-labelledby":"seo-tab",children:t.jsx("div",{className:"row g-3",children:t.jsx("div",{className:"col-12",children:t.jsxs("div",{className:"card border-0 shadow-sm",children:[t.jsx("div",{className:"card-header bg-light",children:t.jsxs("h6",{className:"mb-0",children:[t.jsx("i",{className:"fas fa-search me-2 text-info"}),"Configuración SEO"]})}),t.jsx("div",{className:"card-body",children:t.jsxs("div",{className:"row g-3",children:[x.has("posts","slug")&&t.jsxs("div",{className:"col-md-12",children:[t.jsx(d,{eRef:C,label:t.jsxs(t.Fragment,{children:[t.jsx("i",{className:"fas fa-link me-1"}),"Slug (URL amigable)"]}),placeholder:"mi-post-ejemplo",onChange:e=>{const a=e.target.value;P(a),T.current&&(T.current.value=`${R.APP_URL}/post/${a}`)},required:H("slug")}),t.jsxs("small",{className:"text-muted d-block mt-1",children:[t.jsx("i",{className:"fas fa-globe me-1"}),"Vista previa: ",t.jsxs("span",{className:"text-primary",children:[R.APP_URL,"/post/",M||"slug-del-post"]})]})]}),x.has("posts","meta_title")&&t.jsxs("div",{className:"col-md-12",children:[t.jsx(d,{eRef:D,label:t.jsxs(t.Fragment,{children:[t.jsx("i",{className:"fas fa-heading me-1"}),"Meta Title (SEO)",t.jsxs("span",{className:"badge ms-2 "+(q>60?"bg-danger":"bg-info"),children:[q,"/60"]})]}),placeholder:"Título optimizado para buscadores",maxLength:60,onChange:e=>{const a=e.target.value;L(a.length)},required:H("meta_title")}),t.jsx("small",{className:"text-muted",children:"Máximo 60 caracteres. Se auto-completa si se deja vacío."})]}),x.has("posts","meta_description")&&t.jsxs("div",{className:"col-12",children:[t.jsx(N,{eRef:B,label:t.jsxs(t.Fragment,{children:[t.jsx("i",{className:"fas fa-align-left me-1"}),"Meta Description (SEO)",t.jsxs("span",{className:"badge ms-2 "+(G>160?"bg-danger":"bg-info"),children:[G,"/160"]})]}),rows:3,placeholder:"Descripción breve del post para buscadores",maxLength:160,onChange:e=>{const a=e.target.value;O(a.length)},required:H("meta_description")}),t.jsx("small",{className:"text-muted",children:"Máximo 160 caracteres. Se auto-completa si se deja vacío."})]}),x.has("posts","meta_keywords")&&t.jsxs("div",{className:"col-md-12",children:[t.jsx(d,{eRef:E,label:t.jsxs(t.Fragment,{children:[t.jsx("i",{className:"fas fa-tags me-1"}),"Meta Keywords"]}),placeholder:"palabra1, palabra2, palabra3",required:H("meta_keywords")}),t.jsx("small",{className:"text-muted d-block mt-n2 mb-2",children:"Separadas por comas"})]}),x.has("posts","canonical_url")&&t.jsxs("div",{className:"col-md-12",children:[t.jsx(d,{eRef:T,label:t.jsxs(t.Fragment,{children:[t.jsx("i",{className:"fas fa-external-link-alt me-1"}),"URL Canónica"]}),placeholder:"Se genera automáticamente",readOnly:!0,required:H("canonical_url")}),t.jsx("small",{className:"text-muted",children:"Se genera automáticamente desde el slug"})]})]})})]})})})})]})]})]})]})};j((e,a)=>{s.createRoot(e).render(t.jsx(i,{...a,title:"Posts",children:t.jsx(w,{...a})}))});
