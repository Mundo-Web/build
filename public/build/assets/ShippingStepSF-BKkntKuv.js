import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as d}from"./index-BOnQTV8N.js";import{m as V}from"./main-B6F2O9-U.js";import{t as $}from"./CardProductKatya-ncpmQ0JU.js";import"./server.browser-Bf4gQIc7.js";import"./ShippingStep-C6i134TO.js";import{R as M}from"./PolicyModal-C80IvD61.js";import{G as S}from"./Global-DWbVqTT_.js";import{i as k}from"./tippy-react.esm-DmkRJDEW.js";import{C as l,N as r}from"./Number2Currency-D9Rjvh76.js";import"./VoucherUpload-iBnD6lhN.js";import{G as R}from"./General-BmbBKdsB.js";import{S as O}from"./SalesRest-cTtr6wLG.js";import{C as v}from"./circle-x-5vreeYph.js";import{C as G}from"./chevron-up-Mt3xll-e.js";import{C as z}from"./chevron-down-uIVDLcM-.js";import"./index-yBjzXJbu.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./index-pSueRYGM.js";import"./index-B6ujFmsw.js";import"./index-Chjiymov.js";import"./filepond-plugin-image-preview-DB1AqTVz.js";import"./ProductCard-D_AgkLlk.js";import"./BasicRest-BqhZrBN0.js";import"./createLucideIcon-DfjclApS.js";const B=new O;function ge({isOpen:m,onClose:x,onUpload:A,paymentMethod:E,cart:g=[],subTotal:y,igv:a,envio:n,totalFinal:U,request:p,coupon:h=null,descuentofinal:u=0,autoDiscounts:_=[],autoDiscountTotal:w=0}){const[I,T]=d.useState(null),[C,f]=d.useState(!1),[c,o]=d.useState(""),j=d.useRef(null),N=()=>{var t;c?F():(t=j.current)==null||t.click()},P=t=>{const s=t.target.files[0];s&&o(s)},L=()=>{o(""),j.current&&(j.current.value="")},F=async()=>{if(!C){if(!c){$.error("Error al subir comprobante",{description:"Por favor, sube tu comprobante de pago",icon:e.jsx(v,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"});return}f(!0);try{const t={...p,payment_proof:c,delivery_type:p.delivery_type||"domicilio",applied_promotions:p.applied_promotions?typeof p.applied_promotions=="string"?p.applied_promotions:JSON.stringify(p.applied_promotions):null},s=new FormData;Object.keys(t).forEach(b=>{t[b]!==null&&t[b]!==void 0&&s.append(b,t[b])});const i=await B.save(s);i&&(V.Local.delete(`${S.APP_CORRELATIVE}_cart`),location.href=`${location.origin}/cart?code=${i.code}`)}catch(t){console.error("Error al procesar el pago:",t),$.error("Error al procesar el pago:",{description:"Ocurrió un error al procesar tu pago",icon:e.jsx(v,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"})}finally{f(!1)}}};return d.useEffect(()=>(m?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[m]),e.jsx(M,{isOpen:m,onRequestClose:x,className:"absolute left-1/2 -translate-x-1/2 bg-[#f5f5f5] rounded-2xl shadow-lg w-[95%] max-w-lg top-1/2 -translate-y-1/2 overflow-hidden font-paragraph",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 z-50",ariaHideApp:!1,children:e.jsxs("div",{className:"py-6 px-10 flex flex-col gap-3 max-h-[90vh] md:max-h-[95vh] overflow-y-auto",children:[e.jsx("div",{className:"flex justify-center items-center z-40",children:e.jsx("a",{href:"/",className:"flex items-center gap-2",children:e.jsx("img",{src:`/assets/resources/logo.png?v=${crypto.randomUUID()}`,alt:S.APP_NAME,className:"h-14 object-contain object-center",onError:t=>{t.target.onerror=null,t.target.src="/assets/img/logo-bk.svg"}})})}),e.jsx("h2",{className:"text-xl 2xl:text-2xl font-bold customtext-primary text-center mt-3",children:R.get("checkout_dwallet_name")}),e.jsx("p",{className:"customtext-primary text-sm 2xl:text-base text-center",children:R.get("checkout_dwallet_description")}),e.jsx("div",{className:"w-full flex flex-row items-center justify-center my-1",children:e.jsx(k,{content:"Escanee codigo QR",children:e.jsx("img",{src:`/assets/resources/${R.get("checkout_dwallet_qr")}`,alt:R.get("checkout_dwallet_name"),className:"h-40 w-auto object-cover",onError:t=>{t.currentTarget.src="/assets/img/salafabulosa/logoyape.png"}})})}),e.jsxs("div",{className:"bg-[#EAE8E6] rounded-xl shadow-lg p-6 col-span-2 h-max font-paragraph",children:[e.jsx("h3",{className:"text-xl 2xl:text-2xl font-semibold pb-6 customtext-neutral-dark",children:"Detalle de compras"}),e.jsx("div",{className:"space-y-6 border-b-2 pb-6",children:g.map((t,s)=>e.jsx("div",{className:"rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-white p-0 rounded-xl",children:e.jsx("img",{src:`/storage/images/item/${t.image}`,alt:t.name,className:"w-20 h-20 object-cover rounded  "})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold customtext-neutral-dark text-sm 2xl:text-base mb-1",children:t.name}),(t==null?void 0:t.color)&&e.jsxs("p",{className:"text-xs 2xl:text-sm customtext-neutral-light opacity-70",children:["Color:"," ",e.jsx("span",{className:"customtext-neutral-dark",children:t.color})]}),e.jsxs("p",{className:"text-xs 2xl:text-sm customtext-neutral-light opacity-70",children:["Cantidad:"," ",e.jsxs("span",{className:"customtext-neutral-dark",children:[t.quantity," "]})]})]})]})},t.id))}),e.jsxs("div",{className:"space-y-2 mt-6 bg-white p-4 rounded-xl",children:[e.jsxs("div",{className:"flex justify-between text-sm 2xl:text-base",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:[l()," ",r(y)]})]}),e.jsxs("div",{className:"flex justify-between text-sm 2xl:text-base",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:[l()," ",r(a)]})]}),h&&e.jsxs("div",{className:"mb-2 mt-2 flex justify-between items-center border-b pb-2 text-sm font-bold",children:[e.jsxs("span",{children:["Cupón aplicado"," ",e.jsx(k,{content:"Eliminar",children:e.jsx("i",{className:"mdi mdi-close text-red-500 cursor-pointer",onClick:()=>setCoupon(null)})}),e.jsxs("small",{className:"block text-xs font-light",children:[h.code," ",e.jsx(k,{content:h.description,children:e.jsx("i",{className:"mdi mdi-information-outline ms-1"})})," ","(",h.type==="percentage"?`${h.value}%`:`${l()} ${r(h.value)}`,")"]})]}),e.jsxs("span",{children:[l()," -",r(u)]})]}),_&&_.length>0&&e.jsx("div",{className:"mb-2 mt-2 border-b pb-2",children:e.jsxs("div",{className:"flex justify-between items-center text-sm font-bold text-green-600 mt-1 pt-1 border-t",children:[e.jsx("span",{children:"Total descuentos automáticos:"}),e.jsxs("span",{children:[l()," -",r(w)]})]})}),e.jsxs("div",{className:"flex justify-between text-sm 2xl:text-base",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Envío"}),e.jsxs("span",{className:"font-semibold",children:[l()," ",r(n)]})]}),e.jsx("div",{className:"py-1 border-y",children:e.jsxs("div",{className:"flex justify-between font-bold text-lg 2xl:text-xl items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:[l()," ",r(U)]})]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"file",ref:j,onChange:P,accept:"image/png, image/jpeg, application/pdf",className:"hidden"}),c&&e.jsxs("div",{className:"bg-[#f1f1f1] p-4 rounded-lg border border-dashed",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm truncate",children:c.name}),e.jsx("button",{onClick:L,className:"text-red-500 hover:text-red-700",children:e.jsx(v,{className:"h-5 w-5"})})]}),c.type.startsWith("image/")&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:URL.createObjectURL(c),alt:"Voucher preview",className:"max-h-28 mx-auto"})})]}),e.jsxs("div",{className:"pt-2 space-y-3",children:[e.jsx("button",{onClick:N,disabled:C,className:`w-full bg-primary text-white text-sm 2xl:text-base py-3 rounded-3xl font-medium ${C?"opacity-70 cursor-not-allowed":""}`,children:C?"Procesando...":c?"Confirmar pago":"Subir comprobante"}),e.jsx("button",{onClick:x,className:"w-full border border-primary text-sm 2xl:text-base py-3 rounded-3xl font-medium",children:"Cancelar"})]})]})]})})}function H({contacts:m}){const[x,A]=d.useState({}),E=m.find(a=>a.correlative==="transfer_accounts"),g=E?JSON.parse(E.description):[],y=a=>{A(n=>({...n,[a]:!n[a]}))};return g.length===0?e.jsx("div",{className:"max-w-md w-full bg-gray-100 rounded-md p-4",children:e.jsx("p",{className:"text-gray-800",children:"No hay cuentas bancarias registradas"})}):e.jsx("div",{className:"flex flex-col gap-3 w-full",children:g.map((a,n)=>e.jsxs("div",{className:"max-w-md w-full",children:[e.jsx("div",{className:"bg-gray-100 rounded-t-md p-4",children:e.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>y(n),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-8  rounded-none flex items-center justify-center overflow-hidden",children:a.image?e.jsx("img",{src:`/assets/resources/${a.image}`,alt:a.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"text-white font-bold text-xl",children:e.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})})})}),e.jsx("span",{className:"font-medium text-gray-800 text-base",children:a.name||`Cuenta Bancaria ${n+1}`})]}),x[n]?e.jsx(G,{className:"text-amber-800"}):e.jsx(z,{className:"text-amber-800"})]})}),x[n]&&e.jsx("div",{className:"bg-gray-100 rounded-b-md p-4 pt-0 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[a.cc&&e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-800 font-medium text-sm",children:"Número de Cuenta"}),e.jsx("p",{className:"text-gray-800 font-medium text-sm",children:a.cc})]}),a.cci&&e.jsxs("div",{children:[e.jsx("p",{className:"text-amber-800 font-medium text-sm",children:"Código Interbancario"}),e.jsx("p",{className:"text-gray-800 font-medium text-sm",children:a.cci})]}),a.description&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-amber-800 font-medium text-sm",children:"Descripción"}),e.jsx("p",{className:"text-gray-800 font-medium text-sm",children:a.description})]})]})})]},n))})}const W=new O;function Ne({isOpen:m,onClose:x,onUpload:A,paymentMethod:E,cart:g=[],subTotal:y,igv:a,envio:n,totalFinal:U,request:p,contacts:h=[],coupon:u=null,descuentofinal:_=0,autoDiscounts:w=[],autoDiscountTotal:I=0}){const[T,C]=d.useState(null),[f,c]=d.useState(!1),[o,j]=d.useState(""),N=d.useRef(null),P=()=>{var s;o?t():(s=N.current)==null||s.click()},L=s=>{const i=s.target.files[0];i&&j(i)},F=()=>{j(""),N.current&&(N.current.value="")},t=async()=>{if(!f){if(!o){$.error("Error al subir comprobante",{description:"Por favor, sube tu comprobante de pago",icon:e.jsx(v,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"});return}c(!0);try{const s={...p,payment_proof:o},i=new FormData;Object.keys(s).forEach(D=>{i.append(D,s[D])});const b=await W.save(i);b&&(V.Local.delete(`${S.APP_CORRELATIVE}_cart`),location.href=`${location.origin}/cart?code=${b.code}`)}catch(s){console.error("Error al procesar el pago:",s),$.error("Error al procesar el pago:",{description:"Ocurrió un error al procesar tu pago",icon:e.jsx(v,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"})}finally{c(!1)}}};return d.useEffect(()=>(m?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[m]),e.jsx(M,{isOpen:m,onRequestClose:x,className:"absolute left-1/2 -translate-x-1/2 bg-[#f5f5f5] rounded-2xl shadow-lg w-[95%] max-w-lg top-1/2 -translate-y-1/2 overflow-hidden font-paragraph",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 z-50",ariaHideApp:!1,children:e.jsxs("div",{className:"py-6 px-10 flex flex-col gap-3 max-h-[90vh] md:max-h-[95vh] overflow-y-auto font-paragraph",children:[e.jsx("div",{className:"flex justify-center items-center z-40",children:e.jsx("a",{href:"/",className:"flex items-center gap-2",children:e.jsx("img",{src:`/assets/resources/logo.png?v=${crypto.randomUUID()}`,alt:S.APP_NAME,className:"h-14 object-contain object-center",onError:s=>{s.target.onerror=null,s.target.src="/assets/img/logo-bk.svg"}})})}),e.jsx("h2",{className:"text-xl 2xl:text-2xl font-bold customtext-primary text-center mt-3",children:"Felicitaciones!"}),e.jsx("p",{className:"customtext-primary mb-1 text-sm 2xl:text-base text-center",children:"Estás a un paso de completar tu compra, realiza la transferencia/depósito a nuestras cuentas."}),e.jsxs("div",{className:"p-4 rounded-3xl bg-[#EAE8E6] flex flex-col gap-3 items-center",children:[e.jsx("div",{className:"flex flex-col gap-1 text-center customtext-primary font-semibold",children:e.jsx("h2",{children:"SALA FABULOSA"})}),e.jsx("div",{className:"flex flex-col gap-3 w-full",children:e.jsx(H,{contacts:h})})]}),e.jsxs("div",{className:"bg-[#EAE8E6] rounded-xl shadow-lg p-6 col-span-2 h-max font-paragraph",children:[e.jsx("h3",{className:"text-xl 2xl:text-2xl font-semibold pb-6 customtext-neutral-dark",children:"Detalle de compras"}),e.jsx("div",{className:"space-y-6 border-b-2 pb-6",children:g.map((s,i)=>e.jsx("div",{className:"rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-white p-0 rounded-xl",children:e.jsx("img",{src:`/storage/images/item/${s.image}`,alt:s.name,className:"w-20 h-20 object-cover rounded  "})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold customtext-neutral-dark text-sm 2xl:text-base mb-1",children:s.name}),e.jsxs("p",{className:"text-xs 2xl:text-sm customtext-neutral-light opacity-70",children:["Color:"," ",e.jsx("span",{className:"customtext-neutral-dark",children:s.color})]}),e.jsxs("p",{className:"text-xs 2xl:text-sm customtext-neutral-light opacity-70",children:["Cantidad:"," ",e.jsxs("span",{className:"customtext-neutral-dark",children:[s.quantity," "]})]})]})]})},s.id))}),e.jsxs("div",{className:"space-y-2 mt-6 bg-white p-4 rounded-xl",children:[e.jsxs("div",{className:"flex justify-between text-sm 2xl:text-base",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:[l()," ",r(y)]})]}),e.jsxs("div",{className:"flex justify-between text-sm 2xl:text-base",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV"}),e.jsxs("span",{className:"font-semibold",children:[l()," ",r(a)]})]}),u&&e.jsxs("div",{className:"mb-2 mt-2 flex justify-between items-center border-b pb-2 text-sm font-bold",children:[e.jsxs("span",{children:["Cupón aplicado"," ",e.jsx(k,{content:"Eliminar",children:e.jsx("i",{className:"mdi mdi-close text-red-500 cursor-pointer",onClick:()=>setCoupon(null)})}),e.jsxs("small",{className:"block text-xs font-light",children:[u.name," ",e.jsx(k,{content:u.description,children:e.jsx("i",{className:"mdi mdi-information-outline ms-1"})})," ","(",u.type==="percentage"?`-${Math.round(u.amount*100)/100}%`:`${l()} -${r(u.amount)}`,")"]})]}),e.jsxs("span",{children:[l()," -",r(_)]})]}),w&&w.length>0&&e.jsxs("div",{className:"mb-2 mt-2 border-b pb-2",children:[e.jsx("div",{className:"text-sm font-bold text-green-600 mb-1",children:"Descuentos automáticos aplicados:"}),w.map((s,i)=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("span",{className:"text-green-700",children:[s.rule_name||s.name||"Descuento automático",e.jsx("small",{className:"block text-xs font-light text-gray-600",children:s.description||"Promoción especial"})]}),e.jsxs("span",{className:"font-semibold text-green-600",children:[l()," -",r(s.discount_amount||s.amount||0)]})]},i)),e.jsxs("div",{className:"flex justify-between items-center text-sm font-bold text-green-600 mt-1 pt-1 border-t",children:[e.jsx("span",{children:"Total descuentos automáticos:"}),e.jsxs("span",{children:[l()," -",r(I)]})]})]}),e.jsxs("div",{className:"flex justify-between text-sm 2xl:text-base",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Envío"}),e.jsxs("span",{className:"font-semibold",children:[l()," ",r(n)]})]}),e.jsx("div",{className:"py-1 border-y",children:e.jsxs("div",{className:"flex justify-between font-bold text-lg 2xl:text-xl items-center",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:[l()," ",r(U)]})]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"file",ref:N,onChange:L,accept:"image/png, image/jpeg, application/pdf",className:"hidden"}),o&&e.jsxs("div",{className:"bg-[#f1f1f1] p-4 rounded-lg border border-dashed",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm truncate",children:o.name}),e.jsx("button",{onClick:F,className:"text-red-500 hover:text-red-700",children:e.jsx(v,{className:"h-5 w-5"})})]}),o.type.startsWith("image/")&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:URL.createObjectURL(o),alt:"Voucher preview",className:"max-h-28 mx-auto"})})]}),e.jsxs("div",{className:"pt-2 space-y-3",children:[e.jsx("button",{onClick:P,disabled:f,className:`w-full bg-primary text-white text-sm 2xl:text-base py-3 rounded-3xl font-medium ${f?"opacity-70 cursor-not-allowed":""}`,children:f?"Procesando...":o?"Confirmar pago":"Subir comprobante"}),e.jsx("button",{onClick:x,className:"w-full border border-primary text-sm 2xl:text-base py-3 rounded-3xl font-medium",children:"Cancelar"})]})]})]})})}export{ge as U,Ne as a};
