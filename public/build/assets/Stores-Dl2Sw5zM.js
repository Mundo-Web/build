import{j as s}from"./AboutSimple-Cf8x2fCZ.js";import{r as o}from"./index-BH53Isel.js";import{c as H}from"./ReactAppend-DTVVXReZ.js";import{s as a}from"./server.browser-Bf4gQIc7.js";import{S as L}from"./StoresRest-B0mOUL_h.js";import{C as q}from"./CreateReactScript-BoGwggCx.js";import{B as J}from"./Base-CK06_Hp4.js";import{T as U}from"./Table-DitbKwtZ.js";import{M as P}from"./Modal-CIqmjseY.js";import{I as i}from"./InputFormGroup-D5I6zpZc.js";import{T as V}from"./TextareaFormGroup-DVzYJtLM.js";import{I as z}from"./ImageFormGroup-BPR9pDAU.js";import{S as K}from"./SwitchFormGroup-CGYpv_4Q.js";import{S as B}from"./SelectFormGroup-YqB1XVb8.js";import{D as G}from"./DxButton-DV0H-ZcL.js";import{S as Q}from"./ProductCard-Ap6bpF1Q.js";import"./index-yBjzXJbu.js";import"./index-fNjTmf9T.js";import"./BasicRest-B3rfI5GY.js";import"./main-BvVILmTO.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./index-CMHsc23u.js";import"./index-rimy3MAc.js";import"./index.esm-DAJ8Pwbk.js";import"./index-xsH4HHeE.js";import"./Global-ErywZRdd.js";/* empty css               *//* empty css              */import"./General-BmbBKdsB.js";import"./LaravelSession-Dz9cpV3l.js";import"./tippy-react.esm-BWiGTO87.js";import"./Logout-7s5dsuEK.js";import"./MenuItemContainer-C_dOKkRB.js";const F=new L,W=({ubigeos:t=[]})=>{const c=o.useRef(),f=o.useRef(),d=o.useRef(),h=o.useRef(),x=o.useRef(),g=o.useRef(),j=o.useRef(),b=o.useRef(),p=o.useRef(),v=o.useRef(),R=o.useRef(),m=o.useRef(),u=o.useRef();o.useRef();const y=o.useRef(),N=o.useRef(),w=o.useRef(),[M,C]=o.useState(!1),[S,T]=o.useState([{day:"Lunes",open:"09:00",close:"18:00",closed:!1},{day:"Martes",open:"09:00",close:"18:00",closed:!1},{day:"Miércoles",open:"09:00",close:"18:00",closed:!1},{day:"Jueves",open:"09:00",close:"18:00",closed:!1},{day:"Viernes",open:"09:00",close:"18:00",closed:!1},{day:"Sábado",open:"09:00",close:"15:00",closed:!1},{day:"Domingo",open:"09:00",close:"15:00",closed:!0}]),D=e=>{if(console.log(e),e!=null&&e.id?C(!0):C(!1),d.current.value=(e==null?void 0:e.id)??"",h.current.value=(e==null?void 0:e.name)??"",x.current.value=(e==null?void 0:e.address)??"",g.current.value=(e==null?void 0:e.phone)??"",j.current.value=(e==null?void 0:e.email)??"",b.current.value=(e==null?void 0:e.description)??"",v.current.value=(e==null?void 0:e.latitude)??"",R.current.value=(e==null?void 0:e.longitude)??"",y.current.value=(e==null?void 0:e.manager)??"",N.current.value=(e==null?void 0:e.capacity)??"",$(p.current).val((e==null?void 0:e.ubigeo)??null).trigger("change"),$(w.current).val((e==null?void 0:e.type)??"tienda").trigger("change"),u.current&&(u.current.checked=(e==null?void 0:e.status)??!0),e!=null&&e.business_hours)try{const r=typeof e.business_hours=="string"?JSON.parse(e.business_hours):e.business_hours;T(r)}catch(r){console.error("Error parsing business hours:",r)}else T([{day:"Lunes",open:"09:00",close:"18:00",closed:!1},{day:"Martes",open:"09:00",close:"18:00",closed:!1},{day:"Miércoles",open:"09:00",close:"18:00",closed:!1},{day:"Jueves",open:"09:00",close:"18:00",closed:!1},{day:"Viernes",open:"09:00",close:"18:00",closed:!1},{day:"Sábado",open:"09:00",close:"15:00",closed:!1},{day:"Domingo",open:"09:00",close:"15:00",closed:!0}]);$(f.current).modal("show")},I=async e=>{e.preventDefault(),t.find(n=>n.reniec==p.current.value);const r=new FormData;d.current.value&&r.append("id",d.current.value),r.append("name",h.current.value),r.append("address",x.current.value),r.append("phone",g.current.value),r.append("email",j.current.value),r.append("description",b.current.value),r.append("ubigeo",p.current.value),r.append("latitude",v.current.value),r.append("longitude",R.current.value),r.append("manager",y.current.value),r.append("capacity",N.current.value),r.append("type",w.current.value),r.append("status",u.current.checked?1:0),r.append("business_hours",JSON.stringify(S)),m.current&&m.current.files[0]&&r.append("image",m.current.files[0]),await F.save(r)&&($(c.current).dxDataGrid("instance").refresh(),$(f.current).modal("hide"))},O=async e=>{const{isConfirmed:r}=await Q.fire({title:"Eliminar tienda",text:"¿Estás seguro de eliminar esta tienda?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!r||!await F.delete(e)||$(c.current).dxDataGrid("instance").refresh()},E=(e,r,l)=>{const n=[...S];n[e][r]=l,T(n)},k=e=>$(a.renderToString(s.jsxs("span",{children:[s.jsx("span",{className:"d-block w-100 text-truncate",children:e.text.replace(e.id,"")}),s.jsxs("small",{className:"d-block",children:["Ubigeo: ",e.id]})]})));return s.jsxs(s.Fragment,{children:[s.jsx(U,{gridRef:c,title:"Tiendas / Sucursales",rest:F,exportable:!0,exportableName:"stores",toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(c.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nueva tienda",hint:"Nueva tienda",onClick:()=>D()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"image",caption:"Imagen",width:"80px",cellTemplate:(e,{data:r})=>{r.image?e.html(a.renderToString(s.jsx("img",{src:`/storage/images/store/${r.image}`,alt:r.name,className:"img-thumbnail",style:{width:"50px",height:"50px",objectFit:"cover"}}))):e.html(a.renderToString(s.jsx("div",{className:"bg-light d-flex align-items-center justify-content-center",style:{width:"50px",height:"50px"},children:s.jsx("i",{className:"fas fa-store text-muted"})})))},allowExporting:!1},{dataField:"name",caption:"Nombre",width:"200px"},{dataField:"type",caption:"Tipo",width:"100px",cellTemplate:(e,{data:r})=>{const l={tienda:"Tienda",oficina:"Oficina",almacen:"Almacén",showroom:"Showroom",otro:"Otro"},n={tienda:"success",oficina:"primary",almacen:"warning",showroom:"info",otro:"secondary"},A=l[r.type]||"No especificado",_=n[r.type]||"secondary";e.append(`<span class="badge bg-${_}">${A}</span>`)}},{dataField:"address",caption:"Dirección",width:"250px"},{dataField:"phone",caption:"Teléfono",width:"120px"},{dataField:"email",caption:"Email",width:"180px"},{dataField:"manager",caption:"Encargado",width:"150px"},{dataField:"ubigeo",caption:"Ubicación",width:"150px",cellTemplate:(e,{data:r})=>{const l=t.find(n=>n.reniec==r.ubigeo);l?e.html(a.renderToString(s.jsxs("div",{children:[s.jsx("small",{className:"d-block",children:l.distrito}),s.jsxs("small",{className:"text-muted",children:[l.provincia,", ",l.departamento]})]}))):e.text(r.ubigeo||"Sin ubicación")}},{dataField:"status",caption:"Estado",width:"100px",cellTemplate:(e,{data:r})=>{e.html(a.renderToString(s.jsx("span",{className:`badge ${r.status?"bg-success":"bg-danger"}`,children:r.status?"Activa":"Inactiva"})))}},{caption:"Acciones",width:"100px",cellTemplate:(e,{data:r})=>{e.css("text-overflow","unset"),e.append(G({className:"btn btn-xs btn-soft-primary me-1",title:"Editar",icon:"fa fa-pen",onClick:()=>D(r)})),e.append(G({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>O(r.id)}))},allowFiltering:!1,allowExporting:!1}]}),s.jsxs(P,{modalRef:f,title:M?"Editar Tienda":"Agregar Tienda",onSubmit:I,size:"lg",children:[s.jsx("input",{ref:d,type:"hidden"}),s.jsxs("div",{id:"form-container",className:"row",children:[s.jsx("div",{className:"col-md-6",children:s.jsx(i,{eRef:h,label:"Nombre de la tienda",col:"col-12",required:!0})}),s.jsx("div",{className:"col-md-6",children:s.jsxs(B,{eRef:w,label:"Tipo de establecimiento",col:"col-12",required:!0,dropdownParent:"#form-container",children:[s.jsx("option",{value:"tienda",children:"Tienda"}),s.jsx("option",{value:"oficina",children:"Oficina"}),s.jsx("option",{value:"almacen",children:"Almacén"}),s.jsx("option",{value:"showroom",children:"Showroom"}),s.jsx("option",{value:"otro",children:"Otro"})]})}),s.jsx("div",{className:"col-md-6",children:s.jsx(i,{eRef:y,label:"Encargado",col:"col-12"})}),s.jsx("div",{className:"col-12",children:s.jsx(i,{eRef:x,label:"Dirección completa",col:"col-12",required:!0})}),s.jsx("div",{className:"col-12",children:s.jsx(B,{eRef:p,label:"Distrito/Ubigeo",col:"col-12",templateResult:k,templateSelection:k,dropdownParent:"#form-container",required:!0,children:t.map((e,r)=>s.jsxs("option",{value:e.reniec,children:[e.reniec," ",e.distrito," ",e.provincia," ",e.departamento]},r))})}),s.jsx("div",{className:"col-md-6",children:s.jsx(i,{eRef:g,label:"Teléfono",col:"col-12",type:"tel"})}),s.jsx("div",{className:"col-md-6",children:s.jsx(i,{eRef:j,label:"Email",col:"col-12",type:"email"})}),s.jsx("div",{className:"col-md-6",children:s.jsx(i,{eRef:v,label:"Latitud (Google Maps)",col:"col-12",type:"number",step:"any",placeholder:"Ej: -12.0464"})}),s.jsx("div",{className:"col-md-6",children:s.jsx(i,{eRef:R,label:"Longitud (Google Maps)",col:"col-12",type:"number",step:"any",placeholder:"Ej: -77.0428"})}),s.jsx("div",{className:"col-md-6",children:s.jsx(i,{eRef:N,label:"Capacidad de atención (personas/día)",col:"col-12",type:"number",placeholder:"Ej: 50"})}),s.jsx("div",{className:"col-md-6",children:s.jsx(K,{eRef:u,label:"Tienda activa",col:"col-12"})}),s.jsx("div",{className:"col-12",children:s.jsx(z,{eRef:m,label:"Imagen de la tienda",col:"col-12",accept:"image/*"})}),s.jsx("div",{className:"col-12",children:s.jsx(V,{eRef:b,label:"Descripción",rows:3})}),s.jsx("div",{className:"col-12",children:s.jsxs("div",{className:"mb-3",children:[s.jsx("label",{className:"form-label",children:"Horarios de atención"}),s.jsx("div",{className:"table-responsive",children:s.jsxs("table",{className:"table table-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Día"}),s.jsx("th",{children:"Apertura"}),s.jsx("th",{children:"Cierre"}),s.jsx("th",{children:"Cerrado"})]})}),s.jsx("tbody",{children:S.map((e,r)=>s.jsxs("tr",{children:[s.jsx("td",{className:"align-middle",children:s.jsx("strong",{children:e.day})}),s.jsx("td",{children:s.jsx("input",{type:"time",className:"form-control form-control-sm",value:e.open,onChange:l=>E(r,"open",l.target.value),disabled:e.closed})}),s.jsx("td",{children:s.jsx("input",{type:"time",className:"form-control form-control-sm",value:e.close,onChange:l=>E(r,"close",l.target.value),disabled:e.closed})}),s.jsx("td",{children:s.jsxs("div",{className:"form-check",children:[s.jsx("input",{type:"checkbox",className:"form-check-input",checked:e.closed,onChange:l=>E(r,"closed",l.target.checked)}),s.jsx("label",{className:"form-check-label",children:"Cerrado"})]})})]},r))})]})})]})})]})]})]})};q((t,c)=>{H.createRoot(t).render(s.jsx(J,{...c,title:"Tiendas / Sucursales",children:s.jsx(W,{...c})}))});
