var e=Object.defineProperty,a=(a,t,i)=>((a,t,i)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i)(a,"symbol"!=typeof t?t+"":t,i);import{c as t,j as i,r as s}from"./vendor-react-DB2gWWlz.js";import{B as r}from"./Base-Dz6-QovD.js";import{S as n}from"./SwitchFormGroup-CUJX8XRh.js";import{T as o}from"./TextareaFormGroup-UGEg0Hiq.js";import{S as l}from"./CartKuchara-C7ZIDpxE.js";import{B as c}from"./BasicRest-rcCccbSV.js";import{B as m}from"./BasicEditing-BzftwLDF.js";import{I as d}from"./ImageFormGroup-D2rnctCJ.js";import{I as p}from"./InputFormGroup-2FSTuTd0.js";import{S as u}from"./SelectFormGroup-BrHLxEuP.js";import{M as h}from"./Modal-5lTGbKHj.js";import{T as f}from"./Table-CioVTN-i.js";import{D as j}from"./DxButton-C6FT_beP.js";import{C as g,F as x}from"./CreateReactScript-7rAqIEI0.js";import{R as v}from"./ReactAppend-DaATu3nB.js";import"./vendor-swiper-Cr_RrIb_.js";import"./Global-BAGAPG-V.js";import"./TippyButton-Crd57m29.js";import"./Logout-D009x2BU.js";import"./MenuItemContainer-C29lHQ3g.js";import"./Menu-OQAZllby.js";import"./GoogleSignInButton-Bo5d3xNo.js";import"./BooleanLimit-q2Ad9fGY.js";import"./ArrayDetails2Object-BtdyATqd.js";import"./em-DdskFTBn.js";import"./HtmlContent-CkpQmeQx.js";import"./WebDetailsRest-DNZhLZ6w.js";import"./General-ClVW7qxN.js";import"./LaravelSession-ByQnaUD3.js";const b=new class extends c{constructor(){super(...arguments),a(this,"path","admin/testimonies"),a(this,"hasFiles",!0)}},N=({countries:e,details:a})=>{const r=s.useRef(),c=s.useRef(),g=s.useRef(),N=s.useRef(),y=s.useRef(),F=s.useRef(),R=s.useRef(),w=s.useRef(),D=s.useRef(),[T,C]=s.useState(!1),B=e=>{C(!!e?.id),w.current&&w.resetDeleteFlag&&w.resetDeleteFlag(),g.current.value=e?.id??"",N.current.value=e?.name??"",x.has("testimonies","role")&&(y.current.value=e?.role??""),x.has("testimonies","rating")&&(F.current.value=e?.rating??"5"),x.has("testimonies","country_id")&&$(D.current).val(e?.country_id??"89").trigger("change"),x.has("testimonies","description")&&(R.current.value=e?.description??""),w.current&&w.image&&x.has("testimonies","image")&&(w.image.src=e?.image?`/storage/images/testimony/${e.image}`:"",w.current.value=null),$(c.current).modal("show")};return i.jsxs(i.Fragment,{children:[i.jsx(f,{gridRef:r,title:i.jsx(m,{correlative:"testimonies",details:a}),rest:b,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(r.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo testimonio",hint:"Nuevo testimonio",onClick:()=>B()}})},columns:[{dataField:"id",caption:"ID",visible:!1},x.has("testimonies","image")&&{dataField:"name",caption:"Autor",cellTemplate:(e,{data:a})=>{const s=e instanceof HTMLElement?e:e.get?e.get(0):e[0];if(s){s.innerHTML="";t.createRoot(s).render(i.jsxs("div",{className:"d-flex align-items-center gap-2",children:[i.jsx("img",{className:"avatar-xs rounded-circle",src:`/storage/images/testimony/${a.image}`,alt:a.name,onError:e=>{e.target.onerror=null,e.target.src="/api/cover/thumbnail/null"}}),i.jsx("p",{className:"mb-0",style:{fontSize:"14px"},children:a.name})]}))}}},!x.has("testimonies","image")&&{dataField:"name",caption:"Autor"},x.has("testimonies","role")&&{dataField:"role",caption:"Cargo/Rol",width:"150px"},x.has("testimonies","country_id")&&{dataField:"country",caption:"País",width:"120px"},x.has("testimonies","rating")&&{dataField:"rating",caption:"Rating",width:"120px",cellTemplate:(e,{data:a})=>{const t="⭐".repeat(a.rating||0);e.html(`<span title="${a.rating}/5">${t}</span>`)}},x.has("testimonies","description")&&{dataField:"description",caption:"Testimonio",minWidth:"300px",cellTemplate:(e,{data:a})=>{e.html(`<span class="text-muted">${((e,a=100)=>e?e.length>a?e.substring(0,a)+"...":e:"")(a.description)}</span>`)}},{dataField:"visible",caption:"Visible",dataType:"boolean",cellTemplate:(e,{data:a})=>{$(e).empty(),v(e,i.jsx(n,{checked:1==a.visible,onChange:()=>(async({id:e,value:a})=>{await b.boolean({id:e,field:"visible",value:a})&&$(r.current).dxDataGrid("instance").refresh()})({id:a.id,value:!a.visible})}))}},{caption:"Acciones",cellTemplate:(e,{data:a})=>{e.append(j({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>B(a)})),e.append(j({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>(async e=>{const{isConfirmed:a}=await l.fire({title:"Eliminar testimonio",text:"¿Estas seguro de eliminar este testimonio?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});if(!a)return;await b.delete(e)&&$(r.current).dxDataGrid("instance").refresh()})(a.id)}))},allowFiltering:!1,allowExporting:!1}]}),i.jsxs(h,{modalRef:c,title:T?"Editar testimonio":"Agregar testimonio",onSubmit:async e=>{e.preventDefault();const a={id:g.current.value||void 0,name:N.current.value};x.has("testimonies","country_id")&&(a.country_id=$(D.current).val(),a.country=$(D.current).find("option:selected").text()),x.has("testimonies","role")&&(a.role=y.current.value),x.has("testimonies","rating")&&(a.rating=F.current.value),x.has("testimonies","description")&&(a.description=R.current.value);const t=new FormData;for(const i in a)t.append(i,a[i]);if(w.current&&x.has("testimonies","image")){const e=w.current.files[0];e&&t.append("image",e),w.getDeleteFlag&&w.getDeleteFlag()&&t.append("image_delete","DELETE")}await b.save(t)&&(w.resetDeleteFlag&&w.resetDeleteFlag(),$(r.current).dxDataGrid("instance").refresh(),$(c.current).modal("hide"))},size:"lg",children:[i.jsx("input",{ref:g,type:"hidden"}),i.jsx("div",{id:"testimony-container",children:i.jsxs("div",{className:"row g-3",children:[i.jsx("div",{className:"col-12",children:i.jsxs("div",{className:"card border-0 shadow-sm",children:[i.jsx("div",{className:"card-header bg-light",children:i.jsxs("h6",{className:"mb-0",children:[i.jsx("i",{className:"fas fa-user me-2 text-primary"}),"Información del Autor"]})}),i.jsx("div",{className:"card-body",children:i.jsxs("div",{className:"row g-3",children:[x.has("testimonies","image")&&i.jsxs("div",{className:"col-md-4",children:[i.jsx(d,{eRef:w,name:"image",label:"Foto del Autor",col:"col-12",aspect:1}),i.jsxs("small",{className:"text-muted",children:[i.jsx("i",{className:"fas fa-info-circle me-1"}),"Imagen cuadrada 1:1"]})]}),i.jsx("div",{className:"col-md-8",children:i.jsxs("div",{className:"row ",children:[i.jsx("div",{className:"col-md-12",children:i.jsx(p,{eRef:N,label:"Nombre Completo",placeholder:"Ej: Juan Pérez",required:!0})}),x.has("testimonies","role")&&i.jsx("div",{className:"col-md-12",children:i.jsx(p,{eRef:y,label:"Cargo/Profesión",placeholder:"Ej: Paciente Operado",required:!0})}),x.has("testimonies","country_id")&&i.jsx("div",{className:"col-md-12",children:i.jsx(u,{eRef:D,label:"País de Origen",required:!0,dropdownParent:"#testimony-container",children:e.map((e,a)=>i.jsx("option",{value:e.id,children:e.name},`country-${a}`))})}),x.has("testimonies","rating")&&i.jsx("div",{className:"col-md-12",children:i.jsx(p,{eRef:F,label:"Calificación (1-5 estrellas)",type:"number",min:"1",max:"5",placeholder:"5",required:!0})})]})})]})})]})}),x.has("testimonies","description")&&i.jsx("div",{className:"col-12",children:i.jsxs("div",{className:"card border-0 shadow-sm",children:[i.jsx("div",{className:"card-header bg-light",children:i.jsxs("h6",{className:"mb-0",children:[i.jsx("i",{className:"fas fa-comment-dots me-2 text-success"}),"Testimonio"]})}),i.jsxs("div",{className:"card-body",children:[i.jsx(o,{eRef:R,label:"Descripción del Testimonio",rows:5,placeholder:"Escribe aquí la experiencia y opinión...",required:!0}),i.jsxs("small",{className:"text-muted",children:[i.jsx("i",{className:"fas fa-info-circle me-1"}),"Describe la experiencia completa y detallada"]})]})]})})]})})]})]})};g((e,a)=>{t.createRoot(e).render(i.jsx(r,{...a,title:"Testimonios",children:i.jsx(N,{...a})}))});
