import{r as e,j as a,C as t,S as s,E as i,R as r,J as n}from"./vendor-react-CIhVE-fi.js";import{I as l}from"./ItemsRest-3tin5YGG.js";import{L as c}from"./Loading-ChLofGGn.js";import{N as o}from"./NoResult-Cg718ok7.js";import{S as d}from"./SelectForm-BH2ejc5U.js";import m from"./CardProductBananaLab-v-t-Glgy.js";import{C as u}from"./Number2Currency-BX4epFEo.js";import{m as p,A as h}from"./vendor-motion-iF4wNZTr.js";import"./vendor-swiper-Cr_RrIb_.js";import"./BasicRest-CNjqr-ae.js";import"./OpenPayCardModal-K84_M_7u.js";import"./BooleanLimit-q2Ad9fGY.js";import"./CartKuchara-Dxib2Hfv.js";import"./CartModal-DEGaGNoe.js";import"./CartItemRow-COcyJucy.js";import"./CartModalBananaLab-BuQz01So.js";import"./TippyButton-Cw7YfGyL.js";import"./General-ClVW7qxN.js";const x=new l,g=({items:l,data:g,filteredData:y,cart:f,setCart:b})=>{const{collections:j,categories:v,brands:w,priceRanges:N}=y,[P,C]=e.useState([]),[_,k]=e.useState({collection:!0,marca:!0,precio:!0,categoria:!0,subcategoria:!1,colores:!1}),[S,H]=e.useState({collection_id:[],category_id:[],subcategory_id:[],brand_id:[],price:null,name:null,sort_by:"created_at",order:"desc"}),[M,L]=e.useState([]),[R,A]=e.useState(!1),[B,T]=e.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:21,from:0,to:0}),E={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{duration:.3}}};e.useEffect(()=>{(async()=>{if(S.category_id.length>0)try{const e=await x.getSubcategories({category_id:S.category_id[0]});C(e),k(e=>({...e,subcategoria:!0}))}catch(e){}else C([]),H(e=>({...e,subcategory_id:[]})),k(e=>({...e,subcategoria:!1}))})()},[S.category_id]);const I=async(e=1)=>{A(!0);try{const a={filter:(e=>{const a=[];if(e.collection_id.length>0){const t=e.collection_id.map(e=>["collection_id","=",e]);a.push(["or",...t])}if(e.category_id.length>0){const t=e.category_id.map(e=>["category_id","=",e]);a.push(["or",...t])}if(e.subcategory_id.length>0){const t=e.subcategory_id.map(e=>["subcategory_id","=",e]);a.push(["or",...t])}if(e.brand_id.length>0){const t=e.brand_id.map(e=>["brand_id","=",e]);a.push(["or",...t])}return e.price&&a.push(["and",[["final_price",">=",e.price.min],"and",["final_price","<=",e.price.max]]]),e.name&&a.push(["name","contains",e.name]),a})(S),sort:S.sort,skip:(e-1)*B.itemsPerPage,take:B.itemsPerPage,requireTotalCount:!0},t=await x.paginate(a);L(t.data),T({currentPage:e,totalPages:Math.ceil(t.totalCount/B.itemsPerPage),totalItems:t.totalCount,itemsPerPage:B.itemsPerPage,from:(e-1)*B.itemsPerPage+1,to:Math.min(e*B.itemsPerPage,t.totalCount)})}catch(a){}finally{A(!1)}};e.useEffect(()=>{I(B.currentPage)},[S]);const $=e=>{e>=1&&e<=B.totalPages&&I(e)},z=()=>{const e=[],a=B.totalPages,t=B.currentPage;for(let s=1;s<=a;s++)1===s||s===a||s>=t-2&&s<=t+2?e.push(s):s!==t-2-1&&s!==t+2+1||e.push("...");return e.filter((e,a,t)=>"..."!==e||"..."!==t[a-1])};e.useEffect(()=>{const e=new URLSearchParams(window.location.search),a=e.get("category"),t=e.get("collection"),s=e.get("search");if(a){const e=v.find(e=>e.slug===a);e&&H(a=>({...a,category_id:[e.id]}))}if(t){const e=j.find(e=>e.slug===t);e&&H(a=>({...a,collection_id:[e.id]}))}s&&H(e=>({...e,name:s}))},[l]);const D=(e,a)=>{H(t=>{if("price"===e)return{...t,price:t.price&&t.price.min===a.min&&t.price.max===a.max?null:a};const s=Array.isArray(t[e])?t[e]:[],i=s.includes(a)?s.filter(e=>e!==a):[...s,a];return{...t,[e]:i}})},F=e=>{k(a=>({...a,[e]:!a[e]}))},[K,O]=e.useState(""),[G,Z]=e.useState(""),[q,J]=e.useState(""),U=v.filter(e=>e.name.toLowerCase().includes(K.toLowerCase())),Q=w.filter(e=>e.name.toLowerCase().includes(q.toLowerCase()));return a.jsx(p.section,{id:g?.element_id||null,initial:"hidden",animate:"visible",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{duration:.5}}},className:"py-6 customtext-neutral-dark font-paragraph",children:a.jsx("div",{className:"mx-auto px-primary",children:a.jsxs("div",{className:"relative flex flex-col sm:flex-row gap-4",children:[a.jsxs(p.div,{className:"w-full sm:w-1/5 bg-white p-4 rounded-lg h-max shadow-sm",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2},children:[a.jsx("p",{className:"customtext-neutral-dark text-2xl font-bold pb-4 mb-4 border-b",children:"Escoge el regalo y personaliza"}),a.jsxs(p.div,{className:"mb-6",variants:E,children:[a.jsxs(p.button,{onClick:()=>F("categoria"),className:"flex items-center justify-between w-full mb-4",whileHover:{x:3},children:[a.jsx("span",{className:"font-medium",children:"Categorías"}),a.jsx(t,{className:"h-5 w-5 transform transition-transform "+(_.categoria?"":"-rotate-180")})]}),a.jsx(h,{children:_.categoria&&a.jsxs(p.div,{className:"space-y-1",initial:"hidden",animate:"visible",exit:"hidden",variants:{hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto",transition:{staggerChildren:.1}}},children:[a.jsxs(p.div,{className:"relative",variants:E,children:[a.jsx(s,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0 transition-all duration-300",value:K,onChange:e=>O(e.target.value)})]}),U.map(e=>{const t=S.category_id?.includes(e.id);return a.jsx(p.div,{className:"group py-2 rounded-md "+(t?"bg-primary brightness-125":"bg-transparent"),variants:E,children:a.jsxs("label",{className:"flex items-center justify-between space-x-3 px-4 cursor-pointer",children:[a.jsx("input",{type:"checkbox",className:"hidden",onChange:()=>D("category_id",e.id),checked:t}),a.jsx("img",{src:`/storage/images/category/${e.image}`,onError:e=>e.target.src="assets/img/noimage/no_imagen_circular.png",alt:e.name,className:"w-8 h-8 rounded-full object-cover order-1",loading:"lazy"}),a.jsx("span",{className:""+(t?"text-white":"text-gray-700"),children:e.name})]})},e.id)})]})})]}),P.length>0&&a.jsxs(p.div,{className:"mb-6",variants:E,children:[a.jsxs(p.button,{onClick:()=>F("subcategoria"),className:"flex items-center justify-between w-full mb-4",whileHover:{x:3},children:[a.jsx("span",{className:"font-medium",children:"Subcategorías"}),a.jsx(t,{className:"h-5 w-5 transform transition-transform "+(_.subcategoria?"":"-rotate-180")})]}),a.jsx(h,{children:_.subcategoria&&a.jsx(p.div,{className:"space-y-1 pl-8",initial:"hidden",animate:"visible",exit:"hidden",variants:{hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto",transition:{staggerChildren:.1}}},children:P.map(e=>{const t=S.subcategory_id?.includes(e.id);return a.jsx(p.div,{className:"group py-2 rounded-md "+(t?"bg-primary/10":"bg-transparent"),variants:E,children:a.jsxs("label",{className:"flex items-center space-x-3 px-4 cursor-pointer",children:[a.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",onChange:()=>D("subcategory_id",e.id),checked:t}),a.jsx("span",{className:""+(t?"font-medium text-primary":"text-gray-600"),children:e.name})]})},e.id)})})})]}),a.jsxs(p.div,{className:"mb-6",variants:E,children:[a.jsxs(p.button,{onClick:()=>F("precio"),className:"flex items-center justify-between w-full mb-4",whileHover:{x:3},children:[a.jsx("span",{className:"font-medium",children:"Precio"}),a.jsx(t,{className:"h-5 w-5 transform transition-transform "+(_.precio?"":"-rotate-180")})]}),a.jsx(h,{children:_.precio&&a.jsx(p.div,{className:"space-y-3",initial:"hidden",animate:"visible",exit:"hidden",variants:{hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto",transition:{staggerChildren:.1}}},children:N.map(e=>{const t=S.price&&S.price.min===e.min&&S.price.max===e.max;return a.jsxs(p.label,{className:"flex items-center space-x-3 cursor-pointer",variants:E,whileHover:{x:3},children:[a.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",onChange:()=>D("price",e),checked:t}),a.jsx("span",{className:""+(t?"font-medium text-primary":"text-gray-600"),children:`${u()} ${e.min} - ${u()} ${e.max}`})]},`${e.min}-${e.max}`)})})})]}),a.jsxs(p.div,{className:"mb-6",variants:E,children:[a.jsxs(p.button,{onClick:()=>F("marca"),className:"flex items-center justify-between w-full mb-4",whileHover:{x:3},children:[a.jsx("span",{className:"font-medium",children:"Marcas"}),a.jsx(t,{className:"h-5 w-5 transform transition-transform "+(_.marca?"":"-rotate-180")})]}),a.jsx(h,{children:_.marca&&a.jsxs(p.div,{className:"space-y-1",initial:"hidden",animate:"visible",exit:"hidden",variants:{hidden:{opacity:0,height:0},visible:{opacity:1,height:"auto",transition:{staggerChildren:.1}}},children:[a.jsxs(p.div,{className:"relative",variants:E,children:[a.jsx(s,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0 transition-all duration-300",value:q,onChange:e=>J(e.target.value)})]}),Q.map(e=>{const t=S.brand_id?.includes(e.id);return a.jsx(p.div,{className:"group py-2 rounded-md "+(t?"bg-primary/10":"bg-transparent"),variants:E,children:a.jsxs("label",{className:"flex items-center space-x-3 px-4 cursor-pointer",children:[a.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",onChange:()=>D("brand_id",e.id),checked:t}),a.jsx("span",{className:""+(t?"font-medium text-primary":"text-gray-600"),children:e.name})]})},e.id)})]})})]})]}),a.jsxs(p.div,{className:"w-full sm:w-4/5 py-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[a.jsxs(p.div,{className:"flex flex-col lg:flex-row lg:justify-between items-center mb-4 w-full",variants:E,children:[a.jsxs("div",{className:"flex gap-4 items-center mb-4 lg:mb-0",children:[a.jsx("label",{className:"font-semibold text-sm w-[150px]",children:"Ordenar por"}),a.jsx(d,{options:[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],placeholder:"Recomendados",onChange:e=>{const[a,t]=e.split(":"),s=[{selector:a,desc:"desc"===t}];H(e=>({...e,sort:s}))},labelKey:"label",valueKey:"value",className:"border-primary rounded-full customtext-primary"})]}),a.jsx("div",{className:"customtext-primary font-semibold",children:a.jsxs("div",{className:"flex justify-between items-center w-full",children:[a.jsx("div",{className:"customtext-primary font-semibold",children:a.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[a.jsx(p.button,{className:"p-4 inline-flex items-center "+(1===B.currentPage?"opacity-50 cursor-not-allowed":""),onClick:()=>$(B.currentPage-1),disabled:1===B.currentPage,whileHover:{scale:1.1},whileTap:{scale:.9},children:a.jsx(i,{})}),z().map((e,t)=>a.jsx(r.Fragment,{children:"..."===e?a.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):a.jsx(p.button,{className:"w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 \n                                                                "+(e===B.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"),onClick:()=>$(e),whileHover:{scale:1.05},whileTap:{scale:.95},children:e})},t)),a.jsx(p.button,{className:"p-4 inline-flex items-center "+(B.currentPage===B.totalPages?"opacity-50 cursor-not-allowed":""),onClick:()=>$(B.currentPage+1),disabled:B.currentPage===B.totalPages,whileHover:{scale:1.1},whileTap:{scale:.9},children:a.jsx(n,{})})]})}),a.jsx("div",{children:a.jsxs("p",{className:"font-semibold",children:[B.from," - ",B.to," de ",B.totalItems," Resultados"]})})]})})]}),R?a.jsx(c,{}):a.jsx(p.div,{className:"flex items-center flex-wrap gap-y-2 lg:gap-y-3 transition-all duration-300 ease-in-out",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"visible",children:Array.isArray(M)&&M.length>0?M.map((e,t)=>a.jsx(p.div,{custom:t,variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:100,delay:.03*t}}},whileHover:{y:-5},className:"w-full md:w-1/2 lg:w-1/3 px-2",children:a.jsx(m,{product:e,cart:f,setCart:b})},e.id)):a.jsx(o,{})}),a.jsxs(p.div,{className:"flex justify-between items-center mb-4 w-full mt-8",variants:E,children:[a.jsx("div",{className:"customtext-primary font-semibold",children:a.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[a.jsx(p.button,{className:"p-4 inline-flex items-center "+(1===B.currentPage?"opacity-50 cursor-not-allowed":""),onClick:()=>$(B.currentPage-1),disabled:1===B.currentPage,whileHover:{scale:1.1},whileTap:{scale:.9},children:a.jsx(i,{})}),z().map((e,t)=>a.jsx(r.Fragment,{children:"..."===e?a.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):a.jsx(p.button,{className:"w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 \n                                                        "+(e===B.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"),onClick:()=>$(e),whileHover:{scale:1.05},whileTap:{scale:.95},children:e})},t)),a.jsx(p.button,{className:"p-4 inline-flex items-center "+(B.currentPage===B.totalPages?"opacity-50 cursor-not-allowed":""),onClick:()=>$(B.currentPage+1),disabled:B.currentPage===B.totalPages,whileHover:{scale:1.1},whileTap:{scale:.9},children:a.jsx(n,{})})]})}),a.jsx("div",{children:a.jsxs("p",{className:"font-semibold",children:[B.from," - ",B.to," de ",B.totalItems," Resultados"]})})]})]})]})})})};export{g as default};
