var e=Object.defineProperty,a=(a,s,i)=>((a,s,i)=>s in a?e(a,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[s]=i)(a,"symbol"!=typeof s?s+"":s,i);import{c as s,j as i,r as t}from"./vendor-react-CZUvQwNQ.js";import{B as r}from"./Base-BE1X8Lb3.js";import{S as l}from"./SwitchFormGroup-CA4b2Uj0.js";import{T as o}from"./TextareaFormGroup-dfKTDx8M.js";import{S as n}from"./CartKuchara-C7vqSevl.js";import{B as c}from"./BasicRest-K-34csnH.js";import{M as d}from"./Modal-MmI0jF6v.js";import{D as m}from"./DxButton-C6FT_beP.js";import{I as h}from"./InputFormGroup-BuXn3s3l.js";import{T as b}from"./Table-Cynp-rvu.js";import{C as u,F as p}from"./CreateReactScript-DMiuD_MQ.js";import{R as x}from"./ReactAppend-Db2K6xCH.js";import{I as g}from"./ImageFormGroup-DlJufE2S.js";import"./vendor-swiper-Cr_RrIb_.js";import"./Footer-DAm0kDL9.js";import"./TippyButton-Gia9IjJq.js";import"./Logout-D6byb_Ua.js";import"./MenuItemContainer-BaCqn8PU.js";import"./Menu-DboRETzC.js";import"./OpenPayCardModal-BHkRoVZ6.js";import"./BooleanLimit-q2Ad9fGY.js";import"./General-ClVW7qxN.js";import"./LaravelSession-ByQnaUD3.js";const f=new class extends c{constructor(){super(...arguments),a(this,"path","admin/indicators"),a(this,"hasFiles",!0)}},j=()=>{const e=t.useRef(),a=t.useRef(),s=t.useRef(),r=t.useRef(),c=t.useRef(),u=t.useRef(),j=t.useRef(),v=t.useRef(),N=t.useRef(),y=t.useRef(),w=t.useRef(),k=t.useRef(),[R,F]=t.useState(!1),[_,D]=t.useState(!1),[C,B]=t.useState("#71b6f9"),E=e=>{if(F(!!e?.id),r.current&&r.resetDeleteFlag&&r.resetDeleteFlag(),c.current&&c.resetDeleteFlag&&c.resetDeleteFlag(),s.current.value=e?.id??"",p.has("indicators","name")&&(u.current.value=e?.name??""),p.has("indicators","description")&&(j.current.value=e?.description??""),p.has("indicators","button_text")&&(v.current.value=e?.button_text??""),p.has("indicators","button_link")&&(N.current.value=e?.button_link??""),p.has("indicators","badge")&&(y.current.value=e?.badge??""),p.has("indicators","subtitle")&&(w.current.value=e?.subtitle??""),p.has("indicators","bg_color")){const a=e?.bg_color??"transparent";"transparent"!==a&&""!==a?(D(!0),B(a.startsWith("#")?a:"#71b6f9")):(D(!1),B("#71b6f9"))}p.has("indicators","symbol")&&r.current&&r.image&&(r.current.value=null,r.image.src=e?.symbol?`/storage/images/indicator/${e.symbol}`:""),p.has("indicators","bg_image")&&c.current&&c.image&&(c.current.value=null,c.image.src=e?.bg_image?`/storage/images/indicator/${e.bg_image}`:""),$(a.current).modal("show")};return i.jsxs(i.Fragment,{children:[i.jsx(b,{gridRef:e,title:"Indicadores",rest:f,toolBar:a=>{a.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(e.current).dxDataGrid("instance").refresh()}}),a.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo indicador",hint:"Nuevo indicador",onClick:()=>E()}})},rowDragging:{allowReordering:!0,onReorder:async e=>{const a=e.toIndex;try{await f.reorder(e.itemData.id,a)&&await e.component.refresh()}catch(s){}},dropFeedbackMode:"push"},sorting:{mode:"single"},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"order_index",caption:"Orden",visible:!1,sortOrder:"asc",sortIndex:0},p.has("indicators","symbol")&&{dataField:"symbol",caption:"Icono",width:100,cellTemplate:(e,{data:a})=>{const s=a.symbol?`/storage/images/indicator/${a.symbol}`:"/api/cover/thumbnail/null",t=a.bg_color||"transparent";x(e,i.jsx("div",{style:{width:"60px",height:"60px",backgroundColor:t,borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",padding:"4px"},children:i.jsx("img",{src:s,style:{width:"100%",height:"100%",objectFit:"contain"},onError:e=>e.target.src="/api/cover/thumbnail/null"})}))}},p.has("indicators","name")&&{dataField:"name",caption:"Título",width:150},p.has("indicators","description")&&{dataField:"description",caption:"Descripción"},p.has("indicators","button_text")&&{dataField:"button_text",caption:"Texto del Botón",width:150},p.has("indicators","visible")&&{dataField:"visible",caption:"Visible",width:80,dataType:"boolean",cellTemplate:(a,{data:s})=>{$(a).empty(),x(a,i.jsx(l,{checked:1==s.visible,onChange:()=>(async({id:a,value:s})=>{await f.boolean({id:a,field:"visible",value:s})&&$(e.current).dxDataGrid("instance").refresh()})({id:s.id,value:!s.visible})}))}},{caption:"Acciones",width:120,cellTemplate:(a,{data:s})=>{a.append(m({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>E(s)})),a.append(m({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>(async a=>{const{isConfirmed:s}=await n.fire({title:"Eliminar indicador",text:"¿Estas seguro de eliminar este indicador?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});if(!s)return;await f.delete(a)&&$(e.current).dxDataGrid("instance").refresh()})(s.id)}))},allowFiltering:!1,allowExporting:!1}]}),i.jsxs(d,{modalRef:a,title:R?"Editar indicador":"Agregar indicador",onSubmit:async i=>{i.preventDefault();const t={id:s.current.value||void 0};p.has("indicators","name")&&(t.name=u.current.value),p.has("indicators","description")&&(t.description=j.current.value),p.has("indicators","button_text")&&(t.button_text=v.current.value),p.has("indicators","button_link")&&(t.button_link=N.current.value),p.has("indicators","badge")&&(t.badge=y.current.value),p.has("indicators","subtitle")&&(t.subtitle=w.current.value),p.has("indicators","bg_color")&&(t.bg_color=_?C:"transparent");const l=new FormData;for(const e in t)l.append(e,t[e]);if(r.current&&p.has("indicators","symbol")){const e=r.current.files[0];e&&l.append("symbol",e),r.getDeleteFlag&&r.getDeleteFlag()&&l.append("symbol_delete","DELETE")}if(c.current&&p.has("indicators","bg_image")){const e=c.current.files[0];e&&l.append("bg_image",e),c.getDeleteFlag&&c.getDeleteFlag()&&l.append("bg_image_delete","DELETE")}await f.save(l)&&(r.current&&r.resetDeleteFlag&&r.resetDeleteFlag(),c.current&&c.resetDeleteFlag&&c.resetDeleteFlag(),$(e.current).dxDataGrid("instance").refresh(),$(a.current).modal("hide"))},size:"lg",children:[i.jsx("input",{ref:s,type:"hidden"}),i.jsxs("div",{id:"indicators-container",children:[i.jsxs("ul",{className:"nav nav-pills nav-justified mb-4",role:"tablist",style:{backgroundColor:"#f8f9fa",borderRadius:"8px",padding:"4px",border:"1px solid #e9ecef"},children:[i.jsx("li",{className:"nav-item",role:"presentation",children:i.jsxs("button",{className:"nav-link active",id:"basic-info-tab","data-bs-toggle":"pill","data-bs-target":"#basic-info",type:"button",role:"tab","aria-controls":"basic-info","aria-selected":"true",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[i.jsx("i",{className:"fas fa-info-circle me-2"}),"Información Básica"]})}),(p.has("indicators","symbol")||p.has("indicators","bg_image"))&&i.jsx("li",{className:"nav-item",role:"presentation",children:i.jsxs("button",{className:"nav-link",id:"multimedia-tab","data-bs-toggle":"pill","data-bs-target":"#multimedia",type:"button",role:"tab","aria-controls":"multimedia","aria-selected":"false",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[i.jsx("i",{className:"fas fa-images me-2"}),"Multimedia"]})}),(p.has("indicators","button_text")||p.has("indicators","button_link"))&&i.jsx("li",{className:"nav-item",role:"presentation",children:i.jsxs("button",{className:"nav-link",id:"action-tab","data-bs-toggle":"pill","data-bs-target":"#action",type:"button",role:"tab","aria-controls":"action","aria-selected":"false",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[i.jsx("i",{className:"fas fa-link me-2"}),"Botón de Acción"]})})]}),i.jsxs("div",{className:"tab-content",children:[i.jsx("div",{className:"tab-pane fade show active",id:"basic-info",role:"tabpanel","aria-labelledby":"basic-info-tab",children:i.jsx("div",{className:"row g-3",children:i.jsx("div",{className:"col-12",children:i.jsxs("div",{className:"card border-0 shadow-sm",children:[i.jsx("div",{className:"card-header bg-light",children:i.jsxs("h6",{className:"mb-0",children:[i.jsx("i",{className:"fas fa-tag me-2 text-primary"}),"Información del Indicador"]})}),i.jsx("div",{className:"card-body",children:i.jsxs("div",{className:"row",children:[p.has("indicators","name")&&i.jsx("div",{className:""+(p.has("indicators","subtitle")?"col-md-6":"col-12"),children:i.jsx(h,{eRef:u,label:"Título",required:!0,placeholder:"Ej: Oferta Especial"})}),p.has("indicators","subtitle")&&i.jsx("div",{className:"col-md-6",children:i.jsx(h,{eRef:w,label:"Subtítulo",placeholder:"Ej: 20% de descuento"})}),p.has("indicators","description")&&i.jsx("div",{className:"col-12",children:i.jsx(o,{eRef:j,label:"Descripción",rows:3,placeholder:"Descripción del indicador"})}),p.has("indicators","badge")&&i.jsx("div",{className:"col-md-6",children:i.jsx(h,{eRef:y,label:"Badge",placeholder:"Ej: ¡Limitado!"})})]})})]})})})}),(p.has("indicators","symbol")||p.has("indicators","bg_image"))&&i.jsx("div",{className:"tab-pane fade",id:"multimedia",role:"tabpanel","aria-labelledby":"multimedia-tab",children:i.jsxs("div",{className:"row g-3",children:[p.has("indicators","symbol")&&i.jsx("div",{className:""+(p.has("indicators","bg_image")?"col-md-6":"col-12"),children:i.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[i.jsx("div",{className:"card-header bg-light",children:i.jsxs("h6",{className:"mb-0",children:[i.jsx("i",{className:"fas fa-icons me-2 text-primary"}),"Icono / Símbolo"]})}),i.jsxs("div",{className:"card-body",children:[i.jsx(g,{eRef:r,name:"symbol",label:"Icono del Indicador",col:"col-12",required:!R,aspect:"1/1"}),i.jsxs("small",{className:"text-muted d-block",children:[i.jsx("i",{className:"mdi mdi-information me-1"}),"Recomendado: 100x100px (1:1)"]})]})]})}),p.has("indicators","bg_image")&&i.jsx("div",{className:""+(p.has("indicators","symbol")?"col-md-6":"col-12"),children:i.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[i.jsx("div",{className:"card-header bg-light",children:i.jsxs("h6",{className:"mb-0",children:[i.jsx("i",{className:"fas fa-image me-2 text-success"}),"Imagen de Fondo"]})}),i.jsxs("div",{className:"card-body",children:[i.jsx(g,{eRef:c,name:"bg_image",label:"Imagen de Fondo del Indicador",col:"col-12",aspect:"16/9"}),i.jsxs("small",{className:"text-muted",children:[i.jsx("i",{className:"mdi mdi-information me-1"}),"Recomendado: 1200x675px (16:9)"]})]})]})}),p.has("indicators","bg_color")&&i.jsx("div",{className:"col-12",children:i.jsxs("div",{className:"card border-0 shadow-sm",children:[i.jsx("div",{className:"card-header bg-light",children:i.jsxs("h6",{className:"mb-0",children:[i.jsx("i",{className:"fas fa-palette me-2 text-warning"}),"Color de Fondo del Icono"]})}),i.jsxs("div",{className:"card-body",children:[i.jsxs("div",{className:"form-check form-switch mb-3",children:[i.jsx("input",{className:"form-check-input",type:"checkbox",id:"useBackgroundToggle",checked:_,onChange:e=>D(e.target.checked)}),i.jsx("label",{className:"form-check-label fw-semibold",htmlFor:"useBackgroundToggle",children:"Activar color de fondo personalizado"})]}),_&&i.jsx("div",{className:"row g-4",children:i.jsx("div",{className:"col-md-12",children:i.jsx("div",{className:"row g-3",children:i.jsxs("div",{className:"col-12",children:[i.jsxs("label",{className:"form-label fw-semibold mb-3",children:[i.jsx("i",{className:"fas fa-palette me-2 text-primary"}),"Selector de Color"]}),i.jsxs("div",{className:"d-flex gap-3 align-items-start",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("input",{ref:k,type:"color",value:C,onChange:e=>B(e.target.value),style:{width:"100px",height:"100px",cursor:"pointer",border:"3px solid #dee2e6",borderRadius:"12px",display:"block",padding:"0",backgroundColor:"transparent",WebkitAppearance:"none",MozAppearance:"none",appearance:"none"},title:"Click para seleccionar color"}),i.jsxs("small",{className:"text-muted d-block mt-2",children:[i.jsx("i",{className:"fas fa-hand-pointer me-1"}),"Click aquí"]})]}),i.jsxs("div",{className:"flex-grow-1",children:[i.jsxs("label",{className:"form-label small text-muted mb-2",children:[i.jsx("i",{className:"fas fa-code me-1"}),"Código Hexadecimal"]}),i.jsx("input",{type:"text",className:"form-control form-control-lg",value:C,onChange:e=>B(e.target.value),placeholder:"#71b6f9",style:{fontFamily:"monospace",fontSize:"1.1rem",letterSpacing:"1px",fontWeight:"600"}}),i.jsxs("small",{className:"text-muted d-block mt-2",children:[i.jsx("i",{className:"mdi mdi-information-outline me-1"}),"También puedes escribir el código manualmente"]})]})]})]})})})}),!_&&i.jsxs("div",{className:"alert alert-secondary mb-0 py-2",style:{fontSize:"0.875rem"},children:[i.jsx("i",{className:"mdi mdi-check-circle me-2"}),"El icono se mostrará sin color de fondo (transparente)"]})]})]})})]})}),(p.has("indicators","button_text")||p.has("indicators","button_link"))&&i.jsx("div",{className:"tab-pane fade",id:"action",role:"tabpanel","aria-labelledby":"action-tab",children:i.jsx("div",{className:"row g-3",children:i.jsx("div",{className:"col-12",children:i.jsxs("div",{className:"card border-0 shadow-sm",children:[i.jsx("div",{className:"card-header bg-light",children:i.jsxs("h6",{className:"mb-0",children:[i.jsx("i",{className:"mdi mdi-link-variant me-2 text-info"}),"Configuración del Botón (Opcional)"]})}),i.jsxs("div",{className:"card-body",children:[i.jsxs("div",{className:"row",children:[p.has("indicators","button_text")&&i.jsx("div",{className:"col-md-6",children:i.jsx(h,{eRef:v,label:"Texto del Botón",placeholder:"Ej: Ver más"})}),p.has("indicators","button_link")&&i.jsx("div",{className:"col-md-6",children:i.jsx(h,{eRef:N,label:"Enlace del Botón",placeholder:"Ej: /productos"})})]}),i.jsxs("small",{className:"text-muted mt-2 d-block",children:[i.jsx("i",{className:"mdi mdi-information me-1"}),"El botón solo se mostrará en el frontend si ambos campos están completos"]})]})]})})})})]})]})]})]})};u((e,a)=>{s.createRoot(e).render(i.jsx(r,{...a,title:"Indicadores",children:i.jsx(j,{...a})}))});
