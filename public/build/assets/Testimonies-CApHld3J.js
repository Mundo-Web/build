var e=Object.defineProperty,t=(t,a,s)=>((t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s)(t,"symbol"!=typeof a?a+"":a,s);import{c as a,j as s,r as i}from"./vendor-react-SBvaUJTK.js";import{B as r}from"./Base-BQaY-qII.js";import{S as n}from"./SwitchFormGroup-DGsB37aq.js";import{T as o}from"./TextareaFormGroup-B0EP8gtW.js";import{S as l}from"./CartKuchara-8a8jAeu-.js";import{B as c}from"./BasicRest-Cgj77E-j.js";import{B as m}from"./BasicEditing-BFGpjOPT.js";import{I as d}from"./ImageFormGroup-DPkM2HLo.js";import{I as p}from"./InputFormGroup-DuKrUAYJ.js";import{S as u}from"./SelectFormGroup-DX2Z_QEH.js";import{M as h}from"./Modal-ClgvT3ku.js";import{T as f}from"./Table-Bf8C5yZH.js";import{D as j}from"./DxButton-C6FT_beP.js";import{C as x,F as g}from"./CreateReactScript-BZ6xEkMS.js";import{R as b}from"./ReactAppend-Ix4YwdVY.js";import"./vendor-swiper-Cr_RrIb_.js";import"./Footer-BligNWSa.js";import"./TippyButton-C4KoE0lc.js";import"./Logout-BgttE_VN.js";import"./MenuItemContainer-CwLbZhxp.js";import"./Menu-CqnWUuE2.js";import"./OpenPayCardModal-C0HhlOHJ.js";import"./BooleanLimit-q2Ad9fGY.js";import"./ArrayDetails2Object-BtdyATqd.js";import"./em-DinykN4y.js";import"./HtmlContent-C3m8iMPg.js";import"./WebDetailsRest-Dzh2nCgk.js";import"./General-ClVW7qxN.js";import"./LaravelSession-ByQnaUD3.js";const v=new class extends c{constructor(){super(...arguments),t(this,"path","admin/testimonies"),t(this,"hasFiles",!0)}},y=({countries:e,details:t})=>{const r=i.useRef(),c=i.useRef(),x=i.useRef(),y=i.useRef(),N=i.useRef(),R=i.useRef(),w=i.useRef(),F=i.useRef(),D=i.useRef(),[T,C]=i.useState(!1),E=e=>{C(!!e?.id),F.current&&F.resetDeleteFlag&&F.resetDeleteFlag(),x.current.value=e?.id??"",y.current.value=e?.name??"",g.has("testimonies","role")&&(N.current.value=e?.role??""),g.has("testimonies","rating")&&(R.current.value=e?.rating??"5"),g.has("testimonies","country_id")&&$(D.current).val(e?.country_id??"89").trigger("change"),g.has("testimonies","description")&&(w.current.value=e?.description??""),F.current&&F.image&&g.has("testimonies","image")&&(F.image.src=e?.image?`/storage/images/testimony/${e.image}`:"",F.current.value=null),$(c.current).modal("show")};return s.jsxs(s.Fragment,{children:[s.jsx(f,{gridRef:r,title:s.jsx(m,{correlative:"testimonies",details:t}),rest:v,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(r.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo testimonio",hint:"Nuevo testimonio",onClick:()=>E()}})},columns:[{dataField:"id",caption:"ID",visible:!1},g.has("testimonies","image")&&{dataField:"name",caption:"Autor",cellTemplate:(e,{data:t})=>{const i=e instanceof HTMLElement?e:e.get?e.get(0):e[0];if(i){i.innerHTML="";a.createRoot(i).render(s.jsxs("div",{className:"d-flex align-items-center gap-2",children:[s.jsx("img",{className:"avatar-xs rounded-circle",src:`/storage/images/testimony/${t.image}`,alt:t.name,onError:e=>{e.target.onerror=null,e.target.src="/api/cover/thumbnail/null"}}),s.jsx("p",{className:"mb-0",style:{fontSize:"14px"},children:t.name})]}))}}},!g.has("testimonies","image")&&{dataField:"name",caption:"Autor"},g.has("testimonies","role")&&{dataField:"role",caption:"Cargo/Rol",width:"150px"},g.has("testimonies","country_id")&&{dataField:"country",caption:"País",width:"120px"},g.has("testimonies","rating")&&{dataField:"rating",caption:"Rating",width:"120px",cellTemplate:(e,{data:t})=>{const a="⭐".repeat(t.rating||0);e.html(`<span title="${t.rating}/5">${a}</span>`)}},g.has("testimonies","description")&&{dataField:"description",caption:"Testimonio",minWidth:"300px",cellTemplate:(e,{data:t})=>{e.html(`<span class="text-muted">${((e,t=100)=>e?e.length>t?e.substring(0,t)+"...":e:"")(t.description)}</span>`)}},{dataField:"visible",caption:"Visible",dataType:"boolean",cellTemplate:(e,{data:t})=>{$(e).empty(),b(e,s.jsx(n,{checked:1==t.visible,onChange:()=>(async({id:e,value:t})=>{await v.boolean({id:e,field:"visible",value:t})&&$(r.current).dxDataGrid("instance").refresh()})({id:t.id,value:!t.visible})}))}},{caption:"Acciones",cellTemplate:(e,{data:t})=>{e.append(j({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>E(t)})),e.append(j({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>(async e=>{const{isConfirmed:t}=await l.fire({title:"Eliminar testimonio",text:"¿Estas seguro de eliminar este testimonio?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});if(!t)return;await v.delete(e)&&$(r.current).dxDataGrid("instance").refresh()})(t.id)}))},allowFiltering:!1,allowExporting:!1}]}),s.jsxs(h,{modalRef:c,title:T?"Editar testimonio":"Agregar testimonio",onSubmit:async e=>{e.preventDefault();const t={id:x.current.value||void 0,name:y.current.value};g.has("testimonies","country_id")&&(t.country_id=$(D.current).val(),t.country=$(D.current).find("option:selected").text()),g.has("testimonies","role")&&(t.role=N.current.value),g.has("testimonies","rating")&&(t.rating=R.current.value),g.has("testimonies","description")&&(t.description=w.current.value);const a=new FormData;for(const s in t)a.append(s,t[s]);if(F.current&&g.has("testimonies","image")){const e=F.current.files[0];e&&a.append("image",e),F.getDeleteFlag&&F.getDeleteFlag()&&a.append("image_delete","DELETE")}await v.save(a)&&(F.resetDeleteFlag&&F.resetDeleteFlag(),$(r.current).dxDataGrid("instance").refresh(),$(c.current).modal("hide"))},size:"lg",children:[s.jsx("input",{ref:x,type:"hidden"}),s.jsx("div",{id:"testimony-container",children:s.jsxs("div",{className:"row g-3",children:[s.jsx("div",{className:"col-12",children:s.jsxs("div",{className:"card border-0 shadow-sm",children:[s.jsx("div",{className:"card-header bg-light",children:s.jsxs("h6",{className:"mb-0",children:[s.jsx("i",{className:"fas fa-user me-2 text-primary"}),"Información del Autor"]})}),s.jsx("div",{className:"card-body",children:s.jsxs("div",{className:"row g-3",children:[g.has("testimonies","image")&&s.jsxs("div",{className:"col-md-4",children:[s.jsx(d,{eRef:F,name:"image",label:"Foto del Autor",col:"col-12",aspect:1}),s.jsxs("small",{className:"text-muted",children:[s.jsx("i",{className:"fas fa-info-circle me-1"}),"Imagen cuadrada 1:1"]})]}),s.jsx("div",{className:"col-md-8",children:s.jsxs("div",{className:"row ",children:[s.jsx("div",{className:"col-md-12",children:s.jsx(p,{eRef:y,label:"Nombre Completo",placeholder:"Ej: Juan Pérez",required:!0})}),g.has("testimonies","role")&&s.jsx("div",{className:"col-md-12",children:s.jsx(p,{eRef:N,label:"Cargo/Profesión",placeholder:"Ej: Paciente Operado",required:!0})}),g.has("testimonies","country_id")&&s.jsx("div",{className:"col-md-12",children:s.jsx(u,{eRef:D,label:"País de Origen",required:!0,dropdownParent:"#testimony-container",children:e.map((e,t)=>s.jsx("option",{value:e.id,children:e.name},`country-${t}`))})}),g.has("testimonies","rating")&&s.jsx("div",{className:"col-md-12",children:s.jsx(p,{eRef:R,label:"Calificación (1-5 estrellas)",type:"number",min:"1",max:"5",placeholder:"5",required:!0})})]})})]})})]})}),g.has("testimonies","description")&&s.jsx("div",{className:"col-12",children:s.jsxs("div",{className:"card border-0 shadow-sm",children:[s.jsx("div",{className:"card-header bg-light",children:s.jsxs("h6",{className:"mb-0",children:[s.jsx("i",{className:"fas fa-comment-dots me-2 text-success"}),"Testimonio"]})}),s.jsxs("div",{className:"card-body",children:[s.jsx(o,{eRef:w,label:"Descripción del Testimonio",rows:5,placeholder:"Escribe aquí la experiencia y opinión...",required:!0}),s.jsxs("small",{className:"text-muted",children:[s.jsx("i",{className:"fas fa-info-circle me-1"}),"Describe la experiencia completa y detallada"]})]})]})})]})})]})]})};x((e,t)=>{a.createRoot(e).render(s.jsx(r,{...t,title:"Testimonios",children:s.jsx(y,{...t})}))});
