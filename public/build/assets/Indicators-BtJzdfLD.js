var _=Object.defineProperty;var C=(o,t,a)=>t in o?_(o,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[t]=a;var j=(o,t,a)=>C(o,typeof t!="symbol"?t+"":t,a);import{j as r}from"./AboutSimple-Cf8x2fCZ.js";import{B as S}from"./Base-BtKyxfJk.js";import{S as G}from"./SwitchFormGroup-DXN0cwVk.js";import{T as O}from"./TextareaFormGroup-CliirJM1.js";import{r as l}from"./index-BOnQTV8N.js";import{c as M}from"./ReactAppend-QR5TrZfj.js";import{S as A}from"./CartKuchara-D9l7c7at.js";import{B as L}from"./BasicRest-BML1C-ua.js";import{M as q}from"./Modal-xDw9ufjg.js";import{D as E}from"./DxButton-DV0H-ZcL.js";import{I as m}from"./InputFormGroup-iZIO11ZN.js";import{T as V}from"./Table-O7_BONvQ.js";import{C as z}from"./CreateReactScript-BVFa7_vB.js";import{R as y}from"./ReactAppend-Vm5G2nof.js";import{I as N}from"./ImageFormGroup-40MuGzez.js";import"./index-yBjzXJbu.js";import"./Global-Bz6gVLc5.js";import"./tippy-react.esm-DmkRJDEW.js";import"./index-pSueRYGM.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-B6ujFmsw.js";/* empty css              */import"./Logout-BpuTJ_83.js";import"./main-B6F2O9-U.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./MenuItemContainer-DcxtOi47.js";import"./index.esm-C48oHfFw.js";import"./index-ngrFHoWO.js";import"./CanAccess-BOTQKW2g.js";import"./CardProductKatya-ncpmQ0JU.js";import"./BooleanLimit-D-OsQsek.js";/* empty css               */import"./General-apRuNwp7.js";import"./LaravelSession-Dz9cpV3l.js";class P extends L{constructor(){super(...arguments);j(this,"path","admin/indicators");j(this,"hasFiles",!0)}}const d=new P,U=()=>{const o=l.useRef(),t=l.useRef(),a=l.useRef(),n=l.useRef(),c=l.useRef(),p=l.useRef(),f=l.useRef(),b=l.useRef(),x=l.useRef(),g=l.useRef(),h=l.useRef(),[R,v]=l.useState(!1),w=e=>{e!=null&&e.id?v(!0):v(!1),n.resetDeleteFlag&&n.resetDeleteFlag(),c.resetDeleteFlag&&c.resetDeleteFlag(),a.current.value=(e==null?void 0:e.id)??"",p.current.value=(e==null?void 0:e.name)??"",f.current.value=(e==null?void 0:e.description)??"",b.current.value=(e==null?void 0:e.button_text)??"",x.current.value=(e==null?void 0:e.button_link)??"",g.current.value=(e==null?void 0:e.badge)??"",h.current.value=(e==null?void 0:e.subtitle)??"",n.current.value=null,n.image.src=e!=null&&e.symbol?`/storage/images/indicator/${e.symbol}`:"",c.current.value=null,c.image.src=e!=null&&e.bg_image?`/storage/images/indicator/${e.bg_image}`:"",$(t.current).modal("show")},I=async e=>{e.preventDefault();const i={id:a.current.value||void 0,name:p.current.value,description:f.current.value,button_text:b.current.value,button_link:x.current.value,badge:g.current.value,subtitle:h.current.value},s=new FormData;for(const F in i)s.append(F,i[F]);const u=n.current.files[0];u&&s.append("symbol",u);const D=c.current.files[0];D&&s.append("bg_image",D),n.getDeleteFlag&&n.getDeleteFlag()&&s.append("symbol_delete","DELETE"),c.getDeleteFlag&&c.getDeleteFlag()&&s.append("bg_image_delete","DELETE"),await d.save(s)&&(n.resetDeleteFlag&&n.resetDeleteFlag(),c.resetDeleteFlag&&c.resetDeleteFlag(),$(o.current).dxDataGrid("instance").refresh(),$(t.current).modal("hide"))},T=async({id:e,value:i})=>{await d.boolean({id:e,field:"visible",value:i})&&$(o.current).dxDataGrid("instance").refresh()},B=async e=>{const{isConfirmed:i}=await A.fire({title:"Eliminar indicador",text:"¿Estas seguro de eliminar este indicador?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});!i||!await d.delete(e)||$(o.current).dxDataGrid("instance").refresh()},k=async e=>{const i=e.toIndex;try{await d.reorder(e.itemData.id,i)&&await e.component.refresh()}catch(s){console.error("Error reordering indicator:",s)}};return r.jsxs(r.Fragment,{children:[r.jsx(V,{gridRef:o,title:"Indicadores",rest:d,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(o.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo indicador",hint:"Nuevo indicador",onClick:()=>w()}})},rowDragging:{allowReordering:!0,onReorder:k,dropFeedbackMode:"push"},sorting:{mode:"single"},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"order_index",caption:"Orden",visible:!1,sortOrder:"asc",sortIndex:0},{dataField:"symbol",caption:"Icono",width:100,cellTemplate:(e,{data:i})=>{const s=i.symbol?`/storage/images/indicator/${i.symbol}`:"/api/cover/thumbnail/null";y(e,r.jsx("img",{src:s,style:{width:"60px",height:"60px",objectFit:"contain",objectPosition:"center",borderRadius:"4px"},onError:u=>u.target.src="/api/cover/thumbnail/null"}))}},{dataField:"name",caption:"Título",width:150},{dataField:"description",caption:"Descripción"},{dataField:"button_text",caption:"Texto del Botón",width:150},{dataField:"visible",caption:"Visible",width:80,dataType:"boolean",cellTemplate:(e,{data:i})=>{$(e).empty(),y(e,r.jsx(G,{checked:i.visible==1,onChange:()=>T({id:i.id,value:!i.visible})}))}},{caption:"Acciones",width:120,cellTemplate:(e,{data:i})=>{e.append(E({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>w(i)})),e.append(E({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>B(i.id)}))},allowFiltering:!1,allowExporting:!1}]}),r.jsx(q,{modalRef:t,title:R?"Editar indicador":"Agregar indicador",onSubmit:I,size:"lg",children:r.jsxs("div",{className:"row",id:"indicators-container",children:[r.jsx("input",{ref:a,type:"hidden"}),r.jsx("div",{className:"col-md-7 mb-3",children:r.jsx("div",{className:"card border-0 shadow-sm h-100",children:r.jsxs("div",{className:"card-body",children:[r.jsx(m,{eRef:p,label:"Título",col:"col-12",required:!0,placeholder:"Ej: Oferta Especial"}),r.jsx(m,{eRef:h,label:"Subtítulo (Opcional)",col:"col-12",placeholder:"Ej: 20% de descuento"}),r.jsx(O,{eRef:f,label:"Descripción",col:"col-12",rows:3,placeholder:"Descripción del indicador"}),r.jsx(m,{eRef:g,label:"Badge (Opcional)",col:"col-12",placeholder:"Ej: ¡Limitado!"})]})})}),r.jsx("div",{className:"col-md-5 mb-3",children:r.jsx("div",{className:"card border-0 shadow-sm h-100",children:r.jsxs("div",{className:"card-body",children:[r.jsx(N,{eRef:n,name:"symbol",label:"Icono/Símbolo",col:"col-12",required:!R,aspect:"1/1"}),r.jsxs("small",{className:"text-muted d-block mb-3",children:[r.jsx("i",{className:"mdi mdi-information me-1"}),"Recomendado: 100x100px (1:1)"]}),r.jsx(N,{eRef:c,name:"bg_image",label:"Imagen de Fondo",col:"col-12",aspect:"16/9"}),r.jsxs("small",{className:"text-muted",children:[r.jsx("i",{className:"mdi mdi-information me-1"}),"Recomendado: 1200x675px (16:9)"]})]})})}),r.jsx("div",{className:"col-12",children:r.jsx("div",{className:"card border-0 shadow-sm",children:r.jsxs("div",{className:"card-body",children:[r.jsxs("h6",{className:"card-title text-muted mb-3",children:[r.jsx("i",{className:"mdi mdi-link-variant me-2"}),"Botón de Acción (Opcional)"]}),r.jsxs("div",{className:"row",children:[r.jsx(m,{eRef:b,label:"Texto del Botón",col:"col-md-6",placeholder:"Ej: Ver más"}),r.jsx(m,{eRef:x,label:"Enlace del Botón",col:"col-md-6",placeholder:"Ej: /productos"})]}),r.jsxs("small",{className:"text-muted",children:[r.jsx("i",{className:"mdi mdi-information me-1"}),"El botón solo se mostrará si ambos campos están completos"]})]})})})]})})]})};z((o,t)=>{M.createRoot(o).render(r.jsx(S,{...t,title:"Indicadores",children:r.jsx(U,{...t})}))});
