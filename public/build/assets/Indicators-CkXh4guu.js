var M=Object.defineProperty;var O=(n,t,m)=>t in n?M(n,t,{enumerable:!0,configurable:!0,writable:!0,value:m}):n[t]=m;var w=(n,t,m)=>O(n,typeof t!="symbol"?t+"":t,m);import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{B as W}from"./Base-CHWft3X0.js";import{S as z}from"./SwitchFormGroup-DXN0cwVk.js";import{T as q}from"./TextareaFormGroup-CliirJM1.js";import{r as o}from"./index-BOnQTV8N.js";import{c as L}from"./ReactAppend-QR5TrZfj.js";import{S as V}from"./CartKuchara-D9l7c7at.js";import{B as U}from"./BasicRest-BML1C-ua.js";import{M as H}from"./Modal-xDw9ufjg.js";import{D}from"./DxButton-DV0H-ZcL.js";import{I as b}from"./InputFormGroup-iZIO11ZN.js";import{T as J}from"./Table-BBh2JpCs.js";import{C as K,F as i}from"./CreateReactScript-C-lKJ7Gs.js";import{R as E}from"./ReactAppend-Vm5G2nof.js";import{I}from"./ImageFormGroup-40MuGzez.js";import"./index-yBjzXJbu.js";import"./Global-Bz6gVLc5.js";import"./tippy-react.esm-DmkRJDEW.js";import"./index-pSueRYGM.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-B6ujFmsw.js";/* empty css              */import"./Logout-BpuTJ_83.js";import"./main-B6F2O9-U.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./MenuItemContainer-DcxtOi47.js";import"./index.esm-C48oHfFw.js";import"./index-ngrFHoWO.js";import"./CanAccess-UkN68hbD.js";import"./CardProductKatya-ncpmQ0JU.js";import"./BooleanLimit-D-OsQsek.js";/* empty css               */import"./General-CE1RDd44.js";import"./LaravelSession-Dz9cpV3l.js";class P extends U{constructor(){super(...arguments);w(this,"path","admin/indicators");w(this,"hasFiles",!0)}}const u=new P,Q=()=>{const n=o.useRef(),t=o.useRef(),m=o.useRef(),r=o.useRef(),l=o.useRef(),p=o.useRef(),x=o.useRef(),g=o.useRef(),j=o.useRef(),v=o.useRef(),N=o.useRef(),B=o.useRef(),[k,F]=o.useState(!1),[h,y]=o.useState(!1),[R,f]=o.useState("#71b6f9"),_=s=>{if(s!=null&&s.id?F(!0):F(!1),r.current&&r.resetDeleteFlag&&r.resetDeleteFlag(),l.current&&l.resetDeleteFlag&&l.resetDeleteFlag(),m.current.value=(s==null?void 0:s.id)??"",i.has("indicators","name")&&(p.current.value=(s==null?void 0:s.name)??""),i.has("indicators","description")&&(x.current.value=(s==null?void 0:s.description)??""),i.has("indicators","button_text")&&(g.current.value=(s==null?void 0:s.button_text)??""),i.has("indicators","button_link")&&(j.current.value=(s==null?void 0:s.button_link)??""),i.has("indicators","badge")&&(v.current.value=(s==null?void 0:s.badge)??""),i.has("indicators","subtitle")&&(N.current.value=(s==null?void 0:s.subtitle)??""),i.has("indicators","bg_color")){const a=(s==null?void 0:s.bg_color)??"transparent";a!=="transparent"&&a!==""?(y(!0),f(a.startsWith("#")?a:"#71b6f9")):(y(!1),f("#71b6f9"))}i.has("indicators","symbol")&&r.current&&r.image&&(r.current.value=null,r.image.src=s!=null&&s.symbol?`/storage/images/indicator/${s.symbol}`:""),i.has("indicators","bg_image")&&l.current&&l.image&&(l.current.value=null,l.image.src=s!=null&&s.bg_image?`/storage/images/indicator/${s.bg_image}`:""),$(t.current).modal("show")},T=async s=>{s.preventDefault();const a={id:m.current.value||void 0};i.has("indicators","name")&&(a.name=p.current.value),i.has("indicators","description")&&(a.description=x.current.value),i.has("indicators","button_text")&&(a.button_text=g.current.value),i.has("indicators","button_link")&&(a.button_link=j.current.value),i.has("indicators","badge")&&(a.badge=v.current.value),i.has("indicators","subtitle")&&(a.subtitle=N.current.value),i.has("indicators","bg_color")&&(a.bg_color=h?R:"transparent");const c=new FormData;for(const d in a)c.append(d,a[d]);if(r.current&&i.has("indicators","symbol")){const d=r.current.files[0];d&&c.append("symbol",d),r.getDeleteFlag&&r.getDeleteFlag()&&c.append("symbol_delete","DELETE")}if(l.current&&i.has("indicators","bg_image")){const d=l.current.files[0];d&&c.append("bg_image",d),l.getDeleteFlag&&l.getDeleteFlag()&&c.append("bg_image_delete","DELETE")}await u.save(c)&&(r.current&&r.resetDeleteFlag&&r.resetDeleteFlag(),l.current&&l.resetDeleteFlag&&l.resetDeleteFlag(),$(n.current).dxDataGrid("instance").refresh(),$(t.current).modal("hide"))},S=async({id:s,value:a})=>{await u.boolean({id:s,field:"visible",value:a})&&$(n.current).dxDataGrid("instance").refresh()},G=async s=>{const{isConfirmed:a}=await V.fire({title:"Eliminar indicador",text:"¿Estas seguro de eliminar este indicador?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});!a||!await u.delete(s)||$(n.current).dxDataGrid("instance").refresh()},A=async s=>{const a=s.toIndex;try{await u.reorder(s.itemData.id,a)&&await s.component.refresh()}catch(c){console.error("Error reordering indicator:",c)}};return e.jsxs(e.Fragment,{children:[e.jsx(J,{gridRef:n,title:"Indicadores",rest:u,toolBar:s=>{s.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(n.current).dxDataGrid("instance").refresh()}}),s.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo indicador",hint:"Nuevo indicador",onClick:()=>_()}})},rowDragging:{allowReordering:!0,onReorder:A,dropFeedbackMode:"push"},sorting:{mode:"single"},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"order_index",caption:"Orden",visible:!1,sortOrder:"asc",sortIndex:0},i.has("indicators","symbol")&&{dataField:"symbol",caption:"Icono",width:100,cellTemplate:(s,{data:a})=>{const c=a.symbol?`/storage/images/indicator/${a.symbol}`:"/api/cover/thumbnail/null",C=a.bg_color||"transparent";E(s,e.jsx("div",{style:{width:"60px",height:"60px",backgroundColor:C,borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",padding:"4px"},children:e.jsx("img",{src:c,style:{width:"100%",height:"100%",objectFit:"contain"},onError:d=>d.target.src="/api/cover/thumbnail/null"})}))}},i.has("indicators","name")&&{dataField:"name",caption:"Título",width:150},i.has("indicators","description")&&{dataField:"description",caption:"Descripción"},i.has("indicators","button_text")&&{dataField:"button_text",caption:"Texto del Botón",width:150},i.has("indicators","visible")&&{dataField:"visible",caption:"Visible",width:80,dataType:"boolean",cellTemplate:(s,{data:a})=>{$(s).empty(),E(s,e.jsx(z,{checked:a.visible==1,onChange:()=>S({id:a.id,value:!a.visible})}))}},{caption:"Acciones",width:120,cellTemplate:(s,{data:a})=>{s.append(D({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>_(a)})),s.append(D({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>G(a.id)}))},allowFiltering:!1,allowExporting:!1}]}),e.jsxs(H,{modalRef:t,title:k?"Editar indicador":"Agregar indicador",onSubmit:T,size:"lg",children:[e.jsx("input",{ref:m,type:"hidden"}),e.jsxs("div",{id:"indicators-container",children:[e.jsxs("ul",{className:"nav nav-pills nav-justified mb-4",role:"tablist",style:{backgroundColor:"#f8f9fa",borderRadius:"8px",padding:"4px",border:"1px solid #e9ecef"},children:[e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsxs("button",{className:"nav-link active",id:"basic-info-tab","data-bs-toggle":"pill","data-bs-target":"#basic-info",type:"button",role:"tab","aria-controls":"basic-info","aria-selected":"true",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[e.jsx("i",{className:"fas fa-info-circle me-2"}),"Información Básica"]})}),(i.has("indicators","symbol")||i.has("indicators","bg_image"))&&e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsxs("button",{className:"nav-link",id:"multimedia-tab","data-bs-toggle":"pill","data-bs-target":"#multimedia",type:"button",role:"tab","aria-controls":"multimedia","aria-selected":"false",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[e.jsx("i",{className:"fas fa-images me-2"}),"Multimedia"]})}),(i.has("indicators","button_text")||i.has("indicators","button_link"))&&e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsxs("button",{className:"nav-link",id:"action-tab","data-bs-toggle":"pill","data-bs-target":"#action",type:"button",role:"tab","aria-controls":"action","aria-selected":"false",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[e.jsx("i",{className:"fas fa-link me-2"}),"Botón de Acción"]})})]}),e.jsxs("div",{className:"tab-content",children:[e.jsx("div",{className:"tab-pane fade show active",id:"basic-info",role:"tabpanel","aria-labelledby":"basic-info-tab",children:e.jsx("div",{className:"row g-3",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card border-0 shadow-sm",children:[e.jsx("div",{className:"card-header bg-light",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-tag me-2 text-primary"}),"Información del Indicador"]})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[i.has("indicators","name")&&e.jsx("div",{className:`${i.has("indicators","subtitle")?"col-md-6":"col-12"}`,children:e.jsx(b,{eRef:p,label:"Título",required:!0,placeholder:"Ej: Oferta Especial"})}),i.has("indicators","subtitle")&&e.jsx("div",{className:"col-md-6",children:e.jsx(b,{eRef:N,label:"Subtítulo",placeholder:"Ej: 20% de descuento"})}),i.has("indicators","description")&&e.jsx("div",{className:"col-12",children:e.jsx(q,{eRef:x,label:"Descripción",rows:3,placeholder:"Descripción del indicador"})}),i.has("indicators","badge")&&e.jsx("div",{className:"col-md-6",children:e.jsx(b,{eRef:v,label:"Badge",placeholder:"Ej: ¡Limitado!"})})]})})]})})})}),(i.has("indicators","symbol")||i.has("indicators","bg_image"))&&e.jsx("div",{className:"tab-pane fade",id:"multimedia",role:"tabpanel","aria-labelledby":"multimedia-tab",children:e.jsxs("div",{className:"row g-3",children:[i.has("indicators","symbol")&&e.jsx("div",{className:`${i.has("indicators","bg_image")?"col-md-6":"col-12"}`,children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header bg-light",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-icons me-2 text-primary"}),"Icono / Símbolo"]})}),e.jsxs("div",{className:"card-body",children:[e.jsx(I,{eRef:r,name:"symbol",label:"Icono del Indicador",col:"col-12",required:!k,aspect:"1/1"}),e.jsxs("small",{className:"text-muted d-block",children:[e.jsx("i",{className:"mdi mdi-information me-1"}),"Recomendado: 100x100px (1:1)"]})]})]})}),i.has("indicators","bg_image")&&e.jsx("div",{className:`${i.has("indicators","symbol")?"col-md-6":"col-12"}`,children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header bg-light",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-image me-2 text-success"}),"Imagen de Fondo"]})}),e.jsxs("div",{className:"card-body",children:[e.jsx(I,{eRef:l,name:"bg_image",label:"Imagen de Fondo del Indicador",col:"col-12",aspect:"16/9"}),e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"mdi mdi-information me-1"}),"Recomendado: 1200x675px (16:9)"]})]})]})}),i.has("indicators","bg_color")&&e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card border-0 shadow-sm",children:[e.jsx("div",{className:"card-header bg-light",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-palette me-2 text-warning"}),"Color de Fondo del Icono"]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"form-check form-switch mb-3",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"useBackgroundToggle",checked:h,onChange:s=>y(s.target.checked)}),e.jsx("label",{className:"form-check-label fw-semibold",htmlFor:"useBackgroundToggle",children:"Activar color de fondo personalizado"})]}),h&&e.jsx("div",{className:"row g-4",children:e.jsx("div",{className:"col-md-12",children:e.jsx("div",{className:"row g-3",children:e.jsxs("div",{className:"col-12",children:[e.jsxs("label",{className:"form-label fw-semibold mb-3",children:[e.jsx("i",{className:"fas fa-palette me-2 text-primary"}),"Selector de Color"]}),e.jsxs("div",{className:"d-flex gap-3 align-items-start",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("input",{ref:B,type:"color",value:R,onChange:s=>f(s.target.value),style:{width:"100px",height:"100px",cursor:"pointer",border:"3px solid #dee2e6",borderRadius:"12px",display:"block",padding:"0",backgroundColor:"transparent",WebkitAppearance:"none",MozAppearance:"none",appearance:"none"},title:"Click para seleccionar color"}),e.jsxs("small",{className:"text-muted d-block mt-2",children:[e.jsx("i",{className:"fas fa-hand-pointer me-1"}),"Click aquí"]})]}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsxs("label",{className:"form-label small text-muted mb-2",children:[e.jsx("i",{className:"fas fa-code me-1"}),"Código Hexadecimal"]}),e.jsx("input",{type:"text",className:"form-control form-control-lg",value:R,onChange:s=>f(s.target.value),placeholder:"#71b6f9",style:{fontFamily:"monospace",fontSize:"1.1rem",letterSpacing:"1px",fontWeight:"600"}}),e.jsxs("small",{className:"text-muted d-block mt-2",children:[e.jsx("i",{className:"mdi mdi-information-outline me-1"}),"También puedes escribir el código manualmente"]})]})]})]})})})}),!h&&e.jsxs("div",{className:"alert alert-secondary mb-0 py-2",style:{fontSize:"0.875rem"},children:[e.jsx("i",{className:"mdi mdi-check-circle me-2"}),"El icono se mostrará sin color de fondo (transparente)"]})]})]})})]})}),(i.has("indicators","button_text")||i.has("indicators","button_link"))&&e.jsx("div",{className:"tab-pane fade",id:"action",role:"tabpanel","aria-labelledby":"action-tab",children:e.jsx("div",{className:"row g-3",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card border-0 shadow-sm",children:[e.jsx("div",{className:"card-header bg-light",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"mdi mdi-link-variant me-2 text-info"}),"Configuración del Botón (Opcional)"]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row",children:[i.has("indicators","button_text")&&e.jsx("div",{className:"col-md-6",children:e.jsx(b,{eRef:g,label:"Texto del Botón",placeholder:"Ej: Ver más"})}),i.has("indicators","button_link")&&e.jsx("div",{className:"col-md-6",children:e.jsx(b,{eRef:j,label:"Enlace del Botón",placeholder:"Ej: /productos"})})]}),e.jsxs("small",{className:"text-muted mt-2 d-block",children:[e.jsx("i",{className:"mdi mdi-information me-1"}),"El botón solo se mostrará en el frontend si ambos campos están completos"]})]})]})})})})]})]})]})]})};K((n,t)=>{L.createRoot(n).render(e.jsx(W,{...t,title:"Indicadores",children:e.jsx(Q,{...t})}))});
