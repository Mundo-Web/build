import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{B as vs}from"./Base-7Lnuhu9D.js";import{S as C}from"./SwitchFormGroup-DXN0cwVk.js";import{T as ys}from"./TextareaFormGroup-CliirJM1.js";import{r as n}from"./index-BOnQTV8N.js";import{c as Ns}from"./ReactAppend-CxMClIhj.js";import{s as Y}from"./server.browser-Bf4gQIc7.js";import{S as H}from"./CartKuchara-CVImXKD8.js";import{I as Oe}from"./ItemsRest-DHtNdnWM.js";import{M as Te}from"./Modal-xDw9ufjg.js";import{T as ws}from"./Table-Y6HnbrqJ.js";import{I as pe}from"./ImageFormGroup-40MuGzez.js";import{I as S}from"./InputFormGroup-iZIO11ZN.js";import{Q as Rs}from"./QuillFormGroup-BXX8qnUc.js";import{S as Fe}from"./SelectAPIFormGroup-dbNVmgfP.js";import{S as Z}from"./SelectFormGroup-X8WqJHHl.js";import{D as Ee}from"./DxButton-DV0H-ZcL.js";import{C as Ds,F as o}from"./CreateReactScript-Ci_XyXi1.js";import{C as Pe,N as Ae}from"./Number2Currency-jIsa99f9.js";import{R as j}from"./ReactAppend-C2Knef3a.js";import{S as $e}from"./SetSelectValue-UxyCmHse.js";import"./main-iQpBVKTZ.js";import{t as ks}from"./CardProductKatya-BPLqIfPk.js";import{D as Me}from"./DynamicField-DFjsryM4.js";import"./index-yBjzXJbu.js";import"./Global-Bz6gVLc5.js";import"./tippy-react.esm-BGU1pa2o.js";import"./index-B8-haksW.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-BLHw34Di.js";/* empty css              */import"./Logout-DK3gcKZh.js";import"./MenuItemContainer-B4uedZKJ.js";import"./index.esm-BaU9YRy4.js";import"./index-B9ygI19o.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./CanAccess-BlvzCYjQ.js";import"./BasicRest-tjV1jpAY.js";import"./BooleanLimit-D-OsQsek.js";/* empty css               */import"./General-apRuNwp7.js";import"./LaravelSession-Dz9cpV3l.js";const Cs=new Oe,Ss=({gridRef:L,modalRef:P,excelTemplate:K})=>{const[I,z]=n.useState(null),[ee,Q]=n.useState(!1),[p,v]=n.useState(""),[_,y]=n.useState(!1),[f,N]=n.useState("reset"),B=m=>{z(m.target.files[0])},W=async()=>{var A,M;if(!I){v("Por favor, selecciona un archivo."),y(!0);return}const m=new FormData;m.append("file",I),m.append("mode",f),Q(!0);try{const u=await Cs.importData(m);if(u.error){const U=Array.isArray(u.error)?u.error.join(`
`):u.error;v(`Error en la importación:
${U}`),y(!0)}else v(u.message),y(!1),$(L.current).dxDataGrid("instance").refresh(),$(P.current).modal("hide"),ks.success("Importacion completada con exito",{description:"Todos tus productos han sido importados correctamente.",duration:3e3,position:"bottom-center",richColors:!0})}catch(u){v("Error al importar: "+(((M=(A=u.response)==null?void 0:A.data)==null?void 0:M.error)||u.message)),y(!0)}Q(!1)};return e.jsxs("div",{className:"bg-white p-4",children:[e.jsx("div",{className:"mb-4 pb-3 border-bottom",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsx("h5",{className:"mb-0 text-dark fw-semibold",children:"Importar Productos"}),K&&e.jsxs("a",{href:`/cloud/${K}`,download:!0,className:"btn btn-sm btn-outline-secondary",children:[e.jsx("i",{className:"fas fa-download me-2"}),"Descargar Plantilla"]})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label text-dark fw-semibold mb-3",children:"Modo de Importación"}),e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:`card h-100 ${f==="reset"?"border-primary":"border"}`,style:{cursor:"pointer",transition:"all 0.2s ease",borderWidth:f==="reset"?"2px":"1px"},onClick:()=>N("reset"),children:e.jsx("div",{className:"card-body p-3",children:e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("input",{className:"form-check-input mt-1 me-3 flex-shrink-0",type:"radio",name:"importMode",id:"modeReset",value:"reset",checked:f==="reset",onChange:m=>N(m.target.value),style:{width:"20px",height:"20px",borderRadius:"50%"}}),e.jsxs("label",{className:"form-check-label flex-grow-1",htmlFor:"modeReset",style:{cursor:"pointer"},children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center me-2",style:{width:"36px",height:"36px",borderRadius:"8px",background:"#6c757d",color:"white"},children:e.jsx("i",{className:"fas fa-redo-alt"})}),e.jsx("strong",{className:"text-dark",children:"Importar desde cero"})]}),e.jsx("small",{className:"text-muted",children:"Reemplaza todos los productos existentes con los del archivo Excel"})]})]})})})}),e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:`card h-100 ${f==="add_update"?"border-primary":"border"}`,style:{cursor:"pointer",transition:"all 0.2s ease",borderWidth:f==="add_update"?"2px":"1px"},onClick:()=>N("add_update"),children:e.jsx("div",{className:"card-body p-3",children:e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("input",{className:"form-check-input mt-1 me-3 flex-shrink-0",type:"radio",name:"importMode",id:"modeAddUpdate",value:"add_update",checked:f==="add_update",onChange:m=>N(m.target.value),style:{width:"20px",height:"20px",borderRadius:"50%"}}),e.jsxs("label",{className:"form-check-label flex-grow-1",htmlFor:"modeAddUpdate",style:{cursor:"pointer"},children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center me-2",style:{width:"36px",height:"36px",borderRadius:"8px",background:"#0d6efd",color:"white"},children:e.jsx("i",{className:"fas fa-sync-alt"})}),e.jsx("strong",{className:"text-dark",children:"Agregar / Actualizar"})]}),e.jsx("small",{className:"text-muted",children:"Actualiza productos existentes (por SKU) o agrega nuevos sin eliminar"})]})]})})})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label text-dark fw-semibold mb-2",children:"Archivo Excel"}),e.jsx("input",{className:"form-control form-control-lg",type:"file",accept:".xlsx,.xls",onChange:B}),I&&e.jsxs("div",{className:"mt-2 p-2 bg-light rounded d-flex align-items-center",children:[e.jsx("i",{className:"fas fa-file-excel text-success me-2",style:{fontSize:"20px"}}),e.jsx("div",{className:"flex-grow-1",children:e.jsx("span",{className:"text-dark",children:I.name})}),e.jsx("button",{type:"button",className:"btn btn-sm btn-light",onClick:()=>z(null),children:e.jsx("i",{className:"fas fa-times"})})]})]}),e.jsx("button",{onClick:W,disabled:ee||!I,className:"btn btn-primary btn-lg w-100",type:"button",children:ee?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Procesando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-upload me-2"}),"Importar Productos"]})}),p&&e.jsx("div",{className:`alert ${_?"alert-danger":"alert-success"} mt-3 mb-0`,role:"alert",children:e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("i",{className:`fas ${_?"fa-exclamation-circle":"fa-check-circle"} me-2 mt-1`}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("strong",{children:_?"Error":"Completado"}),e.jsx("div",{className:"mt-1",children:p})]})]})})]})},G=new Oe,Is=({categories:L,brands:P,collections:K,stores:I,generals:z})=>{//!FALTA EDIT AND DELETEDE GALERIA
var Ne;const[ee,Q]=n.useState([]),p=n.useRef(),v=n.useRef(),_=n.useRef(),y=n.useRef(),f=n.useRef(),N=n.useRef(),B=n.useRef(),W=n.useRef(),m=n.useRef(),A=n.useRef(),M=n.useRef(),u=n.useRef(),U=n.useRef(),se=n.useRef(),h=n.useRef(),x=n.useRef(),g=n.useRef(),te=n.useRef(),re=n.useRef(),ae=n.useRef(),q=n.useRef(),Ve=n.useRef([]),Ge=n.useRef([]),le=n.useRef(),[Le,he]=n.useState(!1),[ze,Be]=n.useState(null),[_s,We]=n.useState(null),[Ts,Ue]=n.useState(null),[b,w]=n.useState([]),xe=n.useRef(),[R,T]=n.useState([]),ge=n.useRef(),[D,F]=n.useState([]),ie=n.useRef(),qe=s=>{const r=Array.from(s.target.files).map(a=>({file:a,url:URL.createObjectURL(a)}));w(a=>[...a,...r])},Je=s=>{s.preventDefault();const r=Array.from(s.dataTransfer.files).map(a=>({file:a,url:URL.createObjectURL(a)}));w(a=>[...a,...r])},He=s=>{s.preventDefault()},Ke=(s,t)=>{s.preventDefault(),b[t].id?w(a=>a.map((l,c)=>c===t?{...l,toDelete:!0}:l)):w(a=>a.filter((l,c)=>c!==t))},[k,ne]=n.useState(null),Qe=(s,t)=>{ne(t),s.dataTransfer.effectAllowed="move"},Xe=()=>{ne(null)},Ye=s=>{s.preventDefault(),s.dataTransfer.dropEffect="move"},Ze=(s,t)=>{if(s.preventDefault(),k===null||k===t)return;const r=[...b],a=r[k];r.splice(k,1),r.splice(t,0,a),w(r),ne(null)},es=s=>{const r=Array.from(s.target.files).map(a=>({file:a,name:a.name,url:URL.createObjectURL(a)}));T(a=>[...a,...r])},ss=(s,t)=>{s.preventDefault();const r=R[t];r.url&&!r.file?T(a=>a.map((l,c)=>c===t?{...l,toDelete:!0}:l)):T(a=>a.filter((l,c)=>c!==t))},[O,oe]=n.useState(null),ts=(s,t)=>{oe(t),s.dataTransfer.effectAllowed="move"},rs=()=>{oe(null)},as=s=>{s.preventDefault(),s.dataTransfer.dropEffect="move"},ls=(s,t)=>{if(s.preventDefault(),O===null||O===t)return;const r=[...R],a=r[O];r.splice(O,1),r.splice(t,0,a),T(r),oe(null)},is=s=>{s.preventDefault();const t=ie.current.value.trim();t&&(F(r=>[...r,{url:t,order:r.length+1}]),ie.current.value="")},ns=(s,t)=>{s.preventDefault();const r=D[t];r.order&&!r.new?F(a=>a.map((l,c)=>c===t?{...l,toDelete:!0}:l)):F(a=>a.filter((l,c)=>c!==t))},[V,ce]=n.useState(null),os=(s,t)=>{ce(t),s.dataTransfer.effectAllowed="move"},cs=()=>{ce(null)},ds=s=>{s.preventDefault(),s.dataTransfer.dropEffect="move"},ms=(s,t)=>{if(s.preventDefault(),V===null||V===t)return;const r=[...D],a=r[V];r.splice(V,1),r.splice(t,0,a),F(r),ce(null)},be=s=>{var t,r,a;if(Q(s||null),s!=null&&s.id?he(!0):he(!1),_.current.value=(s==null?void 0:s.id)||"",$(y.current).val((s==null?void 0:s.category_id)||null).trigger("change"),$(f.current).val((s==null?void 0:s.collection_id)||null).trigger("change"),$e(N.current,(t=s==null?void 0:s.subcategory)==null?void 0:t.id,(r=s==null?void 0:s.subcategory)==null?void 0:r.name),$(B.current).val((s==null?void 0:s.brand_id)||null).trigger("change"),$(q.current).val(s!=null&&s.store_id&&s.store_id!==""?s.store_id:"").trigger("change"),W.current.value=(s==null?void 0:s.name)||"",re.current.value=(s==null?void 0:s.sku)||"",m.current.value=(s==null?void 0:s.color)||"",A.current.value=(s==null?void 0:s.size)||"",M.current.value=(s==null?void 0:s.summary)||"",u.current.value=(s==null?void 0:s.price)||0,U.current.value=(s==null?void 0:s.discount)||0,le.current.value=(s==null?void 0:s.weight)||0,$e(se.current,(s==null?void 0:s.tags)??[],"id","name"),h.current.value=null,x.current.value=null,h.image.src=s!=null&&s.banner?`/storage/images/item/${s.banner}`:"",x.image.src=s!=null&&s.image?`/storage/images/item/${s.image}`:"",g.image.src=s!=null&&s.texture?`/storage/images/item/${s.texture}`:"",te.editor.root.innerHTML=(s==null?void 0:s.description)??"",s!=null&&s.pdf&&Array.isArray(s.pdf)){const l=s.pdf.map(c=>({url:c.url?`/storage/images/item/${c.url}`:c,name:c.name||"Documento.pdf",order:c.order||0}));T(l)}else T([]);if(s!=null&&s.linkvideo&&Array.isArray(s.linkvideo)?F(s.linkvideo.map(l=>({url:l.url||l,order:l.order||0}))):F([]),s!=null&&s.images){const l=s.images.map(c=>({id:c.id,url:`/storage/images/item/${c.url}`}));w(l)}else w([]);s!=null&&s.specifications?de(s.specifications.map(l=>({type:l.type,title:l.title,description:l.description,image:l.image||""}))):de([]),ve(((a=s==null?void 0:s.features)==null?void 0:a.map(l=>typeof l=="object"?l:{feature:l}))||[]),ae.current.value=s==null?void 0:s.stock,h.deleteRef&&(h.deleteRef.value=""),x.deleteRef&&(x.deleteRef.value=""),g.deleteRef&&(g.deleteRef.value=""),$(v.current).modal("show")},us=async s=>{s.preventDefault();const t=je.filter(i=>{var d;return typeof i=="string"?i.trim()!=="":typeof i=="object"?((d=i.feature)==null?void 0:d.trim())!=="":!1}),r=ye.filter(i=>i.title&&i.title.trim()!==""||i.description&&i.description.trim()!==""),a={id:_.current.value||void 0,category_id:y.current.value,collection_id:f.current.value||null,subcategory_id:N.current.value,brand_id:B.current.value,name:W.current.value,sku:re.current.value,color:m.current.value,size:A.current.value,summary:M.current.value,price:u.current.value,discount:U.current.value,tags:$(se.current).val(),description:te.current.value,stock:ae.current.value||0,features:t,specifications:r,weight:le.current.value||0,store_id:q.current.value&&q.current.value!==""?q.current.value:null},l=new FormData;for(const i in a)if(i==="features"||i==="specifications")l.append(i,JSON.stringify(a[i]));else if(i==="tags"){const d=a[i];Array.isArray(d)?d.forEach((bs,js)=>{l.append(`tags[${js}]`,bs)}):d&&l.append("tags[0]",d)}else l.append(i,a[i]);const c=x.current.files[0];c&&l.append("image",c);const J=g.current.files[0];J&&l.append("texture",J);const we=h.current.files[0];we&&l.append("banner",we);const Re=R.filter(i=>!i.toDelete);let De=0;Re.forEach(i=>{i.file&&(l.append(`pdf[${De}]`,i.file),De++)});const ke=Re.map((i,d)=>({index:d,order:d+1,name:i.name||"Documento.pdf"}));ke.length>0&&l.append("pdf_order",JSON.stringify(ke));const Ce=R.map((i,d)=>i.toDelete?d:null).filter(i=>i!==null);Ce.length>0&&l.append("deleted_pdfs",JSON.stringify(Ce));const Se=D.filter(i=>!i.toDelete).map((i,d)=>({url:i.url,order:d+1}));Se.length>0&&l.append("linkvideo",JSON.stringify(Se));const Ie=D.map((i,d)=>i.toDelete?d:null).filter(i=>i!==null);Ie.length>0&&l.append("deleted_videos",JSON.stringify(Ie)),h.getDeleteFlag&&h.getDeleteFlag()&&l.append("banner_delete","DELETE"),x.getDeleteFlag&&x.getDeleteFlag()&&l.append("image_delete","DELETE"),g.getDeleteFlag&&g.getDeleteFlag()&&l.append("texture_delete","DELETE");let ue=0,fe=0;const X=[];b.forEach((i,d)=>{i.toDelete||(i.file?(l.append(`gallery[${ue}]`,i.file),X.push({type:"new",index:ue}),ue++):(l.append(`gallery_ids[${fe}]`,i.id),X.push({type:"existing",id:i.id,index:fe}),fe++))}),X.length>0&&l.append("gallery_order",JSON.stringify(X));const _e=b.filter(i=>i.toDelete).map(i=>i.id);_e.length>0&&_e.forEach((i,d)=>{l.append(`deleted_images[${d}]`,i)});for(let[i,d]of l.entries());await G.save(l)&&(h.resetDeleteFlag&&h.resetDeleteFlag(),x.resetDeleteFlag&&x.resetDeleteFlag(),g.resetDeleteFlag&&g.resetDeleteFlag(),$(p.current).dxDataGrid("instance").refresh(),$(v.current).modal("hide"),w([]),T([]),F([]))},fs=async({id:s,value:t})=>{await G.boolean({id:s,field:"visible",value:t})&&$(p.current).dxDataGrid("instance").refresh()},E=async({id:s,field:t,value:r})=>{await G.boolean({id:s,field:t,value:r})&&$(p.current).dxDataGrid("instance").refresh()},ps=async s=>{const{isConfirmed:t}=await H.fire({title:"Eliminar item",text:"¿Estás seguro de eliminar este item?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!t||!await G.delete(s)||$(p.current).dxDataGrid("instance").refresh()},[je,ve]=n.useState([]),[ye,de]=n.useState([]),hs=["Principal","General"],[Fs,Es]=n.useState(!1),me=n.useRef(),xs=()=>{$(me.current).modal("show")},gs=async()=>{try{H.fire({title:"Exportando items...",text:"Por favor espere",allowOutsideClick:!1,didOpen:()=>{H.showLoading()}}),await G.exportData(),H.fire({icon:"success",title:"Exportación exitosa",text:"El archivo se ha descargado correctamente",timer:2e3})}catch(s){console.error("Error al exportar:",s),H.fire({icon:"error",title:"Error",text:s.message||"No se pudo exportar los items. Por favor intente nuevamente."})}};return e.jsxs(e.Fragment,{children:[e.jsx(ws,{gridRef:p,title:"Items",rest:G,toolBar:s=>{s.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(p.current).dxDataGrid("instance").refresh()}}),s.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Agregar",hint:"Agregar",onClick:()=>be()}}),s.unshift({widget:"dxButton",location:"after",options:{icon:"upload",text:"Importar Datos",hint:"Importar Datos",onClick:()=>xs()}}),s.unshift({widget:"dxButton",location:"after",options:{icon:"download",text:"Exportar Items",hint:"Exportar Items (Formato Excel)",onClick:()=>gs()}})},exportable:!0,exportableName:"Items",columns:[{dataField:"id",caption:"ID",visible:!1},o.has("items","category_id")&&{dataField:"category.name",caption:"Categoría",width:"120px",cellTemplate:(s,{data:t})=>{var r,a,l;s.html(Y.renderToString(e.jsxs(e.Fragment,{children:[e.jsx("b",{className:"d-block fst-italic text-muted",children:(r=t.collection)==null?void 0:r.name}),e.jsx("b",{className:"d-block",children:(a=t.category)==null?void 0:a.name}),e.jsx("small",{className:"text-muted",children:(l=t.subcategory)==null?void 0:l.name})]})))}},o.has("items","subcategory_id")&&{dataField:"subcategory.name",caption:"Subcategoría",visible:!1},o.has("items","brand_id")&&{dataField:"brand.name",caption:"Marca",width:"120px"},{dataField:"name",caption:"Nombre",minWidth:"300px",cellTemplate:(s,{data:t})=>{const a=((l,c)=>{if(!l)return"";const J=l.split(" ");return J.length>c?J.slice(0,c).join(" ")+"...":l})(t.summary,12);s.html(Y.renderToString(e.jsxs(e.Fragment,{children:[e.jsx("b",{children:t.name}),e.jsx("br",{}),e.jsx("span",{children:a})]})))}},o.has("items","sku")&&{dataField:"sku",caption:"SKU",width:"120px"},{dataField:"final_price",caption:"Precio",dataType:"number",width:"75px",cellTemplate:(s,{data:t})=>{s.html(Y.renderToString(e.jsxs(e.Fragment,{children:[t.discount>0&&e.jsxs("small",{className:"d-block text-muted",style:{textDecoration:"line-through"},children:[Pe()," ",Ae(t.price)]}),e.jsxs("span",{children:[Pe()," ",Ae(t.discount>0?t.discount:t.price)]})]})))}},o.has("items","weight")&&{dataField:"weight",caption:"Peso",dataType:"number",width:"75px"},{dataField:"image",caption:"Imagen",width:"90px",allowFiltering:!1,cellTemplate:(s,{data:t})=>{j(s,e.jsx("img",{src:`/storage/images/item/${t.image}`,style:{width:"80px",height:"48px",objectFit:"cover",objectPosition:"center",borderRadius:"4px"},onError:r=>r.target.src="/api/cover/thumbnail/null"}))}},o.has("items","is_new")&&{dataField:"is_new",caption:"Nuevo",dataType:"boolean",width:"80px",cellTemplate:(s,{data:t})=>{const r=t.is_new===1||t.is_new==="1"||t.is_new===!0;j(s,e.jsx(C,{checked:r,onChange:a=>E({id:t.id,field:"is_new",value:a.target.checked?1:0})}))}},o.has("items","offering")&&{dataField:"offering",caption:"En oferta",dataType:"boolean",width:"80px",cellTemplate:(s,{data:t})=>{const r=t.offering===1||t.offering==="1"||t.offering===!0;j(s,e.jsx(C,{checked:r,onChange:a=>E({id:t.id,field:"offering",value:a.target.checked?1:0})}))}},o.has("items","recommended")&&{dataField:"recommended",caption:"Recomendado",dataType:"boolean",width:"80px",cellTemplate:(s,{data:t})=>{const r=t.recommended===1||t.recommended==="1"||t.recommended===!0;j(s,e.jsx(C,{checked:r,onChange:a=>E({id:t.id,field:"recommended",value:a.target.checked?1:0})}))}},o.has("items","featured")&&{dataField:"featured",caption:"Destacado",dataType:"boolean",width:"80px",cellTemplate:(s,{data:t})=>{const r=t.featured===1||t.featured==="1"||t.featured===!0;j(s,e.jsx(C,{checked:r,onChange:a=>E({id:t.id,field:"featured",value:a.target.checked?1:0})}))}},{dataField:"views",caption:"Vistas",dataType:"number",width:"80px",cellTemplate:(s,{data:t})=>{const r=t.views||0;s.html(Y.renderToString(e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-eye text-primary me-1"}),e.jsx("span",{className:"fw-bold",children:r.toLocaleString()})]})))}},o.has("items","most_view")&&{dataField:"most_view",caption:"Más visto",dataType:"boolean",width:"80px",cellTemplate:(s,{data:t})=>{const r=t.most_view===1||t.most_view==="1"||t.most_view===!0;j(s,e.jsx(C,{checked:r,onChange:a=>E({id:t.id,field:"most_view",value:a.target.checked?1:0})}))}},o.has("items","is_detail")&&{dataField:"is_detail",caption:"Con Detalle",dataType:"boolean",width:"90px",cellTemplate:(s,{data:t})=>{const r=t.is_detail===1||t.is_detail==="1"||t.is_detail===!0;j(s,e.jsx(C,{checked:r,onChange:a=>E({id:t.id,field:"is_detail",value:a.target.checked?1:0})}))}},o.has("items","sold_out")&&{dataField:"sold_out",caption:"Agotado",dataType:"boolean",width:"85px",cellTemplate:(s,{data:t})=>{const r=t.sold_out===1||t.sold_out==="1"||t.sold_out===!0;j(s,e.jsx(C,{checked:r,onChange:a=>E({id:t.id,field:"sold_out",value:a.target.checked?1:0})}))}},o.has("items","visible")&&{dataField:"visible",caption:"Visible",dataType:"boolean",width:"80px",cellTemplate:(s,{data:t})=>{j(s,e.jsx(C,{checked:t.visible,onChange:r=>fs({id:t.id,value:r.target.checked})}))}},{caption:"Acciones",width:"100px",cellTemplate:(s,{data:t})=>{s.css("text-overflow","unset"),s.append(Ee({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>be(t)})),s.append(Ee({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>ps(t.id)}))},allowFiltering:!1,allowExporting:!1}]}),e.jsx(Te,{modalRef:v,title:Le?"Editar item":"Agregar item",onSubmit:us,size:"xl",children:e.jsxs("div",{id:"principal-container",children:[e.jsx("input",{ref:_,type:"hidden"}),e.jsxs("ul",{className:"nav nav-pills nav-justified mb-4",role:"tablist",style:{backgroundColor:"#f8f9fa",borderRadius:"8px",padding:"4px",border:"1px solid #e9ecef"},children:[e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsxs("button",{className:"nav-link active",id:"basic-info-tab","data-bs-toggle":"pill","data-bs-target":"#basic-info",type:"button",role:"tab","aria-controls":"basic-info","aria-selected":"true",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[e.jsx("i",{className:"fas fa-info-circle me-2"}),"Información Básica"]})}),e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsxs("button",{className:"nav-link",id:"pricing-tab","data-bs-toggle":"pill","data-bs-target":"#pricing",type:"button",role:"tab","aria-controls":"pricing","aria-selected":"false",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[e.jsx("i",{className:"fas fa-dollar-sign me-2"}),"Precios y Stock"]})}),e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsxs("button",{className:"nav-link",id:"multimedia-tab","data-bs-toggle":"pill","data-bs-target":"#multimedia",type:"button",role:"tab","aria-controls":"multimedia","aria-selected":"false",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[e.jsx("i",{className:"fas fa-images me-2"}),"Multimedia"]})}),e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsxs("button",{className:"nav-link",id:"features-tab","data-bs-toggle":"pill","data-bs-target":"#features",type:"button",role:"tab","aria-controls":"features","aria-selected":"false",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[e.jsx("i",{className:"fas fa-list-ul me-2"}),"Características"]})})]}),e.jsxs("div",{className:"tab-content",children:[e.jsx("div",{className:"tab-pane fade show active",id:"basic-info",role:"tabpanel","aria-labelledby":"basic-info-tab",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-tag me-2"}),"Identificación"]})}),e.jsxs("div",{className:"card-body",children:[e.jsx(S,{eRef:re,label:"SKU",required:!0,hidden:!o.has("items","sku")}),e.jsx(S,{eRef:W,label:"Nombre del Producto",required:!0,hidden:!o.has("items","name")}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsx(S,{eRef:m,label:"Color",required:!0,hidden:!o.has("items","color")})}),e.jsx("div",{className:"col-md-6",children:e.jsx(S,{eRef:A,label:"Talla",required:!0,hidden:!o.has("items","size")})}),e.jsx("div",{className:"col-md-6",children:e.jsx(S,{eRef:le,label:"Peso",hidden:!o.has("items","weight")})})]})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-sitemap me-2"}),"Categorización"]})}),e.jsxs("div",{className:"card-body",children:[e.jsx(Z,{eRef:y,label:"Categoría",required:!0,dropdownParent:"#principal-container",onChange:s=>Be(s.target.value),hidden:!o.has("items","category_id"),children:L.map((s,t)=>e.jsx("option",{value:s.id,children:s.name},t))}),e.jsx(Z,{eRef:f,label:"Colección",dropdownParent:"#principal-container",onChange:s=>We(s.target.value),hidden:!o.has("items","collection_id"),children:K.map((s,t)=>e.jsx("option",{value:s.id,children:s.name},t))}),e.jsx(Fe,{eRef:N,label:"Subcategoría",searchAPI:"/api/admin/subcategories/paginate",searchBy:"name",filter:["category_id","=",ze],dropdownParent:"#principal-container",hidden:!o.has("items","subcategory_id")}),e.jsx(Z,{eRef:B,label:"Marca",dropdownParent:"#principal-container",hidden:!o.has("items","brand_id"),children:P.map((s,t)=>e.jsx("option",{value:s.id,children:s.name},t))})]})]})}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card border-0 shadow-sm",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-align-left me-2"}),"Descripción"]})}),e.jsxs("div",{className:"card-body",children:[e.jsx(ys,{eRef:M,label:"Resumen",rows:3,hidden:!o.has("items","summary")}),e.jsxs(Z,{eRef:q,label:"Tienda",dropdownParent:"#principal-container",onChange:s=>Ue(s.target.value),hidden:!o.has("items","store_id"),children:[e.jsx("option",{value:"",children:"Seleccionar tienda (opcional)"}),I.map((s,t)=>e.jsx("option",{value:s.id,children:s.name},t))]}),e.jsx(Fe,{id:"tags",eRef:se,searchAPI:"/api/admin/tags/paginate",searchBy:"name",label:"Tags",dropdownParent:"#principal-container",tags:!0,multiple:!0})]})]})})]})}),e.jsx("div",{className:"tab-pane fade",id:"pricing",role:"tabpanel","aria-labelledby":"pricing-tab",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-dollar-sign me-2"}),"Precios"]})}),e.jsxs("div",{className:"card-body",children:[e.jsx(S,{eRef:u,label:"Precio Regular",type:"number",step:"0.01",required:!0,hidden:!o.has("items","price")}),e.jsx(S,{eRef:U,label:"Precio con Descuento",type:"number",step:"0.01"})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-boxes me-2"}),"Inventario"]})}),e.jsx("div",{className:"card-body",children:e.jsx(S,{label:"Stock Disponible",eRef:ae,type:"number",required:!0,hidden:!o.has("items","stock")})})]})})]})}),e.jsx("div",{className:"tab-pane fade",id:"multimedia",role:"tabpanel","aria-labelledby":"multimedia-tab",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-image me-2"}),"Imágenes Principales"]})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsx(pe,{eRef:h,name:"banner",label:"Banner",aspect:2/1,col:"col-12",hidden:!o.has("items","banner")}),e.jsx(pe,{eRef:x,name:"image",label:"Imagen Principal",aspect:1,col:"col-md-6",hidden:!o.has("items","image")}),e.jsx(pe,{eRef:g,name:"texture",label:"Textura",aspect:1,col:"col-md-6",hidden:!o.has("items","texture")})]})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-photo-video me-2"}),"Galería y Multimedia"]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{className:"form-label fw-semibold text-dark mb-3",children:[e.jsx("i",{className:"fas fa-images me-2 text-primary"}),"Galería de Imágenes",b.filter(s=>!s.toDelete).length>0&&e.jsx("span",{className:"badge bg-primary ms-2",children:b.filter(s=>!s.toDelete).length})]}),e.jsx("input",{id:"input-item-gallery",ref:xe,type:"file",multiple:!0,accept:"image/*",hidden:!0,onChange:qe}),e.jsxs("div",{className:"gallery-container",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"16px",padding:"16px",backgroundColor:"#f8f9fa",borderRadius:"12px",border:"2px dashed #dee2e6",minHeight:"160px"},children:[b.filter(s=>!s.toDelete).map((s,t)=>{const r=b.findIndex(l=>l===s),a=t+1;return e.jsxs("div",{className:"gallery-item position-relative",draggable:!0,onDragStart:l=>Qe(l,r),onDragEnd:Xe,onDragOver:Ye,onDrop:l=>Ze(l,r),style:{aspectRatio:"1",borderRadius:"12px",overflow:"hidden",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",transition:"all 0.3s ease",cursor:"grab",transform:k===r?"scale(1.05)":"scale(1)",opacity:k===r?.8:1,border:"3px solid transparent",background:"white"},onMouseEnter:l=>{k===null&&(l.currentTarget.style.transform="scale(1.02)",l.currentTarget.style.boxShadow="0 6px 20px rgba(0,0,0,0.15)")},onMouseLeave:l=>{k===null&&(l.currentTarget.style.transform="scale(1)",l.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)")},children:[e.jsx("div",{className:"position-absolute top-0 start-0 m-2",children:e.jsx("span",{className:"badge bg-primary rounded-circle d-flex align-items-center justify-content-center",style:{width:"24px",height:"24px",fontSize:"11px",fontWeight:"bold"},children:a})}),e.jsx("img",{src:s.url,alt:`Imagen ${a}`,className:"w-100 h-100",style:{objectFit:"cover",pointerEvents:"none"}}),e.jsx("div",{className:"position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{background:"rgba(0,0,0,0.7)",opacity:0,transition:"opacity 0.3s ease"},onMouseEnter:l=>l.currentTarget.style.opacity=1,onMouseLeave:l=>l.currentTarget.style.opacity=0,children:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-light btn-sm rounded-circle d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},title:"Mover imagen",children:e.jsx("i",{className:"fas fa-arrows-alt text-dark"})}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm rounded-circle d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},onClick:l=>Ke(l,r),title:"Eliminar imagen",children:e.jsx("i",{className:"fas fa-trash text-white"})})]})})]},r)}),e.jsx("div",{className:"gallery-add-button d-flex flex-column align-items-center justify-content-center",style:{aspectRatio:"1",border:"3px dashed #71b6f9",borderRadius:"12px",backgroundColor:"rgba(13, 110, 253, 0.05)",cursor:"pointer",transition:"all 0.3s ease",minHeight:"120px"},onClick:()=>xe.current.click(),onDrop:Je,onDragOver:He,onMouseEnter:s=>{s.currentTarget.style.backgroundColor="rgba(13, 110, 253, 0.1)",s.currentTarget.style.borderColor="#0056b3",s.currentTarget.style.transform="scale(1.02)"},onMouseLeave:s=>{s.currentTarget.style.backgroundColor="rgba(13, 110, 253, 0.05)",s.currentTarget.style.borderColor="#0d6efd",s.currentTarget.style.transform="scale(1)"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-2 bg-primary",style:{width:"48px",height:"48px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto"},children:e.jsx("i",{className:"fas fa-plus text-white fa-lg"})}),e.jsx("p",{className:"mb-0 text-primary fw-semibold",style:{fontSize:"12px"},children:"Agregar Imagen"}),e.jsx("small",{className:"text-muted",style:{fontSize:"10px"},children:"Arrastra o haz clic"})]})})]}),b.filter(s=>!s.toDelete).length===0&&e.jsxs("div",{className:"text-center py-4 text-muted",children:[e.jsx("i",{className:"fas fa-images fa-3x mb-3 opacity-50"}),e.jsx("p",{className:"mb-1",children:"No hay imágenes en la galería"}),e.jsx("small",{children:'Arrastra archivos aquí o haz clic en "Agregar Imagen"'})]})]}),e.jsxs("div",{className:"mb-4",hidden:!o.has("items","pdf"),children:[e.jsxs("label",{className:"form-label fw-semibold text-dark mb-3",children:[e.jsx("i",{className:"fas fa-file-pdf me-2 text-danger"}),"Archivos PDF (Manuales / Catálogos)",R.filter(s=>!s.toDelete).length>0&&e.jsx("span",{className:"badge bg-danger ms-2",children:R.filter(s=>!s.toDelete).length})]}),e.jsx("input",{ref:ge,type:"file",multiple:!0,accept:".pdf",hidden:!0,onChange:es}),e.jsx("div",{className:"list-group mb-3",children:R.filter(s=>!s.toDelete).map((s,t)=>{const r=R.findIndex(a=>a===s);return e.jsxs("div",{draggable:!0,onDragStart:a=>ts(a,r),onDragEnd:rs,onDragOver:as,onDrop:a=>ls(a,r),className:"list-group-item d-flex align-items-center justify-content-between",style:{cursor:"grab",opacity:O===r?.5:1,backgroundColor:O===r?"#f8f9fa":"white",transition:"all 0.2s ease"},children:[e.jsxs("div",{className:"d-flex align-items-center flex-grow-1",style:{minWidth:0},children:[e.jsx("span",{className:"badge bg-danger me-3",style:{minWidth:"28px"},children:t+1}),e.jsx("i",{className:"fas fa-grip-vertical text-muted me-3"}),e.jsx("i",{className:"fas fa-file-pdf text-danger me-2"}),e.jsx("span",{className:"text-truncate",style:{maxWidth:"250px"},children:s.name})]}),e.jsxs("div",{className:"d-flex gap-2 flex-shrink-0",children:[!s.file&&e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-outline-primary",children:e.jsx("i",{className:"fas fa-eye"})}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:a=>ss(a,r),children:e.jsx("i",{className:"fas fa-trash"})})]})]},r)})}),e.jsxs("button",{type:"button",className:"btn btn-outline-danger w-100",onClick:()=>ge.current.click(),children:[e.jsx("i",{className:"fas fa-plus me-2"}),"Agregar PDFs"]})]}),e.jsxs("div",{className:"mb-3",hidden:!o.has("items","linkvideo"),children:[e.jsxs("label",{className:"form-label fw-semibold text-dark mb-3",children:[e.jsx("i",{className:"fas fa-video me-2 text-success"}),"Links de Videos",D.filter(s=>!s.toDelete).length>0&&e.jsx("span",{className:"badge bg-success ms-2",children:D.filter(s=>!s.toDelete).length})]}),e.jsx("div",{className:"list-group mb-3",children:D.filter(s=>!s.toDelete).map((s,t)=>{const r=D.findIndex(a=>a===s);return e.jsxs("div",{draggable:!0,onDragStart:a=>os(a,r),onDragEnd:cs,onDragOver:ds,onDrop:a=>ms(a,r),className:"list-group-item d-flex align-items-center justify-content-between",style:{cursor:"grab",opacity:V===r?.5:1,backgroundColor:V===r?"#f8f9fa":"white",transition:"all 0.2s ease"},children:[e.jsxs("div",{className:"d-flex align-items-center flex-grow-1",style:{minWidth:0,overflow:"hidden"},children:[e.jsx("span",{className:"badge bg-success me-3 flex-shrink-0",style:{minWidth:"28px"},children:t+1}),e.jsx("i",{className:"fas fa-grip-vertical text-muted me-3 flex-shrink-0"}),e.jsx("i",{className:"fas fa-video text-success me-2 flex-shrink-0"}),e.jsx("span",{className:"small",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%"},title:s.url,children:s.url})]}),e.jsxs("div",{className:"d-flex gap-2 flex-shrink-0 ms-2",children:[e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-outline-primary",children:e.jsx("i",{className:"fas fa-external-link-alt"})}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:a=>ns(a,r),children:e.jsx("i",{className:"fas fa-trash"})})]})]},r)})}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{ref:ie,type:"url",className:"form-control",placeholder:"https://youtube.com/watch?v=..."}),e.jsxs("button",{type:"button",className:"btn btn-success",onClick:is,children:[e.jsx("i",{className:"fas fa-plus me-2"}),"Agregar"]})]})]})]})]})})]})}),e.jsx("div",{className:"tab-pane fade",id:"features",role:"tabpanel","aria-labelledby":"features-tab",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-list-ul me-2"}),"Características"]})}),e.jsx("div",{className:"card-body",children:e.jsx(Me,{ref:Ve,label:"Lista de Características",structure:"",value:je,onChange:ve})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-cogs me-2"}),"Especificaciones"]})}),e.jsx("div",{className:"card-body",children:e.jsx(Me,{ref:Ge,label:"Especificaciones Técnicas",structure:{type:"",title:"",description:""},value:ye,onChange:de,typeOptions:hs})})]})}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card border-0 shadow-sm",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-edit me-2"}),"Descripción Detallada"]})}),e.jsx("div",{className:"card-body",children:e.jsx(Rs,{eRef:te,label:"Descripción Completa"})})]})})]})})]})]})}),e.jsx(Te,{modalRef:me,title:"Importar Datos",size:"lg",children:e.jsx(Ss,{gridRef:p,modalRef:me,excelTemplate:Array.isArray(z)?(Ne=z.find(s=>s.correlative==="excel_import_template"))==null?void 0:Ne.description:null})})]})};Ds((L,P)=>{Ns.createRoot(L).render(e.jsx(vs,{...P,title:"Items",children:e.jsx(Is,{...P})}))});
