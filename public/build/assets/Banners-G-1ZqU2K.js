var ue=Object.defineProperty;var pe=(m,r,p)=>r in m?ue(m,r,{enumerable:!0,configurable:!0,writable:!0,value:p}):m[r]=p;var L=(m,r,p)=>pe(m,typeof r!="symbol"?r+"":r,p);import{j as i}from"./AboutSimple-Cf8x2fCZ.js";import{B as fe}from"./Base-NbtpFRZL.js";import{T as Y}from"./TextareaFormGroup-CliirJM1.js";import{r as o}from"./index-BOnQTV8N.js";import{c as ge}from"./ReactAppend-QR5TrZfj.js";import{s as xe}from"./server.browser-Bf4gQIc7.js";import{S as he}from"./ProductCard-D_AgkLlk.js";import{B as be}from"./BasicRest-BqhZrBN0.js";import{S as ve}from"./SystemRest-DWBOOamd.js";import{I as Z}from"./ImageFormGroup-DkVgPNU5.js";import{S as Be}from"./SwitchFormGroup-DXN0cwVk.js";import{S as K}from"./SelectFormGroup-X8WqJHHl.js";import{M as Re}from"./Modal-BYL-UsqM.js";import{T as je}from"./Table-C0bje_JZ.js";import{D as ee}from"./DxButton-DV0H-ZcL.js";import{I as te}from"./InputFormGroup-iZIO11ZN.js";import{C as we}from"./CreateReactScript-Dz3UpYPP.js";import{R as O}from"./ReactAppend-Vm5G2nof.js";import{S as Se}from"./SortByAfterField-2AndDudn.js";import"./index-yBjzXJbu.js";import"./Global-DWbVqTT_.js";import"./tippy-react.esm-DmkRJDEW.js";import"./index-pSueRYGM.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-B6ujFmsw.js";/* empty css              */import"./Logout-BpuTJ_83.js";import"./main-B6F2O9-U.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./MenuItemContainer-DwXwpKCn.js";import"./index.esm-D6GvEWn_.js";import"./index-BQJyKPGC.js";import"./CanAccess-DgL4m2bH.js";import"./CardProductKatya-ncpmQ0JU.js";/* empty css               */import"./General-BmbBKdsB.js";import"./LaravelSession-Dz9cpV3l.js";class Fe extends be{constructor(){super(...arguments);L(this,"path","admin/banners");L(this,"hasFiles",!0)}}const y=new Fe,ie=new ve,ye=({pages:m,systems:r=[]})=>{const p=o.useRef(),P=o.useRef(),k=o.useRef(),v=o.useRef(),T=o.useRef(),d=o.useRef(),u=o.useRef(),D=o.useRef(),C=o.useRef(),B=o.useRef(),N=o.useRef(),R=o.useRef(),E=o.useRef(),[I,V]=o.useState(!1),[j,_]=o.useState(r),[ne,ae]=o.useState([]),[A,W]=o.useState(""),z=[{id:"BannerSimple",name:"Banner Simple",icon:"mdi mdi-image-size-select-large"},{id:"BannerAd",name:"Banner Ad",icon:"mdi mdi-google-ads"},{id:"BannerFullWidth",name:"Banner Full Width",icon:"mdi mdi-view-carousel"},{id:"BannerFlex",name:"Banner Flex",icon:"mdi mdi-view-split-vertical"},{id:"BannerPublicitario",name:"Banner Publicitario",icon:"mdi mdi-bullhorn"},{id:"BannerPublicitarioPaani",name:"Banner Publicitario Paani",icon:"mdi mdi-bullhorn-variant"},{id:"BannerPostSuscriptionPaani",name:"Banner Post Suscripción Paani",icon:"mdi mdi-email-newsletter"},{id:"BannerStatic",name:"Banner Static",icon:"mdi mdi-image-frame"},{id:"BannerStaticSecond",name:"Banner Static Second",icon:"mdi mdi-image-multiple"},{id:"BannerSimpleSF",name:"Banner Simple SF",icon:"mdi mdi-image-outline"},{id:"BannerSimpleD2",name:"Banner Simple D2",icon:"mdi mdi-image"},{id:"BannerBananaLab",name:"Banner Banana Lab",icon:"mdi mdi-fruit-grapes"},{id:"BannerCTAMakita",name:"Banner CTA Makita",icon:"mdi mdi-call-to-action"},{id:"BannerContactMakita",name:"Banner Contact Makita",icon:"mdi mdi-contact-mail"},{id:"BannerPidelo",name:"Banner Pidelo",icon:"mdi mdi-shopping"},{id:"BannerMultivet",name:"Banner Multivet",icon:"mdi mdi-medical-bag"},{id:"BannerPublicitarioKatya",name:"Banner Publicitario Katya",icon:"mdi mdi-account-star"},{id:"BannerBlogSectionKatya",name:"Banner Blog Section Katya",icon:"mdi mdi-post"}],M=e=>{const t=j.filter(n=>n.page_id===(e||null)),a=Se(t);ae(a)};o.useEffect(()=>{M()},[]),o.useEffect(()=>{M(A)},[A,j]);const q=e=>{e!=null&&e.id?V(!0):V(!1);const t=(e==null?void 0:e.data)||{};k.current.value=(e==null?void 0:e.id)??"",v.current.value=t.name??"",T.current.value=t.description??"",d.image.src=t.background?`/storage/images/system/${t.background}`:"",d.current.value=null,u.image.src=t.image?`/storage/images/system/${t.image}`:"",u.current.value=null,d.resetDeleteFlag&&d.resetDeleteFlag(),u.resetDeleteFlag&&u.resetDeleteFlag(),D.current.value=t.button_text??"",C.current.value=t.button_link??"",B.current&&(B.current.checked=t.contenedor==="absoluto"),$(N.current).val((e==null?void 0:e.page_id)||"").trigger("change");const a=(e==null?void 0:e.page_id)||"";W(a),M(a),setTimeout(()=>{const n=(e==null?void 0:e.after_component)||"";$(R.current).val(n).trigger("change")},100),$(E.current).val(t.type||"BannerSimple").trigger("change"),$(P.current).modal("show")},oe=async e=>{var Q;e.preventDefault();const t=k.current.value,a=$(N.current).val(),n=$(R.current).val()||null,c=$(E.current).val(),h={name:`Banner - ${v.current.value}`,component:"banner",value:c,page_id:a||null,after_component:n,visible:!0};t&&(h.id=t);const f=await ie.save(h);if(!f)return;const U={id:f.id,name:v.current.value,description:T.current.value,button_text:D.current.value,button_link:C.current.value,contenedor:(Q=B.current)!=null&&Q.checked?"absoluto":"relativo",type:c},x=new FormData;for(const s in U)x.append(s,U[s]);const H=d.current.files[0];H&&x.append("background",H);const J=u.current.files[0];J&&x.append("image",J),d.getDeleteFlag&&d.getDeleteFlag()&&x.append("background_delete","DELETE"),u.getDeleteFlag&&u.getDeleteFlag()&&x.append("image_delete","DELETE");const G=await y.save(x);if(!G)return;d.resetDeleteFlag&&d.resetDeleteFlag(),u.resetDeleteFlag&&u.resetDeleteFlag();const ce=f.page_id,me=f.id,w=f.after_component,de=j.filter(s=>s.page_id===ce);if(w||!I&&w===null){let s=[...de];I&&(s=s.filter(l=>l.id!==me));const b={...f,data:G.data};if(w===null)s.unshift(b);else{const l=s.findIndex(F=>F.id==w);l!==-1?s.splice(l+1,0,b):s.push(b)}const g={};if(s.forEach((l,F)=>{const X=F===0?null:s[F-1].id;l.after_component!==X&&(g[l.id]=X)}),Object.keys(g).length>0&&!await ie.updateOrder(g))return}const S={...f,data:G.data};_(s=>{const b=s.some(l=>l.id===S.id);let g;return b?g=s.map(l=>l.id===S.id?S:l):g=[...s,S],g}),$(P.current).modal("hide"),setTimeout(()=>{window.location.reload()},1e3)},se=e=>{const t=$(e.target).val();W(t),setTimeout(()=>{$(R.current).val("").trigger("change")},100)},re=async({id:e,value:t})=>{await y.boolean({id:e,field:"visible",value:t})&&_(n=>n.map(c=>c.id===e?{...c,visible:t}:c))},le=async e=>{const{isConfirmed:t}=await he.fire({title:"Eliminar registro",text:"¿Estas seguro de eliminar este registro?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});!t||!await y.delete(e)||_(n=>n.filter(c=>c.id!=e))};return i.jsxs(i.Fragment,{children:[i.jsx(je,{gridRef:p,title:"Banners",rest:y,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(p.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo banner",hint:"Nuevo banner",onClick:()=>q()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"name",caption:"Información",cellTemplate:(e,{data:t})=>{const a=m.find(c=>c.id==(t==null?void 0:t.page_id)),n=z.find(c=>{var h;return c.id===((h=t==null?void 0:t.data)==null?void 0:h.type)});e.html(xe.renderToString(i.jsx(i.Fragment,{children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx("i",{className:`${(n==null?void 0:n.icon)||"mdi mdi-image"} me-2`}),i.jsxs("div",{children:[i.jsx("b",{className:"d-block",children:t==null?void 0:t.name}),i.jsxs("small",{className:"text-muted d-block",children:["Tipo: ",(n==null?void 0:n.name)||"Banner Simple"]}),i.jsxs("small",{className:"text-muted",children:["Página: ",(a==null?void 0:a.name)||"Base Template"]})]})]})})))}},{dataField:"after_component",caption:"Después de",cellTemplate:(e,{data:t})=>{if(!t.after_component){e.text("Al inicio");return}const a=j.find(n=>n.id===t.after_component);e.text(a?a.name:"Componente eliminado")}},{dataField:"background",caption:"Fondo",width:"90px",allowFiltering:!1,cellTemplate:(e,{data:t})=>{var a;O(e,i.jsx("img",{src:`/storage/images/system/${(a=t==null?void 0:t.data)==null?void 0:a.background}`,style:{width:"80px",height:"48px",objectFit:"cover",objectPosition:"center",borderRadius:"4px"},onError:n=>n.target.src="/api/cover/thumbnail/null"}))}},{dataField:"image",caption:"Imagen",width:"90px",allowFiltering:!1,cellTemplate:(e,{data:t})=>{var a;O(e,i.jsx("img",{src:`/storage/images/system/${(a=t==null?void 0:t.data)==null?void 0:a.image}`,style:{width:"80px",height:"48px",objectFit:"cover",objectPosition:"center",borderRadius:"4px"},onError:n=>n.target.src="/api/cover/thumbnail/null"}))}},{dataField:"visible",caption:"Visible",dataType:"boolean",cellTemplate:(e,{data:t})=>{$(e).empty(),O(e,i.jsx(Be,{checked:t.visible==1,onChange:()=>re({id:t.id,value:!t.visible})}))}},{caption:"Acciones",cellTemplate:(e,{data:t})=>{e.css("text-overflow","unset"),e.append(ee({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>q(t)})),e.append(ee({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>le(t.id)}))},allowFiltering:!1,allowExporting:!1}]}),i.jsxs(Re,{modalRef:P,title:I?"Editar banner":"Agregar banner",onSubmit:oe,size:"lg",children:[i.jsx("input",{ref:k,type:"hidden"}),i.jsx("div",{className:"row",id:"banner-container",children:i.jsxs("div",{className:"col-12",children:[i.jsxs("div",{className:"row",children:[i.jsx("div",{className:"col-md-6",children:i.jsx(K,{eRef:E,label:"Tipo de Banner",dropdownParent:"#banner-container",children:z.map(e=>i.jsx("option",{value:e.id,children:e.name},e.id))})}),i.jsx("div",{className:"col-md-6",children:i.jsxs(K,{eRef:N,label:"Página",onChange:se,dropdownParent:"#banner-container",children:[i.jsx("option",{value:"",children:"Base Template"}),m.filter(e=>e.menuable).map(e=>i.jsx("option",{value:e.id,children:e.name},e.id))]})})]}),i.jsxs(K,{eRef:R,label:"Posición (después de)",dropdownParent:"#banner-container",changeWith:[A],children:[i.jsx("option",{value:"",children:"Al inicio"}),ne.map(e=>i.jsx("option",{value:e.id,children:e.name},e.id))]}),i.jsx(Z,{eRef:d,name:"background",label:"Fondo"}),i.jsxs("div",{className:"row",children:[i.jsx("div",{className:"col-sm-6",children:i.jsx(Z,{eRef:u,name:"image",label:"Imagen",aspect:1})}),i.jsxs("div",{className:"col-sm-6",children:[i.jsx(Y,{eRef:v,label:"Titulo",rows:2}),i.jsx(Y,{eRef:T,label:"Descripción",rows:2}),i.jsx(te,{eRef:D,label:"Texto botón"})]})]}),i.jsx(te,{eRef:C,label:"URL botón"}),i.jsxs("div",{className:"form-group row",children:[i.jsx("label",{className:"col-sm-3 col-form-label",children:"Posición"}),i.jsxs("div",{className:"col-sm-9",children:[i.jsxs("div",{className:"custom-control custom-switch",children:[i.jsx("input",{type:"checkbox",className:"custom-control-input",id:"absoluteSwitch",ref:B}),i.jsx("label",{className:"custom-control-label",htmlFor:"absoluteSwitch",children:"Imagen absoluta"})]}),i.jsx("small",{className:"form-text text-muted",children:"Marca esta opción para posicionamiento absoluto de la imagen"})]})]})]})})]})]})};we((m,r)=>{ge.createRoot(m).render(i.jsx(fe,{...r,title:"Banners",children:i.jsx(ye,{...r})}))});
