var G=Object.defineProperty;var S=(l,t,c)=>t in l?G(l,t,{enumerable:!0,configurable:!0,writable:!0,value:c}):l[t]=c;var j=(l,t,c)=>S(l,typeof t!="symbol"?t+"":t,c);import{j as r}from"./AboutSimple-Cf8x2fCZ.js";import{B as k}from"./Base-GfEhzAjp.js";import{S as B}from"./SwitchFormGroup-DXN0cwVk.js";import{r as o}from"./index-BOnQTV8N.js";import{I as p}from"./InputFormGroup-iZIO11ZN.js";import{c as M}from"./ReactAppend-QR5TrZfj.js";import{S as q}from"./ProductCard-D9l7c7at.js";import{B as I}from"./BasicRest-BML1C-ua.js";import{I as N}from"./ImageFormGroup-40MuGzez.js";import{M as L}from"./Modal-xDw9ufjg.js";import{T as _}from"./Table-Cv1BshIS.js";import{D as y}from"./DxButton-DV0H-ZcL.js";import{C as K}from"./CreateReactScript-Bqovr-Zn.js";import{R as m}from"./ReactAppend-Vm5G2nof.js";import"./index-yBjzXJbu.js";import"./Global-CazroCzF.js";import"./tippy-react.esm-DmkRJDEW.js";import"./index-pSueRYGM.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-B6ujFmsw.js";/* empty css              */import"./Logout-BpuTJ_83.js";import"./main-B6F2O9-U.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./MenuItemContainer-DcxtOi47.js";import"./index.esm-C48oHfFw.js";import"./index-ngrFHoWO.js";import"./CanAccess-BlvzCYjQ.js";import"./CardProductKatya-ncpmQ0JU.js";import"./BooleanLimit-D-OsQsek.js";/* empty css               */import"./General-apRuNwp7.js";import"./LaravelSession-Dz9cpV3l.js";class P extends I{constructor(){super(...arguments);j(this,"path","admin/apps");j(this,"hasFiles",!0)}}const u=new P,z=()=>{const l=o.useRef(),t=o.useRef(),c=o.useRef(),d=o.useRef(),f=o.useRef(),g=o.useRef(),n=o.useRef(),a=o.useRef(),x=o.useRef(),h=o.useRef(),v=o.useRef(),[E,R]=o.useState(!1),w=e=>{e!=null&&e.id?R(!0):R(!1),c.current.value=(e==null?void 0:e.id)??"",d.current.value=(e==null?void 0:e.name)??"",f.current.value=(e==null?void 0:e.store)??"Google Play",g.current.value=(e==null?void 0:e.link)??"",x.current.value=(e==null?void 0:e.downloads)??"100",h.current.value=(e==null?void 0:e.downloads_unit)??"K",v.current.value=(e==null?void 0:e.rating)??"4.5",n.image.src=e!=null&&e.logo?`/storage/images/app/${e.logo}`:"",n.current.value=null,a.image.src=e!=null&&e.image?`/storage/images/app/${e.image}`:"",a.current.value=null,n.resetDeleteFlag&&n.resetDeleteFlag(),a.resetDeleteFlag&&a.resetDeleteFlag(),$(t.current).modal("show")},A=async e=>{e.preventDefault();const s={id:c.current.value||void 0,name:d.current.value,store:f.current.value,link:g.current.value,downloads:x.current.value,downloads_unit:h.current.value,rating:v.current.value},i=new FormData;for(const D in s)i.append(D,s[D]);const b=n.current.files[0];b&&i.append("logo",b);const F=a.current.files[0];F&&i.append("image",F),n.getDeleteFlag&&n.getDeleteFlag()&&i.append("logo_delete","DELETE"),a.getDeleteFlag&&a.getDeleteFlag()&&i.append("image_delete","DELETE"),await u.save(i)&&(n.resetDeleteFlag&&n.resetDeleteFlag(),a.resetDeleteFlag&&a.resetDeleteFlag(),$(l.current).dxDataGrid("instance").refresh(),$(t.current).modal("hide"))},T=async({id:e,value:s})=>{await u.boolean({id:e,field:"visible",value:s})&&$(l.current).dxDataGrid("instance").refresh()},C=async e=>{const{isConfirmed:s}=await q.fire({title:"Eliminar registro",text:"¿Estás seguro de eliminar esta app?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!s||!await u.delete(e.id)||$(l.current).dxDataGrid("instance").refresh()};return r.jsxs(r.Fragment,{children:[r.jsx(_,{gridRef:l,title:"Apps Móviles",rest:u,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(l.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nueva app",hint:"Nueva app",onClick:()=>w()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"logo",caption:"Logo",width:"80px",allowFiltering:!1,cellTemplate:(e,{data:s})=>{m(e,r.jsx("img",{src:`/storage/images/app/${s.logo}`,style:{width:"60px",height:"60px",objectFit:"contain",borderRadius:"8px"},onError:i=>i.target.src="/api/cover/thumbnail/null"}))}},{dataField:"name",caption:"Nombre",width:"25%"},{dataField:"store",caption:"Tienda",width:"15%"},{dataField:"downloads",caption:"Descargas",width:"12%",cellTemplate:(e,{data:s})=>{const i=`${s.downloads}${s.downloads_unit||""}`;m(e,r.jsx("span",{children:i}))}},{dataField:"rating",caption:"Rating",width:"10%",cellTemplate:(e,{data:s})=>{m(e,r.jsxs("div",{className:"d-flex align-items-center",children:[r.jsx("span",{className:"text-warning mr-1",children:"★"}),r.jsx("span",{children:s.rating})]}))}},{dataField:"visible",caption:"Visible",dataType:"boolean",cellTemplate:(e,{data:s})=>{$(e).empty(),m(e,r.jsx(B,{checked:s.visible==1,onChange:()=>T({id:s.id,value:!s.visible})}))}},{caption:"Acciones",cellTemplate:(e,{data:s})=>{e.css("text-overflow","unset"),e.append(y({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>w(s)})),e.append(y({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>C(s)}))},allowFiltering:!1,allowExporting:!1}]}),r.jsxs(L,{modalRef:t,title:E?"Editar app":"Agregar app",onSubmit:A,children:[r.jsx("input",{ref:c,type:"hidden"}),r.jsxs("div",{className:"row",children:[r.jsxs("div",{className:"col-md-6",children:[r.jsx(N,{eRef:n,name:"logo",label:"Logo de la App",col:"col-12",aspect:1}),r.jsx(N,{eRef:a,name:"image",label:"Screenshot de la Tienda",col:"col-12",aspect:9/16})]}),r.jsxs("div",{className:"col-md-6",children:[r.jsx(p,{eRef:d,label:"Nombre de la App",required:!0}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{children:["Tienda ",r.jsx("span",{className:"text-danger",children:"*"})]}),r.jsxs("select",{ref:f,className:"form-control",required:!0,children:[r.jsx("option",{value:"Google Play",children:"Google Play"}),r.jsx("option",{value:"App Store",children:"App Store"}),r.jsx("option",{value:"Huawei AppGallery",children:"Huawei AppGallery"}),r.jsx("option",{value:"Amazon Appstore",children:"Amazon Appstore"})]})]}),r.jsx(p,{eRef:g,label:"Link de la Tienda",type:"url",placeholder:"https://play.google.com/store/apps/details?id=...",required:!0}),r.jsxs("div",{className:"row",children:[r.jsx("div",{className:"col-md-8",children:r.jsx(p,{eRef:x,label:"Cantidad de Descargas",type:"number",required:!0})}),r.jsx("div",{className:"col-md-4",children:r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{children:["Unidad ",r.jsx("span",{className:"text-danger",children:"*"})]}),r.jsxs("select",{ref:h,className:"form-control",required:!0,children:[r.jsx("option",{value:"",children:"Número exacto"}),r.jsx("option",{value:"K",children:"K (Miles)"}),r.jsx("option",{value:"M",children:"M (Millones)"})]})]})})]}),r.jsx(p,{eRef:v,label:"Rating (0.0 - 5.0)",type:"number",step:"0.1",min:"0",max:"5",required:!0})]})]})]})]})};K((l,t)=>{M.createRoot(l).render(r.jsx(k,{...t,title:"Apps Móviles",children:r.jsx(z,{...t})}))});
