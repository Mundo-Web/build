import{r as e,j as t,u as r,H as a,v as s,w as n,X as i,S as o,y as l,z as c}from"./vendor-react-DB2gWWlz.js";import{G as d}from"./Global-BAGAPG-V.js";import{C as u}from"./HeaderSearch-DYRcDESG.js";import{L as m}from"./Logout-D009x2BU.js";import{M as h}from"./MobileMenu-Db0EJydr.js";import{P as p}from"./ProfileImage-DzbEMjbD.js";import{C as x}from"./Number2Currency-BX4epFEo.js";import{A as g,m as f}from"./vendor-motion-Ma5gYeLT.js";import"./vendor-swiper-Cr_RrIb_.js";import"./CartItemRow-DjcmXrs1.js";import"./CartKuchara-C7ZIDpxE.js";import"./MenuSimple-DwqMzyHb.js";import"./MobileMenu-Cdwr69WZ.js";import"./GoogleSignInButton-Bo5d3xNo.js";import"./BasicRest-rcCccbSV.js";import"./BooleanLimit-q2Ad9fGY.js";import"./General-ClVW7qxN.js";const b=({items:b,data:j,cart:y,setCart:v,isUser:w,pages:N,generals:k=[]})=>{const C=k.find(e=>"phone_whatsapp"===e.correlative),S=k.find(e=>"message_whatsapp"===e.correlative),L=C?.description??null,E=S?.description??null,[z,M]=e.useState(!1),[D,R]=e.useState(!1),[T,B]=e.useState(!1),[P,I]=e.useState(""),[F,H]=e.useState(!1),[A,U]=e.useState(!1),[$,q]=e.useState([]),[K,_]=e.useState(!1),[W,G]=e.useState(!1),[O,J]=e.useState(-1),X=e.useRef([]),V=e.useRef(null),Y=e.useRef(null),Q=e.useRef(null),Z=e.useRef(null),ee=e.useRef(null),te=e.useRef(null),re=e.useRef([]),ae=y.reduce((e,t)=>Number(e)+Number(t.quantity),0),se=async e=>{if(!e.trim()||e.length<2)return q([]),void _(!1);G(!0);try{const t=await fetch("/api/items/paginate",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({take:8,skip:0,filter:[["name","contains",e],"or",["summary","contains",e],"or",["description","contains",e]],sort:[{selector:"name",desc:!1}],requireTotalCount:!1,with:"category,brand"})});if(!t.ok)throw new Error("Error en la búsqueda");const r=await t.json();200===r.status&&Array.isArray(r.data)?(q(r.data),_(r.data.length>0)):(q([]),_(!1))}catch(t){q([]),_(!1)}finally{G(!1)}},ne=e=>{I(e),J(-1),te.current&&clearTimeout(te.current),te.current=setTimeout(()=>{se(e)},300)},ie=()=>{_(!1),q([]),J(-1)},oe=e=>{if(!e)return;_(!1),B(!1);const t=e.slug?`/product/${e.slug}`:`/catalogo?search=${encodeURIComponent(e.name)}`;window.location.href=t};e.useEffect(()=>{function e(e){V.current&&!V.current.contains(e.target)&&H(!1),Y.current&&!Y.current.contains(e.target)&&(P.trim()||B(!1)),!ee.current||ee.current.contains(e.target)||Z.current?.contains(e.target)||Q.current?.contains(e.target)||ie()}return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[P]),e.useEffect(()=>{const e=()=>{window.scrollY>0?U(!0):U(!1)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),e.useEffect(()=>{const e=e=>{"Escape"===e.key&&(K?ie():T&&(B(!1),I("")))};return(T||K)&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[T,K]),e.useEffect(()=>()=>{te.current&&clearTimeout(te.current)},[]),e.useEffect(()=>{O>=0&&re.current[O]&&ee.current&&re.current[O].scrollIntoView({block:"nearest",behavior:"smooth"})},[O]);const le={hidden:{opacity:0,y:-10,scale:.95},visible:{opacity:1,y:0,scale:1,transition:{type:"spring",stiffness:400,damping:25}},exit:{opacity:0,y:-10,scale:.95,transition:{duration:.15}}},ce=[{icon:t.jsx(l,{size:16}),label:"Mi Perfil",href:"/profile"},{icon:t.jsx(n,{size:16}),label:"Mis Pedidos",href:"/customer/dashboard"},{icon:t.jsx(c,{size:16}),label:"Configuración",href:"/account"},{icon:t.jsx(s,{size:16}),label:"Cerrar Sesión",onClick:m}],de=e=>{if(e.preventDefault(),ie(),P.trim()){const e=P.trim();window.location.href=`/catalogo?search=${encodeURIComponent(e)}`}return!1},ue=e=>{if(e.preventDefault(),ie(),P.trim()){const e=P.trim();B(!1),window.location.href=`/catalogo?search=${encodeURIComponent(e)}`}return!1};function me(e){const t=ee.current,r=X.current[e];if(!t||!r)return;const a=t.getBoundingClientRect(),s=r.getBoundingClientRect();s.top<a.top?t.scrollTop-=a.top-s.top:s.bottom>a.bottom&&(t.scrollTop+=s.bottom-a.bottom)}const he=e=>{if(K&&0!==$.length)switch(e.key){case"ArrowDown":e.preventDefault(),J(e=>{const t=e<$.length-1?e+1:e;return setTimeout(()=>me(t),0),t});break;case"ArrowUp":e.preventDefault(),J(e=>{const t=e>0?e-1:0;return setTimeout(()=>me(t),0),t});break;case"Enter":e.preventDefault(),O>=0&&O<$.length?oe($[O]):P.trim()&&de(e);break;case"Escape":_(!1)}},pe=({suggestions:e,isLoading:r,onSelect:a,selectedIndex:s})=>K?t.jsx(f.div,{ref:ee,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute top-full left-0 right-0 bg-white border border-gray-200 rounded-lg shadow-lg z-[60] max-h-80 overflow-y-auto mt-1",children:r?t.jsx("div",{className:"p-4 text-center customtext-neutral-dark",children:t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 border-2 border-primary border-t-transparent rounded-full animate-spin"}),"Buscando..."]})}):e.length>0?t.jsx("ul",{className:"py-2",children:e.map((e,r)=>t.jsx("li",{ref:e=>X.current[r]=e,children:t.jsxs("button",{"data-suggestion-button":!0,onMouseDown:t=>{t.preventDefault(),t.stopPropagation(),setTimeout(()=>a(e),0)},className:"w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors duration-200 flex items-center gap-3 "+(r===s?"bg-primary/10 border-l-4 border-primary":""),type:"button",children:[t.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-gray-100 rounded-lg overflow-hidden",children:e.image?t.jsx("img",{src:`/api/items/media/${e.image}`,alt:e.name,className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none"}}):t.jsx("div",{className:"w-full h-full flex items-center justify-center customtext-neutral-dark",children:t.jsx(o,{size:16})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"font-medium customtext-neutral-dark truncate",children:e.name}),e.category&&t.jsx("div",{className:"text-sm customtext-neutral-dark truncate",children:e.category.name}),e.final_price&&t.jsxs("div",{className:"text-sm font-semibold customtext-primary",children:[x()," ",parseFloat(e.final_price).toFixed(2)]})]})]})},e.id))}):t.jsx("div",{className:"p-4 text-center customtext-neutral-dark",children:"No se encontraron productos"})}):null;let xe=!1;if(w&&Array.isArray(w.roles)){const e=w.roles.map(e=>e.name?.toLowerCase());xe=!e.includes("admin")&&!e.includes("root")}return t.jsxs("header",{id:j?.element_id||null,className:"w-full top-0 left-0 z-50 transition-all duration-300 "+(A?"fixed bg-white shadow-lg":"relative bg-white"),children:[t.jsxs("div",{className:"px-primary  bg-white 2xl:px-0 2xl:max-w-7xl mx-auto py-4 font-font-secondary text-base font-semibold",children:[t.jsxs("div",{className:"flex items-center justify-between gap-4",children:[t.jsx("a",{href:"/",className:"flex items-center gap-2 z-[51]",children:t.jsx("img",{src:`/assets/resources/logo.png?v=${crypto.randomUUID()}`,alt:d.APP_NAME,className:"h-14 object-contain object-center",onError:e=>{e.target.onerror=null,e.target.src="/assets/img/logo-bk.svg"}})}),j?.showLoginCart&&t.jsxs("div",{className:"flex gap-8 lg:hidden",children:[t.jsxs("div",{className:(T?"hidden":"flex")+" items-center gap-4",children:[w?t.jsxs("div",{ref:V,className:"relative",children:[t.jsx("button",{"aria-label":"user",className:"flex items-center gap-2 hover:customtext-primary transition-all duration-300 relative group",onClick:()=>H(!F),children:t.jsx("div",{className:"relative transform group-hover:scale-105 transition-transform duration-200",children:w.uuid?t.jsxs("div",{className:"relative",children:[t.jsx(p,{uuid:w.uuid,name:w.name,lastname:w.lastname,className:"!w-6 !h-6 rounded-full object-cover border-2 border-primary ring-secondary transition-all duration-300"}),t.jsx("div",{className:"relative",style:{display:"none"},children:t.jsx(r,{className:"customtext-primary  border-primary rounded-full   ring-secondary transition-all duration-300",width:"1.5rem"})}),t.jsxs("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-primary border-2 border-white rounded-full animate-pulse",children:[t.jsx("div",{className:"w-full h-full bg-primary rounded-full animate-ping opacity-75 absolute"}),t.jsx("div",{className:"w-full h-full bg-primary rounded-full"})]})]}):t.jsxs("div",{className:"relative",children:[t.jsx(r,{className:"customtext-primary border-2 border-primary rounded-full  ring-secondary  transition-all duration-300",width:"1.5rem"}),t.jsxs("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-primary border-2 border-white rounded-full animate-pulse",children:[t.jsx("div",{className:"w-full h-full bg-primary rounded-full animate-ping opacity-75 absolute"}),t.jsx("div",{className:"w-full h-full bg-primary rounded-full"})]})]})})}),t.jsx(g,{children:F&&t.jsx(f.div,{initial:"hidden",animate:"visible",exit:"exit",variants:le,className:"absolute z-50 top-full -left-20 bg-white shadow-xl border-t rounded-xl w-48 mt-2",children:t.jsx("div",{className:"p-4",children:t.jsx("ul",{className:"space-y-3",children:xe?ce.map((e,r)=>t.jsx("li",{children:e.onClick?t.jsxs("button",{"aria-label":"menu-items",onClick:t=>{t.preventDefault(),t.stopPropagation(),H(!1),setTimeout(()=>{e.onClick()},150)},className:"flex w-full items-center gap-3 customtext-neutral-dark text-sm hover:customtext-primary hover:bg-gray-50 transition-all duration-300 p-2 rounded-lg",children:[e.icon,t.jsx("span",{children:e.label})]}):t.jsxs("a",{href:e.href,onClick:e=>{e.stopPropagation(),H(!1)},className:"flex items-center gap-3 customtext-neutral-dark text-sm hover:customtext-primary hover:bg-gray-50 transition-all duration-300 p-2 rounded-lg",children:[e.icon,t.jsx("span",{children:e.label})]})},r)):t.jsxs(t.Fragment,{children:[t.jsx("li",{children:t.jsxs("a",{href:"/admin/home",onClick:e=>{e.stopPropagation(),H(!1)},className:"flex items-center gap-3 customtext-neutral-dark text-sm hover:customtext-primary hover:bg-gray-50 transition-all duration-300 p-2 rounded-lg",children:[t.jsx(a,{size:16}),t.jsx("span",{children:"Dashboard"})]})}),t.jsx("li",{children:t.jsxs("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),H(!1),setTimeout(()=>{m()},150)},className:"flex w-full items-center gap-3 customtext-neutral-dark text-sm hover:customtext-primary hover:bg-gray-50 transition-all duration-300 p-2 rounded-lg",children:[t.jsx(s,{size:16}),t.jsx("span",{children:"Cerrar Sesión"})]})})]})})})})})]}):t.jsx("a",{href:"/iniciar-sesion",className:"flex items-center",children:t.jsx(r,{className:"customtext-primary",width:"1.5rem"})}),t.jsxs("button",{"aria-label":"",onClick:()=>M(!0),className:"flex items-center relative",children:[t.jsx(n,{className:"customtext-primary",width:"1.5rem"}),t.jsx("span",{className:"absolute -right-2 -top-2 inline-flex items-center justify-center w-4 h-4 bg-primary text-white rounded-full text-[8px]",children:ae})]})]}),t.jsx("button",{"aria-label":"Menú",onClick:()=>R(!D),className:"flex md:hidden items-center justify-center bg-primary rounded-lg w-auto h-auto p-2 text-white fill-white transition-all duration-300 ",children:D?t.jsx(i,{}):t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[t.jsx("path",{d:"M10 5H20",stroke:"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),t.jsx("path",{d:"M4 12H20",stroke:"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),t.jsx("path",{d:"M4 19H14",stroke:"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})})]}),t.jsxs("div",{className:"hidden md:block relative w-full max-w-xl mx-auto",children:[t.jsxs("form",{onSubmit:de,role:"search",children:[t.jsx("input",{ref:Z,type:"search",name:"search",placeholder:"Estoy buscando...",value:P,onChange:e=>ne(e.target.value),onKeyDown:he,onFocus:()=>{P.trim().length>=2&&se(P)},className:"w-full pr-14 py-4 pl-4 border rounded-full font-normal focus:ring-0 customtext-neutral-dark placeholder:customtext-neutral-dark focus:outline-none bg-[#DFF4FF]",enterKeyHint:"search",inputMode:"search",autoComplete:"on",role:"searchbox","aria-label":"Estoy buscando..."}),t.jsx("button",{type:"submit",className:"absolute right-3 top-1/2 transform -translate-y-1/2 p-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors","aria-label":"Buscar",children:t.jsx(o,{})})]}),t.jsx(g,{children:t.jsx(pe,{suggestions:$,isLoading:W,onSelect:oe})})]}),j?.showLoginCart?t.jsxs("div",{className:"hidden md:flex items-center gap-4 relative text-sm",children:[t.jsxs("div",{ref:V,children:[w?t.jsxs("button",{"aria-label":"user",className:"customtext-neutral-dark flex items-center gap-2 hover:customtext-primary pr-6 transition-all duration-300 relative group",onClick:()=>H(!F),children:[t.jsx("div",{className:"relative transform group-hover:scale-105 transition-transform duration-200",children:w.uuid?t.jsxs("div",{className:"relative",children:[t.jsx(p,{uuid:w.uuid,name:w.name,lastname:w.lastname,className:"w-8 h-8 rounded-full object-cover border-2 border-primary ring-secondary transition-all duration-300"}),t.jsxs("div",{className:"absolute -bottom-[-0.115rem] -right-0.5 w-3.5 h-3.5 bg-primary border-2 border-white rounded-full animate-pulse",children:[t.jsx("div",{className:"w-full h-full bg-primary rounded-full animate-ping opacity-75 absolute"}),t.jsx("div",{className:"w-full h-full bg-primary rounded-full"})]})]}):t.jsxs("div",{className:"relative",children:[t.jsx(r,{className:"customtext-primary border-2 border-primary rounded-full  ring-secondary group-hover:ring-green-300 transition-all duration-300"}),t.jsxs("div",{className:"absolute -bottom-0.5 -right-0.5 w-3.5 h-3.5 bg-primary border-2 border-white rounded-full animate-pulse",children:[t.jsx("div",{className:"w-full h-full bg-primary rounded-full animate-ping opacity-75 absolute"}),t.jsx("div",{className:"w-full h-full bg-primary rounded-full"})]})]})}),t.jsx("span",{className:"hidden md:inline",children:w.name})]}):t.jsxs("a",{href:"/iniciar-sesion",className:"flex items-center gap-2 text-sm hover:customtext-primary transition-colors duration-300",children:[t.jsx(r,{className:"customtext-primary"}),t.jsx("span",{className:"hidden md:inline",children:"Iniciar Sesión"})]}),t.jsx(g,{children:F&&t.jsx(f.div,{initial:"hidden",animate:"visible",exit:"exit",variants:le,className:"absolute z-50 top-full left-0 bg-white shadow-xl border-t rounded-xl w-48 mt-2",children:t.jsx("div",{className:"p-4",children:t.jsx("ul",{className:"space-y-4",children:xe?ce.map((e,r)=>t.jsx("li",{children:e.onClick?t.jsxs("button",{"aria-label":"menu-items",onClick:t=>{t.preventDefault(),t.stopPropagation(),H(!1),setTimeout(()=>{e.onClick()},150)},className:"flex w-full items-center gap-3 customtext-neutral-dark text-sm hover:customtext-primary hover:bg-gray-50 transition-all duration-300 p-2 rounded-lg",children:[e.icon,t.jsx("span",{children:e.label})]}):t.jsxs("a",{href:e.href,onClick:e=>{e.stopPropagation(),H(!1)},className:"flex items-center gap-3 customtext-neutral-dark text-sm hover:customtext-primary hover:bg-gray-50 transition-all duration-300 p-2 rounded-lg",children:[e.icon,t.jsx("span",{children:e.label})]})},r)):t.jsxs(t.Fragment,{children:[t.jsx("li",{children:t.jsxs("a",{href:"/admin/home",onClick:e=>{e.stopPropagation(),H(!1)},className:"flex items-center gap-3 customtext-neutral-dark text-sm hover:customtext-primary hover:bg-gray-50 transition-all duration-300 p-2 rounded-lg",children:[t.jsx(a,{size:16}),t.jsx("span",{children:"Dashboard"})]})}),t.jsx("li",{children:t.jsxs("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),H(!1),setTimeout(()=>{m()},150)},className:"flex w-full items-center gap-3 customtext-neutral-dark text-sm hover:customtext-primary hover:bg-gray-50 transition-all duration-300 p-2 rounded-lg",children:[t.jsx(s,{size:16}),t.jsx("span",{children:"Cerrar Sesión"})]})})]})})})})})]}),t.jsxs("button",{"aria-label":"cart",onClick:()=>M(!0),className:"flex items-center gap-2 text-sm relative hover:customtext-primary transition-colors duration-300",children:[t.jsx("div",{className:"customtext-primary",children:t.jsx(n,{})}),t.jsx("span",{className:"hidden md:inline",children:"Mi Carrito"}),t.jsx("span",{className:"absolute -right-6 -top-2 inline-flex items-center justify-center w-5 h-5 text-xs bg-primary text-white rounded-full",children:ae})]})]}):t.jsxs(t.Fragment,{children:[t.jsx("a",{"aria-label":"primary-button",className:`${j.class?j.class:"bg-primary"} hidden lg:block px-6 py-2.5 text-white font-medium rounded-3xl hover:brightness-125 transition-colors duration-300`,target:"_blank",rel:"noopener noreferrer",href:L&&E?`https://api.whatsapp.com/send?phone=${encodeURIComponent(L)}&text=${encodeURIComponent(E)}`:"#",children:"Haz tu pedido"}),t.jsx("div",{className:"md:hidden relative w-full max-w-xl mx-auto",children:T?t.jsxs("div",{className:"relative w-full",children:[t.jsxs("form",{onSubmit:ue,role:"search",children:[t.jsx("input",{ref:Q,type:"search",name:"search",placeholder:"Buscar productos",value:P,onChange:e=>ne(e.target.value),onKeyDown:he,onFocus:()=>{P.trim().length>=2&&se(P)},className:"w-full pr-14 py-4 pl-4 border rounded-full focus:ring-0 focus:outline-none",autoFocus:!0,enterKeyHint:"search",inputMode:"search",autoComplete:"off",role:"searchbox","aria-label":"Buscar productos",onBlur:()=>{setTimeout(()=>{P.trim()||K||B(!1)},200)}}),t.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex gap-2",children:[t.jsx("button",{type:"button",onClick:()=>{I(""),ie(),B(!1)},className:"p-2 bg-gray-200 text-gray-600 rounded-lg hover:bg-gray-300 transition-colors","aria-label":"Cerrar búsqueda",children:t.jsx(i,{size:16})}),t.jsx("button",{type:"submit",className:"p-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors","aria-label":"Buscar",children:t.jsx(o,{size:16})})]})]}),t.jsx(g,{children:t.jsx(pe,{suggestions:$,isLoading:W,onSelect:oe,selectedIndex:O})})]}):t.jsx("button",{"aria-label":"Buscar productos",onClick:()=>{B(!0),setTimeout(()=>{Q.current&&Q.current.focus()},100)},className:"flex items-center justify-end w-full px-0 py-3",children:t.jsx(o,{className:"customtext-primary",size:28})})})]})]}),j?.mobileSearch&&!(()=>{try{const e=window.location.pathname||"";return["/cart","/checkout"].some(t=>e.includes(t))}catch(e){return!1}})()&&t.jsx("div",{className:"block md:hidden mt-6 space-y-4",children:t.jsxs("div",{className:"w-full relative",children:[t.jsxs("form",{onSubmit:ue,role:"search",className:"relative w-full",children:[t.jsx("input",{type:"search",name:"search",placeholder:"Buscar productos...",value:P,onChange:e=>ne(e.target.value),onKeyDown:he,onFocus:()=>{P.trim().length>=2&&se(P)},className:"w-full pr-14 py-3 font-normal pl-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-primary focus:border-transparent focus:outline-none bg-gray-50",enterKeyHint:"search",inputMode:"search",autoComplete:"off",role:"searchbox","aria-label":"Buscar productos"}),t.jsx("button",{type:"submit",className:"absolute right-2 top-1/2 transform -translate-y-1/2 p-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors","aria-label":"Buscar",children:t.jsx(o,{size:18})})]}),t.jsx(g,{children:t.jsx(pe,{suggestions:$,isLoading:W,onSelect:oe,selectedIndex:O})})]})})]}),t.jsx(g,{children:D&&t.jsx(f.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2},className:"lg:hidden bg-transparent text-textWhite shadow-lg w-full min-h-screen absolute z-10 top-20",children:t.jsx(h,{search:P,setSearch:I,pages:N,items:b,onClose:()=>R(!D)})})}),t.jsx(u,{data:j,cart:y,setCart:v,modalOpen:z,setModalOpen:M})]})};export{b as default};
