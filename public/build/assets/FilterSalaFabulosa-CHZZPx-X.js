import{r as e,m as t,j as s,f as a,bd as r,E as l,R as i,J as n,X as o,N as c,S as d}from"./vendor-react-CtPXetfm.js";import"./ProductDetailB-DzJO_4TN.js";import{I as m}from"./ItemsRest-B-0SQfAd.js";import{A as u}from"./ArrayJoin-BdaqwNXM.js";import{L as x}from"./Loading-Cn0aHsiY.js";import{N as p}from"./NoResult-BPfUh4c-.js";import{S as g}from"./SelectForm-DCbCyjIZ.js";import{C as h}from"./Number2Currency-BX4epFEo.js";import"./CartKuchara-Jdwx0GGB.js";import f from"./ProductCardColors-5ud_eCC3.js";import"./vendor-swiper-Cr_RrIb_.js";import"./OpenPayCardModal-CLeyEGiH.js";import"./CartModal-DcYNc6DJ.js";import"./CartItemRow-eFLbqPUz.js";import"./vendor-motion-CThzL09Q.js";import"./Footer-coriRrmf.js";import"./BasicRest-BxJc2T7L.js";import"./BooleanLimit-q2Ad9fGY.js";import"./General-ClVW7qxN.js";import"./TippyButton-Dqi9Vaf_.js";const b=new m,j=({items:m,data:j,filteredData:y,cart:w,setCart:N})=>{const[v,C]=e.useState([]),[P,_]=e.useState([]),[k,S]=e.useState([]),[E,A]=e.useState([]),[T,L]=e.useState([]),[R,M]=e.useState({collection:!j?.collection,marca:!!j?.brand,precio:!0,categoria:!!j?.category,colores:!!j?.color}),[G,I]=e.useState(window.innerWidth<1024),[$,B]=e.useState([]);e.useEffect(()=>{const e=()=>{I(window.innerWidth<1024)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const O=e=>{M(G?t=>{const s={collection:!1,marca:!1,precio:!1,categoria:!1,colores:!1};return s[e]=!t[e],s}:t=>({...t,[e]:!t[e]}))},z=()=>{q({collection_id:[],category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort_by:"created_at",order:"desc"}),B([])},[F,q]=e.useState({collection_id:t.GET.collection?t.GET.collection.split(","):[],category_id:t.GET.category?t.GET.category.split(","):[],brand_id:t.GET.brand?t.GET.brand.split(","):[],subcategory_id:t.GET.subcategory?t.GET.subcategory.split(","):[],price:null,name:t.GET.search||null,sort_by:"created_at",order:"desc"}),[D,J]=e.useState([]),[K,H]=e.useState(!0),[V,W]=e.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:21,from:0,to:0}),Y=F.collection_id.length>0||F.category_id.length>0||F.brand_id.length>0||F.subcategory_id.length>0||null!==F.price||null!==F.name,Z=async(e=1)=>{H(!0);try{const t=(e=>{const t=[];if(e.collection_id.length>0){const s=e.collection_id.map(e=>["collection.slug","=",e]);t.push(u(s,"or"))}if(e.category_id.length>0){const s=e.category_id.map(e=>["category.slug","=",e]);t.push(u(s,"or"))}if(e.subcategory_id.length>0){const s=e.subcategory_id.map(e=>["subcategory.slug","=",e]);t.push(u(s,"or"))}if(e.brand_id.length>0){const s=e.brand_id.map(e=>["brand.slug","=",e]);t.push(u(s,"or"))}return e.price?.min&&e.price?.max&&t.push([["final_price",">=",e.price.min],"or",["final_price","<=",e.price.max]]),e.name&&t.push(["name","contains",e.name]),u(t,"and")})(F),s={filter:t,sort:F.sort,skip:(e-1)*V.itemsPerPage,take:V.itemsPerPage,requireTotalCount:!0,filterSequence:$},a=await b.paginate(s);J(a.data),W({currentPage:e,totalPages:Math.ceil(a.totalCount/V.itemsPerPage),totalItems:a.totalCount,itemsPerPage:V.itemsPerPage,from:(e-1)*V.itemsPerPage+1,to:Math.min(e*V.itemsPerPage,a.totalCount)}),C(a?.summary.collections),_(a?.summary.brands),A(a?.summary.categories),S(a?.summary.subcategories),L(a?.summary.priceRanges)}catch(t){}finally{H(!1)}};e.useEffect(()=>{Z(V.currentPage)},[F]);const U=e=>{e>=1&&e<=V.totalPages&&Z(e)},X=()=>{const e=[],t=V.totalPages,s=V.currentPage;for(let a=1;a<=t;a++)1===a||a===t||a>=s-2&&a<=s+2?e.push(a):a!==s-2-1&&a!==s+2+1||e.push("...");return e.filter((e,t,s)=>"..."!==e||"..."!==s[t-1])},Q=(e,t)=>{B(s=>{let a=!1;if("price"===e)a=!!t;else{a=!(Array.isArray(F[e])?F[e]:[]).includes(t)}if(s.includes(e)&&a)return s;if(!s.includes(e)&&a)return[...s,e];if(!a){let a=!1;if("price"===e)a=!t;else{a=0===(Array.isArray(F[e])?[...F[e]]:[]).filter(e=>e!==t).length}return a?s.filter(t=>t!==e):s}return s}),q(s=>{if("price"===e)return{...s,price:s.price&&s.price.min===t?.min&&s.price.max===t?.max?null:t};const a=Array.isArray(s[e])?s[e]:[],r=a.includes(t)?a.filter(e=>e!==t):[...a,t];return{...s,[e]:r}})},[ee,te]=e.useState(""),[se,ae]=e.useState(""),[re,le]=e.useState(""),ie=v?.filter(e=>e.name.toLowerCase().includes(se.toLowerCase())),ne=E?.filter(e=>e.name.toLowerCase().includes(ee.toLowerCase()));P?.filter(e=>e.name.toLowerCase().includes(re.toLowerCase()));const[oe,ce]=e.useState(!1),[de,me]=e.useState(!1),[ue,xe]=e.useState(!1),pe=()=>{xe(!1),setTimeout(()=>me(!1),300),document.body.style.overflow="auto"},ge={overlay:{backgroundColor:ue?"rgba(0, 0, 0, 0.5)":"rgba(0, 0, 0, 0)",zIndex:50,transition:"background-color 300ms ease-in-out"},content:{top:"auto",left:"0",right:"0",bottom:"0",borderRadius:"1rem 1rem 0 0",border:"none",padding:"0",height:"85vh",transform:ue?"translateY(0)":"translateY(100%)",transition:"transform 300ms ease-in-out",willChange:"transform"}},he=()=>s.jsxs("div",{className:"flex-1 overflow-y-auto px-4 pb-20 lg:pb-0 lg:px-0",children:[s.jsxs("div",{className:"sticky top-0 bg-white py-4 border-b flex justify-between items-center lg:hidden",children:[s.jsx("h2",{className:"text-xl font-bold",children:"Filtros"}),s.jsx("button",{onClick:pe,children:s.jsx(o,{className:"h-6 w-6"})})]}),s.jsx("p",{className:"customtext-primary text-2xl font-bold pb-4 mb-4 border-b lg:block hidden",children:"Combina como desees"}),Y&&s.jsx("div",{className:"mb-4",children:s.jsxs("button",{onClick:z,className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium py-2 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:[s.jsx(o,{size:16}),s.jsx("span",{children:"Limpiar todos los filtros"})]})}),R.collection&&ie?.length>0&&s.jsxs("div",{className:"mt-2 mb-4",children:[s.jsxs("button",{onClick:()=>O("collection"),className:"flex items-center justify-between w-full mb-2 p-2 lg:p-0",children:[s.jsx("span",{className:"font-semibold text-lg",children:"Colecciones"}),s.jsx(c,{className:"h-5 w-5 transform transition-transform "+(R.collection?"":"-rotate-180")})]}),R.collection&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative hidden md:flex",children:[s.jsx(d,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full pl-10 pr-4 py-3 border rounded-xl focus:ring-0 focus:outline-0",value:se,onChange:e=>ae(e.target.value)})]}),s.jsx("div",{className:"max-h-[200px] xl:max-h-none overflow-y-auto space-y-1 md:space-y-2",children:ie?.map(e=>{const t=F.collection_id?.includes(e.slug);return s.jsx("div",{className:"group flex items-center gap-3 p-2 rounded-lg "+(t?"bg-secondary":"hover:bg-gray-50"),children:s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 accent-primary form-checkbox focus:ring-0 customtext-neutral-dark",onChange:()=>Q("collection_id",e.slug),checked:t}),s.jsx("img",{src:`/storage/images/collection/${e.image}`,onError:e=>e.target.src="assets/img/noimage/no_imagen_circular.png",className:"w-8 h-8 rounded-full object-cover",alt:e.name}),s.jsx("span",{className:"text-sm lg:text-base",children:e.name})]})},e.id)})})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("button",{onClick:()=>O("categoria"),className:"flex items-center justify-between w-full mb-2 p-2 lg:p-0",children:[s.jsx("span",{className:"font-semibold text-lg",children:"Categorías"}),s.jsx(c,{className:"h-5 w-5 transform transition-transform "+(R.categoria?"":"-rotate-180")})]}),R.categoria&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"relative hidden md:flex",children:[s.jsx(d,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full pl-10 pr-4 py-3 border rounded-xl focus:ring-0 focus:outline-0",value:ee,onChange:e=>te(e.target.value)})]}),s.jsx("div",{className:"max-h-[200px] xl:max-h-none overflow-y-auto space-y-1 md:space-y-2",children:ne?.map(e=>{const t=F.category_id?.includes(e.slug);return s.jsx("div",{className:"group flex items-center gap-3 p-2 rounded-lg "+(t?"bg-secondary":"hover:bg-gray-50"),children:s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 accent-primary form-checkbox focus:ring-0 customtext-neutral-dark",onChange:()=>Q("category_id",e.slug),checked:t}),s.jsx("img",{src:`/storage/images/category/${e.image}`,onError:e=>e.target.src="assets/img/noimage/no_imagen_circular.png",className:"w-8 h-8 rounded-full object-cover",alt:e.name}),s.jsx("span",{className:"text-sm lg:text-base",children:e.name})]})},e.id)})})]})]}),R.precio&&T?.length>0&&s.jsxs("div",{className:"mb-4",children:[s.jsxs("button",{onClick:()=>O("precio"),className:"flex items-center justify-between w-full mb-2 p-2 lg:p-0",children:[s.jsx("span",{className:"font-semibold text-lg",children:"Precio"}),s.jsx(c,{className:"h-5 w-5 transform transition-transform "+(R.precio?"":"-rotate-180")})]}),R.precio&&s.jsx("div",{className:"max-h-[200px] xl:max-h-none overflow-y-auto space-y-1 md:space-y-2",children:T.map(e=>{const t=F.price?.min===e.min&&F.price?.max===e.max;return s.jsxs("label",{className:"flex items-center gap-2 p-2 rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>{Q("price",t?null:e)},children:[s.jsx("div",{className:`w-[18px] h-[18px] rounded-full border ${t?"border-primary":"border-gray-300"} flex items-center justify-center`,children:t&&s.jsx("div",{className:"w-3 h-3 rounded-full bg-primary"})}),s.jsx("span",{className:"text-sm lg:text-base",children:`${h()} ${e.min} - ${h()} ${e.max}`})]},`${e.min}-${e.max}`)})})]}),s.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t p-4 h-20 flex items-center lg:hidden",children:s.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-xl font-bold hover:bg-primary-dark transition-colors",onClick:pe,children:"Ver resultados"})})]});return s.jsxs("div",{id:j?.element_id||null,children:[s.jsx(a,{isOpen:de,onRequestClose:pe,style:ge,closeTimeoutMS:300,ariaHideApp:!1,shouldCloseOnOverlayClick:!0,shouldCloseOnEsc:!0,children:he()}),s.jsx("section",{className:"py-6 font-paragraph customtext-primary",children:s.jsxs("div",{className:"mx-auto px-primary 2xl:max-w-7xl 2xl:px-0",children:[s.jsx("p",{className:"customtext-primary text-3xl font-bold mb-2 xl:hidden",children:"Combina como desees"}),s.jsxs("div",{className:"relative flex flex-col xl:flex-row gap-10",children:[s.jsx("div",{className:"hidden xl:block xl:w-1/4 lg:bg-white lg:p-0 xl:rounded-lg xl:h-max",children:he()}),s.jsxs("div",{className:"w-full pb-4",children:[s.jsxs("div",{className:"mb-4 lg:mb-8 w-full gap-5 xl:flex xl:flex-row xl:justify-between items-start",children:[s.jsxs("div",{className:"flex flex-row justify-between items-end gap-5",children:[s.jsxs("div",{className:"flex flex-col xl:flex-row xl:justify-between gap-2 xl:items-center lg:max-w-xs w-full",children:[s.jsx("label",{className:"font-semibold text-base 2xl:text-lg w-auto",children:"Ordenar por"}),s.jsx("div",{className:"min-w-52",children:s.jsx(g,{options:[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],placeholder:"Recomendados",onChange:e=>{const[t,s]=e.split(":"),a=[{selector:t,desc:"desc"===s}];q(e=>({...e,sort:a}))},labelKey:"label",valueKey:"value",className:"border-primary rounded-full customtext-primary w-full"})})]}),s.jsx("div",{children:s.jsx("button",{onClick:()=>{me(!0),setTimeout(()=>xe(!0),10),document.body.style.overflow="hidden"},className:"flex xl:hidden bg-primary text-white rounded-full p-3 shadow-lg z-40 items-center justify-center","aria-label":"Abrir filtros",children:s.jsx(r,{className:"w-6 h-6"})})})]}),s.jsx("div",{className:"hidden xl:flex customtext-primary font-semibold w-full lg:w-auto",children:s.jsxs("div",{className:"flex gap-3 items-center w-full",children:[s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsxs("nav",{className:"flex items-center gap-x-1 min-w-max",children:[s.jsx("button",{className:"p-0 inline-flex items-center "+(1===V.currentPage?"opacity-50 cursor-not-allowed":""),onClick:()=>U(V.currentPage-1),disabled:1===V.currentPage,children:s.jsx(l,{})}),X().map((e,t)=>s.jsx(i.Fragment,{children:"..."===e?s.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):s.jsx("button",{className:"w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 \n                                           \n                                            "+(e===V.currentPage?"bg-accent text-white":"bg-transparent hover:text-white hover:bg-accent"),onClick:()=>U(e),children:e})},t)),s.jsx("button",{className:"p-0 inline-flex items-center "+(V.currentPage===V.totalPages?"opacity-50 cursor-not-allowed":""),onClick:()=>U(V.currentPage+1),disabled:V.currentPage===V.totalPages,children:s.jsx(n,{})})]})}),s.jsx("div",{children:s.jsxs("p",{className:"font-semibold",children:[V.from," - ",V.to," ","de ",V.totalItems," ","Resultados"]})})]})})]}),K?s.jsx(x,{}):s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 md:gap-6 xl:gap-8 gap-y-2 lg:gap-y-3 transition-all duration-300 ease-in-out",children:Array.isArray(D)&&D.length>0?D.map(e=>s.jsx(f,{product:e,widthClass:"lg:w-1/3",cart:w,setCart:N},e.id)):s.jsx(p,{})}),s.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsx("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[s.jsx("button",{className:"p-4 inline-flex items-center "+(1===V.currentPage?"opacity-50 cursor-not-allowed":""),onClick:()=>U(V.currentPage-1),disabled:1===V.currentPage,children:s.jsx(l,{})}),X().map((e,t)=>s.jsx(i.Fragment,{children:"..."===e?s.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):s.jsx("button",{className:"w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 \n                                            "+(e===V.currentPage?"bg-accent text-white":"bg-transparent hover:text-white hover:bg-accent"),onClick:()=>U(e),children:e})},t)),s.jsx("button",{className:"p-4 inline-flex items-center "+(V.currentPage===V.totalPages?"opacity-50 cursor-not-allowed":""),onClick:()=>U(V.currentPage+1),disabled:V.currentPage===V.totalPages,children:s.jsx(n,{})})]})})})}),s.jsx("div",{children:s.jsxs("p",{className:"font-semibold",children:[V.from," - ",V.to," de"," ",V.totalItems," Resultados"]})})]})]})]})]})})]})};export{j as default};
