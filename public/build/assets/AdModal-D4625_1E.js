import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as i}from"./index-BOnQTV8N.js";import{R as S}from"./PolicyModal-C80IvD61.js";import{H as $}from"./HtmlContent-ghmllTyl.js";import{X as _}from"./x-fof_H3Vv.js";import{C as D}from"./chevron-left-JcR9Fe4w.js";import{C as E}from"./chevron-right-Cug7tVUE.js";import{c as T}from"./createLucideIcon-DfjclApS.js";import"./index-yBjzXJbu.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-B6ujFmsw.js";import"./index-Chjiymov.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=T("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),X=({data:r,items:h=[]})=>{const[d,s]=i.useState(!1),[f,y]=i.useState(!1),[a,j]=i.useState([]),[c,p]=i.useState(0),x=t=>`mblens_ad_seen_${t.id||t.image}`;i.useEffect(()=>{const t=h.filter(o=>o&&o.image);console.log("AdModal: Procesando anuncios...",t);const n=new Date,l=new Date(n.getFullYear(),n.getMonth(),n.getDate()),C=t.filter(o=>{if(!o.date_begin&&!o.date_end)return console.log(`AdModal: Anuncio ${o.id||o.image} sin fechas, siempre visible.`),!0;const u=o.date_begin?new Date(o.date_begin+"T00:00:00"):null,g=o.date_end?new Date(o.date_end+"T23:59:59"):null;return u&&l<u?(console.log(`AdModal: Anuncio ${o.id||o.image} aún no inicia (${o.date_begin}).`),!1):g&&n>g?(console.log(`AdModal: Anuncio ${o.id||o.image} ya expiró (${o.date_end}).`),!1):(console.log(`AdModal: Anuncio ${o.id||o.image} está dentro del rango de fechas.`),!0)}).filter(o=>{const u=x(o),g=localStorage.getItem(u);if(!g)return!0;const k=Date.now(),w=parseInt(g,10);return isNaN(w)||k>w?(console.log(`AdModal: Anuncio ${o.id||o.image} expiró su marca de visto. Mostrando de nuevo.`),localStorage.removeItem(u),!0):(console.log(`AdModal: Anuncio ${o.id||o.image} ya fue visto. Ocultando.`),!1)});j(C)},[h]),i.useEffect(()=>{if(a.length===0||f)return;const n=(a[0].seconds||0)*1e3;console.log(`AdModal: Programando apertura en ${n}ms`);const l=setTimeout(()=>{s(!0),y(!0)},n);return()=>clearTimeout(l)},[a,f]),i.useEffect(()=>{if(!d||a.length<=1)return;const t=a[c],n=((t==null?void 0:t.seconds)||5)*1e3;console.log(`AdModal: Slide ${c+1} durará ${n}ms`);const l=setTimeout(()=>{p(m=>(m+1)%a.length)},n);return()=>clearTimeout(l)},[d,a.length,c]);const A=()=>{p(t=>(t+1)%a.length)},N=()=>{p(t=>(t-1+a.length)%a.length)},v=()=>{console.log("AdModal: Cerrando y guardando estado 'visto'..."),s(!1);const t=1440*60*1e3,n=Date.now()+t;a.forEach(l=>{const m=x(l);localStorage.setItem(m,n.toString()),console.log(`AdModal: Guardado ${m} expira en ${new Date(n).toLocaleString()}`)})},M=t=>{t&&window.open(t,"_blank","noopener,noreferrer")};if(a.length===0)return null;const b=a.some(t=>t.invasivo);return e.jsxs(S,{isOpen:d,shouldCloseOnOverlayClick:!b,shouldCloseOnEsc:!b,onRequestClose:v,contentLabel:"Anuncio",className:"absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-white w-[90%] max-w-4xl outline-none shadow-2xl rounded-2xl overflow-visible",overlayClassName:"fixed inset-0 bg-black/70 backdrop-blur-sm z-[9999] flex items-center justify-center",ariaHideApp:!1,children:[e.jsx("button",{onClick:v,className:"absolute -top-3 -right-3 md:-top-4 md:-right-4 z-[9999] w-10 h-10 md:w-12 md:h-12 bg-white text-gray-700 rounded-full shadow-xl border border-gray-100 hover:bg-gray-50 hover:scale-110 hover:text-red-500 transition-all duration-300 flex items-center justify-center group","aria-label":"Cerrar anuncio",children:e.jsx(_,{size:22,strokeWidth:2.5,className:"transition-transform group-hover:rotate-90 duration-300"})}),e.jsxs("div",{className:"w-full h-full bg-white rounded-2xl overflow-hidden relative",children:[e.jsx("div",{className:"relative",children:a.map((t,n)=>e.jsx("div",{className:`transition-all duration-500 ease-in-out ${n===c?"opacity-100 relative":"opacity-0 absolute inset-0 pointer-events-none"}`,children:e.jsx(O,{ad:t,handleAdClick:M})},t.id||n))}),a.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:N,className:"absolute left-2 md:left-4 top-1/2 -translate-y-1/2 z-30 p-2 md:p-3 rounded-full bg-white/90 hover:bg-primary text-gray-700 hover:text-white transition-all duration-300 hover:scale-110 shadow-lg group","aria-label":"Anterior",children:e.jsx(D,{className:"w-5 h-5 md:w-6 md:h-6 transition-transform group-hover:-translate-x-0.5"})}),e.jsx("button",{onClick:A,className:"absolute right-2 md:right-4 top-1/2 -translate-y-1/2 z-30 p-2 md:p-3 rounded-full bg-white/90 hover:bg-primary text-gray-700 hover:text-white transition-all duration-300 hover:scale-110 shadow-lg group","aria-label":"Siguiente",children:e.jsx(E,{className:"w-5 h-5 md:w-6 md:h-6 transition-transform group-hover:translate-x-0.5"})})]}),a.length>1&&e.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-30 flex space-x-2",children:a.map((t,n)=>e.jsx("button",{onClick:()=>p(n),className:`transition-all duration-300 rounded-full ${n===c?"w-8 h-2.5 bg-primary":"w-2.5 h-2.5 bg-gray-300 hover:bg-gray-400"}`,"aria-label":`Ir al anuncio ${n+1}`},n))})]})]})},O=({ad:r,handleAdClick:h})=>{const d=r.button_text||"Ver más detalles",s=r.name||r.description||r.link;return e.jsxs("div",{className:`flex flex-col w-full ${s?"md:flex-row":""}`,children:[e.jsxs("div",{className:`w-full ${s?"md:w-1/2":""} relative bg-gray-100 overflow-hidden group`,children:[e.jsx("div",{className:"aspect-square w-full",children:e.jsx("img",{src:`/api/ads/media/${r.image}`,alt:r.name||"Anuncio",className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"})}),s&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/30 via-transparent to-transparent md:bg-gradient-to-r md:from-transparent md:via-transparent md:to-black/10 pointer-events-none"})]}),s&&e.jsx("div",{className:"w-full md:w-1/2 p-6 md:p-10 lg:p-12 flex flex-col justify-center items-start text-left bg-white relative",children:e.jsxs("div",{className:"w-full space-y-4 md:space-y-6",children:[r.name&&e.jsx("h2",{className:"text-2xl md:text-3xl lg:text-4xl font-bold text-gray-900 leading-tight",children:r.name}),r.description&&e.jsx("div",{className:"prose prose-sm md:prose-base text-gray-600 line-clamp-4 md:line-clamp-6",children:e.jsx($,{html:r.description})}),r.link&&e.jsxs("button",{onClick:()=>h(r.link),className:"mt-4 w-full md:w-auto bg-primary hover:bg-primary/90 text-white font-semibold py-3 px-8 rounded-full transition-all duration-300 shadow-lg hover:shadow-xl hover:scale-105 flex items-center justify-center gap-2 group",children:[e.jsx("span",{children:d}),e.jsx(I,{className:"w-4 h-4 group-hover:translate-x-1 group-hover:-translate-y-0.5 transition-transform"})]})]})})]})};export{X as default};
