import{r as e,m as t,j as a,b3 as s,aY as r,q as i}from"./vendor-react-CIjjZrQp.js";import{P as l}from"./ProductCardIbergruas-D4_30UYl.js";import o from"./StoreMap-BascTVwd.js";import{I as n}from"./ItemsRest-C8ZotzGr.js";import{A as c}from"./ArrayJoin-BdaqwNXM.js";import{N as d}from"./NoResult-C_mMdO9d.js";import{S as m}from"./SelectForm-fbL8O2pX.js";import{M as u}from"./MessagesRest-CRUc6FuS.js";import{t as x}from"./OpenPayCardModal-CwaBgze7.js";import{A as g,m as h}from"./vendor-motion-8tRwuE1V.js";import"./vendor-swiper-Cr_RrIb_.js";import"./CartModal-D6iWiH0j.js";import"./CartItemRow-CwX9fDj8.js";import"./Number2Currency-SEeETbGC.js";import"./General-ClVW7qxN.js";import"./CartKuchara-CBARZO7P.js";import"./ProductCardIbergruas-Cp5PcczU.js";import"./Footer-BJbvhrcw.js";import"./BasicRest-Czelh5on.js";import"./BooleanLimit-q2Ad9fGY.js";const p=new n,b=new u,f=({items:n,data:u,filteredData:f,cart:y,setCart:j})=>{const w=[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],[v,N]=e.useState([]),[_,C]=e.useState([]),[E,S]=e.useState([]),[k,T]=e.useState([]),[G,P]=e.useState([]),[A,R]=e.useState([]),[z,q]=e.useState({category:null,current_subcategory:null,subcategories:[],banners:[],stores:[]}),[I,M]=e.useState(()=>("undefined"!=typeof window&&window.innerWidth,{marca:!1,precio:!1,categoria:!1,subcategoria:!1,colores:!1,coleccion:!1})),[$,D]=e.useState({collection_id:[],category_id:[],brand_id:[],subcategory_id:[],tag_id:t.GET.tag?t.GET.tag.split(","):[],price:[],name:t.GET.search||null,sort:(()=>{if(t.GET.sortBy){const e=t.GET.sortBy;let a=w.find(t=>t.value===e);if(a||(a=w.find(t=>t.label.toLowerCase()===e.toLowerCase())),a){const[e,t]=a.value.split(":");return[{selector:e,desc:"desc"===t}]}}return[{selector:"final_price",desc:!0}]})()}),[L,K]=e.useState([]),[B,F]=e.useState(!0),[W,O]=e.useState(!1),[U,Z]=e.useState(!1),[J,Q]=e.useState(!1),[V,Y]=e.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:24,from:0,to:0}),H=async(e=1,t=!1)=>{Q(!1),t?O(!0):F(!0);try{const t=(e=>{const t=[];if(e.sort&&Array.isArray(e.sort)){const a=["featured","offering","is_new","recommended"];e.sort.forEach(e=>{a.includes(e.selector)&&t.push([e.selector,"=",1])})}if(e.collection_id.length>0){const a=e.collection_id.map(e=>["collection.id","=",k.find(t=>t.slug===e)?.id||e]);t.push(c(a,"or"))}if(e.category_id.length>0){const a=e.category_id.map(e=>["category.id","=",e]);t.push(c(a,"or"))}if(e.subcategory_id.length>0){const a=e.subcategory_id.map(e=>["subcategory.id","=",e]);t.push(c(a,"or"))}if(e.brand_id.length>0){const a=e.brand_id.map(e=>{const t=v.find(t=>t.slug===e);return t?["brand.slug","=",t.slug]:["brand.slug","=",e]});t.push(c(a,"or"))}if(e.tag_id&&e.tag_id.length>0){const a=e.tag_id.map(e=>["item_tag.tag_id","=",e]);t.push(c(a,"or"))}if(e.price&&e.price.length>0){const a=e.price.map(e=>["and",[["final_price",">=",e.min],"and",["final_price","<=",e.max]]]);t.push(c(a,"or"))}if(e.name){const a=[["name","contains",e.name],"or",["summary","contains",e.name],"or",["description","contains",e.name]];t.push(a)}return c(t,"and")})($),a=16,s=["featured","offering","is_new","recommended"],r=$.sort.filter(e=>!s.includes(e.selector)),i={filter:t,sort:r.length>0?r:[{selector:"final_price",desc:!0}],skip:(e-1)*a,take:a,requireTotalCount:!0,with:"category,brand"},l=await p.paginate(i);if(200!==l.status)throw new Error(`API returned status ${l.status}`);K(l.data||[]),Z(!0),l.data&&0!==l.data.length||setTimeout(()=>Q(!0),300);const o=l.totalCount||0,n=Math.ceil(o/a);Y({currentPage:e,totalPages:n,totalItems:o,itemsPerPage:a,from:o>0?(e-1)*a+1:0,to:Math.min(e*a,o)}),N(l?.summary?.brands||[]),S(l?.summary?.categories||[]),C(l?.summary?.subcategories||[]),T(l?.summary?.collections||[]),P(l?.summary?.priceRanges||[]),R(l?.summary?.tags||[])}catch(a){setTimeout(()=>Q(!0),300)}finally{F(!1),O(!1)}};e.useEffect(()=>{f&&(S(f.categories||[]),N(f.brands||[]),C(f.subcategories||[]),P(f.priceRanges||[])),(async()=>{try{const e={};if(t.GET.category&&(e.category_slugs=t.GET.category),t.GET.brand&&(e.brand_slugs=t.GET.brand),t.GET.subcategory&&(e.subcategory_slugs=t.GET.subcategory),t.GET.collection&&(e.collection_slugs=t.GET.collection),Object.keys(e).length>0){const a=await p.convertSlugs(e);200===a.status&&D(e=>({...e,category_id:Array.isArray(a.data.category_ids)?a.data.category_ids:a.data.category_ids?[a.data.category_ids]:[],brand_id:t.GET.brand?[t.GET.brand]:[],subcategory_id:Array.isArray(a.data.subcategory_ids)?a.data.subcategory_ids:a.data.subcategory_ids?[a.data.subcategory_ids]:[],collection_id:Array.isArray(a.data.collection_ids)?a.data.collection_ids:a.data.collection_ids?[a.data.collection_ids]:[]}))}}catch(e){}})(),(async()=>{try{const e={};if(t.GET.subcategory&&(e.subcategory=t.GET.subcategory),t.GET.category&&(e.category=t.GET.category),t.GET.brand&&(e.brand=t.GET.brand),Object.keys(e).length>0){const t=await i.get("/api/catalog/context",{params:e});t.data&&q(t.data)}}catch(e){}})(),H(1,!1)},[f]),e.useEffect(()=>{H(1,U)},[$]);const[X,ee]=e.useState(""),[te,ae]=e.useState(""),[se,re]=e.useState(!1),ie=e.useRef(),le=e.useRef(),oe=e.useRef(),ne=e.useRef(),ce=e.useRef(),de=e.useRef(),[me,ue]=e.useState(!1),[xe,ge]=e.useState(""),[he,pe]=e.useState(""),[be,fe]=e.useState("");E.filter(e=>e.name.toLowerCase().includes(X.toLowerCase())),v.filter(e=>e.name.toLowerCase().includes(te.toLowerCase()));const ye=e=>{const t=e.replace(/\D/g,"");return 9!==t.length?"El teléfono debe tener 9 dígitos":t.startsWith("9")?"":"El número debe empezar con 9"};return a.jsxs("div",{id:u?.element_id||null,children:[a.jsx("div",{className:"",children:(()=>{const e=e=>{if(!e)return null;return e.split(/(\*[^*]+\*)/g).map((e,t)=>{if(e.startsWith("*")&&e.endsWith("*")){const s=e.slice(1,-1);return a.jsx("span",{className:"customtext-primary",children:s},t)}return a.jsx("span",{children:e},t)})};return z.banners&&z.banners.length>0?a.jsx("div",{className:"",children:z.banners.map((t,s)=>{if(0===s)return a.jsxs("div",{className:"relative overflow-hidden h-[500px] lg:h-[600px] flex items-center justify-center",children:[t.image&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"absolute inset-0",children:a.jsx("img",{src:`/storage/images/category/${t.image}`,alt:t.title||"Banner",className:"w-full h-full object-cover"})}),a.jsx("div",{className:"absolute inset-0 bg-black/50"})]}),a.jsx("div",{className:"relative z-10 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[t.title&&a.jsx("h1",{className:"text-4xl md:text-5xl  max-w-xl lg:text-6xl font-bold mb-6 leading-tight text-white",children:e(t.title)}),t.description&&a.jsx("p",{className:"text-lg md:text-xl lg:text-2xl text-white mb-8 max-w-2xl mx-auto",children:t.description}),t.button_text&&t.button_link&&a.jsx("a",{href:t.button_link,className:"inline-flex items-center gap-2 px-8 py-4 bg-transparent border-2 border-primary customtext-primary text-lg font-bold hover:bg-primary hover:text-white transition-all duration-300",children:a.jsx("span",{children:t.button_text})})]})})]},s);const r=s%2==1;return a.jsx("div",{className:"w-full overflow-hidden shadow-xl",children:a.jsxs("div",{className:"grid lg:grid-cols-2 min-h-[400px] lg:min-h-[500px] bg-white",children:[a.jsx("div",{className:"bg-primary flex items-center justify-center px-8 md:px-12 lg:px-16 xl:px-20 py-12 lg:py-16 "+(r?"order-2 lg:order-1":"order-2"),children:a.jsxs("div",{className:"max-w-2xl w-full space-y-6",children:[t.title&&a.jsx("h2",{className:"text-3xl md:text-4xl lg:text-5xl font-bold customtext-neutral-dark leading-tight",children:e(t.title)}),t.description&&a.jsx("p",{className:"text-lg md:text-xl customtext-neutral-darkleading-relaxed",children:t.description}),t.button_text&&t.button_link&&a.jsx("div",{className:"pt-4",children:a.jsx("a",{href:t.button_link,className:"inline-flex items-center border-2 border-neutral-dark justify-center gap-3 px-8 py-4 customtext-neutral-dark font-bold text-lg  transition-all duration-300 hover:scale-105 shadow-xl",children:a.jsx("span",{children:t.button_text})})})]})}),a.jsx("div",{className:"relative h-64 lg:h-auto "+(r?"order-1 lg:order-2":"order-1"),children:t.image&&a.jsxs(a.Fragment,{children:[a.jsx("img",{src:`/storage/images/category/${t.image}`,alt:t.title||"Banner",className:"absolute inset-0 w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/30 to-transparent lg:hidden"})]})})]})},s)})}):a.jsx(h.div,{className:"flex flex-col md:flex-row md:justify-between items-start md:items-center mb-6 lg:mb-8 lg:pb-6 lg:border-b-2 border-gradient-to-r from-blue-200 via-indigo-200 to-purple-200",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:a.jsx("div",{className:"md:w-6/12",children:a.jsx("h2",{className:"text-2xl lg:text-[32px] md:text-4xl font-bold customtext-primary lg:mb-2",children:u?.title||"Catálogo"})})})})()}),a.jsx("section",{className:"py-4 lg:py-12 bg-secondary",children:a.jsxs("div",{className:"mx-auto px-4 md:px-6 lg:px-8 2xl:px-0 2xl:max-w-7xl",children:[a.jsxs("div",{className:"mb-6 flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[z.subcategories&&z.subcategories.length>0&&a.jsx("div",{className:"w-full md:w-auto md:min-w-[280px]",children:a.jsx(m,{options:z.subcategories,valueKey:"slug",labelKey:"name",value:z.current_subcategory?.slug||"",placeholder:"Seleccionar subcategoría",className:"bg-primary text-white border-primary",classNameDropdown:"!rounded-none",classNameIcon:"text-white",onChange:e=>{window.location.href=`/catalogo?subcategory=${e}`}})}),a.jsx("div",{className:"w-full md:w-auto md:min-w-[280px]",children:a.jsx(m,{options:w,valueKey:"value",labelKey:"label",value:$.sort?.[0]?.selector?`${$.sort[0].selector}:${$.sort[0].desc?"desc":"asc"}`:"final_price:desc",placeholder:"Ordenar por",className:"bg-primary text-white border-primary",classNameDropdown:"!rounded-none",classNameIcon:"text-white",onChange:e=>{const[t,a]=e.split(":");D(e=>({...e,sort:[{selector:t,desc:"desc"===a}]}))}})})]}),a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"text-white",children:V.totalItems>0&&a.jsxs("p",{className:"text-sm",children:["Mostrando ",a.jsx("span",{className:"font-semibold text-white",children:V.from})," - ",a.jsx("span",{className:"font-semibold text-white",children:V.to})," de ",a.jsx("span",{className:"font-semibold text-white",children:V.totalItems})," productos"]})})}),a.jsxs("div",{className:"w-full",children:[B?a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[...Array(8)].map((e,t)=>a.jsx("div",{className:"bg-white rounded-2xl h-[400px] animate-pulse"},t))}):L.length>0?a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:a.jsx(g,{children:L.map((e,t)=>a.jsx(h.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{delay:.05*t},className:"h-full",children:a.jsx(l,{product:e,cart:y,setCart:j,data:u})},e.id))})}):J&&a.jsx(d,{}),V.totalPages>1&&a.jsx("div",{className:"mt-12 flex justify-center gap-2",children:Array.from({length:V.totalPages},(e,t)=>t+1).map(e=>a.jsx("button",{onClick:()=>(e=>{e>=1&&e<=V.totalPages&&e!==V.currentPage&&(window.scrollTo({top:0,behavior:"smooth"}),H(e,!1))})(e),className:"w-10 h-10 font-bold transition-all "+(V.currentPage===e?"bg-primary text-white shadow-lg scale-110":" text-white hover:bg-gray-50 hover:customtext-neutral-dark"),children:e},e))})]})]})}),a.jsxs(h.section,{className:"bg-secondary relative overflow-hidden",initial:{opacity:0},animate:{opacity:1},transition:{duration:.6},children:[a.jsx("div",{className:"hidden lg:block absolute left-0 top-0 bottom-0 w-1/3 z-0",children:z.category?.image?a.jsx("img",{src:`/storage/images/category/${z.category.image}`,alt:z.category.name,className:"w-full h-full object-cover"}):a.jsx("div",{className:"w-full h-full bg-gradient-to-br from-primary to-primary/80 flex items-center justify-center",children:a.jsxs("div",{className:"text-center text-white",children:[a.jsx(s,{size:80,className:"mx-auto mb-4 opacity-50"}),a.jsx("p",{className:"text-2xl font-bold",children:z.category?.name||"Maquinaria de Construcción"})]})})}),a.jsx("div",{className:"lg:hidden relative h-64 bg-gradient-to-br from-primary to-primary/80",children:z.category?.image?a.jsx("img",{src:`/storage/images/category/${z.category.image}`,alt:z.category.name,className:"w-full h-full object-cover opacity-80"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:a.jsxs("div",{className:"text-center text-white",children:[a.jsx(s,{size:80,className:"mx-auto mb-4 opacity-50"}),a.jsx("p",{className:"text-2xl font-bold",children:z.category?.name||"Maquinaria de Construcción"})]})})}),a.jsx("div",{className:"relative z-10 mx-auto px-[5%] 2xl:px-0 2xl:max-w-7xl",children:a.jsx("div",{className:"flex justify-end",children:a.jsxs("div",{className:"w-full lg:w-2/3 text-white lg:py-12 ",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h2",{className:"text-3xl lg:text-4xl font-bold text-white mb-3",children:"¡Cotiza con los N° 1 en el mundo!"}),a.jsx("p",{className:"text-white",children:"Cotizar nuestras maquinarias de construcción es muy fácil, déjanos tus datos a través del siguiente formulario."})]}),a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),me)return;const t=xe.replace(/\D/g,""),a=ye(xe);if(a)return pe(a),void x.error("Error de validación",{description:a,duration:3e3,position:"bottom-center"});ue(!0);const s={name:ie.current.value,phone:t,email:oe.current.value,company:ne.current?.value||"",ruc:ce.current?.value||"",subject:"Cotización desde catálogo",category:z.category?.name||"",subcategory:be||z.current_subcategory?.name||"",machinery:be||z.current_subcategory?.name||z.category?.name||"",description:de.current.value};await b.save(s),ie.current&&(ie.current.value=""),le.current&&(le.current.value=""),ge(""),pe(""),oe.current&&(oe.current.value=""),ne.current&&(ne.current.value=""),ce.current&&(ce.current.value=""),de.current&&(de.current.value=""),fe(""),x.success("Cotización enviada",{description:"¡Tu solicitud ha sido enviada correctamente! Nos pondremos en contacto contigo pronto.",duration:3e3,position:"bottom-center"}),ue(!1)},className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-white mb-2",children:["Nombre completo ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{ref:ie,type:"text",placeholder:"Nombre y apellido",required:!0,className:"w-full px-4 py-3 bg-transparent text-white placeholder-white/60 border border-white/30 focus:ring-2 focus:ring-white/50 focus:border-white transition-all"})]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-white mb-2",children:["Correo electrónico ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{ref:oe,type:"email",placeholder:"hola@mail.com.pe",required:!0,className:"w-full px-4 py-3 bg-transparent text-white placeholder-white/60 border border-white/30 focus:ring-2 focus:ring-white/50 focus:border-white transition-all"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-white mb-2",children:["Celular o Whatsapp ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{ref:le,type:"tel",placeholder:"+51...",value:xe,onChange:e=>{const t=(e=>{const t=e.replace(/\D/g,"").slice(0,9);return t.length<=3?t:t.length<=6?`${t.slice(0,3)} ${t.slice(3)}`:`${t.slice(0,3)} ${t.slice(3,6)} ${t.slice(6)}`})(e.target.value);if(ge(t),he){const e=ye(t);pe(e)}},required:!0,className:"w-full px-4 py-3 bg-transparent text-white placeholder-white/60 border focus:ring-2 focus:ring-white/50 focus:border-white transition-all "+(he?"border-red-500":"border-white/30")}),he&&a.jsx("p",{className:"mt-1 text-sm text-red-500",children:he})]})]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"Empresa"}),a.jsx("input",{ref:ne,type:"text",placeholder:"Razón Social",className:"w-full px-4 py-3 bg-transparent text-white placeholder-white/60 border border-white/30 focus:ring-2 focus:ring-white/50 focus:border-white transition-all"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-white mb-2",children:"RUC"}),a.jsx("input",{ref:ce,type:"text",placeholder:"Número de RUC",maxLength:11,className:"w-full px-4 py-3 bg-transparent text-white placeholder-white/60 border border-white/30 focus:ring-2 focus:ring-white/50 focus:border-white transition-all"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-white mb-2",children:[z.category?.name||"Maquinarias"," ",a.jsx("span",{className:"text-red-500",children:"*"})]}),z.subcategories&&z.subcategories.length>0?a.jsx(m,{options:z.subcategories,valueKey:"name",labelKey:"name",value:be||z.current_subcategory?.name||"",placeholder:"Seleccionar maquinaria",className:"bg-transparent text-white",classNameDropdown:"!rounded-none",classNameIcon:"text-white",onChange:fe}):a.jsx("input",{type:"text",value:z.category?.name||"Categoría",disabled:!0,className:"w-full px-4 py-3 border border-white/30 bg-transparent text-white/60 cursor-not-allowed"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-white mb-2",children:["Comentario ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("textarea",{ref:de,placeholder:"Consideraciones a tomar en cuenta",rows:4,required:!0,className:"w-full px-4 py-3 bg-transparent text-white placeholder-white/60 border border-white/30 focus:ring-2 focus:ring-white/50 focus:border-white transition-all resize-none"})]}),a.jsx("button",{type:"submit",disabled:me,className:"w-full bg-primary hover:bg-primary/90 text-white font-bold py-4 px-6 transition-all duration-300 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:me?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Enviando..."]}):a.jsxs(a.Fragment,{children:[a.jsx(r,{size:20}),"Enviar"]})})]})]})})})]}),z.stores&&z.stores.length>0&&a.jsx(h.section,{className:"pt-12 bg-secondary",initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.3},children:a.jsxs("div",{className:"",children:[a.jsxs(h.div,{className:"text-center mb-8",initial:{y:30,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.5},children:[a.jsx("h2",{className:"text-3xl lg:text-4xl font-bold customtext-primary mb-3",children:"Nuestras Ubicaciones"}),a.jsxs("p",{className:"text-lg text-white max-w-2xl mx-auto",children:["Visítanos en cualquiera de nuestras sedes especializadas en ",z.category?.name||"maquinaria de construcción"]})]}),a.jsx(o,{data:{class_container:"",class_title:"customtext-primary",class_description:"customtext-neutral-dark",class_button:"bg-primary text-white hover:bg-primary/90"},stores:z.stores})]})})]})};export{f as default};
