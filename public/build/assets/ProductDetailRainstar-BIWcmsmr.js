import{r as e,j as a,bS as s,br as t,K as r,ak as i,al as l,f as c,X as n,a as o}from"./vendor-react-SBvaUJTK.js";import{I as d}from"./ItemsRest-C4Zko3jv.js";import{S as p}from"./CartKuchara-8a8jAeu-.js";import{P as x,N as m}from"./vendor-swiper-Cr_RrIb_.js";import{C as b}from"./Number2Currency-BX4epFEo.js";import{G as h}from"./General-ClVW7qxN.js";import{T as u}from"./TextWithHighlight-C3mHdfsW.js";import{C as g}from"./ProductDetailRainstar-BNDPVnRC.js";import{m as v,A as f}from"./vendor-motion-DsSUWJCr.js";import"./BasicRest-Cgj77E-j.js";import"./OpenPayCardModal-C0HhlOHJ.js";import"./BooleanLimit-q2Ad9fGY.js";const j=({item:j,data:k,setCart:N,cart:w,generals:y,favorites:_,setFavorites:C})=>{const S=new d,[A,E]=e.useState(1),[$,I]=e.useState(!1),[M,P]=e.useState(!1),[L,O]=e.useState(!1),[R,z]=e.useState(!1),[T,B]=e.useState([]),[H,K]=e.useState(!1),[q,D]=e.useState(j),[F,G]=e.useState({}),[U,V]=e.useState(!1),[X,Y]=e.useState({x:0,y:0}),[W,Z]=e.useState(!1),J=e.useRef(null),Q=h.whatsapp_advisors||[],ee=y?.find(e=>"delivery_policy"===e.correlative)?.description||"Políticas de envío no disponibles.";e.useEffect(()=>{if(j?.id){ae(j),D(j);const e={};j.attributes&&j.attributes.length>0&&j.attributes.forEach(a=>{const s=a.name||a.slug,t=a.pivot?.value||a.value;t&&(e[s]={value:t,itemId:j.id,item:j})}),G(e),j.agrupador?(K(!0),fetch(`/api/items/variants/${j.agrupador}`).then(e=>e.json()).then(e=>{const a=[j,...e],s=Array.from(new Map(a.map(e=>[e.id,e])).values());B(s);const t=s.filter(e=>!e.is_master&&e.id!==j.id);if(t.length>0){const e=t[0];D(e);const a={};e.attributes&&e.attributes.forEach(s=>{const t=s.name||s.slug,r=s.pivot?.value||s.value;r&&(a[t]={value:r,itemId:e.id,item:e})}),G(a)}}).catch(e=>{B([j])}).finally(()=>K(!1))):B([j])}},[j]);const ae=async e=>{try{await S.updateViews({id:e?.id})}catch(a){}},se=e=>{if(e.is_master||j.agrupador&&e.id===j.id)return void p.fire({title:"Seleccione una variante",text:"Por favor, elija una de las opciones disponibles (color, talla, etc.) antes de agregar al carrito.",icon:"info",confirmButtonColor:"#000000",customClass:{popup:"rounded-none border-4 border-black font-black uppercase tracking-tight",confirmButton:"rounded-none border-4 border-black bg-black text-white hover:bg-white hover:text-black transition-all"}});const a=[...w],s=a.findIndex(a=>a.id===e.id);-1===s?a.push({...e,quantity:A}):a[s].quantity+=A,N(a),V(!0)},te=(e,a)=>{G(s=>({...s,[e]:a})),a.item&&D(a.item)},re=q||j,ie=T.length>0?{variants:T,allAttributes:Array.from(new Set(T.flatMap(e=>e.attributes?.map(e=>e.name||e.slug)))).map(e=>{const a=[];return T.forEach(s=>{const t=s.attributes?.find(a=>(a.name||a.slug)===e);if(t){const e=t.pivot?.value||t.value;a.find(a=>a.value===e)||a.push({value:e,itemId:s.id,item:s})}}),{name:e,attribute:T[0].attributes?.find(a=>(a.name||a.slug)===e),values:a}})}:null,le="text-xl md:text-3xl font-black uppercase tracking-tighter border-b-4 border-black pb-4 mb-6 flex items-center gap-4",ce="w-full py-5 text-xs font-black uppercase tracking-[0.3em] transition-all duration-300 rounded-none border-4 border-black active:translate-y-1 active:shadow-none",ne=`${ce} bg-black text-white hover:bg-white hover:text-black shadow-[8px_8px_0px_0px_rgba(0,0,0,0.1)]`,oe=`${ce} bg-white text-black hover:bg-black hover:text-white shadow-[8px_8px_0px_0px_rgba(0,0,0,0.1)]`,de=(Array.isArray(re?.specifications)&&re.specifications.length>0?re.specifications:Array.isArray(j?.specifications)?j.specifications:[]).filter(e=>"general"===e.type||!e.type);return a.jsxs("main",{className:"bg-white min-h-screen text-black py-16 px-4 md:px-6 2xl:px-0",children:[a.jsxs("div",{className:"container mx-auto 2xl:max-w-7xl",children:[a.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-12",children:[a.jsxs("div",{className:"col-span-12 lg:col-span-7 space-y-6",children:[a.jsx(v.div,{initial:{opacity:0,x:-50},animate:{opacity:1,x:0},className:"relative border-4 border-black p-4 bg-white shadow-[20px_20px_0px_0px_rgba(0,0,0,0.05)] group overflow-hidden",children:a.jsxs("div",{ref:J,className:"aspect-[3/4] bg-white cursor-zoom-in relative overflow-hidden",onClick:()=>{Z(!W)},onMouseMove:e=>{if(!W)return;const{left:a,top:s,width:t,height:r}=J.current.getBoundingClientRect(),i=(e.pageX-a-window.scrollX)/t*100,l=(e.pageY-s-window.scrollY)/r*100;Y({x:i,y:l})},onMouseLeave:()=>{Z(!1)},children:[a.jsx("img",{src:`/storage/images/item/${re?.image||j?.image}`,alt:re?.name||j?.name,className:"w-full h-full object-cover object-top grayscale transition-all duration-700 group-hover:grayscale-0 "+(W?"scale-150":"scale-100"),style:W?{transformOrigin:`${X.x}% ${X.y}%`}:{},onError:e=>e.target.src="/api/cover/thumbnail/null"}),!W&&a.jsx("div",{className:"absolute top-4 right-4 bg-black text-white p-2 opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx(s,{className:"w-5 h-5"})})]})}),a.jsx("div",{className:"grid grid-cols-4 gap-4",children:[re?.image||j?.image,...re?.images||j?.images||[]].filter((e,a,s)=>{const t=e?.url||e;return t&&s.findIndex(e=>(e?.url||e)===t)===a}).slice(0,4).map((e,s)=>a.jsx("div",{className:"aspect-[3/4] border-4 border-black p-2 bg-white cursor-pointer grayscale hover:grayscale-0 transition-all shadow-[5px_5px_0px_0px_rgba(0,0,0,0.05)] hover:shadow-none translate-x-0 hover:translate-x-1 hover:translate-y-1",children:a.jsx("img",{src:`/storage/images/item/${e?.url||e}`,className:"w-full h-full object-cover object-top",onError:e=>e.target.src="/api/cover/thumbnail/null"})},s))})]}),a.jsx("div",{className:"col-span-12 lg:col-span-5 space-y-8",children:a.jsxs(v.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},className:"space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("span",{className:"inline-block px-3 py-1 bg-black text-white text-[10px] font-black uppercase tracking-[0.3em]",children:re?.brand?.name||re?.category?.name||"Premium Item"}),a.jsx("h1",{className:"text-4xl md:text-6xl font-black uppercase tracking-tighter leading-none",children:a.jsx(u,{text:re?.name})}),a.jsxs("p",{className:"text-xs font-bold uppercase tracking-widest text-neutral-400",children:["SKU: ",re?.sku]})]}),a.jsxs("div",{className:"flex items-center gap-6 border-y-4 border-black py-6",children:[a.jsxs("div",{className:"text-4xl font-black tracking-tighter",children:[b()," ",re?.final_price]}),re?.price>re?.final_price&&a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{className:"text-xl text-neutral-300 line-through font-bold",children:[b()," ",re?.price]}),a.jsxs("span",{className:"bg-black text-white px-3 py-1 text-xs font-black uppercase italic",children:["-",Number(re?.discount_percent).toFixed(0),"%"]})]})]}),H?a.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold uppercase tracking-widest animate-pulse",children:[a.jsx("div",{className:"w-2 h-2 bg-black rounded-full"}),"Actualizando Variantes..."]}):ie?.allAttributes?.length>0&&a.jsx("div",{className:"space-y-6",children:ie.allAttributes.map(e=>a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-neutral-400",children:e.name}),a.jsx("div",{className:"flex flex-wrap gap-2",children:e.values.map((s,t)=>{const r=F[e.name]?.value===s.value,i=(l=e.name,c=s.value,ie.variants.some(e=>{const a=e.attributes?.some(e=>{const a=e.name||e.slug,s=e.pivot?.value||e.value;return a===l&&s===c});if(!a)return!1;for(const[s,t]of Object.entries(F)){if(s===l)continue;const a=e.attributes?.some(e=>{const a=e.name||e.slug,r=e.pivot?.value||e.value;return a===s&&r===t.value});if(!a)return!1}return!0}));var l,c;return a.jsx("button",{disabled:!i,onClick:()=>{const a=((e,a,s)=>{const t=s.variants.filter(s=>s.attributes?.some(s=>(s.name||s.slug)===e&&(s.pivot?.value||s.value)===a.value));if(0===t.length)return null;const r=t.map(a=>{let s=0;return Object.entries(F).forEach(([t,r])=>{if(t===e)return;const i=a.attributes?.some(e=>(e.name||e.slug)===t&&(e.pivot?.value||e.value)===r.value);i&&s++}),{variant:a,score:s}});return r.sort((e,a)=>a.score-e.score),r[0].variant})(e.name,s,ie);if(a){D(a);const e={};a.attributes?.forEach(s=>{e[s.name||s.slug]={value:s.pivot?.value||s.value,item:a}}),G(e)}else te(e.name,s)},className:`px-4 py-2 text-xs font-black uppercase tracking-widest transition-all border-2 \n                                                                ${r?"bg-black text-white border-black":i?"bg-white text-black border-neutral-200 hover:border-black":"bg-neutral-50 text-neutral-300 border-neutral-100 cursor-not-allowed line-through opacity-50"}\n                                                            `,children:s.value},t)})})]},e.name))}),a.jsxs("div",{className:"space-y-4 pt-6",children:[a.jsxs("div",{className:"flex items-center justify-between border-4 border-black p-4 bg-gray-50 mb-4",children:[a.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.3em]",children:"Cantidad"}),a.jsxs("div",{className:"flex items-center gap-6",children:[a.jsx("button",{onClick:()=>E(Math.max(1,A-1)),className:"text-2xl font-black hover:scale-125 transition-transform",children:"-"}),a.jsx("span",{className:"text-xl font-black w-8 text-center",children:A}),a.jsx("button",{onClick:()=>E(Math.min(10,A+1)),className:"text-2xl font-black hover:scale-125 transition-transform",children:"+"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx("button",{onClick:()=>{se(re),window.location.href="/cart"},className:ne,children:"Comprar Ahora"}),a.jsx("button",{onClick:()=>se(re),className:oe,children:"Al Carrito"})]})]})]})}),a.jsxs("div",{className:"col-span-12 grid grid-cols-1 lg:grid-cols-2 gap-12 mt-16 border-t-8 border-black pt-16",children:[a.jsxs("section",{children:[a.jsxs("h2",{className:le,children:[a.jsx("span",{className:"italic text-neutral-300",children:"01"})," ","Descripción"]}),a.jsx("div",{className:"text-lg font-medium uppercase tracking-tight leading-relaxed prose prose-neutral max-w-none text-black",dangerouslySetInnerHTML:{__html:re?.description||j?.description}})]}),a.jsxs("section",{children:[a.jsxs("h2",{className:le,children:[a.jsx("span",{className:"italic text-neutral-300",children:"02"})," ","Especificaciones"]}),a.jsx("div",{className:"grid grid-cols-1 gap-4",children:de.length>0?de.map((e,s)=>a.jsx("div",{className:"border-2 border-black p-4 hover:bg-black hover:text-white transition-all group shadow-[5px_5px_0px_0px_rgba(0,0,0,0.05)]",children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-8 h-8 border-2 border-black group-hover:border-white flex items-center justify-center font-black text-xs shrink-0",children:s+1}),a.jsx("span",{className:"text-sm font-black uppercase tracking-widest",children:e.title||"Característica"})]}),a.jsx("span",{className:"text-sm font-bold uppercase text-neutral-400 group-hover:text-neutral-300 text-right",children:e.description||e.value})]})},s)):a.jsx("p",{className:"text-xs font-bold uppercase tracking-widest text-neutral-400",children:"No hay especificaciones disponibles."})})]})]}),a.jsx("div",{className:"col-span-12 mt-12 mb-20",children:a.jsxs("div",{onClick:()=>z(!0),className:"bg-white text-black p-10 flex items-center justify-between cursor-pointer group border-4 border-black hover:bg-black hover:text-white transition-all shadow-[15px_15px_0px_0px_rgba(0,0,0,0.05)]",children:[a.jsxs("div",{className:"flex items-center gap-8",children:[a.jsx(t,{className:"w-14 h-14"}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-3xl font-black uppercase tracking-tighter",children:"Políticas de Envío"}),a.jsx("p",{className:"text-xs font-bold tracking-[0.3em] uppercase opacity-60 mt-1",children:"Conoce nuestras condiciones de entrega a nivel nacional"})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.5em] hidden group-hover:block animate-pulse",children:"Leer más"}),a.jsx(r,{className:"w-10 h-10 transform group-hover:translate-x-2 transition-transform"})]})]})})]}),a.jsxs("div",{className:"md:hidden space-y-8",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"border-b-4 border-black pb-4",children:[a.jsxs("span",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-neutral-400 mb-2 block",children:["#",re?.sku]}),a.jsx("h1",{className:"text-3xl font-black uppercase tracking-tighter leading-none mb-4",children:re?.name}),a.jsx("div",{className:"flex items-center gap-4",children:a.jsxs("span",{className:"text-3xl font-black tracking-tighter",children:[b()," ",re?.final_price]})})]}),a.jsx("div",{className:"border-4 border-black p-4",children:a.jsx(i,{modules:[x,m],pagination:{clickable:!0},className:"aspect-[3/4]",children:[re?.image,...re?.images||[]].map((e,s)=>a.jsx(l,{children:a.jsx("img",{src:`/storage/images/item/${e?.url||e}`,className:"w-full h-full object-cover object-top grayscale",onError:e=>e.target.src="/api/cover/thumbnail/null"})},s))})})]}),a.jsx("div",{className:"space-y-6",children:ie?.allAttributes?.map(e=>a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.3em]",children:e.name}),a.jsx("div",{className:"flex flex-wrap gap-2",children:e.values.map((s,t)=>a.jsx("button",{onClick:()=>te(e.name,s),className:"px-4 py-2 text-xs font-black uppercase tracking-tighter border-2 "+(F[e.name]?.value===s.value?"bg-black text-white":"bg-white text-black border-black"),children:s.value},t))})]},e.name))}),a.jsxs("div",{className:"space-y-6 border-t-4 border-black pt-8",children:[a.jsxs("section",{children:[a.jsx("h2",{className:"text-xl font-black uppercase tracking-tighter mb-4",children:"Descripción"}),a.jsx("div",{className:"text-sm font-medium uppercase tracking-tight leading-relaxed prose-sm",dangerouslySetInnerHTML:{__html:re?.description}})]}),a.jsxs("section",{children:[a.jsx("h2",{className:"text-xl font-black uppercase tracking-tighter mb-4",children:"Especificaciones"}),a.jsx("div",{className:"space-y-2",children:de.map((e,s)=>a.jsxs("div",{className:"flex justify-between border-b-2 border-black/5 py-2",children:[a.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:e.title||"Característica"}),a.jsx("span",{className:"text-[10px] font-bold uppercase text-neutral-400",children:e.description||e.value})]},s))})]})]}),a.jsxs("div",{onClick:()=>z(!0),className:"border-4 border-black p-6 flex justify-between items-center bg-gray-50",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(t,{className:"w-8 h-8"}),a.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Políticas de Envío"})]}),a.jsx(r,{className:"w-6 h-6"})]}),a.jsx("div",{className:"flex flex-col gap-4 sticky bottom-4 z-40 bg-white p-4 border-4 border-black shadow-[10px_10px_0px_0px_rgba(0,0,0,0.1)]",children:a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx("button",{onClick:()=>se(re),className:oe,children:"Carrito"}),a.jsx("button",{onClick:()=>{se(re),window.location.href="/cart"},className:ne,children:"Pagar"})]})})]})]}),a.jsx(c,{isOpen:R,onRequestClose:()=>z(!1),className:"fixed inset-0 z-[100] flex items-center justify-center p-4 outline-none",overlayClassName:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[90]",children:a.jsxs("div",{className:"bg-white border-8 border-black p-8 max-w-3xl w-full shadow-[30px_30px_0px_0px_rgba(0,0,0,0.1)] overflow-y-auto max-h-[80vh] rounded-none",children:[a.jsxs("div",{className:"flex justify-between items-center mb-8 border-b-4 border-black pb-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(t,{className:"w-10 h-10"}),a.jsx("h2",{className:"text-3xl md:text-4xl font-black uppercase tracking-tighter",children:"Políticas de Envío"})]}),a.jsx("button",{onClick:()=>z(!1),className:"hover:scale-125 transition-transform",children:a.jsx(n,{className:"w-10 h-10"})})]}),a.jsx("div",{className:"prose prose-neutral max-w-none prose-headings:font-black prose-headings:uppercase prose-p:font-bold prose-p:uppercase prose-p:tracking-widest prose-p:text-sm",children:a.jsx("div",{dangerouslySetInnerHTML:{__html:ee}})}),a.jsx("button",{onClick:()=>z(!1),className:"mt-12 w-full py-5 bg-black text-white font-black uppercase tracking-[0.4em] text-xs hover:bg-neutral-800 transition-colors",children:"Entendido / Cerrar"})]})}),Q.length>0&&a.jsxs("div",{className:"fixed bottom-8 right-8 z-[80] flex flex-col items-end gap-4 scale-75 md:scale-100",children:[a.jsx(f,{children:L&&a.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"bg-white border-4 border-black p-4 mb-2 min-w-[250px] shadow-[15px_15px_0px_0px_rgba(0,0,0,0.1)]",children:[a.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] mb-4 border-b-2 border-black pb-2",children:"Consultar con Asesor"}),a.jsx("div",{className:"space-y-2",children:Q.map((e,s)=>a.jsxs("a",{href:`https://api.whatsapp.com/send?phone=${e.phone}&text=${encodeURIComponent(`¡Hola! Tengo dudas sobre: ${re?.name}`)}`,target:"_blank",className:"flex items-center gap-3 p-3 border-2 border-transparent hover:border-black transition-all group",children:[a.jsx("div",{className:"w-8 h-8 bg-black text-white flex items-center justify-center font-black text-xs uppercase",children:e.name?.charAt(0)}),a.jsx("span",{className:"text-xs font-bold uppercase tracking-widest group-hover:italic",children:e.name})]},s))})]})}),a.jsx("button",{onClick:()=>O(!L),className:"w-20 h-20 bg-black text-white flex items-center justify-center border-4 border-black shadow-[10px_10px_0px_0px_rgba(0,0,0,0.1)] hover:bg-white hover:text-black transition-all active:translate-y-2 active:shadow-none",children:a.jsx(o,{className:"w-10 h-10"})})]}),a.jsx(g,{cart:w,data:k,setCart:N,modalOpen:U,setModalOpen:V})]})};export{j as default};
