var q=Object.defineProperty;var z=(u,c,a)=>c in u?q(u,c,{enumerable:!0,configurable:!0,writable:!0,value:a}):u[c]=a;var D=(u,c,a)=>z(u,typeof c!="symbol"?c+"":c,a);import{j as r}from"./AboutSimple-Cf8x2fCZ.js";import{B as O}from"./Base-DSZ3J1Re.js";import{S as B}from"./SwitchFormGroup-DXN0cwVk.js";import{T as H}from"./TextareaFormGroup-CliirJM1.js";import{r as n}from"./index-BOnQTV8N.js";import{c as J}from"./ReactAppend-QR5TrZfj.js";import{s as K}from"./server.browser-Bf4gQIc7.js";import{S as Q}from"./ProductCard-D_AgkLlk.js";import{B as U}from"./BasicRest-BML1C-ua.js";import{I as G}from"./ImageFormGroup-40MuGzez.js";import{M as W}from"./Modal-xDw9ufjg.js";import{T as X}from"./Table-bW0uinRR.js";import{D as I}from"./DxButton-DV0H-ZcL.js";import{C as Y,F as m}from"./CreateReactScript-B_EwXk3P.js";import{R as h}from"./ReactAppend-Vm5G2nof.js";import{I as S}from"./InputFormGroup-iZIO11ZN.js";import{S as P}from"./SelectFormGroup-X8WqJHHl.js";import"./index-yBjzXJbu.js";import"./Global-CazroCzF.js";import"./tippy-react.esm-DmkRJDEW.js";import"./index-pSueRYGM.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-B6ujFmsw.js";/* empty css              */import"./Logout-BpuTJ_83.js";import"./main-B6F2O9-U.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./MenuItemContainer-DwXwpKCn.js";import"./index.esm-D6GvEWn_.js";import"./index-BQJyKPGC.js";import"./CanAccess-DwCGzUAc.js";import"./CardProductKatya-ncpmQ0JU.js";import"./BooleanLimit-D-OsQsek.js";/* empty css               */import"./General-apRuNwp7.js";import"./LaravelSession-Dz9cpV3l.js";class Z extends U{constructor(){super(...arguments);D(this,"path","admin/services");D(this,"hasFiles",!0)}}const f=new Z,ee=({service_categories:u=[],service_sub_categories:c=[]})=>{const a=n.useRef(),x=n.useRef(),b=n.useRef(),j=n.useRef(),R=n.useRef(),F=n.useRef(),w=n.useRef(),d=n.useRef(),s=n.useRef(),t=n.useRef(),v=n.useRef(),[y,k]=n.useState(!1),[E,N]=n.useState(null),C=e=>{e!=null&&e.id?k(!0):k(!1),b.current.value=(e==null?void 0:e.id)??"",F.current.value=(e==null?void 0:e.name)??"",w.current.value=(e==null?void 0:e.description)??"",d.current&&(d.current.value=(e==null?void 0:e.path)??""),v.current&&(v.current.value=(e==null?void 0:e.slug)??""),s.current&&(s.image.src=e!=null&&e.image?`/storage/images/service/${e.image}`:"",s.current.value=null,s.resetDeleteFlag&&s.resetDeleteFlag()),t.current&&(t.image.src=e!=null&&e.background_image?`/storage/images/service/${e.background_image}`:"",t.current.value=null,t.resetDeleteFlag&&t.resetDeleteFlag()),$(j.current).val((e==null?void 0:e.service_category_id)||null).trigger("change"),e!=null&&e.service_category_id&&N(Number(e.service_category_id)),$(R.current).val((e==null?void 0:e.service_subcategory_id)||null).trigger("change"),$(x.current).modal("show")},V=async e=>{var T;e.preventDefault();const i={id:b.current.value||void 0,name:F.current.value,description:w.current.value},o=j.current.value;o&&o!==""&&o!=="null"&&(i.service_category_id=o);const g=R.current.value;if(g&&g!==""&&g!=="null"&&(i.service_subcategory_id=g),d.current){const l=d.current.value;l&&l.trim()!==""?i.path=l:y&&(i.path=null)}const _=(T=v.current)==null?void 0:T.value;_&&_.trim()!==""?i.slug=_:y&&(i.slug=null);const p=new FormData;for(const l in i)i[l]!==void 0&&p.append(l,i[l]===null?"":i[l]);if(s.current){const l=s.current.files[0];l&&p.append("image",l)}if(t.current){const l=t.current.files[0];l&&p.append("background_image",l)}s.current&&s.getDeleteFlag&&s.getDeleteFlag()&&p.append("image_delete","DELETE"),t.current&&t.getDeleteFlag&&t.getDeleteFlag()&&p.append("background_image_delete","DELETE"),await f.save(p)&&(s.current&&s.resetDeleteFlag&&s.resetDeleteFlag(),t.current&&t.resetDeleteFlag&&t.resetDeleteFlag(),$(a.current).dxDataGrid("instance").refresh(),$(x.current).modal("hide"))},M=async({id:e,value:i})=>{await f.boolean({id:e,field:"visible",value:i})&&$(a.current).dxDataGrid("instance").refresh()},A=async({id:e,value:i})=>{await f.boolean({id:e,field:"status",value:i})&&$(a.current).dxDataGrid("instance").refresh()},L=async e=>{const{isConfirmed:i}=await Q.fire({title:"Eliminar registro",text:"¿Estas seguro de eliminar este registro?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});!i||!await f.delete(e.id)||$(a.current).dxDataGrid("instance").refresh()};return r.jsxs(r.Fragment,{children:[r.jsx(X,{gridRef:a,title:"Servicios",rest:f,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(a.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo registro",hint:"Nuevo registro",onClick:()=>C()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"category.name",caption:"Categoría",width:"120px",cellTemplate:(e,{data:i})=>{var o,g;e.html(K.renderToString(r.jsxs(r.Fragment,{children:[r.jsx("b",{className:"d-block",children:((o=i.category)==null?void 0:o.name)||"Sin categoría"}),r.jsx("small",{className:"text-muted",children:((g=i.subcategory)==null?void 0:g.name)||"Sin subcategoría"})]})))}},{dataField:"name",caption:"Servicio",width:"25%"},{dataField:"description",caption:"Descripción",width:"35%"},m.has("services","image")&&{dataField:"image",caption:"Imagen",width:"90px",allowFiltering:!1,cellTemplate:(e,{data:i})=>{h(e,r.jsx("img",{src:`/storage/images/service/${i.image}`,style:{width:"80px",height:"48px",objectFit:"cover",objectPosition:"center",borderRadius:"4px"},onError:o=>o.target.src="/api/cover/thumbnail/null"}))}},m.has("services","background_image")&&{dataField:"background_image",caption:"Fondo",width:"90px",allowFiltering:!1,cellTemplate:(e,{data:i})=>{h(e,r.jsx("img",{src:`/storage/images/service/${i.background_image}`,style:{width:"80px",height:"48px",objectFit:"cover",objectPosition:"center",borderRadius:"4px"},onError:o=>o.target.src="/api/cover/thumbnail/null"}))}},{dataField:"visible",caption:"Visible",dataType:"boolean",cellTemplate:(e,{data:i})=>{$(e).empty(),h(e,r.jsx(B,{checked:i.visible==1,onChange:()=>M({id:i.id,value:!i.visible})}))}},{dataField:"status",caption:"Estado",dataType:"boolean",cellTemplate:(e,{data:i})=>{$(e).empty(),h(e,r.jsx(B,{checked:i.status==1,onChange:()=>A({id:i.id,value:!i.status})}))}},{caption:"Acciones",cellTemplate:(e,{data:i})=>{e.css("text-overflow","unset"),e.append(I({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>C(i)})),e.append(I({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>L(i)}))},allowFiltering:!1,allowExporting:!1}]}),r.jsxs(W,{modalRef:x,title:y?"Editar servicio":"Agregar servicio",onSubmit:V,size:"md",children:[r.jsx("input",{ref:b,type:"hidden"}),r.jsx("input",{ref:v,type:"hidden"}),r.jsx("div",{id:"services-modal-container",children:r.jsxs("div",{className:"row",children:[(m.has("services","image")||m.has("services","background_image"))&&r.jsx("div",{className:"col-md-5",children:m.has("services","image")&&r.jsx("div",{className:"mb-3",children:r.jsx(G,{eRef:s,name:"image",label:"Logo del Servicio",col:"col-12",aspect:1})})}),r.jsx("div",{className:m.has("services","image")||m.has("services","background_image")?"col-md-7":"col-md-12",children:r.jsxs("div",{className:"row",children:[r.jsx("div",{className:"col-md-12",children:r.jsx(S,{eRef:F,label:"Nombre del Servicio",required:!0})}),r.jsx("div",{className:"col-md-12",children:r.jsx(P,{eRef:j,label:"Categoría",dropdownParent:"#services-modal-container",onChange:e=>N(e.target.value?Number(e.target.value):null),children:u.map((e,i)=>r.jsx("option",{value:e.id,children:e.name},i))})}),r.jsxs("div",{className:"col-md-12",children:[r.jsx(P,{eRef:R,label:"Subcategoría",dropdownParent:"#services-modal-container",children:c.filter(e=>!E||e.service_category_id===E).map((e,i)=>r.jsx("option",{value:e.id,children:e.name},i))}),!m.has("services","image")&&!m.has("services","background_image")&&r.jsx("div",{className:"col-md-6",children:r.jsx(S,{eRef:d,label:"Ruta (Path)",placeholder:"/casillero-virtual"})})]})]})}),m.has("services","background_image")&&r.jsx("div",{className:"mb-3",children:r.jsx(G,{eRef:t,name:"background_image",label:"Imagen de Fondo",col:"col-12",aspect:16/9})}),m.has("services","background_image")&&r.jsx("div",{className:"mb-3",children:r.jsx(S,{eRef:d,label:"Ruta (Path)",placeholder:"/casillero-virtual"})}),r.jsx("div",{className:"col-md-12",children:r.jsx(H,{eRef:w,label:"Descripción",rows:3})})]})})]})]})};Y((u,c)=>{J.createRoot(u).render(r.jsx(O,{...c,title:"Servicios",children:r.jsx(ee,{...c})}))});
