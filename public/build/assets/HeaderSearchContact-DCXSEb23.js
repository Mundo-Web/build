import{r as e,I as t,j as s,b as a,G as r}from"./System-Bybt2Brn.js";import{C as n}from"./CartModal-Db_dBOJN.js";import{N as l}from"./Number2Currency-DExzICY3.js";import"./vendor-BiOv2i5T.js";import"./index-Cmhjy_Bv.js";import"./index-Bx5UHif0.js";import"./CartItemRow-CLpuTcvn.js";import"./tippy-react.esm-Cpb4mDDh.js";import"./proxy-BmPRG09w.js";import"./trash-2-CDXts6on.js";import"./createLucideIcon-oahCLV50.js";import"./minus-BhdGy6sP.js";import"./plus-4JHYG4O1.js";import"./index-Da4AP4wO.js";const i=new t,o=({data:t,cart:o,setCart:c,pages:m})=>{var d,x,u,p;const[h,j]=e.useState(!1),[f,g]=e.useState(!1),[N,b]=e.useState(""),[v,y]=e.useState([]),w=e.useRef(null);e.useEffect((()=>{const e=e=>{w.current&&!w.current.contains(e.target)&&g(!1)};return f&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[f]),e.useEffect((()=>{N.length>2?i.paginate({filter:[["name","contains",N],"or",["summary","contains",N],"or",["description","contains",N]]}).then((({data:e})=>{if(!e)return y([]);y(e)})):y([])}),[N]),e.useEffect((()=>{b("")}),[f]);const k=o.reduce(((e,t)=>Number(e)+Number(t.quantity)),0),C=o.reduce(((e,t)=>{const s=t.discount?t.discount:t.price;return e+Number(t.quantity)*s}),0);return s.jsxs(s.Fragment,{children:[s.jsx("section",{className:"bg-white shadow z-20 sticky top-0",children:s.jsxs("header",{className:"px-[5%] mx-auto flex p-3 justify-between items-center",children:[s.jsx("a",{href:"/",className:"flex-shrink-0",children:s.jsx("img",{className:"h-12 aspect-[13/4] object-contain object-center w-auto",src:`/assets/resources/logo.png?v=${crypto.randomUUID()}`,alt:a.APP_NAME,onError:e=>{e.target.onerror=null,e.target.src="/assets/img/logo-bk.svg"}})}),s.jsx("div",{className:"hidden md:flex relative flex-grow mx-8 max-w-xl",children:s.jsxs("button",{onClick:()=>g(!0),className:"w-full py-2 px-4 bg-accent rounded-full text-sm text-left text-gray-500 cursor-pointer hover:bg-accent/80 transition-colors",children:["Estoy buscando...",s.jsx("i",{className:"mdi mdi-magnify float-end"})]})}),s.jsxs("div",{className:"flex items-center gap-5",children:[(null==(d=r)?void 0:d.support_phone)&&s.jsxs("a",{href:`//wa.me/${null==(u=null==(x=r)?void 0:x.support_phone)?void 0:u.keep("0-9")}`,className:"hidden md:block text-right",target:"_blank",children:[s.jsx("p",{className:"text-xs font-medium",children:"Haz tu pedido"}),s.jsx("p",{className:"text-sm font-bold",children:null==(p=r)?void 0:p.support_phone})]}),s.jsx("button",{className:"md:hidden",onClick:()=>g(!0),children:s.jsx("i",{className:"mdi mdi-magnify text-2xl"})}),s.jsx("button",{className:"cursor-pointer",onClick:()=>location.href="/login",children:s.jsx("i",{className:"mdi mdi-account-outline text-2xl"})}),s.jsxs("button",{className:"relative flex items-center",onClick:()=>j(!0),children:[s.jsxs("div",{className:"relative",children:[s.jsx("i",{className:"mdi mdi-cart-outline text-2xl"}),s.jsx("span",{className:"flex items-center justify-center absolute w-5 h-5 -right-1 -top-1 bg-primary text-[10px] text-white rounded-full",children:k})]}),s.jsxs("div",{className:"hidden md:block ml-2 text-left",children:[s.jsx("p",{className:"text-xs font-medium",children:"Tu carrito"}),s.jsxs("p",{className:"text-sm font-bold",children:["S/ ",C.toFixed(2)]})]})]})]})]})}),f&&s.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-start justify-center pt-20",children:s.jsxs("div",{ref:w,className:"bg-white w-full max-w-xl rounded-lg shadow-xl mx-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",autoFocus:!0,value:N,onChange:e=>b(e.target.value),placeholder:"Estoy buscando (mÃ­nimo 2 caracteres)...",className:"w-full p-3 px-4 bg-transparent focus:outline-none"}),s.jsx("button",{onClick:()=>g(!1),className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:s.jsx("i",{className:"mdi mdi-close text-xl"})})]}),s.jsxs("div",{className:"max-h-[60vh] overflow-y-auto",children:[v.map((e=>s.jsxs("a",{href:`/${null==t?void 0:t.path_product}/${e.slug}`,className:"px-4 py-3 hover:bg-gray-50 cursor-pointer flex gap-2 items-center border-t",children:[s.jsx("img",{src:`/storage/images/item/${e.image}`,className:"h-10 aspect-[4/3] rounded",alt:e.name,onError:e=>e.target.src="/api/cover/thumbnail/null"}),s.jsxs("div",{className:"w-[calc(100%-60px)]",children:[s.jsx("h3",{className:"font-bold truncate w-full",children:e.name}),s.jsxs("h3",{className:"text-nowrap text-sm font-bold",children:["S/ ",l(e.final_price),(null==e?void 0:e.discount_percent)>0&&s.jsx("span",{className:"ms-1 line-through text-gray-500 font-normal text-xs",children:e.price})]}),s.jsx("p",{className:"text-sm text-gray-600",children:e.summary})]})]},e.id))),N.length>2&&0===v.length&&s.jsxs("div",{className:"p-4 text-center text-gray-500 border-t",children:['No se encontraron resultados para "',N,'"']})]})]})}),s.jsx(n,{data:t,cart:o,setCart:c,modalOpen:h,setModalOpen:j})]})};export{o as default};
