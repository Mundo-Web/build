import{r as e,j as s,I as a}from"./System-Bybt2Brn.js";import{u as t,S as r,_ as l}from"./Select-aab027f3.esm-BgXrncPs.js";import{A as i}from"./ArrayJoin-E1gnboGL.js";import{P as n}from"./ProductCard-BzbTc2wB.js";import"./vendor-BiOv2i5T.js";import"./hoist-non-react-statics.cjs-DChrExwb.js";import"./Number2Currency-DExzICY3.js";import"./tippy-react.esm-Cpb4mDDh.js";import"./sweetalert2.esm.all-DbJpIAEg.js";var c=e.forwardRef((function(s,a){var i=t(s);return e.createElement(r,l({ref:a},i))}));const d=({current:a,setCurrent:t,pages:r})=>{const l=new Array(r||1);l.fill(null);return e.useEffect((()=>{a>r&&t(r)}),[r,a]),s.jsx(s.Fragment,{children:s.jsx("nav",{"aria-label":"Page navigation example w-full",children:s.jsxs("ul",{className:"flex flex-wrap items-center gap-2 -space-x-px text-base justify-center",children:[s.jsx("li",{children:s.jsxs("button",{className:"cursor-pointer flex items-center justify-center px-4 h-10 w-10 leading-tight text-gray-500 hover:bg-gray-100 hover:text-gray-700",onClick:()=>{const e=a--;t(e<1?1:e)},type:"button",children:[s.jsx("span",{className:"sr-only",children:"Previous"}),s.jsx("i",{className:"mdi mdi-arrow-left"})]})}),l.map(((e,r)=>r+1==a-4||r+1==a+4?s.jsx("li",{children:s.jsx("button",{"aria-current":"page",className:"z-10 flex items-center justify-center px-4 h-10 w-10 leading-tight bg-transparent text-gray-500 hover:text-gray-700 cursor-default",type:"button",children:"···"})},`item-${r}`):s.jsx("li",{className:r+1>a-4&&r+1<a+4?"block":"hidden",children:s.jsx("button",{"aria-current":"page",className:"cursor-pointer z-10 flex items-center justify-center px-4 h-10 w-10 leading-tight  "+(a==r+1?"bg-primary text-white cursor-default":"bg-gray-100 text-gray-500 hover:text-gray-700"),onClick:()=>t(r+1),type:"button",children:r+1})},`item-${r}`))),s.jsx("li",{children:s.jsxs("button",{className:"cursor-pointer flex items-center justify-center px-4 h-10 w-10 leading-tight text-gray-500 hover:bg-gray-100 hover:text-gray-700",onClick:()=>{const e=a--;t(e>r?r:e)},type:"button",children:[s.jsx("span",{className:"sr-only",children:"Next"}),s.jsx("i",{className:"mdi mdi-arrow-right"})]})})]})})})},o=new a,m=({summary:e,keyName:a,field:t,otherField:r,title:l,onChange:i,filter:n})=>{var c,d;if(0==(null!=(c=e[a])?c:[]).length)return;const o=n.find((e=>e.field==t));return s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"my-2"}),s.jsxs("div",{children:[s.jsx("b",{className:"mb-1 block",children:l}),s.jsx("div",{className:"flex flex-wrap gap-x-2 gap-y-1",children:null==(d=e[a])?void 0:d.map(((e,a)=>{var l;const n=null==(l=null==o?void 0:o.values)?void 0:l.includes(e.id);return s.jsxs("label",{className:"cursor-pointer border rounded-lg py-1 px-2 text-sm",children:[s.jsx("input",{className:"me-1 cursor-pointer",type:"checkbox",name:t,value:e.id,"other-field":r,"other-field-value":e[r],onChange:i,checked:n}),s.jsx("span",{children:e.name})]},a)}))})]})]})},u=({data:a,category:t,subcategory:r,cart:l,setCart:u})=>{const[x,g]=e.useState(["category_id","subcategory_id","brand_id","item_tag.tag_id"].map((e=>{const s=[];return"category_id"==e&&t&&s.push(t.id),"subcategory_id"==e&&r&&s.push(r.id),{field:e,values:s}}))),[p,h]=e.useState([]),[j,f]=e.useState({value:"asc",label:s.jsxs(s.Fragment,{children:["Menor a mayor ",s.jsx("i",{className:"mdi mdi-arrow-up"})]})}),[y,v]=e.useState(0),[b,N]=e.useState(1),[w,C]=e.useState(1),[k,_]=e.useState({}),[S,F]=e.useState(!1);e.useEffect((()=>{A()}),[x,j,w]);const M=({target:e})=>{const s=e.name,a=e.value,t=e.checked,r=e.getAttribute("other-field"),l=e.getAttribute("other-field-value");g((e=>e.map((e=>(e.field==s&&(t?e.values.push(a):e.values=e.values.filter((e=>e!=a))),e.field==r&&t&&e.values.push(l),e)))))},A=async()=>{var e;F(!0),h([]);const s=await o.paginate({filter:i(x.map((e=>{if(0!=e.values.length)return i(e.values.map((s=>[e.field,"=",s])),"or")})).filter(Boolean),"and"),take:12,skip:12*(w-1),requireTotalCount:!0,sort:[{selector:"final_price",desc:"desc"==j.value},{selector:"discount_percent",desc:"desc"!=j.value}]});s.status&&(h(null!=(e=s.data)?e:[]),v(s.totalCount),N(Math.ceil(s.totalCount/12)),_(s.summary),F(!1))};return s.jsx("section",{className:"bg-white",children:s.jsxs("div",{className:"px-[5%] replace-max-w-here w-full mx-auto px-4 py-[5%] md:py-[2.5%]",children:[((null==a?void 0:a.title)||(null==a?void 0:a.description))&&s.jsxs("div",{className:"mb-[2%]",children:[(null==a?void 0:a.title)&&s.jsx("h1",{className:"text-2xl font-bold mb-[2%]",children:null==a?void 0:a.title}),(null==a?void 0:a.description)&&s.jsx("p",{className:"text-sm mb-[3%]",children:null==a?void 0:a.description})]}),s.jsxs("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-[5px] sm:gap-[10px] md:gap-[15px] lg:gap-5",children:[s.jsx("div",{className:"w-full",children:s.jsxs("div",{className:"shadow-lg border h-max sticky top-4 p-4 rounded-3xl",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Filtros de items"}),s.jsx(m,{filter:x,keyName:"categories",title:"Categoria",field:"category_id",summary:k,onChange:M}),s.jsx(m,{filter:x,keyName:"subcategories",title:"Subcategoria",field:"subcategory_id",otherField:"category_id",summary:k,onChange:M}),s.jsx(m,{filter:x,keyName:"brands",title:"Marca",field:"brand_id",summary:k,onChange:M}),s.jsx(m,{filter:x,keyName:"tags",title:"Tags",field:"item_tag.tag_id",summary:k,onChange:M}),s.jsx("hr",{className:"my-2"}),s.jsxs("div",{children:[s.jsx("b",{className:"mb-1 block",children:"Ordenar precio"}),s.jsx(c,{className:"text-sm",options:[{value:"asc",label:s.jsxs(s.Fragment,{children:["Menor a mayor"," ",s.jsx("i",{className:"mdi mdi-arrow-up"})]})},{value:"desc",label:s.jsxs(s.Fragment,{children:["Mayor a menor"," ",s.jsx("i",{className:"mdi mdi-arrow-down"})]})}],defaultValue:j,onChange:e=>f(e)})]})]})}),s.jsxs("div",{className:"w-full md:col-span-2 lg:col-span-3",children:[s.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-[5px] sm:gap-[10px] md:gap-[15px] lg:gap-5 mb-[2.5%] items-center justify-between",children:[s.jsxs("div",{className:"",children:["Mostrando ",s.jsx("b",{children:p.length})," items de"," ",s.jsx("b",{children:y})]}),s.jsxs("div",{className:"lg:col-span-2 flex justify-between w-full",children:[s.jsx("div",{className:"mx-auto"}),s.jsx(d,{pages:b,current:w,setCurrent:C})]})]}),s.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-[5px] sm:gap-[10px] md:gap-[15px] lg:gap-5",children:[p.map(((e,t)=>s.jsx(n,{data:a,item:e,cart:l,setCart:u},t))),S&&[null,null,null].map((e=>s.jsx(n,{})))]}),s.jsx("div",{className:"mt-[5%] w-max max-w-full mx-auto",children:s.jsx(d,{pages:b,current:w,setCurrent:C})})]})]})]})})};export{u as default};
