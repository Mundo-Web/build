var e=Object.defineProperty,s=(s,a,i)=>((s,a,i)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[a]=i)(s,"symbol"!=typeof a?a+"":a,i);import{c as a,j as i,r,s as l}from"./vendor-react-CtPXetfm.js";import{D as t}from"./DeliveryPricesRest-npxLshlJ.js";import{B as c}from"./BasicRest-DtgqEuc9.js";import{S as n}from"./StoresRest-PEQU8Mt2.js";import{C as d}from"./CreateReactScript-Cjoo020C.js";import{S as o}from"./CartKuchara-Bi-J8T1O.js";import{B as m}from"./Base-B2hVq4yw.js";import{D as p}from"./DxButton-CkntFyfB.js";import{M as h}from"./Modal-CUkY7A3F.js";import{T as x}from"./Table-Wc6W9AoI.js";import{I as u}from"./InputFormGroup-CRGKsLQr.js";import{S as g}from"./SelectFormGroup-2ND56lst.js";import{C as b,N as f}from"./Number2Currency-BX4epFEo.js";import"./vendor-swiper-Cr_RrIb_.js";import"./OpenPayCardModal-CbSnHq7o.js";import"./BooleanLimit-q2Ad9fGY.js";import"./Footer-coriRrmf.js";import"./TippyButton-Dqi9Vaf_.js";import"./General-ClVW7qxN.js";import"./LaravelSession-ByQnaUD3.js";import"./Menu-BjIZNCK0.js";import"./Logout-DQyEsGXW.js";import"./MenuItemContainer-UDNHvqM7.js";const j=new t,N=new class extends c{constructor(){super(...arguments),s(this,"path","admin/types_delivery"),s(this,"hasFiles",!0)}},v=new n,y=({ubigeo:e=[],hasRootRole:s=!1})=>{const a=r.useRef(),t=r.useRef(),c=r.useRef(),n=r.useRef(),d=r.useRef(),m=r.useRef(),y=r.useRef(),k=r.useRef(),_=r.useRef(),w=r.useRef(),S=r.useRef(),C=r.useRef(),R=r.useRef(),T=r.useRef();r.useRef();const[E,F]=r.useState(!1),[D,A]=r.useState(!1),[B,P]=r.useState(!1),[I,G]=r.useState(!1),[z,O]=r.useState(!1),[U,V]=r.useState(!1),[q,M]=r.useState(!1),[L,J]=r.useState(!1),[K,W]=r.useState(!1),[X,Z]=r.useState("0.00"),[H,Q]=r.useState(!1),[Y,ee]=r.useState([]),[se,ae]=r.useState([]),[ie,re]=r.useState([]),le=e=>{F(!!e?.id),re([]),m.current.value=e?.id??"",$(y.current).val(e?.ubigeo??null).trigger("change");const s=e?.price&&parseFloat(e.price)>0,a=e?.express_price&&parseFloat(e.express_price)>0;e?.agency_price&&parseFloat(e.agency_price),O(e?.is_standard??(s||!e?.id)),V(a),M(e?.is_free??!1),J(e?.is_agency??!1),W(e?.agency_payment_on_delivery??!1),Q(e?.is_store_pickup??!1);const i=e?.agency_payment_on_delivery?"0.00":e?.agency_price?parseFloat(e.agency_price).toFixed(2):"0.00";Z(i),e?.is_store_pickup&&(te(),e?.selected_stores&&Array.isArray(e.selected_stores)&&re(e.selected_stores)),$(c.current).modal("show"),setTimeout(()=>{_.current&&(_.current.checked=e?.is_free??!1),w.current&&(w.current.checked=e?.is_express??!1),S.current&&(S.current.checked=e?.is_agency??!1),C.current&&(C.current.checked=e?.is_store_pickup??!1),k.current&&(k.current.value=e?.price??""),R.current&&(R.current.value=e?.express_price??""),T.current&&(T.current.value=e?.agency_payment_on_delivery?"":e?.agency_price??"")},100)},te=async()=>{try{const e=await v.paginate({page:1,per_page:100,status:!0,visible:!0});if(e&&e.data&&Array.isArray(e.data)){const s=e.data.filter(e=>{const s=!0===e.visible||1===e.visible,a=!0===e.status||1===e.status,i=!0===e.pickup_available||1===e.pickup_available||void 0===e.pickup_available;return s&&a&&i});ae(s)}else ae([])}catch(e){ae([])}},ce=r.useRef(),ne=r.useRef(),de=r.useRef(),[oe,me]=r.useState([{value:""}]),pe=e=>$(l.renderToString(i.jsxs("span",{children:[i.jsx("span",{className:"d-block w-100 text-truncate",children:e.text.replace(e.id,"")}),i.jsxs("small",{className:"d-block",children:["Ubigeo: ",e.id]})]}))),he=async()=>{const{isConfirmed:e}=await o.fire({title:"Validar y Actualizar Nombres de Ubigeo",html:'\n                <div class="text-start">\n                    <p>Esta acci√≥n validar√° y actualizar√° los nombres de todos los registros de env√≠o seg√∫n el archivo ubigeo.json.</p>\n                    <p class="mb-2"><strong>El proceso:</strong></p>\n                    <ul class="text-start">\n                        <li>Verificar√° cada c√≥digo ubigeo en la base de datos</li>\n                        <li>Buscar√° el distrito, provincia y departamento correspondiente</li>\n                        <li>Actualizar√° el nombre al formato: "DISTRITO, PROVINCIA - DEPARTAMENTO"</li>\n                    </ul>\n                    <p class="text-warning"><i class="fas fa-exclamation-triangle"></i> Esta operaci√≥n puede tardar varios minutos.</p>\n                </div>\n            ',icon:"info",showCancelButton:!0,confirmButtonText:"S√≠, validar y actualizar",cancelButtonText:"Cancelar",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33"});if(e){G(!0);try{const e=await j.validateReniec();if(!e||!e.success)throw new Error(e?.message||"Error al validar ubigeo");await o.fire({title:"Validaci√≥n Completada",html:`\n                        <div class="text-start">\n                            <p><strong>Resultados:</strong></p>\n                            <ul>\n                                <li>Total registros procesados: ${e.processed||0}</li>\n                                <li>Registros actualizados: ${e.updated||0}</li>\n                                <li>Registros sin coincidencia: ${e.notFound||0}</li>\n                            </ul>\n                        </div>\n                    `,icon:"success"}),$(a.current).dxDataGrid("instance").refresh()}catch(s){await o.fire({title:"Error",text:s.message||"Ocurri√≥ un error al validar los nombres de ubigeo",icon:"error"})}finally{G(!1)}}};return i.jsxs(i.Fragment,{children:[i.jsx("input",{id:"file-input",type:"file",accept:".xlsx, .xls",style:{display:"none"},onChange:async e=>{const s=e.target.files[0];if(!s)return;e.target.value=null;const i=new FormData;i.append("excel",s);await j.upload(i)&&$(a.current).dxDataGrid("instance").refresh()}}),i.jsx(x,{gridRef:a,title:"Costos de env√≠o",rest:j,exportable:!0,exportableName:"delivery.prices",toolBar:e=>{s&&e.unshift({widget:"dxButton",location:"after",options:{icon:"check",text:"Validar Ubigeo",hint:"Validar y actualizar nombres de ubigeo desde ubigeo.json",type:"success",disabled:I,onClick:he}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"upload",hint:"Cargar archivo Excel",onClick:()=>document.getElementById("file-input").click()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(a.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo registro",hint:"Nuevo registro",onClick:()=>le()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",text:"Actualizar datos de Delivery",hint:"Actualizar datos de Delivery",onClick:()=>{$(n.current).modal("show")}}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"ubigeo",caption:"Ubigeo (RENIEC)",width:"150px"},{dataField:"name",caption:"Env√≠o a",allowExporting:!1,calculateCellValue:e=>e.name},{dataField:"active_options_search",dataType:"string",caption:"Tipos de delivery",width:"250px",allowFiltering:!0,calculateCellValue:e=>{const s=[];return e.price&&parseFloat(e.price)>0&&!e.is_free&&s.push("Est√°ndar"),(e.is_express||e.express_price&&parseFloat(e.express_price)>0)&&s.push("Express"),e.is_free&&s.push("Gratis"),e.is_agency&&s.push("Agencia"),e.is_store_pickup&&s.push("Tienda"),s.join(", ")},cellTemplate:(e,{data:s})=>{const a=[];s.price&&parseFloat(s.price)>0&&!s.is_free&&a.push(i.jsxs("span",{className:"badge bg-primary me-1 mb-1",children:[i.jsx("i",{className:"fas fa-truck me-1"}),"Est√°ndar"]},"standard")),(s.is_express||s.express_price&&parseFloat(s.express_price)>0)&&a.push(i.jsxs("span",{className:"badge bg-warning text-dark me-1 mb-1",children:[i.jsx("i",{className:"fas fa-bolt me-1"}),"Express"]},"express")),s.is_free&&a.push(i.jsxs("span",{className:"badge bg-success me-1 mb-1",children:[i.jsx("i",{className:"fas fa-gift me-1"}),"Gratis"]},"free")),s.is_agency&&a.push(i.jsxs("span",{className:"badge bg-info me-1 mb-1",children:[i.jsx("i",{className:"fas fa-building me-1"}),"Agencia ",s.agency_payment_on_delivery?"(Pago Destino)":""]},"agency")),s.is_store_pickup&&a.push(i.jsxs("span",{className:"badge bg-primary me-1 mb-1",children:[i.jsx("i",{className:"fas fa-store me-1"}),"Tienda"]},"store")),0===a.length?e.html(l.renderToString(i.jsxs("span",{className:"text-muted font-italic",children:[i.jsx("i",{className:"fas fa-times-circle me-1"}),"Sin opciones"]}))):e.html(l.renderToString(i.jsx("div",{className:"d-flex flex-wrap",children:a})))}},{dataField:"price",caption:"Precios",dataType:"number",width:"200px",cellTemplate:(e,{data:s})=>{const a=[];s.price&&parseFloat(s.price)>0&&a.push(i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"badge bg-primary me-1",children:"Est."}),i.jsxs("strong",{children:[b()," ",f(s.price)]})]},"standard")),s.express_price&&parseFloat(s.express_price)>0&&a.push(i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"badge bg-warning text-dark me-1",children:"Exp."}),i.jsxs("strong",{children:[b()," ",f(s.express_price)]})]},"express")),s.is_agency&&(s.agency_payment_on_delivery?a.push(i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"badge bg-info me-1",children:"Age."}),i.jsx("strong",{className:"text-info",children:"Pago en Destino"})]},"agency")):s.agency_price&&a.push(i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"badge bg-info me-1",children:"Age."}),i.jsxs("strong",{children:[b()," ",f(s.agency_price)]})]},"agency"))),s.is_free&&a.push(i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"badge bg-success me-1",children:"Free"}),i.jsx("strong",{className:"text-success",children:"GRATIS*"})]},"free")),s.is_store_pickup&&a.push(i.jsxs("div",{className:"mb-1",children:[i.jsx("span",{className:"badge bg-primary me-1",children:"Tienda"}),i.jsx("strong",{className:"text-success",children:"GRATIS"})]},"store")),0===a.length?e.html(l.renderToString(i.jsx("span",{className:"text-muted font-italic",children:"- Sin precios -"}))):e.html(l.renderToString(i.jsxs("div",{className:"d-flex flex-column",children:[a,s.is_free&&i.jsx("small",{className:"text-muted",children:"* Condicional"})]})))}},{dataField:"selected_stores",caption:"Tiendas",width:"200px",cellTemplate:(e,{data:s})=>{s.is_store_pickup||s.is_free?s.selected_stores&&Array.isArray(s.selected_stores)&&s.selected_stores.length>0?e.html(l.renderToString(i.jsx("div",{children:i.jsxs("span",{className:"badge bg-primary",children:[s.selected_stores.length," tienda",s.selected_stores.length>1?"s":""," espec√≠fica",s.selected_stores.length>1?"s":""]})}))):e.html(l.renderToString(i.jsx("span",{className:"badge bg-success",children:"Todas las tiendas"}))):e.html(l.renderToString(i.jsx("span",{className:"text-muted font-italic",children:"No aplica"})))},allowFiltering:!1,allowExporting:!1},{caption:"Acciones",width:"100px",cellTemplate:(e,{data:s})=>{e.css("text-overflow","unset"),e.append(p({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>le(s)})),e.append(p({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>(async e=>{const{isConfirmed:s}=await o.fire({title:"Eliminar registro",text:"¬øEstas seguro de eliminar este registro?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});if(!s)return;await j.delete(e)&&$(a.current).dxDataGrid("instance").refresh()})(s.id)}))},allowFiltering:!1,allowExporting:!1}]}),i.jsxs(h,{modalRef:c,title:E?"Editar Costo de env√≠o":"Agregar Costo de env√≠o",onSubmit:async s=>{s.preventDefault();const i=y.current.value,r=e.find(e=>String(e.reniec)===String(i));if(!r)return void(await o.fire({title:"Error",text:"No se encontr√≥ el ubigeo seleccionado",icon:"error"}));const l={id:m.current.value||void 0,name:`${r.distrito.toUpperCase()}, ${r.provincia.toUpperCase()} - ${r.departamento.toUpperCase()}`,price:z&&k.current.value||0,is_free:q,is_standard:z,is_express:U,is_agency:L,is_store_pickup:H,express_price:U&&R.current.value||0,agency_price:L&&!K&&T.current.value||0,agency_payment_on_delivery:!!L&&K,ubigeo:i,selected_stores:H&&ie.length>0?ie:null};await j.save(l)&&(re([]),$(a.current).dxDataGrid("instance").refresh(),$(c.current).modal("hide"))},size:"lg",children:[i.jsx("input",{ref:m,type:"hidden"}),i.jsxs("div",{id:"form-container",className:"row",children:[i.jsx(g,{eRef:y,label:"Distrito/Ubigeo",templateResult:pe,templateSelection:pe,dropdownParent:"#form-container",required:!0,children:e.map((e,s)=>i.jsxs("option",{value:e.reniec,children:[e.reniec," ",e.distrito," ",e.provincia," ",e.departamento]},s))}),i.jsx("div",{className:"col-12 mb-4",children:i.jsx("div",{className:"alert alert-primary border-0 shadow-sm",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:i.jsxs("div",{className:"d-flex align-items-start",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("i",{className:"fas fa-info-circle fa-2x me-3 opacity-75"})}),i.jsxs("div",{className:"flex-grow-1",children:[i.jsxs("h5",{className:"alert-heading mb-2",children:[i.jsx("i",{className:"fas fa-truck me-2"}),"¬øC√≥mo configurar las opciones de delivery?"]}),i.jsxs("p",{className:"mb-2",children:["Selecciona ",i.jsx("strong",{children:"UNA O VARIAS"})," opciones de env√≠o para esta ubicaci√≥n. Los clientes ver√°n todas las opciones activas en el checkout y podr√°n elegir la que m√°s les convenga."]}),i.jsx("hr",{className:"my-2",style:{borderColor:"rgba(255,255,255,0.3)"}}),i.jsxs("div",{className:"small",children:[i.jsx("strong",{children:"üí° Ejemplo:"}),' Puedes activar "Delivery Est√°ndar" + "Delivery Express" + "Retiro en Tienda" al mismo tiempo.']})]})]})})}),i.jsx("div",{className:"col-md-6 mb-3",children:i.jsx("div",{className:"card h-100 border-2 "+(z?"border-primary shadow-sm":"border-light"),children:i.jsxs("div",{className:"card-body",children:[i.jsxs("div",{className:"d-flex align-items-start mb-3",children:[i.jsxs("div",{className:"form-check flex-grow-1",children:[i.jsx("input",{className:"form-check-input",type:"checkbox",id:"enableStandard",checked:z,onChange:e=>O(e.target.checked),style:{width:"1.2em",height:"1.2em"}}),i.jsxs("label",{className:"form-check-label fw-bold ms-2",htmlFor:"enableStandard",style:{fontSize:"1.1rem"},children:[i.jsx("i",{className:"fas fa-truck text-primary me-2"}),"Delivery Est√°ndar"]})]}),z&&i.jsx("span",{className:"badge bg-primary",children:"Activo"})]}),i.jsxs("p",{className:"text-muted small mb-3",children:[i.jsx("i",{className:"fas fa-clock me-1"})," Entrega en 3-5 d√≠as h√°biles",i.jsx("br",{}),i.jsx("i",{className:"fas fa-box me-1"})," Opci√≥n m√°s com√∫n para env√≠os regulares"]}),z&&i.jsxs("div",{className:"mt-3 pt-3 border-top",children:[i.jsx(u,{eRef:k,label:i.jsxs("span",{children:[i.jsx("i",{className:"fas fa-money-bill-wave me-1"})," Costo de env√≠o (S/)"]}),col:"col-12",type:"number",step:.01,placeholder:"Ej: 15.00",required:!0}),i.jsxs("div",{className:"alert alert-light border mb-0",children:[i.jsx("small",{className:"text-muted d-block mb-1",children:i.jsx("strong",{children:"üí° Sugerencia:"})}),i.jsx("small",{className:"text-muted",children:"Este es el precio est√°ndar que pagar√°n los clientes por env√≠o regular."})]})]})]})})}),i.jsx("div",{className:"col-md-6 mb-3",children:i.jsx("div",{className:"card h-100 border-2 "+(U?"border-warning shadow-sm":"border-light"),children:i.jsxs("div",{className:"card-body",children:[i.jsxs("div",{className:"d-flex align-items-start mb-3",children:[i.jsxs("div",{className:"form-check flex-grow-1",children:[i.jsx("input",{ref:w,className:"form-check-input",type:"checkbox",id:"enableExpress",checked:U,onChange:e=>V(e.target.checked),style:{width:"1.2em",height:"1.2em"}}),i.jsxs("label",{className:"form-check-label fw-bold ms-2",htmlFor:"enableExpress",style:{fontSize:"1.1rem"},children:[i.jsx("i",{className:"fas fa-bolt text-warning me-2"}),"Delivery Express"]})]}),U&&i.jsx("span",{className:"badge bg-warning text-dark",children:"‚ö° R√°pido"})]}),i.jsxs("p",{className:"text-muted small mb-3",children:[i.jsx("i",{className:"fas fa-shipping-fast me-1"})," Entrega en 24-48 horas",i.jsx("br",{}),i.jsx("i",{className:"fas fa-star me-1"})," Env√≠o prioritario con costo adicional"]}),U&&i.jsxs("div",{className:"mt-3 pt-3 border-top",children:[i.jsx(u,{eRef:R,label:i.jsxs("span",{children:[i.jsx("i",{className:"fas fa-money-bill-wave me-1"})," Costo express (S/)"]}),col:"col-12",type:"number",step:.01,placeholder:"Ej: 25.00",required:!0}),i.jsxs("div",{className:"alert alert-warning border mb-0",children:[i.jsx("small",{className:"text-dark d-block mb-1",children:i.jsx("strong",{children:"‚ö° Importante:"})}),i.jsx("small",{className:"text-dark",children:"Precio premium por entrega r√°pida. Generalmente mayor que el est√°ndar."})]})]})]})})}),i.jsx("div",{className:"col-md-6 mb-3",children:i.jsx("div",{className:"card h-100 border-2 "+(q?"border-success shadow-sm":"border-light"),children:i.jsxs("div",{className:"card-body",children:[i.jsxs("div",{className:"d-flex align-items-start mb-3",children:[i.jsxs("div",{className:"form-check flex-grow-1",children:[i.jsx("input",{ref:_,className:"form-check-input",type:"checkbox",id:"enableFree",checked:q,onChange:e=>M(e.target.checked),style:{width:"1.2em",height:"1.2em"}}),i.jsxs("label",{className:"form-check-label fw-bold ms-2",htmlFor:"enableFree",style:{fontSize:"1.1rem"},children:[i.jsx("i",{className:"fas fa-gift text-success me-2"}),"Delivery Gratis"]})]}),q&&i.jsx("span",{className:"badge bg-success",children:"üéÅ Gratis"})]}),i.jsxs("p",{className:"text-muted small mb-3",children:[i.jsx("i",{className:"fas fa-check-circle me-1"})," Condicional (monto m√≠nimo)",i.jsx("br",{}),i.jsx("i",{className:"fas fa-heart me-1"})," Incentiva compras mayores"]}),q&&i.jsx("div",{className:"alert alert-success border-0 mb-0 mt-3",children:i.jsxs("div",{className:"d-flex align-items-start",children:[i.jsx("i",{className:"fas fa-info-circle me-2 mt-1"}),i.jsxs("div",{children:[i.jsx("strong",{className:"d-block mb-1",children:"¬øC√≥mo funciona?"}),i.jsxs("small",{children:["El env√≠o ser√° ",i.jsx("strong",{children:"GRATIS"})," cuando el cliente alcance el monto m√≠nimo de compra configurado en el sistema."]}),i.jsx("hr",{className:"my-2"}),i.jsxs("small",{className:"text-muted",children:[i.jsx("i",{className:"fas fa-cog me-1"})," Configura el monto m√≠nimo en: ",i.jsx("strong",{children:"Configuraciones ‚Üí General"})]})]})]})})]})})}),i.jsx("div",{className:"col-md-6 mb-3",children:i.jsx("div",{className:"card h-100 border-2 "+(L?"border-info shadow-sm":"border-light"),children:i.jsxs("div",{className:"card-body",children:[i.jsxs("div",{className:"d-flex align-items-start mb-3",children:[i.jsxs("div",{className:"form-check flex-grow-1",children:[i.jsx("input",{ref:S,className:"form-check-input",type:"checkbox",id:"enableAgency",checked:L,onChange:e=>J(e.target.checked),style:{width:"1.2em",height:"1.2em"}}),i.jsxs("label",{className:"form-check-label fw-bold ms-2",htmlFor:"enableAgency",style:{fontSize:"1.1rem"},children:[i.jsx("i",{className:"fas fa-building text-info me-2"}),"Recojo en Agencia"]})]}),L&&i.jsx("span",{className:"badge bg-info",children:"üì¶ Agencia"})]}),i.jsxs("p",{className:"text-muted small mb-3",children:[i.jsx("i",{className:"fas fa-map-marker-alt me-1"})," Olva, Shalom, Cruz del Sur, etc.",i.jsx("br",{}),i.jsx("i",{className:"fas fa-hand-holding-usd me-1"})," Dos modalidades disponibles"]}),L&&i.jsxs("div",{className:"mt-3 pt-3 border-top",children:[i.jsxs("div",{className:"mb-3",children:[i.jsxs("label",{className:"form-label fw-bold",children:[i.jsx("i",{className:"fas fa-money-check-alt me-1"}),"Tipo de cobro:"]}),i.jsxs("div",{className:"btn-group w-100",role:"group",children:[i.jsx("input",{type:"radio",className:"btn-check",name:"agencyPaymentType",id:"agencyFixedPrice",checked:!K,onChange:()=>W(!1)}),i.jsxs("label",{className:"btn btn-outline-primary",htmlFor:"agencyFixedPrice",children:[i.jsx("i",{className:"fas fa-dollar-sign me-1"}),"Nosotros cobramos"]}),i.jsx("input",{type:"radio",className:"btn-check",name:"agencyPaymentType",id:"agencyPaymentOnDelivery",checked:K,onChange:()=>W(!0)}),i.jsxs("label",{className:"btn btn-outline-info",htmlFor:"agencyPaymentOnDelivery",children:[i.jsx("i",{className:"fas fa-hand-holding-usd me-1"}),"Pago en Destino"]})]})]}),!K&&i.jsxs("div",{className:"animate__animated animate__fadeIn",children:[i.jsx(u,{eRef:T,label:i.jsxs("span",{children:[i.jsx("i",{className:"fas fa-money-bill-wave me-1"})," Precio que cobramos (S/)"]}),col:"col-12",type:"number",step:.01,placeholder:"Ej: 10.00",onChange:e=>Z(e.target.value||"0.00"),required:!0}),i.jsx("div",{className:"alert alert-primary border-0 mb-0",children:i.jsxs("div",{className:"d-flex align-items-start",children:[i.jsx("i",{className:"fas fa-info-circle me-2 mt-1"}),i.jsxs("div",{children:[i.jsx("strong",{className:"d-block mb-1",children:"Nosotros cobramos el env√≠o"}),i.jsxs("small",{children:["El cliente paga ",i.jsxs("strong",{children:["S/ ",X]})," en el checkout. Con esta opci√≥n, el cliente ",i.jsx("strong",{children:"ya NO paga nada adicional"})," al recoger en la agencia."]})]})]})})]}),K&&i.jsx("div",{className:"animate__animated animate__fadeIn",children:i.jsx("div",{className:"alert alert-info border-0 mb-0",children:i.jsxs("div",{className:"d-flex align-items-start",children:[i.jsx("i",{className:"fas fa-hand-holding-usd fa-2x me-3 mt-1"}),i.jsxs("div",{children:[i.jsx("strong",{className:"d-block mb-2",children:"Cliente paga contra entrega"}),i.jsxs("ul",{className:"mb-0 ps-3",children:[i.jsxs("li",{className:"mb-1",children:[i.jsx("strong",{children:"Nosotros NO cobramos"})," por el env√≠o"]}),i.jsxs("li",{className:"mb-1",children:["El cliente paga directamente a la ",i.jsx("strong",{children:"agencia de transporte"})," al recoger"]}),i.jsxs("li",{children:["Ideal para agencias como: ",i.jsx("span",{className:"badge bg-info ms-1",children:"Olva"})," ",i.jsx("span",{className:"badge bg-info",children:"Shalom"})," ",i.jsx("span",{className:"badge bg-info",children:"Cruz del Sur"})]})]})]})]})})})]})]})})}),i.jsx("div",{className:"col-12 mb-3",children:i.jsx("div",{className:"card border-2 "+(H?"border-primary shadow-sm":"border-light"),children:i.jsxs("div",{className:"card-body",children:[i.jsxs("div",{className:"d-flex align-items-start mb-3",children:[i.jsxs("div",{className:"form-check flex-grow-1",children:[i.jsx("input",{ref:C,className:"form-check-input",type:"checkbox",id:"enableStorePickup",checked:H,onChange:e=>{Q(e.target.checked),e.target.checked?te():re([])},style:{width:"1.2em",height:"1.2em"}}),i.jsxs("label",{className:"form-check-label fw-bold ms-2",htmlFor:"enableStorePickup",style:{fontSize:"1.1rem"},children:[i.jsx("i",{className:"fas fa-store text-primary me-2"}),"Retiro en Tienda"]})]}),H&&i.jsx("span",{className:"badge bg-primary",children:"üè™ Sin costo"})]}),i.jsxs("p",{className:"text-muted small mb-3",children:[i.jsx("i",{className:"fas fa-map-marked-alt me-1"})," Cliente recoge en tienda f√≠sica",i.jsx("br",{}),i.jsx("i",{className:"fas fa-dollar-sign me-1"})," ",i.jsx("strong",{className:"text-success",children:"Totalmente GRATIS"})," (sin costo de env√≠o)"]}),H&&i.jsx("div",{className:"alert alert-primary border-0 mb-0 mt-3",children:i.jsxs("div",{className:"d-flex align-items-start",children:[i.jsx("i",{className:"fas fa-check-circle me-2 mt-1"}),i.jsxs("div",{children:[i.jsx("strong",{className:"d-block mb-1",children:"Beneficio para el cliente"}),i.jsx("small",{children:"El cliente ahorra el costo de env√≠o recogiendo su pedido directamente en tu tienda."})]})]})})]})})}),H&&i.jsx("div",{className:"col-12 mb-3",children:i.jsxs("div",{className:"card border-0 bg-light",children:[i.jsx("div",{className:"card-header bg-primary text-white",children:i.jsxs("h6",{className:"mb-0",children:[i.jsx("i",{className:"fas fa-store-alt me-2"}),"Selecciona las tiendas para retiro"]})}),i.jsx("div",{className:"card-body",children:se.length>0?i.jsxs("div",{children:[i.jsx("div",{className:"alert alert-info border-0 mb-3",children:i.jsxs("div",{className:"d-flex align-items-start",children:[i.jsx("i",{className:"fas fa-lightbulb fa-lg me-2 mt-1"}),i.jsxs("div",{children:[i.jsx("strong",{className:"d-block mb-2",children:"¬øC√≥mo funciona?"}),i.jsxs("ul",{className:"mb-0 ps-3",children:[i.jsxs("li",{className:"mb-1",children:[i.jsx("strong",{children:"Sin selecci√≥n:"})," Retiro disponible en ",i.jsx("span",{className:"badge bg-success",children:"TODAS las tiendas"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Con selecci√≥n:"})," Retiro solo en ",i.jsx("span",{className:"badge bg-primary",children:"tiendas marcadas"})]})]}),i.jsxs("small",{className:"text-muted d-block mt-2",children:[i.jsx("i",{className:"fas fa-info-circle me-1"}),"Solo se muestran tiendas del tipo ",i.jsx("strong",{children:"Tienda"})," y ",i.jsx("strong",{children:"Tienda Principal"})]})]})]})}),i.jsx("div",{className:"row",children:se.map(e=>i.jsx("div",{className:"col-md-6 mb-3",children:i.jsx("div",{className:"card border "+(ie.includes(e.id)?"border-primary bg-light":""),children:i.jsx("div",{className:"card-body p-3",children:i.jsxs("div",{className:"form-check",children:[i.jsx("input",{className:"form-check-input",type:"checkbox",id:`store_${e.id}`,checked:ie.includes(e.id),onChange:s=>{s.target.checked?re([...ie,e.id]):re(ie.filter(s=>s!==e.id))}}),i.jsx("label",{className:"form-check-label w-100",htmlFor:`store_${e.id}`,children:i.jsxs("div",{className:"d-flex",children:[i.jsx("div",{className:"flex-shrink-0",children:i.jsx("img",{src:`/storage/images/store/${e.image}`,alt:e.name,className:"rounded",style:{width:"50px",height:"50px",objectFit:"cover"},onError:e=>e.target.src="/api/cover/thumbnail/null"})}),i.jsxs("div",{className:"flex-grow-1 ms-3",children:[i.jsxs("div",{className:"d-flex align-items-center gap-2 mb-1",children:[i.jsx("h6",{className:"mb-0",children:e.name}),i.jsx("span",{className:"badge "+("tienda_principal"===e.type?"bg-warning text-dark":"bg-info"),children:"tienda_principal"===e.type?"Tienda Principal":"Tienda"})]}),i.jsxs("small",{className:"text-muted d-block",children:[i.jsx("i",{className:"fas fa-map-marker-alt me-1"}),e.address]}),e.phone&&i.jsxs("small",{className:"text-muted d-block",children:[i.jsx("i",{className:"fas fa-phone me-1"}),e.phone]})]})]})})]})})})},e.id))}),i.jsx("div",{className:"mt-3 pt-3 border-top",children:i.jsxs("div",{className:"d-flex align-items-center justify-content-between bg-white p-3 rounded border",children:[i.jsx("div",{children:i.jsxs("strong",{className:"text-primary",children:[i.jsx("i",{className:"fas fa-check-circle me-1"}),"Tiendas seleccionadas:"]})}),i.jsx("div",{children:0===ie.length?i.jsxs("span",{className:"badge bg-success fs-6",children:[i.jsx("i",{className:"fas fa-store me-1"}),"Todas (",se.length,")"]}):i.jsxs("span",{className:"badge bg-primary fs-6",children:[i.jsx("i",{className:"fas fa-map-marker-alt me-1"}),ie.length," de ",se.length]})})]})})]}):i.jsx("div",{className:"alert alert-warning border-0 mb-0",children:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx("i",{className:"fas fa-exclamation-triangle fa-2x me-3"}),i.jsxs("div",{children:[i.jsx("strong",{className:"d-block mb-1",children:"No hay tiendas disponibles"}),i.jsx("small",{children:"No se encontraron tiendas activas en esta ubicaci√≥n."}),i.jsx("div",{className:"mt-2",children:i.jsxs("a",{href:"/admin/stores",target:"_blank",className:"btn btn-sm btn-warning",children:[i.jsx("i",{className:"fas fa-plus me-1"}),"Administrar tiendas"]})})]})]})})})]})})]})]}),i.jsx(h,{modalRef:n,title:"Tipos de Delivery",size:"lg",children:i.jsx(x,{gridRef:t,title:"Tipos de Delivery",rest:N,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(t.current).dxDataGrid("instance").refresh()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"name",caption:"Nombre",width:"150px",allowExporting:!1},{dataField:"description",caption:"Descripci√≥n",width:"300px",cellTemplate:(e,{data:s})=>{e.html(s.description||'<i class="text-muted">- Sin descripci√≥n -</i>')}},{dataField:"characteristics",caption:"Caracteristicas",width:"200px",cellTemplate:(e,{data:s})=>{s.characteristics&&s.characteristics.forEach(s=>{e.css("text-overflow","unset"),e.append(l.renderToString(i.jsx("li",{className:"d-flex gap-2",children:i.jsxs("i",{className:"text-muted font-italic d-block",children:["- ",s]})})))})}},{caption:"Acciones",width:"50px",cellTemplate:(e,{data:s})=>{e.css("text-overflow","unset"),e.append(p({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>(e=>{A(!!e?.id),ce.current.value=e?.id??"",ne.current.value=e?.name??"",de.current.value=e?.description??"",e?.characteristics&&e.characteristics.length>0?me(e.characteristics.map(e=>({value:e}))):me([{value:""}]),$(d.current).modal("show")})(s)}))},allowFiltering:!1,allowExporting:!1}]})}),i.jsxs(h,{modalRef:d,title:E?"Editar tipo de Delivery":"Agregar tipo de Delivery",onSubmit:async e=>{e.preventDefault();const s=new FormData;s.append("name",ne.current.value),s.append("description",de.current.value),D&&s.append("id",ce.current.value);const a=oe.map(e=>e.value.trim()).filter(e=>e.length>0);s.append("characteristics",JSON.stringify(a));await N.save(s)&&($(t.current).dxDataGrid("instance").refresh(),$(d.current).modal("hide"),me([{value:""}]))},size:"sm",children:[i.jsx("input",{ref:ce,type:"hidden"}),i.jsxs("div",{id:"form-container",className:"row",children:[i.jsxs("div",{className:"col-12",children:[i.jsx(u,{eRef:ne,label:"Nombre",col:"col-12",type:"string"}),i.jsx(u,{eRef:de,label:"descripcion",col:"col-12",type:"string",required:!0})]}),i.jsx("div",{className:"col-12",children:i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"form-label",children:"Caracter√≠sticas"}),oe.map((e,s)=>i.jsxs("div",{className:"input-group mb-2",children:[i.jsx("input",{type:"text",className:"form-control",placeholder:"Ej: Egresada de la Universidad Nacional Federico Villarreal.",value:e.value,onChange:e=>((e,s)=>{const a=[...oe];a[e].value=s,me(a)})(s,e.target.value)}),i.jsx("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>(e=>{if(oe.length<=1)return;const s=oe.filter((s,a)=>a!==e);me(s)})(s),disabled:oe.length<=1,children:i.jsx("i",{className:"fas fa-times"})})]},s)),i.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:()=>{me([...oe,{value:""}])},children:[i.jsx("i",{className:"fas fa-plus me-1"})," Agregar caracter√≠stica"]})]})})]})]})]})};d((e,s)=>{a.createRoot(e).render(i.jsx(m,{...s,title:"Costos de envio",children:i.jsx(y,{...s})}))});
