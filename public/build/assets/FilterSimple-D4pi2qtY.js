import{r as e,j as s,ba as a}from"./vendor-react-SBvaUJTK.js";import{I as t}from"./ItemsRest-C4Zko3jv.js";import{F as r}from"./FilterPagination-BKUA3VNn.js";import{A as l}from"./ArrayJoin-BdaqwNXM.js";import{P as i}from"./ProductCard-BWJW--L7.js";import"./vendor-swiper-Cr_RrIb_.js";import"./BasicRest-Cgj77E-j.js";import"./OpenPayCardModal-C0HhlOHJ.js";import"./BooleanLimit-q2Ad9fGY.js";import"./Number2Currency-BX4epFEo.js";import"./General-ClVW7qxN.js";import"./CartKuchara-8a8jAeu-.js";const d=new t,c=({summary:e,keyName:a,field:t,otherField:r,title:l,onChange:i,filter:d})=>{if(0==(e[a]??[]).length)return;const c=d.find(e=>e.field==t);return s.jsxs(s.Fragment,{children:[s.jsx("hr",{className:"my-2"}),s.jsxs("div",{children:[s.jsx("b",{className:"mb-1 block",children:l}),s.jsx("div",{className:"flex flex-wrap gap-x-2 gap-y-1",children:e[a]?.map((e,a)=>{const l=c?.values?.includes(e.id);return s.jsxs("label",{className:"cursor-pointer border rounded-lg py-1 px-2 text-sm",children:[s.jsx("input",{className:"me-1 cursor-pointer",type:"checkbox",name:t,value:e.id,"other-field":r,"other-field-value":e[r],onChange:i,checked:l}),s.jsx("span",{children:e.name})]},a)})})]})]})},m=({data:t,category:m,subcategory:n,cart:o,setCart:u})=>{const[p,g]=e.useState(["category_id","subcategory_id","brand_id","item_tag.tag_id"].map(e=>{const s=[];return"category_id"==e&&m&&s.push(m.id),"subcategory_id"==e&&n&&s.push(n.id),{field:e,values:s}})),[x,h]=e.useState([]),[j,f]=e.useState({value:"asc",label:s.jsxs(s.Fragment,{children:["Menor a mayor ",s.jsx("i",{className:"mdi mdi-arrow-up"})]})}),[b,y]=e.useState(0),[v,N]=e.useState(1),[w,C]=e.useState(1),[_,k]=e.useState({}),[F,S]=e.useState(!1);e.useEffect(()=>{A()},[p,j,w]);const M=({target:e})=>{const s=e.name,a=e.value,t=e.checked,r=e.getAttribute("other-field"),l=e.getAttribute("other-field-value");g(e=>e.map(e=>(e.field==s&&(t?e.values.push(a):e.values=e.values.filter(e=>e!=a)),e.field==r&&t&&e.values.push(l),e)))},A=async()=>{S(!0),h([]);const e=await d.paginate({filter:l(p.map(e=>{if(0!=e.values.length)return l(e.values.map(s=>[e.field,"=",s]),"or")}).filter(Boolean),"and"),take:12,skip:12*(w-1),requireTotalCount:!0,sort:[{selector:"final_price",desc:"desc"==j.value},{selector:"discount_percent",desc:"desc"!=j.value}]});e.status&&(h(e.data??[]),y(e.totalCount),N(Math.ceil(e.totalCount/12)),k(e.summary),S(!1))};return s.jsx("section",{id:t?.element_id||null,className:"bg-white",children:s.jsxs("div",{className:"px-[5%] replace-max-w-here w-full mx-auto px-4 py-[5%] md:py-[2.5%]",children:[(t?.title||t?.description)&&s.jsxs("div",{className:"mb-[2%]",children:[t?.title&&s.jsx("h1",{className:"text-2xl font-bold mb-[2%]",children:t?.title}),t?.description&&s.jsx("p",{className:"text-sm mb-[3%]",children:t?.description})]}),s.jsxs("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-[5px] sm:gap-[10px] md:gap-[15px] lg:gap-5",children:[s.jsx("div",{className:"w-full",children:s.jsxs("div",{className:"shadow-lg border h-max sticky top-4 p-4 rounded-3xl",children:[s.jsx("h3",{className:"text-lg font-bold",children:"Filtros de items"}),s.jsx(c,{filter:p,keyName:"categories",title:"Categoria",field:"category_id",summary:_,onChange:M}),s.jsx(c,{filter:p,keyName:"subcategories",title:"Subcategoria",field:"subcategory_id",otherField:"category_id",summary:_,onChange:M}),s.jsx(c,{filter:p,keyName:"brands",title:"Marca",field:"brand_id",summary:_,onChange:M}),s.jsx(c,{filter:p,keyName:"tags",title:"Tags",field:"item_tag.tag_id",summary:_,onChange:M}),s.jsx("hr",{className:"my-2"}),s.jsxs("div",{children:[s.jsx("b",{className:"mb-1 block",children:"Ordenar precio"}),s.jsx(a,{className:"text-sm",options:[{value:"asc",label:s.jsxs(s.Fragment,{children:["Menor a mayor"," ",s.jsx("i",{className:"mdi mdi-arrow-up"})]})},{value:"desc",label:s.jsxs(s.Fragment,{children:["Mayor a menor"," ",s.jsx("i",{className:"mdi mdi-arrow-down"})]})}],defaultValue:j,onChange:e=>f(e)})]})]})}),s.jsxs("div",{className:"w-full md:col-span-2 lg:col-span-3",children:[s.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-[5px] sm:gap-[10px] md:gap-[15px] lg:gap-5 mb-[2.5%] items-center justify-between",children:[s.jsxs("div",{className:"",children:["Mostrando ",s.jsx("b",{children:x.length})," items de"," ",s.jsx("b",{children:b})]}),s.jsxs("div",{className:"lg:col-span-2 flex justify-between w-full",children:[s.jsx("div",{className:"mx-auto"}),s.jsx(r,{pages:v,current:w,setCurrent:C})]})]}),s.jsxs("div",{className:"grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-[5px] sm:gap-[10px] md:gap-[15px] lg:gap-5",children:[x.map((e,a)=>s.jsx(i,{data:t,item:e,cart:o,setCart:u},a)),F&&[null,null,null].map(e=>s.jsx(i,{}))]}),s.jsx("div",{className:"mt-[5%] w-max max-w-full mx-auto",children:s.jsx(r,{pages:v,current:w,setCurrent:C})})]})]})]})})};export{m as default};
