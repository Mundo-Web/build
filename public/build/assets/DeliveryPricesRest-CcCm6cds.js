var t=Object.defineProperty,r=(r,e,a)=>((r,e,a)=>e in r?t(r,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[e]=a)(r,"symbol"!=typeof e?e+"":e,a);import{t as e,m as a}from"./vendor-react-SBvaUJTK.js";import{C as s}from"./Number2Currency-BX4epFEo.js";import"./OpenPayCardModal-C0HhlOHJ.js";class o{static async applyToCart(t,r,a=null){try{if(!Array.isArray(t)||0===t.length)return{success:!1,error:"Carrito vacío o inválido",data:null};const s={cart_items:t.map(t=>({item_id:String(t.item_id||t.id||""),quantity:parseInt(t.quantity)||1,price:parseFloat(t.price||t.final_price||0),name:String(t.name||t.description||"Producto sin nombre"),category_id:t.category_id?String(t.category_id):null,type:t.type||"item",combo_id:"combo"===t.type?t.id:null})),total_amount:parseFloat(r)||0,customer_email:a||null},o=await e.post("/api/discount-rules/apply-to-cart",s);return 200===o.data.status?{success:!0,data:o.data.data,message:o.data.message}:{success:!1,error:o.data.message||"Error al aplicar descuentos",data:null}}catch(s){return s.response?.data?{success:!1,error:s.response.data.message||"Error del servidor",data:s.response.data.data||null}:{success:!1,error:"Error de conexión",data:null}}}static formatDiscounts(t){return t&&Array.isArray(t)?t.map(t=>({id:t.rule_id,name:t.rule_name||"Descuento automático",description:t.description||"",amount:parseFloat(t.discount_amount||0),type:t.discount_type||"fixed",promotion_type:t.promotion_type||null,free_items:t.free_items||[],formatted_amount:"percentage"===t.discount_type?`${t.discount_amount}%`:`${s()} ${parseFloat(t.discount_amount||0).toFixed(2)}`})):[]}static getFreeItems(t){if(!t||!Array.isArray(t))return[];const r=[];return t.forEach(t=>{t.free_items&&Array.isArray(t.free_items)&&r.push(...t.free_items)}),r}static calculateTotalDiscount(t){return t&&Array.isArray(t)?t.reduce((t,r)=>t+parseFloat(r.discount_amount||0),0):0}}class i{}r(i,"getShippingCost",async t=>{try{const{status:r,result:e}=await a.Fetch("./api/delivery-prices",{method:"POST",body:JSON.stringify(t)});if(!r)throw new Error(e?.message||"Error al obtener datos");return e}catch(r){return!1}}),r(i,"getCosts",async t=>{try{const{status:t,result:r}=await a.Fetch("./api/prices-type",{method:"POST"});if(!t)throw new Error(r?.message||"Error al obtener datos");return r}catch(r){return!1}});export{o as D,i as a};
