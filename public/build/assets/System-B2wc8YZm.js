import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as i}from"./index-BOnQTV8N.js";import{c as Ce}from"./ReactAppend-QR5TrZfj.js";import{C as ye}from"./CreateReactScript-oMPs_TEK.js";import{i as _}from"./tippy-react.esm-DmkRJDEW.js";import{S as Q}from"./SystemRest-DVRjGh0L.js";import{S as fe}from"./SwitchFormGroup-DXN0cwVk.js";import{G as je}from"./Global-CazroCzF.js";import{S as pe}from"./SortByAfterField-2AndDudn.js";import{I as ve}from"./InputFormGroup-iZIO11ZN.js";import{T as Ne}from"./TextareaFormGroup-CliirJM1.js";import{M as ue}from"./Modal-xDw9ufjg.js";import{S as Z}from"./SelectFormGroup-X8WqJHHl.js";import{S as ke}from"./SetSelectValue-UxyCmHse.js";import{M as Se,a as me}from"./MenuItemContainer-DcxtOi47.js";import{C as Re,S as $e}from"./SettingsRest-B0EGzuRs.js";import{G as Ee}from"./GalleryRest-C7g46JMQ.js";import"./index-yBjzXJbu.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-B6ujFmsw.js";import"./index.esm-C48oHfFw.js";import"./index-ngrFHoWO.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./main-B6F2O9-U.js";/* empty css               *//* empty css              */import"./General-apRuNwp7.js";import"./LaravelSession-Dz9cpV3l.js";import"./CanAccess-ChFzj8lc.js";import"./BooleanLimit-D-OsQsek.js";import"./index-pSueRYGM.js";import"./BasicRest-BML1C-ua.js";import"./CardProductKatya-ncpmQ0JU.js";const ne=(s="")=>{s=s.replace(/[^a-zA-Z0-9_{}]/g,"");const r=/{([^}]+)}/g,h=[];let x;for(;(x=r.exec(s))!==null;)h.push(x[1]);return h},Pe=(s,r)=>{const h=new RegExp(`[${r}]+$`,"g");return s.replace(h,"")},te=new Q,Fe=s=>{const{id:r,name:h,path:x,extends_base:b=!1,menuable:m=!1,setPages:c,onSEOClicked:o,onParamsClicked:l}=s,[a,n]=i.useState(!1),[u,d]=i.useState(!1),[j,w]=i.useState(!1),[k,p]=i.useState(!1),g=async C=>{if(h===C.target.value)return n(!1);te.savePage({id:r,name:C.target.value})&&(n(!1),c(P=>P.map(y=>y.id===r?{...y,name:C.target.value}:y)))},S=async C=>{if(x===C.target.value)return d(!1);const R=C.target.value;let P=structuredClone(R);const y=s.using??{};for(const M of ne(R))P=P.replace(`{${M}}`,"").replace(`{${M}?}`,""),y[M]=y[M]??{model:null};const F=Pe(P,"/");te.savePage({id:r,path:R,pseudo_path:F,using:Object.keys(y).length>0?y:void 0})&&(d(!1),c(M=>M.map(I=>I.id===r?{...I,path:C.target.value}:I)))},z=async C=>{w(!0);const R=C.target.checked,P=te.savePage({id:r,extends_base:R});w(!1),P&&c(y=>y.map(F=>F.id===r?{...F,extends_base:R}:F))},U=async C=>{p(!0);const R=C.target.checked,P=te.savePage({id:r,menuable:R});p(!1),P&&c(y=>y.map(F=>F.id===r?{...F,menuable:R}:F))},V=async C=>{await te.deletePage(C.id)&&(c(P=>P.filter(y=>y.id!=C.id)),$('[data-bs-toggle="tab"]').removeClass("active"),$(".tab-pane").removeClass("active"),$("#base-template-link").addClass("active"),$("#base-template").addClass("active"))},K=ne(x);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"dropdown float-end",children:[e.jsx("a",{href:"#",className:"dropdown-toggle arrow-none card-drop","data-bs-toggle":"dropdown","aria-expanded":"false",children:e.jsx("i",{className:"mdi mdi-dots-vertical"})}),e.jsxs("div",{className:"dropdown-menu dropdown-menu-end",children:[e.jsxs("button",{className:"dropdown-item",onClick:()=>o(s),children:[e.jsx("i",{className:"mdi mdi-cloud-search-outline me-1"}),"Editar SEO"]}),K.length>0&&e.jsxs("button",{className:"dropdown-item",onClick:()=>l(s),children:[e.jsx("i",{className:"mdi mdi-code-braces me-1"}),"Parámetros"]}),e.jsx("div",{className:"dropdown-divider"}),e.jsxs("button",{className:"dropdown-item",onClick:()=>V(s),children:[e.jsx("i",{className:"mdi mdi-trash-can-outline me-1"}),"Eliminar página"]})]})]}),e.jsxs("div",{children:[a?e.jsx("input",{className:"form-control form-control-sm mb-1",defaultValue:h,onBlur:g,autoFocus:!0}):e.jsx(_,{content:"Editar nombre",placement:"left",children:e.jsx("h4",{className:"header-title mb-1 d-block",onClick:()=>n(!0),style:{minWidth:"200px",cursor:"pointer"},children:h||"Sin nombre"})}),u?e.jsx("input",{className:"form-control form-control-sm mb-1",defaultValue:x,style:{minHeight:27,fieldSizing:"content"},onBlur:S,autoFocus:!0}):e.jsx(_,{content:"Editar ruta",placement:"left",children:e.jsx("small",{className:"text-muted d-block mb-1",onClick:()=>d(!0),style:{minWidth:"200px",cursor:"pointer"},children:x||"Sin ruta"})})]}),e.jsxs("div",{className:"row",children:[e.jsx(fe,{label:"Extiende de base",col:"col-lg-6 col-md-12 col-sm-6",checked:b,onChange:z,disabled:j}),e.jsx(fe,{label:"Mostrar en menu",col:"col-lg-6 col-md-12 col-sm-6",checked:m,onChange:U,disabled:k})]})]})},Be=new Q,Me=({dataLoaded:s,setDataLoaded:r,modalRef:h})=>{const x=i.useRef(null),b=i.useRef(null),m=i.useRef(null),c=async o=>{o.preventDefault(),await Be.savePage({id:s.id,description:b.current.value,keywords:$(m.current).val()})&&(r(null),$(h.current).modal("hide"))};return i.useEffect(()=>{x.current.value=`${s==null?void 0:s.name} | ${je.APP_NAME}`,b.current.value=(s==null?void 0:s.description)??"",ke(m.current,(s==null?void 0:s.keywords)??[])},[s]),e.jsx(ue,{modalRef:h,title:`Editar SEO - ${s==null?void 0:s.name}`,size:"sm",onSubmit:c,children:e.jsxs("div",{id:"seo-container",children:[e.jsx(ve,{eRef:x,label:"Título",disabled:!0}),e.jsx(Ne,{eRef:b,label:"Descripción",rows:2}),e.jsx(Z,{eRef:m,label:"Palabras clave",tags:!0,multiple:!0,dropdownParent:"#seo-container"})]})})},xe=({className:s,system:r,component:h,onComponentClicked:x,onDeleteClicked:b,onEditDataClicked:m})=>{var l;const c=(h==null?void 0:h.options)??[],o=c.find(a=>a.id==r.value);return e.jsxs("div",{className:`dropdown ${s}`,"data-id":r.id,children:[e.jsxs("div",{className:"btn btn-light dropdown-toggle text-truncate w-100 text-start",type:"button",id:`dd-${r.id}`,"data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true",children:[e.jsx("i",{className:"mdi mdi-chevron-down ms-1 float-end"}),e.jsxs("span",{className:"handle-sortable",style:{cursor:"move"},children:[e.jsx("i",{className:"fa fa-ellipsis-v"}),e.jsx("i",{className:"fa fa-ellipsis-v"})]}),e.jsx("span",{className:"ms-1",children:r.name})]}),e.jsxs("div",{className:"dropdown-menu","aria-labelledby":`dd-${r.id}`,"data-popper-placement":"bottom-start","data-simplebar":!0,style:{maxHeight:"300px",width:"100%"},children:[c.length>1&&e.jsxs(e.Fragment,{children:[c.filter(a=>a.id!=r.value).map((a,n)=>e.jsxs("button",{className:"dropdown-item",onClick:()=>x({...r,name:`${h.name} - ${a.name}`,value:a.id}),children:[h.name," - ",a.name]},n)),e.jsx("div",{className:"dropdown-divider"})]}),(((l=o==null?void 0:o.using)==null?void 0:l.filters)||(o==null?void 0:o.data))&&e.jsxs("button",{className:"dropdown-item",onClick:()=>m(r,o),children:[e.jsx("i",{className:"mdi mdi-pencil me-1"}),"Configurar datos"]}),e.jsxs("button",{className:"dropdown-item",onClick:()=>b(r),children:[e.jsx("i",{className:"mdi mdi-trash-can-outline me-1"}),"Eliminar"]})]})]})},Ie=({col:s,label:r,eRef:h,placeholder:x,required:b=!1,rows:m=3,value:c,onChange:o=()=>{}})=>{const[l,a]=i.useState(c),n=i.useRef(),u=i.useRef(null),d=h||n;return i.useEffect(()=>(u.current&&(u.current.toTextArea(),u.current=null),u.current=CodeMirror.fromTextArea(d.current,{mode:"htmlmixed",theme:"sode",indentUnit:2,tabSize:2}),u.current.setValue(c),setTimeout(()=>{u.current.refresh()},125),u.current.on("change",j=>{const w=j.getValue();a(w),o({target:{value:w}})}),()=>{u.current&&(u.current.toTextArea(),u.current=null)}),[d]),i.useEffect(()=>{l!==c&&(a(c),u.current&&(u.current.setValue(c),setTimeout(()=>{u.current.refresh()},125)))},[c]),e.jsxs("div",{className:`form-group ${s} mb-2`,children:[e.jsxs("label",{htmlFor:"",className:"mb-1",children:[r," ",b&&e.jsx("b",{className:"text-danger",children:"*"})]}),e.jsx("textarea",{ref:d,className:"form-control",placeholder:x,required:b,rows:m,defaultValue:c,onChange:j=>a(j.target.value)})]})},ge=new Q,De=({dataLoaded:s,setDataLoaded:r,setSystems:h,modalRef:x})=>{var u,d,j,w,k,p,g,S,z,U,V,K,C,R,P,y,F,H,M,I,q,L;const[b,m]=i.useState((s==null?void 0:s.data)||{}),[c,o]=i.useState([]),l={};l.model=i.useRef(null),l.filters=i.useRef(null),l.filtersMethod=i.useRef(null);const a=async f=>{var E,T;f.preventDefault();const B=await ge.save({id:s.id,data:b,filters:$(l.filters.current).val(),filters_method:(T=(E=s==null?void 0:s.component)==null?void 0:E.using)==null?void 0:T["filters:method"],filters_method_values:$(l.filtersMethod.current).val()});B&&(r(null),$(x.current).modal("hide"),h(J=>J.map(W=>W.id==s.id?B:W)))};i.useEffect(()=>{var T,J,W,re,le,ee,ie,ce,ae,t;const f={};(J=(T=s==null?void 0:s.component)==null?void 0:T.data)!=null&&J.forEach&&((re=(W=s==null?void 0:s.component)==null?void 0:W.data)==null||re.forEach(v=>{var N;f[v]=((N=s==null?void 0:s.data)==null?void 0:N[v])??""})),m(f),l.model.current.value=((ee=(le=s==null?void 0:s.component)==null?void 0:le.using)==null?void 0:ee.model)??"",$(l.filters.current).val((s==null?void 0:s.filters)??[]).trigger("change"),$(l.filtersMethod.current).val((s==null?void 0:s.filtersMethod)??[]).trigger("change");const B=(ce=(ie=s==null?void 0:s.component)==null?void 0:ie.using)==null?void 0:ce.model,E=(t=(ae=s==null?void 0:s.component)==null?void 0:ae.using)==null?void 0:t["filters:method"];!B||!E||ge.simpleGet(`/api/admin/system/related/${B}/${E}`).then(v=>{o(v)})},[s]);const n=(f,B)=>{m({...b,[f]:B})};return e.jsxs(ue,{modalRef:x,title:s==null?void 0:s.name,onSubmit:a,size:(d=(u=s==null?void 0:s.component)==null?void 0:u.data)!=null&&d.some(f=>f.startsWith("code:"))?"lg":"md",children:[e.jsxs("ul",{className:"nav nav-tabs nav-bordered",children:[e.jsx("li",{className:"nav-item",hidden:!((w=(j=s==null?void 0:s.component)==null?void 0:j.data)!=null&&w.length),children:e.jsx("a",{href:"#tab-info","data-bs-toggle":"tab","aria-expanded":"true",className:"nav-link active",children:"Información"})}),e.jsx("li",{className:"nav-item",hidden:!((p=(k=s==null?void 0:s.component)==null?void 0:k.using)!=null&&p.filters)&&!((S=(g=s==null?void 0:s.component)==null?void 0:g.using)!=null&&S["filters:method"]),children:e.jsx("a",{href:"#tab-db","data-bs-toggle":"tab","aria-expanded":"true",className:"nav-link",children:"Base de datos"})})]}),e.jsxs("div",{className:"tab-content",id:"data-modal-container",children:[e.jsx("div",{className:"tab-pane active",id:"tab-info",hidden:!((U=(z=s==null?void 0:s.component)==null?void 0:z.data)!=null&&U.length),children:(K=(V=s==null?void 0:s.component)==null?void 0:V.data)==null?void 0:K.map((f,B)=>f.startsWith("code:")?e.jsx(Ie,{label:f.replace("code:",""),value:b[f]??"",rows:1,onChange:E=>m({...b,[f]:E.target.value})},B):e.jsx(e.Fragment,{children:f.startsWith("bool:")?e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:f.replace("bool:","")}),e.jsxs("div",{children:[e.jsxs("div",{className:"form-check form-check-inline",children:[e.jsx("input",{type:"radio",className:"form-check-input",id:`${f}-true`,name:f,value:"true",checked:b[f]===!0,onChange:E=>n(f,E.target.value==="true")}),e.jsx("label",{className:"form-check-label",htmlFor:`${f}-true`,children:"Sí"})]}),e.jsxs("div",{className:"form-check form-check-inline",children:[e.jsx("input",{type:"radio",className:"form-check-input",id:`${f}-false`,name:f,value:"false",checked:b[f]===!1,onChange:E=>n(f,E.target.value==="true")}),e.jsx("label",{className:"form-check-label",htmlFor:`${f}-false`,children:"No"})]})]})]}):e.jsx(Ne,{label:f,value:b[f]??"",rows:1,onChange:E=>m({...b,[f]:E.target.value})},B)}))}),e.jsxs("div",{className:"tab-pane show",id:"tab-db",children:[e.jsx(ve,{eRef:l.model,label:"Modelo",disabled:!0}),e.jsx(Z,{eRef:l.filters,label:"Filtros",multiple:!0,dropdownParent:"#tab-db",hidden:!((R=(C=s==null?void 0:s.component)==null?void 0:C.using)!=null&&R.filters),children:(F=(y=(P=s==null?void 0:s.component)==null?void 0:P.using)==null?void 0:y.filters)==null?void 0:F.map((f,B)=>e.jsx("option",{value:f,children:f},B))}),e.jsx("div",{hidden:!((M=(H=s==null?void 0:s.component)==null?void 0:H.using)!=null&&M["filters:method"]),children:e.jsx(Z,{eRef:l.filtersMethod,label:(L=(q=(I=s==null?void 0:s.component)==null?void 0:I.using)==null?void 0:q["filters:method"])==null?void 0:L.toTitleCase(),multiple:!0,dropdownParent:"#tab-db",changeWith:[c],children:c==null?void 0:c.map(f=>e.jsx("option",{value:f.id,children:f.name},f.id))})})]})]})]})},be=new Q,_e=({components:s,onClick:r})=>{const[h,x]=i.useState(""),b=s.filter(m=>m.options.length>0).filter(m=>{if(!h)return!0;const c=h.toLowerCase();return m.name.toLowerCase().includes(c)||m.options.some(o=>o.name.toLowerCase().includes(c))});return e.jsx("div",{className:"left-side-menu top-0 pt-2",children:e.jsxs("div",{"data-simplebar":!0,className:"h-100",children:[e.jsx("div",{id:"sidebar-menu",className:"show",children:e.jsxs("ul",{id:"side-menu",children:[e.jsx("li",{className:"menu-title",children:"Lista de componentes"}),e.jsx("li",{className:"px-3 py-2",children:e.jsxs("div",{className:"position-relative",children:[e.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:"Buscar componentes...",value:h,onChange:m=>x(m.target.value),style:{backgroundColor:"#ffffff",color:"#8391a2",paddingLeft:"35px"}}),e.jsx("i",{className:"mdi mdi-magnify position-absolute",style:{left:"10px",top:"50%",transform:"translateY(-50%)",color:"#8391a2",fontSize:"16px"}})]})}),b.map((m,c)=>e.jsx(Se,{title:m.name,icon:m.icon,children:m.options.map((o,l)=>e.jsx(me,{name:o.name,icon:o.icon,onClick:()=>{const a=$(".tab-pane:visible .components-container > div").last().data("id");r({name:`${m.name} - ${o.name}`,component:m.id,value:o.id,after_component:a})},children:o.name},l))},c)),b.length===0&&h&&e.jsx("li",{className:"px-3 py-2",children:e.jsx("small",{className:"text-muted",children:"No se encontraron componentes"})}),"          ",e.jsx("li",{className:"menu-title",children:"Sistema de respaldo"}),e.jsx(me,{icon:"mdi mdi-cogs",rightBarToggle:!0,children:"Configuraciones"}),e.jsx(me,{icon:"mdi mdi-cloud-download",onClick:async()=>{const m=await be.exportBK(),c=new Blob([JSON.stringify(m)],{type:"application/json"}),o=URL.createObjectURL(c),l=document.createElement("a");l.href=o,l.download="backup.json",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)},children:"Exportar Backup"}),e.jsx("input",{type:"file",id:"file-input",accept:"application/json",style:{display:"none"},onChange:async m=>{const c=m.target.files[0];if(m.target.value=null,c){const o=new FormData;if(o.append("backup",c),!await be.importBK(o))return;location.reload()}}}),e.jsx(me,{icon:"mdi mdi-backup-restore",onClick:()=>{document.getElementById("file-input").click()},children:"Importar Backup"})]})}),e.jsx("div",{className:"clearfix"})]})})},ze=({page:s,param:r,models:h,setUsing:x,setPages:b})=>{var j,w,k;const m=i.useRef(),c=i.useRef(),o=i.useRef(),l=s==null?void 0:s.using,[a,n]=i.useState(null),u=p=>{const g=m.current.value,S=h.find(z=>z.name==g)??null;n(S)};i.useEffect(()=>{var p;$(m.current).val((p=l==null?void 0:l[r])==null?void 0:p.model).trigger("change")},[r]),i.useEffect(()=>{var p,g;x(S=>({...S,[r]:{...S[r],model:(a==null?void 0:a.name)??null}})),$(c.current).val(((p=l==null?void 0:l[r])==null?void 0:p.field)??null).trigger("change"),$(o.current).val(((g=l==null?void 0:l[r])==null?void 0:g.relations)??[]).trigger("change")},[a]);const d=`${r}-container`;return e.jsxs("div",{id:d,className:"row",children:[e.jsxs("label",{className:"form-label",children:["Parámetro ",e.jsx("code",{children:r})]}),e.jsx(Z,{eRef:m,label:"Modelo",col:"col-md-6",dropdownParent:`#${d}`,onChange:u,children:h.map((p,g)=>e.jsx("option",{value:p.name,children:p.name},g))}),e.jsx(Z,{eRef:c,label:"Campo",col:"col-md-6",dropdownParent:`#${d}`,onChange:p=>{x(g=>({...g,[r]:{...g[r],field:p.target.value}}))},children:(j=a==null?void 0:a.fields)==null?void 0:j.map((p,g)=>e.jsx("option",{children:p},g))}),e.jsx("div",{hidden:(((w=a==null?void 0:a.relations)==null?void 0:w.length)??0)==0,children:e.jsx(Z,{eRef:o,label:"Relaciones",multiple:!0,dropdownParent:`#${d}`,onChange:p=>{const g=$(p.target).val();x(S=>({...S,[r]:{...S[r],relations:g}}))},children:(k=a==null?void 0:a.relations)==null?void 0:k.map((p,g)=>e.jsx("option",{children:p},g))})})]})},Ve=new Q,Ae=({dataLoaded:s,setDataLoaded:r,setPages:h,modalRef:x,models:b})=>{const m=ne((s==null?void 0:s.path)??""),[c,o]=i.useState({}),l=async a=>{a.preventDefault();const n=await Ve.savePage({id:s.id,using:c});n&&(r(null),h(n),$(x.current).modal("hide"))};return i.useEffect(()=>{o((s==null?void 0:s.using)??{})},[s]),e.jsx(ue,{modalRef:x,title:`Editar parámetros de URL - ${s==null?void 0:s.name}`,onSubmit:l,onClose:()=>r(null),children:m.map((a,n)=>e.jsx(ze,{page:s,param:a,models:b,using:c,setUsing:o,setPages:h},n))})},Te=new Ee,Ge=new Re,Oe=new $e,Ue=({colors:s,setColors:r,settings:h,setSettings:x})=>{const[b,m]=i.useState([{uuid:crypto.randomUUID(),col:"col-3",name:"Icon (1:1)",src:"icon.png",width:"100%",aspectRatio:1},{uuid:crypto.randomUUID(),col:"col-5",name:"Logo (13:4)",src:"logo.png",width:"100%",aspectRatio:3.25},{uuid:crypto.randomUUID(),col:"col-4",name:"Logo footer (1:1)",src:"logo-footer.png",width:"100%",aspectRatio:1}]),c=async n=>{var k;const u=((k=n.target.files)==null?void 0:k[0])??null;if(!u)return;n.target.value=null;const d=n.target.name,j=new FormData;j.append("image",u),j.append("name",d),await Te.save(j)&&m(p=>p.map(g=>(g.src==d&&(g.uuid=crypto.randomUUID()),g)))},o=async n=>{const u=n.target.getAttribute("data-color-id"),d=n.target.name,j=n.target.value;if(s.find(p=>p.id==u)[d]===j)return;const k=await Ge.save({id:u,[d]:j});k&&r(p=>p.map(g=>g.id==u?k.data:g))},l=async n=>{var p;const u=n.target.getAttribute("data-id"),d=n.target.name;let j=n.target.value;if(n.target.type=="checkbox"&&(j=n.target.checked?"true":"false"),(((p=h.find(g=>g.name==d))==null?void 0:p.description)??"")===j)return;const k=await Oe.save({name:d,value:j});k&&x(g=>g.map(S=>S.id==u?k.data:S))},a=n=>{const u=h.find(d=>d.name==n);return u?u.value:""};return e.jsx("div",{className:"right-bar",children:e.jsxs("div",{"data-simplebar":!0,className:"h-100",children:[e.jsxs("div",{className:"rightbar-title",children:[e.jsx("a",{href:"#",className:"right-bar-toggle float-end",children:e.jsx("i",{className:"mdi mdi-close"})}),e.jsx("h4",{className:"font-16 m-0 text-white",children:"Configuraciones"})]}),e.jsxs("div",{className:"p-2",children:[e.jsx("h5",{children:"Imágenes principales"}),e.jsx("div",{className:"row",children:b.map((n,u)=>{const d="file-"+n.uuid;return e.jsxs("div",{className:n.col,children:[e.jsx("input",{id:d,name:n.src,type:"file",accept:"image/png",hidden:!0,onChange:c}),e.jsx("label",{htmlFor:d,className:"form-label d-block mb-1",style:{cursor:"pointer"},children:n.name}),e.jsx("label",{htmlFor:d,style:{cursor:"pointer"},className:"w-100",children:e.jsx("img",{className:"border",src:`/assets/resources/${n.src}?v=${n.uuid}`,alt:"",style:{height:n.height,width:n.width,objectFit:"contain",objectPosition:"center",backgroundColor:"#f5f5f5",borderRadius:"4px",aspectRatio:n.aspectRatio}})})]},u)})}),e.jsx("hr",{className:"my-2"}),e.jsx("h5",{children:"Fuentes del sistema"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"",className:"form-label mb-1",children:"Titulos"}),e.jsx(_,{content:"Nombre de la fuente",children:e.jsx("input",{type:"text",className:"form-control form-control-sm mb-1",name:"title-font-name",defaultValue:a("title-font-name"),onBlur:l})}),e.jsx(_,{content:"Enlace de la fuente",children:e.jsx("textarea",{className:"form-control form-control-sm",rows:1,name:"title-font-url",defaultValue:a("title-font-url"),onBlur:l,style:{minHeight:27,fieldSizing:"content"}})}),e.jsx(_,{content:"Marcar si el archivo es un archivo de fuente (otf, woff, woff2, etc)",children:e.jsxs("div",{className:"form-check mt-1",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",name:"title-font-source",id:"title-font-source",defaultChecked:a("title-font-source")=="true",onBlur:l}),e.jsx("label",{className:"form-check-label",htmlFor:"title-font-source",children:"¿Es este un archivo de fuente?"})]})})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"",className:"form-label mb-1",children:"Parrafos"}),e.jsx(_,{content:"Nombre de la fuente",children:e.jsx("input",{type:"text",className:"form-control form-control-sm mb-1",name:"paragraph-font-name",defaultValue:a("paragraph-font-name"),onBlur:l})}),e.jsx(_,{content:"Enlace de la fuente",children:e.jsx("textarea",{className:"form-control form-control-sm",rows:1,name:"paragraph-font-url",defaultValue:a("paragraph-font-url"),onBlur:l,style:{minHeight:27,fieldSizing:"content"}})}),e.jsx(_,{content:"Marcar si el archivo es un archivo de fuente (otf, woff, woff2, etc)",children:e.jsxs("div",{className:"form-check mt-1",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",name:"paragraph-font-source",id:"paragraph-font-source",defaultChecked:a("paragraph-font-source")=="true",onBlur:l}),e.jsx("label",{className:"form-check-label",htmlFor:"paragraph-font-source",children:"¿Es este un archivo de fuente?"})]})})]}),e.jsx("hr",{className:"my-2"}),e.jsx("h5",{children:"Colores del sistema"}),e.jsx("div",{className:"d-flex flex-column gap-1",children:s.map((n,u)=>{var j,w;const d=((j=n.description)==null?void 0:j.startsWith("linear-gradient"))||((w=n.description)==null?void 0:w.startsWith("radial-gradient"));return e.jsxs("div",{children:[e.jsxs("div",{className:"input-group input-group-sm",children:[!d&&e.jsx("span",{className:"input-group-text px-1",children:e.jsx("input",{type:"color",name:"description","data-color-id":n.id,className:"p-0",style:{width:"20px",height:"20px",border:"1px solid #ced4da",borderRadius:"4px",cursor:"pointer"},defaultValue:n.description,onBlur:o})}),e.jsx("input",{type:"text",name:"name","data-color-id":n.id,className:"form-control form-control-sm",placeholder:"Color",defaultValue:n.name,onBlur:o,disabled:n.name=="primary",style:{cursor:n.name=="primary"?"not-allowed":"text"}})]}),d?e.jsx("textarea",{name:"description","data-color-id":n.id,className:"form-control form-control-sm mt-1",placeholder:"Gradiente: linear-gradient(...)",defaultValue:n.description||"",onBlur:o,rows:2,style:{fontSize:"11px",minHeight:27,fieldSizing:"content"}}):e.jsx("input",{type:"text",name:"description","data-color-id":n.id,className:"form-control form-control-sm mt-1",placeholder:"Hex color",defaultValue:n.description,onBlur:o,style:{fontSize:"11px"}})]},u)})})]})]})})},X=new Q,He=({systems:s=[],pages:r=[],colors:h=[],components:x,models:b,settings:m=[]})=>{const c=i.useRef(null),o=i.useRef(null),l=i.useRef(null),a=i.useRef(null),[n,u]=i.useState(s),[d,j]=i.useState(r),[w,k]=i.useState(h),[p,g]=i.useState(m),[S,z]=i.useState(!1),[U,V]=i.useState(null),[K,C]=i.useState(null),[R,P]=i.useState(!1),[y,F]=i.useState(!1),[H,M]=i.useState(null),[I,q]=i.useState(!1),[L,f]=i.useState(0),B=async()=>{z(!0);const t=await X.savePage();t&&(z(!1),j(t))},E=async t=>{const N=$(".tab-pane:visible").data("id")??null;t.page_id=N;const D=await X.save(t);if(!D)return;const G=D;u(O=>O.some(A=>A.id===G.id)?O.map(A=>A.id===G.id?G:A):[...O,G])},T=async t=>{await X.delete(t.id)&&u(N=>N.filter(D=>D.id!=t.id))},J=async()=>{q(!0);const t=await X.fetchRemoteChanges();q(!1),t&&location.reload()},W=t=>{const v=$(t.target).data("page-id"),N=$(t.target).data("page-path"),D=$(t.target).val();$(`#iframe-${v}`).removeAttr("src"),$(`#iframe-${v}`).attr("src",`${N}/${D}`)},re=async t=>{V(t),$(c.current).modal("show")},le=async t=>{V(t),$(o.current).modal("show")},ee=async(t,v)=>{C({...t,component:v}),$(a.current).modal("show")};i.useEffect(()=>{let t=null;const v=async()=>{if(I)return;if(R){clearInterval(t);return}const N=await X.hasRemoteChanges();if(!N){P(!0);return}F(N.has_changes),M(N.last_commit),f(N.commits)};return t=setInterval(async()=>{await v()},1e4),()=>clearInterval(t)},[R,I]),i.useEffect(()=>{const t=$("iframe:visible");t&&($(t).removeAttr("src"),$(t).attr("src",t.data("path")))},[n,w,p]),i.useEffect(()=>{[...$(".components-container")].forEach(v=>{try{$(v).hasClass("ui-sortable")&&$(v).sortable("destroy")}catch{}$(v).sortable({connectWith:".components-container",handle:".handle-sortable",forcePlaceholderSize:!0,update:async function(N,D){const G=[...$(v).children()],O={};if(G.forEach(oe=>{const A=$(oe).data("id"),Y=$(oe).prev().data("id")??null,se=n.find(he=>he.id==A);(se==null?void 0:se.after_component)!==Y&&(O[A]=Y)}),Object.keys(O).length>0){if(!await X.updateOrder(O))return;u(A=>{const Y=[...A];return Object.entries(O).forEach(([se,he])=>{const de=Y.findIndex(we=>we.id==se);de!==-1&&(Y[de]={...Y[de],after_component:he})}),Y})}}}).disableSelection()})},[d,n]),i.useEffect(()=>{document.title=`Sistema | ${je.APP_NAME}`},[]);const[ie,ce,ae]=(H==null?void 0:H.split(`
`))??[];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{id:"wrapper position-relative",children:[e.jsx(_e,{components:x,onClick:E}),e.jsx("div",{className:"content-page mt-2 pb-3",style:{height:"max-content"},children:e.jsx("div",{className:"content mt-2",children:e.jsxs("div",{className:"container-fluid",children:[e.jsx("button",{className:"button-menu-mobile d-lg-none d-md-block position-absolute ",style:{zIndex:1,border:"none",borderRadius:"0 50% 50% 0",backgroundColor:"#fff",color:"#343a40",top:"50%",left:"0",transform:"translateY(-50%)",padding:"24px 0px 20px 6px ",fontWeight:"bold"},children:"〉"}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card mb-0",children:e.jsxs("div",{className:"card-body",style:{height:"calc(100vh - 48px)"},children:[e.jsxs("ul",{className:"nav nav-tabs nav-bordered flex-nowrap",style:{overflowX:"auto",overflowY:"hidden"},children:[e.jsx("li",{className:"nav-item",children:e.jsx("a",{id:"base-template-link",href:"#base-template","data-bs-toggle":"tab","aria-expanded":"false",className:"nav-link active h-100",children:"Base"})}),d.map((t,v)=>e.jsx("li",{className:"nav-item",children:e.jsxs("a",{href:`#page-${t.id}`,"data-bs-toggle":"tab","aria-expanded":"false",className:"nav-link h-100",style:{whiteSpace:"nowrap"},children:[t.name,e.jsx("small",{className:"d-block text-muted",style:{fontWeight:"normal"},children:t.path})]})},v)),e.jsx("li",{className:"nav-item d-flex justify-content-center align-items-center px-2",children:e.jsx(_,{content:"Agregar página",children:e.jsx("button",{className:"nav-link btn btn-xs btn-white rounded-pill",onClick:B,disabled:S,children:S?e.jsx("i",{className:"mdi mdi-loading mdi-spin"}):e.jsx("i",{className:"mdi mdi-plus"})})})})]}),e.jsxs("div",{className:"tab-content",children:[e.jsx("div",{className:"tab-pane active",id:"base-template",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"d-flex flex-column gap-2 components-container","data-page-id":null,children:pe(n).filter(t=>t.page_id==null).map(t=>{const v=x.find(N=>N.id==t.component);if(v==null||v.options,t.component=="content")return e.jsxs("button",{"data-id":t.id,className:"btn btn-light text-truncate w-100 text-start",type:"button",children:[e.jsx("i",{className:"fa fa-ellipsis-v"}),e.jsx("i",{className:"fa fa-ellipsis-v"}),e.jsx("span",{className:"ms-1",children:t.name})]},t.id);{const N=x.find(D=>D.id==t.component);return e.jsx(xe,{className:"",system:t,component:N,onComponentClicked:E,onDeleteClicked:T,onEditDataClicked:ee},t.id)}})})}),e.jsx("div",{className:"col-md-8",children:e.jsx("iframe",{src:"/base-template","data-path":"/base-template",className:"w-100 h-100 border",style:{minHeight:"calc(100vh - 200px)",borderRadius:"4px"}})})]})}),d.map((t,v)=>e.jsx("div",{className:"tab-pane",id:`page-${t.id}`,"data-id":t.id,children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsx(Fe,{...t,models:b,setPages:j,onSEOClicked:re,onParamsClicked:le}),e.jsx("hr",{className:"my-2"}),e.jsx("div",{className:"d-flex flex-column gap-2 components-container","data-page-id":t.id,children:pe(n).filter(N=>N.page_id==t.id).map(N=>{const D=x.find(G=>G.id==N.component);return e.jsx(xe,{className:"",system:N,component:D,onComponentClicked:E,onDeleteClicked:T,onEditDataClicked:ee},N.id)})})]}),e.jsxs("div",{className:"col-md-8",children:[e.jsxs("div",{className:"input-group mb-2",children:[e.jsxs("span",{className:"input-group-text",children:[(t==null?void 0:t.pseudo_path)||t.path,ne(t==null?void 0:t.path).length>0&&"/"]}),ne(t==null?void 0:t.path).length>0&&e.jsx("input",{type:"text",className:"form-control",placeholder:"Parametros","data-page-path":t.pseudo_path,"data-page-id":t.id,onChange:W})]}),e.jsx("iframe",{id:`iframe-${t.id}`,src:(t==null?void 0:t.pseudo_path)||t.path,"data-path":(t==null?void 0:t.pseudo_path)||t.path,className:"w-100 h-100 border",style:{minHeight:"calc(100vh - 302px)",borderRadius:"4px"}})]})]})},v))]})]})})})})]})})}),y&&e.jsx(_,{content:`Tienes ${L} cambios sin sincronizar`,children:e.jsxs("button",{className:"btn btn-dark p-0 position-absolute rounded-pill",style:{right:"20px",bottom:"20px",height:"40px",width:"40px"},onClick:()=>$(l.current).modal("show"),children:[e.jsx("small",{className:"position-absolute",style:{backgroundColor:"#ff5b5b",borderRadius:"50%",width:"18px",height:"18px",top:"-5px",left:"-5px"},children:L}),e.jsx("i",{className:"mdi mdi-github mdi-24px"})]})})]}),e.jsx(ue,{modalRef:l,title:"Cambios de Github",size:"sm",hideFooter:!0,children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"mdi mdi-github mdi-48px"}),e.jsx("h5",{className:"mt-2",children:"Tienes cambios sin sincronizar"}),e.jsxs("div",{className:"mb-2 py-2",children:[e.jsx("b",{className:"d-block",children:ie}),e.jsx("small",{className:"d-block text-muted",children:moment(ce).fromNow()}),e.jsxs("span",{className:"d-block",children:["Commit: ",ae]})]}),e.jsx("button",{className:"btn btn-primary mb-2",type:"button",onClick:()=>J(),disabled:I,children:I?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-loading mdi-spin me-1"}),"Sincronizando"]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"mdi mdi-cloud-download me-1"}),"Sincronizar"]})})]})}),e.jsx(Ue,{colors:w,setColors:k,settings:p,setSettings:g}),e.jsx(Me,{dataLoaded:U,setDataLoaded:V,modalRef:c}),e.jsx(Ae,{dataLoaded:U,setDataLoaded:V,setPages:j,modalRef:o,models:b}),e.jsx(De,{dataLoaded:K,setDataLoaded:C,setSystems:u,modalRef:a})]})};ye((s,r)=>{Ce.createRoot(s).render(e.jsx(He,{...r}))});
