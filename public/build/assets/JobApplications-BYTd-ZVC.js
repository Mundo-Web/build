var e=Object.defineProperty,a=(a,t,i)=>((a,t,i)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i)(a,"symbol"!=typeof t?t+"":t,i);import{c as t,j as i,r as s}from"./vendor-react-LJZQRWVP.js";import{C as r}from"./CreateReactScript-1qFalD4_.js";import{B as l}from"./Base-d3D_nH13.js";import{T as n}from"./Table-_Mka0EYb.js";import{M as o}from"./Modal-vo2KOb7R.js";import{D as d}from"./DxButton-C6FT_beP.js";import{S as c}from"./SwitchFormGroup-DmF3CemX.js";import{R as m}from"./ReactAppend-DwMsYvyu.js";import{S as u}from"./CartKuchara-B42NOSvQ.js";import{B as p}from"./BasicRest-BX2nxOrK.js";import{I as f}from"./InputFormGroup-BgXABemt.js";import{T as j}from"./TextareaFormGroup-DuKD7Eef.js";import"./vendor-swiper-Cr_RrIb_.js";import"./Footer-DCwBNfoi.js";import"./TippyButton-CwI1PIG0.js";import"./General-ClVW7qxN.js";import"./LaravelSession-ByQnaUD3.js";import"./Menu-CEdT8p4D.js";import"./BooleanLimit-q2Ad9fGY.js";import"./Logout-CZL0vZGv.js";import"./MenuItemContainer-Bn3kuPvp.js";import"./OpenPayCardModal-CIqEZuEl.js";const h=new class extends p{constructor(){super(...arguments),a(this,"path","admin/job-applications"),a(this,"hasFiles",!0)}},x=()=>{const e=s.useRef(),a=s.useRef(),t=s.useRef(),r=s.useRef(),l=s.useRef(),p=s.useRef(),x=s.useRef(),b=s.useRef(),v=s.useRef(),[w,g]=s.useState(!1),[y,N]=s.useState(null),[C,R]=s.useState(!1),F=(e,i=!1)=>{R(i),g(!!e?.id),t.current.value=e?.id??"",r.current.value=e?.name??"",l.current.value=e?.email??"",p.current.value=e?.phone??"",x.current.value=e?.position??"",b.current.value=e?.message??"",v.current.value=null,N(e?.cv??null),$(a.current).modal("show")},T=e=>{e&&window.open(`/api/job-applications/media/${e}`,"_blank")};return i.jsxs(i.Fragment,{children:[i.jsx(n,{gridRef:e,title:"Solicitudes de Trabajo",rest:h,toolBar:a=>{a.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(e.current).dxDataGrid("instance").refresh()}}),a.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Agregar solicitud",hint:"Agregar solicitud",onClick:()=>F()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"name",caption:"Nombre",width:"20%"},{dataField:"email",caption:"Email",width:"18%"},{dataField:"phone",caption:"Teléfono",width:"12%"},{dataField:"position",caption:"Posición",width:"15%"},{dataField:"message",caption:"Mensaje",width:"20%",cellTemplate:(e,{data:a})=>{const t=a.message||"",i=t.length>50?t.substring(0,50)+"...":t;e.text(i),t.length>50&&e.attr("title",t)}},{dataField:"cv",caption:"CV",width:"80px",allowFiltering:!1,cellTemplate:(e,{data:a})=>{a.cv?e.append(d({className:"btn btn-xs btn-soft-info",title:"Descargar CV",icon:"fa fa-download",onClick:()=>T(a.cv)})):e.text("Sin CV")}},{dataField:"reviewed",caption:"Revisado",dataType:"boolean",width:"100px",cellTemplate:(a,{data:t})=>{$(a).empty(),m(a,i.jsx(c,{checked:1==t.reviewed,onChange:()=>(async({id:a,value:t})=>{await h.boolean({id:a,field:"reviewed",value:t})&&$(e.current).dxDataGrid("instance").refresh()})({id:t.id,value:!t.reviewed})}))}},{dataField:"created_at",caption:"Fecha",dataType:"date",width:"120px",format:"dd/MM/yyyy"},{caption:"Acciones",width:"100px",cellTemplate:(a,{data:t})=>{a.css("text-overflow","unset"),a.append(d({className:"btn btn-xs btn-soft-info",title:"Ver detalles",icon:"fa fa-eye",onClick:()=>F(t,!0)})),a.append(d({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>(async a=>{const{isConfirmed:t}=await u.fire({title:"¿Estás seguro?",text:"¡No podrás revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminarlo",cancelButtonText:"Cancelar"});if(!t)return;await h.delete(a.id)&&$(e.current).dxDataGrid("instance").refresh()})(t)}))},allowFiltering:!1,allowExporting:!1}]}),i.jsxs(o,{modalRef:a,title:C?"Ver solicitud":w?"Editar solicitud":"Agregar solicitud",onSubmit:async i=>{i.preventDefault();const s={id:t.current.value||void 0,name:r.current.value,email:l.current.value,phone:p.current.value,position:x.current.value,message:b.current.value},n=new FormData;for(const e in s)null!=s[e]&&n.append(e,s[e]);const o=v.current.files[0];o&&n.append("cv",o);await h.save(n)&&($(e.current).dxDataGrid("instance").refresh(),$(a.current).modal("hide"))},hideFooter:C,children:[i.jsx("input",{ref:t,type:"hidden"}),i.jsxs("div",{className:"row",children:[i.jsx("div",{className:"col-md-6",children:i.jsx(f,{eRef:r,label:"Nombre completo",required:!0,disabled:C})}),i.jsx("div",{className:"col-md-6",children:i.jsx(f,{eRef:l,label:"Email",type:"email",required:!0,disabled:C})}),i.jsx("div",{className:"col-md-6",children:i.jsx(f,{eRef:p,label:"Teléfono",type:"tel",disabled:C})}),i.jsx("div",{className:"col-md-6",children:i.jsx(f,{eRef:x,label:"Posición deseada",disabled:C})}),i.jsx("div",{className:"col-md-12",children:i.jsx(j,{eRef:b,label:"Mensaje",rows:3,disabled:C})}),!C&&i.jsx("div",{className:"col-md-12",children:i.jsxs("div",{className:"mb-3",children:[i.jsxs("label",{className:"form-label",children:["CV (PDF, DOC, DOCX)",y&&i.jsxs("span",{className:"text-muted ms-2",children:["(Actual: ",y,")"]})]}),i.jsx("input",{ref:v,type:"file",className:"form-control",accept:".pdf,.doc,.docx"})]})}),C&&y&&i.jsx("div",{className:"col-md-12",children:i.jsxs("div",{className:"mb-3",children:[i.jsxs("label",{className:"form-label d-flex justify-content-between align-items-center",children:[i.jsx("span",{children:"Curriculum Vitae"}),i.jsxs("button",{type:"button",className:"btn btn-sm btn-primary",onClick:()=>T(y),children:[i.jsx("i",{className:"fa fa-download me-2"}),"Descargar CV"]})]}),i.jsx("div",{className:"border rounded",style:{height:"600px"},children:i.jsx("iframe",{src:`/api/job-applications/media/${y}`,className:"w-100 h-100",style:{border:"none"},title:"Vista previa del CV"})})]})}),C&&i.jsx("div",{className:"col-md-12 text-end",children:i.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>$(a.current).modal("hide"),children:"Cerrar"})})]})]})]})};r((e,a)=>{t.createRoot(e).render(i.jsx(l,{...a,title:"Solicitudes de Trabajo",children:i.jsx(x,{...a})}))});
