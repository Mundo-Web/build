var B=Object.defineProperty;var S=(o,t,n)=>t in o?B(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n;var v=(o,t,n)=>S(o,typeof t!="symbol"?t+"":t,n);import{j as i}from"./AboutSimple-Cf8x2fCZ.js";import{B as G}from"./Base-BtKyxfJk.js";import{S as I}from"./SwitchFormGroup-DXN0cwVk.js";import{T as k}from"./TextareaFormGroup-CliirJM1.js";import{r as a}from"./index-BOnQTV8N.js";import{c as F}from"./ReactAppend-QR5TrZfj.js";import{S as q}from"./CartKuchara-D9l7c7at.js";import{B as A}from"./BasicRest-BML1C-ua.js";import{B as M}from"./BasicEditing-TVz-VY9q.js";import"./server.browser-Bf4gQIc7.js";import{I as P}from"./ImageFormGroup-40MuGzez.js";import{I as b}from"./InputFormGroup-iZIO11ZN.js";import{S as z}from"./SelectFormGroup-X8WqJHHl.js";import{M as O}from"./Modal-xDw9ufjg.js";import{T as _}from"./Table-O7_BONvQ.js";import{D as y}from"./DxButton-DV0H-ZcL.js";import{C as H}from"./CreateReactScript-BVFa7_vB.js";import{R as L}from"./ReactAppend-Vm5G2nof.js";import"./index-yBjzXJbu.js";import"./Global-Bz6gVLc5.js";import"./tippy-react.esm-DmkRJDEW.js";import"./index-pSueRYGM.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-B6ujFmsw.js";/* empty css              */import"./Logout-BpuTJ_83.js";import"./main-B6F2O9-U.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./MenuItemContainer-DcxtOi47.js";import"./index.esm-C48oHfFw.js";import"./index-ngrFHoWO.js";import"./CanAccess-BOTQKW2g.js";import"./CardProductKatya-ncpmQ0JU.js";import"./BooleanLimit-D-OsQsek.js";import"./ArrayDetails2Object-DR0Igcn7.js";import"./em-Dm5QugzS.js";import"./HtmlContent-ghmllTyl.js";import"./WebDetailsRest-DsgeLSDz.js";/* empty css               */import"./General-apRuNwp7.js";import"./LaravelSession-Dz9cpV3l.js";class V extends A{constructor(){super(...arguments);v(this,"path","admin/testimonies");v(this,"hasFiles",!0)}}const p=new V,J=({countries:o,details:t})=>{const n=a.useRef(),u=a.useRef(),f=a.useRef(),x=a.useRef(),h=a.useRef(),g=a.useRef(),j=a.useRef(),l=a.useRef(),d=a.useRef(),[E,R]=a.useState(!1),N=e=>{e!=null&&e.id?R(!0):R(!1),l.resetDeleteFlag&&l.resetDeleteFlag(),f.current.value=(e==null?void 0:e.id)??"",x.current.value=(e==null?void 0:e.name)??"",h.current.value=(e==null?void 0:e.role)??"",g.current.value=(e==null?void 0:e.rating)??"5",$(d.current).val((e==null?void 0:e.country_id)??"89").trigger("change"),j.current.value=(e==null?void 0:e.description)??"",l.image.src=e!=null&&e.image?`/storage/images/testimony/${e.image}`:"",l.current.value=null,$(u.current).modal("show")},T=async e=>{e.preventDefault();const r={id:f.current.value||void 0,country_id:$(d.current).val(),country:$(d.current).find("option:selected").text(),name:x.current.value,role:h.current.value,rating:g.current.value,description:j.current.value},s=new FormData;for(const w in r)s.append(w,r[w]);const c=l.current.files[0];c&&s.append("image",c),l.getDeleteFlag&&l.getDeleteFlag()&&s.append("image_delete","DELETE"),await p.save(s)&&(l.resetDeleteFlag&&l.resetDeleteFlag(),$(n.current).dxDataGrid("instance").refresh(),$(u.current).modal("hide"))},D=async({id:e,value:r})=>{await p.boolean({id:e,field:"visible",value:r})&&$(n.current).dxDataGrid("instance").refresh()},C=async e=>{const{isConfirmed:r}=await q.fire({title:"Eliminar testimonio",text:"¿Estas seguro de eliminar este testimonio?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});!r||!await p.delete(e)||$(n.current).dxDataGrid("instance").refresh()};return i.jsxs(i.Fragment,{children:[i.jsx(_,{gridRef:n,title:i.jsx(M,{correlative:"testimonies",details:t}),rest:p,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(n.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo testimonio",hint:"Nuevo testimonio",onClick:()=>N()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"name",caption:"Autor",cellTemplate:(e,{data:r})=>{const s=e instanceof HTMLElement?e:e.get?e.get(0):e[0];s&&(s.innerHTML="",F.createRoot(s).render(i.jsxs("div",{className:"d-flex align-items-center gap-2",children:[i.jsx("img",{className:"avatar-xs rounded-circle",src:`/storage/images/testimony/${r.image}`,alt:r.name,onError:m=>{m.target.onerror=null,console.error("Image failed to load (admin):",r.image),m.target.src="/api/cover/thumbnail/null"}}),i.jsx("p",{className:"mb-0",style:{fontSize:"14px"},children:r.name})]})))}},{dataField:"role",caption:"Cargo/Rol",width:"150px"},{dataField:"country",caption:"País",width:"120px"},{dataField:"rating",caption:"Rating",width:"120px",cellTemplate:(e,{data:r})=>{const s="⭐".repeat(r.rating||0);e.html(`<span title="${r.rating}/5">${s}</span>`)}},{dataField:"description",caption:"Testimonio",minWidth:"300px",cellTemplate:(e,{data:r})=>{const s=(c,m=100)=>c?c.length>m?c.substring(0,m)+"...":c:"";e.html(`<span class="text-muted">${s(r.description)}</span>`)}},{dataField:"visible",caption:"Visible",dataType:"boolean",cellTemplate:(e,{data:r})=>{$(e).empty(),L(e,i.jsx(I,{checked:r.visible==1,onChange:()=>D({id:r.id,value:!r.visible})}))}},{caption:"Acciones",cellTemplate:(e,{data:r})=>{e.append(y({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>N(r)})),e.append(y({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>C(r.id)}))},allowFiltering:!1,allowExporting:!1}]}),i.jsxs(O,{modalRef:u,title:E?"Editar testimonio":"Agregar testimonio",onSubmit:T,size:"lg",children:[i.jsx("input",{ref:f,type:"hidden"}),i.jsx("div",{id:"testimony-container",children:i.jsxs("div",{className:"row g-3",children:[i.jsx("div",{className:"col-12",children:i.jsxs("div",{className:"card border-0 shadow-sm",children:[i.jsx("div",{className:"card-header bg-light",children:i.jsxs("h6",{className:"mb-0",children:[i.jsx("i",{className:"fas fa-user me-2 text-primary"}),"Información del Autor"]})}),i.jsx("div",{className:"card-body",children:i.jsxs("div",{className:"row g-3",children:[i.jsxs("div",{className:"col-md-4",children:[i.jsx(P,{eRef:l,name:"image",label:"Foto del Autor",col:"col-12",aspect:1}),i.jsxs("small",{className:"text-muted",children:[i.jsx("i",{className:"fas fa-info-circle me-1"}),"Imagen cuadrada 1:1"]})]}),i.jsx("div",{className:"col-md-8",children:i.jsxs("div",{className:"row ",children:[i.jsx("div",{className:"col-md-12",children:i.jsx(b,{eRef:x,label:"Nombre Completo",placeholder:"Ej: Juan Pérez",required:!0})}),i.jsx("div",{className:"col-md-12",children:i.jsx(b,{eRef:h,label:"Cargo/Profesión",placeholder:"Ej: Paciente Operado",required:!0})}),i.jsx("div",{className:"col-md-12",children:i.jsx(z,{eRef:d,label:"País de Origen",required:!0,dropdownParent:"#testimony-container",children:o.map((e,r)=>i.jsx("option",{value:e.id,children:e.name},`country-${r}`))})}),i.jsx("div",{className:"col-md-12",children:i.jsx(b,{eRef:g,label:"Calificación (1-5 estrellas)",type:"number",min:"1",max:"5",placeholder:"5",required:!0})})]})})]})})]})}),i.jsx("div",{className:"col-12",children:i.jsxs("div",{className:"card border-0 shadow-sm",children:[i.jsx("div",{className:"card-header bg-light",children:i.jsxs("h6",{className:"mb-0",children:[i.jsx("i",{className:"fas fa-comment-dots me-2 text-success"}),"Testimonio"]})}),i.jsxs("div",{className:"card-body",children:[i.jsx(k,{eRef:j,label:"Descripción del Testimonio",rows:5,placeholder:"Escribe aquí la experiencia y opinión...",required:!0}),i.jsxs("small",{className:"text-muted",children:[i.jsx("i",{className:"fas fa-info-circle me-1"}),"Describe la experiencia completa y detallada"]})]})]})})]})})]})]})};H((o,t)=>{F.createRoot(o).render(i.jsx(G,{...t,title:"Testimonios",children:i.jsx(J,{...t})}))});
