var e=Object.defineProperty,a=(a,t,r)=>((a,t,r)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r)(a,"symbol"!=typeof t?t+"":t,r);import{c as t,j as r,r as s}from"./vendor-react-CZUvQwNQ.js";import{B as l}from"./Base-BE1X8Lb3.js";import{S as i}from"./SwitchFormGroup-BPmRxEC1.js";import{I as n}from"./InputFormGroup-BuXn3s3l.js";import{S as o}from"./CartKuchara-C7vqSevl.js";import{B as d}from"./BasicRest-K-34csnH.js";import{I as c}from"./ImageFormGroup-DlJufE2S.js";import{M as p}from"./Modal-MmI0jF6v.js";import{T as u}from"./Table-Cynp-rvu.js";import{D as m}from"./DxButton-C6FT_beP.js";import{C as g}from"./CreateReactScript-DMiuD_MQ.js";import{R as f}from"./ReactAppend-Db2K6xCH.js";import"./vendor-swiper-Cr_RrIb_.js";import"./Footer-DAm0kDL9.js";import"./TippyButton-Gia9IjJq.js";import"./Logout-D6byb_Ua.js";import"./MenuItemContainer-BaCqn8PU.js";import"./Menu-DboRETzC.js";import"./OpenPayCardModal-BHkRoVZ6.js";import"./BooleanLimit-q2Ad9fGY.js";import"./General-ClVW7qxN.js";import"./LaravelSession-ByQnaUD3.js";const j=new class extends d{constructor(){super(...arguments),a(this,"path","admin/apps"),a(this,"hasFiles",!0)}},x=()=>{const e=s.useRef(),a=s.useRef(),t=s.useRef(),l=s.useRef(),d=s.useRef(),g=s.useRef(),x=s.useRef(),h=s.useRef(),v=s.useRef(),b=s.useRef(),w=s.useRef(),[F,R]=s.useState(!1),D=e=>{R(!!e?.id),t.current.value=e?.id??"",l.current.value=e?.name??"",d.current.value=e?.store??"Google Play",g.current.value=e?.link??"",v.current.value=e?.downloads??"100",b.current.value=e?.downloads_unit??"K",w.current.value=e?.rating??"4.5",x.image.src=e?.logo?`/storage/images/app/${e.logo}`:"",x.current.value=null,h.image.src=e?.image?`/storage/images/app/${e.image}`:"",h.current.value=null,x.resetDeleteFlag&&x.resetDeleteFlag(),h.resetDeleteFlag&&h.resetDeleteFlag(),$(a.current).modal("show")};return r.jsxs(r.Fragment,{children:[r.jsx(u,{gridRef:e,title:"Apps Móviles",rest:j,toolBar:a=>{a.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(e.current).dxDataGrid("instance").refresh()}}),a.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nueva app",hint:"Nueva app",onClick:()=>D()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"logo",caption:"Logo",width:"80px",allowFiltering:!1,cellTemplate:(e,{data:a})=>{f(e,r.jsx("img",{src:`/storage/images/app/${a.logo}`,style:{width:"60px",height:"60px",objectFit:"contain",borderRadius:"8px"},onError:e=>e.target.src="/api/cover/thumbnail/null"}))}},{dataField:"name",caption:"Nombre",width:"25%"},{dataField:"store",caption:"Tienda",width:"15%"},{dataField:"downloads",caption:"Descargas",width:"12%",cellTemplate:(e,{data:a})=>{const t=`${a.downloads}${a.downloads_unit||""}`;f(e,r.jsx("span",{children:t}))}},{dataField:"rating",caption:"Rating",width:"10%",cellTemplate:(e,{data:a})=>{f(e,r.jsxs("div",{className:"d-flex align-items-center",children:[r.jsx("span",{className:"text-warning mr-1",children:"★"}),r.jsx("span",{children:a.rating})]}))}},{dataField:"visible",caption:"Visible",dataType:"boolean",cellTemplate:(a,{data:t})=>{$(a).empty(),f(a,r.jsx(i,{checked:1==t.visible,onChange:()=>(async({id:a,value:t})=>{await j.boolean({id:a,field:"visible",value:t})&&$(e.current).dxDataGrid("instance").refresh()})({id:t.id,value:!t.visible})}))}},{caption:"Acciones",cellTemplate:(a,{data:t})=>{a.css("text-overflow","unset"),a.append(m({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>D(t)})),a.append(m({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>(async a=>{const{isConfirmed:t}=await o.fire({title:"Eliminar registro",text:"¿Estás seguro de eliminar esta app?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});if(!t)return;await j.delete(a.id)&&$(e.current).dxDataGrid("instance").refresh()})(t)}))},allowFiltering:!1,allowExporting:!1}]}),r.jsxs(p,{modalRef:a,title:F?"Editar app":"Agregar app",onSubmit:async r=>{r.preventDefault();const s={id:t.current.value||void 0,name:l.current.value,store:d.current.value,link:g.current.value,downloads:v.current.value,downloads_unit:b.current.value,rating:w.current.value},i=new FormData;for(const e in s)i.append(e,s[e]);const n=x.current.files[0];n&&i.append("logo",n);const o=h.current.files[0];o&&i.append("image",o),x.getDeleteFlag&&x.getDeleteFlag()&&i.append("logo_delete","DELETE"),h.getDeleteFlag&&h.getDeleteFlag()&&i.append("image_delete","DELETE");await j.save(i)&&(x.resetDeleteFlag&&x.resetDeleteFlag(),h.resetDeleteFlag&&h.resetDeleteFlag(),$(e.current).dxDataGrid("instance").refresh(),$(a.current).modal("hide"))},children:[r.jsx("input",{ref:t,type:"hidden"}),r.jsxs("div",{className:"row",children:[r.jsxs("div",{className:"col-md-6",children:[r.jsx(c,{eRef:x,name:"logo",label:"Logo de la App",col:"col-12",aspect:1}),r.jsx(c,{eRef:h,name:"image",label:"Screenshot de la Tienda",col:"col-12",aspect:9/16})]}),r.jsxs("div",{className:"col-md-6",children:[r.jsx(n,{eRef:l,label:"Nombre de la App",required:!0}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{children:["Tienda ",r.jsx("span",{className:"text-danger",children:"*"})]}),r.jsxs("select",{ref:d,className:"form-control",required:!0,children:[r.jsx("option",{value:"Google Play",children:"Google Play"}),r.jsx("option",{value:"App Store",children:"App Store"}),r.jsx("option",{value:"Huawei AppGallery",children:"Huawei AppGallery"}),r.jsx("option",{value:"Amazon Appstore",children:"Amazon Appstore"})]})]}),r.jsx(n,{eRef:g,label:"Link de la Tienda",type:"url",placeholder:"https://play.google.com/store/apps/details?id=...",required:!0}),r.jsxs("div",{className:"row",children:[r.jsx("div",{className:"col-md-8",children:r.jsx(n,{eRef:v,label:"Cantidad de Descargas",type:"number",required:!0})}),r.jsx("div",{className:"col-md-4",children:r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{children:["Unidad ",r.jsx("span",{className:"text-danger",children:"*"})]}),r.jsxs("select",{ref:b,className:"form-control",required:!0,children:[r.jsx("option",{value:"",children:"Número exacto"}),r.jsx("option",{value:"K",children:"K (Miles)"}),r.jsx("option",{value:"M",children:"M (Millones)"})]})]})})]}),r.jsx(n,{eRef:w,label:"Rating (0.0 - 5.0)",type:"number",step:"0.1",min:"0",max:"5",required:!0})]})]})]})]})};g((e,a)=>{t.createRoot(e).render(r.jsx(l,{...a,title:"Apps Móviles",children:r.jsx(x,{...a})}))});
