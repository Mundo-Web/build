import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as o,R as $}from"./index-BH53Isel.js";import"./ProductNavigation-DroFAaZZ.js";import{I as oe}from"./ItemsRest-DBSKIEqF.js";import{A as ne}from"./ArrayJoin-2k6ba35P.js";import{L as ie}from"./Loading-B-FwDSWi.js";import{N as ce}from"./NoResult-C9qZVva5.js";import"./ProductCard-C2H10lUi.js";import{P as me}from"./ProductCardColors-DO0WYGP_.js";import{m as i}from"./main-BSEyQEJW.js";import{M as de}from"./PaymentModal-Bxx5p2o_.js";import{F}from"./filter-Ci9tsc_e.js";import{C as R}from"./chevron-left-B2s3ZsB7.js";import{C as T}from"./chevron-right-Ckt5D2ka.js";import{X as ue}from"./x-DBMwyD6F.js";import{C as b}from"./chevron-up-D78jyEhP.js";import{S as L}from"./search-TwiiKGP5.js";import"./index-yBjzXJbu.js";import"./HeaderSearch-Dq_WE7sS.js";import"./CartItemRow-BhtCHp_j.js";import"./tippy-react.esm-BWiGTO87.js";import"./index-rimy3MAc.js";import"./index-fNjTmf9T.js";import"./Number2Currency-e57Tgsuk.js";import"./minus-jyhodMPN.js";import"./createLucideIcon-Cy5Ya80P.js";import"./plus-Bot15Khs.js";import"./BasicRest-DEv02zgs.js";/* empty css              */import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";import"./index-Chjiymov.js";const xe=new oe,Qe=({items:ge,data:pe,filteredData:he,cart:I,setCart:G})=>{const[u,M]=o.useState([]),[A,O]=o.useState([]),[fe,z]=o.useState([]),[B,V]=o.useState([]),[q,W]=o.useState([]),[m,j]=o.useState({collection:!1,marca:!1,precio:!1,categoria:!1,colores:!1}),[Y,D]=o.useState(window.innerWidth<1024);o.useEffect(()=>{const t=()=>{D(window.innerWidth<1024)};return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const x=t=>{j(Y?a=>{const l={collection:!1,marca:!1,precio:!1,categoria:!1,colores:!1};return l[t]=!a[t],l}:a=>({...a,[t]:!a[t]}))},[c,H]=o.useState({collection_id:i.GET.collection?i.GET.collection.split(","):[],category_id:i.GET.category?i.GET.category.split(","):[],brand_id:i.GET.brand?i.GET.brand.split(","):[],subcategory_id:i.GET.subcategory?i.GET.subcategory.split(","):[],price:null,name:i.GET.search||null,sort_by:"created_at",order:"desc"}),[g,J]=o.useState([]),[U,y]=o.useState(!0),[r,X]=o.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:21,from:0,to:0}),K=t=>{const a=[];if(t.collection_id.length>0){const l=t.collection_id.map(s=>["collection.slug","=",s]);a.push([...l])}if(t.category_id.length>0){const l=t.category_id.map(s=>["category.slug","=",s]);a.push([...l])}if(t.subcategory_id.length>0){const l=t.subcategory_id.map(s=>["subcategory.slug","=",s]);a.push([...l])}if(t.brand_id.length>0){const l=t.brand_id.map(s=>["brand.slug","=",s]);a.push([...l])}return t.price&&a.push(["or",[["final_price",">=",t.price.min],"and",["final_price","<=",t.price.max]]]),t.name&&a.push(["name","contains",t.name]),ne(a,"and")},w=async(t=1)=>{y(!0);try{const a=K(c);console.log(a);const l={filter:a,sort:c.sort,skip:(t-1)*r.itemsPerPage,take:r.itemsPerPage,requireTotalCount:!0},s=await xe.paginate(l);J(s.data),X({currentPage:t,totalPages:Math.ceil(s.totalCount/r.itemsPerPage),totalItems:s.totalCount,itemsPerPage:r.itemsPerPage,from:(t-1)*r.itemsPerPage+1,to:Math.min(t*r.itemsPerPage,s.totalCount)}),console.log(s),M(s==null?void 0:s.summary.collections),O(s==null?void 0:s.summary.brands),V(s==null?void 0:s.summary.categories),z(s==null?void 0:s.summary.subcategories),W(s==null?void 0:s.summary.priceRanges)}catch(a){console.error("Error fetching products:",a)}finally{y(!1)}};o.useEffect(()=>{w(r.currentPage)},[c]);const d=t=>{t>=1&&t<=r.totalPages&&w(t)},N=()=>{const t=[],a=r.totalPages,l=r.currentPage,s=2;for(let n=1;n<=a;n++)n===1||n===a||n>=l-s&&n<=l+s?t.push(n):(n===l-s-1||n===l+s+1)&&t.push("...");return t.filter((n,f,le)=>n!=="..."||le[f-1]!=="...")},p=(t,a)=>{H(l=>{if(t==="price")return{...l,price:l.price&&l.price.min===a.min&&l.price.max===a.max?null:a};const s=Array.isArray(l[t])?l[t]:[],n=s.includes(a)?s.filter(f=>f!==a):[...s,a];return{...l,[t]:n}})},[C,Q]=o.useState(""),[v,Z]=o.useState(""),[ee,be]=o.useState(""),te=u==null?void 0:u.filter(t=>t.name.toLowerCase().includes(v.toLowerCase())),se=B.filter(t=>t.name.toLowerCase().includes(C.toLowerCase()));A.filter(t=>t.name.toLowerCase().includes(ee.toLowerCase()));const[je,ye]=o.useState(!1),[ae,P]=o.useState(!1),[S,k]=o.useState(!1),_=()=>{P(!0),setTimeout(()=>k(!0),10),document.body.style.overflow="hidden"},h=()=>{k(!1),setTimeout(()=>P(!1),300),document.body.style.overflow="auto"},re={overlay:{backgroundColor:S?"rgba(0, 0, 0, 0.5)":"rgba(0, 0, 0, 0)",zIndex:50,transition:"background-color 300ms ease-in-out"},content:{top:"auto",left:"0",right:"0",bottom:"0",borderRadius:"1rem 1rem 0 0",border:"none",padding:"0",height:"75vh",transform:S?"translateY(0)":"translateY(100%)",transition:"transform 300ms ease-in-out",willChange:"transform"}},E=()=>e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 pb-20 lg:pb-0 lg:px-0",children:[e.jsxs("div",{className:"sticky top-0 bg-white py-4 border-b flex justify-between items-center lg:hidden",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Filtros"}),e.jsx("button",{onClick:h,children:e.jsx(ue,{className:"h-6 w-6"})})]}),e.jsx("p",{className:"customtext-primary text-2xl font-bold pb-4 mb-4 border-b lg:block hidden",children:"Combina como desees tu sala"}),e.jsxs("div",{className:"mt-2 mb-4",children:[e.jsxs("button",{onClick:()=>x("collection"),className:"flex items-center justify-between w-full mb-2 p-2 lg:p-0",children:[e.jsx("span",{className:"font-medium",children:"Colecciones"}),e.jsx(b,{className:`h-5 w-5 transform transition-transform ${m.collection?"":"-rotate-180"}`})]}),m.collection&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative hidden md:flex",children:[e.jsx(L,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full pl-10 pr-4 py-3 border rounded-xl focus:ring-0 focus:outline-0",value:v,onChange:t=>Z(t.target.value)})]}),e.jsx("div",{className:"max-h-[200px] xl:max-h-none overflow-y-auto space-y-1 md:space-y-2",children:te.map(t=>{var l;const a=(l=c.collection_id)==null?void 0:l.includes(t.slug);return e.jsx("div",{className:`group flex items-center gap-3 p-2 rounded-lg ${a?"bg-secondary":"hover:bg-gray-50"}`,children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-300 accent-primary hidden ",onChange:()=>p("collection_id",t.slug),checked:a}),e.jsx("img",{src:`/storage/images/collection/${t.image}`,onError:s=>s.target.src="assets/img/noimage/no_imagen_circular.png",className:"w-8 h-8 rounded-full object-cover",alt:t.name}),e.jsx("span",{className:"text-sm lg:text-base",children:t.name})]})},t.id)})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("button",{onClick:()=>x("categoria"),className:"flex items-center justify-between w-full mb-2 p-2 lg:p-0",children:[e.jsx("span",{className:"font-medium",children:"CategorÃ­as"}),e.jsx(b,{className:`h-5 w-5 transform transition-transform ${m.categoria?"":"-rotate-180"}`})]}),m.categoria&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative hidden md:flex",children:[e.jsx(L,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full pl-10 pr-4 py-3 border rounded-xl focus:ring-0 focus:outline-0",value:C,onChange:t=>Q(t.target.value)})]}),e.jsx("div",{className:"max-h-[200px] xl:max-h-none overflow-y-auto space-y-1 md:space-y-2",children:se.map(t=>{var l;const a=(l=c.category_id)==null?void 0:l.includes(t.slug);return e.jsx("div",{className:`group flex items-center gap-3 p-2 rounded-lg ${a?"bg-secondary":"hover:bg-gray-50"}`,children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-300 accent-primary hidden",onChange:()=>p("category_id",t.slug),checked:a}),e.jsx("img",{src:`/storage/images/category/${t.image}`,onError:s=>s.target.src="assets/img/noimage/no_imagen_circular.png",className:"w-8 h-8 rounded-full object-cover",alt:t.name}),e.jsx("span",{className:"text-sm lg:text-base",children:t.name})]})},t.id)})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("button",{onClick:()=>x("precio"),className:"flex items-center justify-between w-full mb-2 p-2 lg:p-0",children:[e.jsx("span",{className:"font-medium",children:"Precio"}),e.jsx(b,{className:`h-5 w-5 transform transition-transform ${m.precio?"":"-rotate-180"}`})]}),m.precio&&e.jsx("div",{className:"max-h-[200px] xl:max-h-none overflow-y-auto space-y-1 md:space-y-2",children:q.map(t=>{var a,l;return e.jsxs("label",{className:" flex items-center gap-2 p-2 rounded-lg hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-300 accent-primary",onChange:()=>p("price",t),checked:((a=c.price)==null?void 0:a.min)===t.min&&((l=c.price)==null?void 0:l.max)===t.max}),e.jsx("span",{className:"text-sm lg:text-base",children:`S/ ${t.min} - S/ ${t.max}`})]},`${t.min}-${t.max}`)})})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t p-4 h-20 flex items-center lg:hidden",children:e.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-xl font-bold hover:bg-primary-dark transition-colors",onClick:h,children:"Ver resultados"})})]});return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:_,className:"fixed flex xl:hidden left-1 top-2/3 transform -translate-y-1/2 bg-primary text-white rounded-full p-3 shadow-lg z-40 items-center justify-center","aria-label":"Abrir filtros",children:e.jsx(F,{className:"w-6 h-6"})}),e.jsx(de,{isOpen:ae,onRequestClose:h,style:re,closeTimeoutMS:300,ariaHideApp:!1,shouldCloseOnOverlayClick:!0,shouldCloseOnEsc:!0,children:E()}),e.jsx("section",{className:"py-6 font-font-general customtext-primary",children:e.jsxs("div",{className:"mx-auto px-primary",children:[e.jsxs("button",{onClick:_,className:"w-auto xl:hidden flex gap-2 items-center mb-4 p-3 bg-white rounded-lg shadow-sm",children:[e.jsx(F,{className:"h-5 w-5"}),e.jsx("span",{className:"font-semibold",children:"Filtros"})]}),e.jsxs("div",{className:"relative flex flex-col xl:flex-row gap-10",children:[e.jsx("div",{className:"hidden xl:block xl:w-1/4 lg:bg-white lg:p-0 xl:rounded-lg xl:h-max",children:E()}),e.jsxs("div",{className:"w-full pb-4",children:[e.jsx("div",{className:"flex flex-col lg:flex-row lg:justify-between items-center mb-4 lg:mb-8 w-full gap-5",children:e.jsx("div",{className:"customtext-primary font-semibold w-full lg:w-auto",children:e.jsxs("div",{className:"flex gap-3 items-center w-full",children:[e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsxs("nav",{className:"flex items-center gap-x-1 min-w-max",children:[e.jsx("button",{className:`p-0 inline-flex items-center ${r.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>d(r.currentPage-1),disabled:r.currentPage===1,children:e.jsx(R,{})}),N().map((t,a)=>e.jsx($.Fragment,{children:t==="..."?e.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):e.jsx("button",{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                                            ${t===r.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>d(t),children:t})},a)),e.jsx("button",{className:`p-0 inline-flex items-center ${r.currentPage===r.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>d(r.currentPage+1),disabled:r.currentPage===r.totalPages,children:e.jsx(T,{})})]})}),e.jsx("div",{children:e.jsxs("p",{className:"font-semibold",children:[r.from," - ",r.to," ","de ",r.totalItems," ","Resultados"]})})]})})}),U?e.jsx(ie,{}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 md:gap-6 xl:gap-8 gap-y-2 lg:gap-y-3 transition-all duration-300 ease-in-out",children:Array.isArray(g)&&g.length>0?g.map(t=>e.jsx(me,{product:t,widthClass:"lg:w-1/3",cart:I,setCart:G},t.id)):e.jsx(ce,{})}),e.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsx("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[e.jsx("button",{className:`p-4 inline-flex items-center ${r.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>d(r.currentPage-1),disabled:r.currentPage===1,children:e.jsx(R,{})}),N().map((t,a)=>e.jsx($.Fragment,{children:t==="..."?e.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):e.jsx("button",{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                                            ${t===r.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>d(t),children:t})},a)),e.jsx("button",{className:`p-4 inline-flex items-center ${r.currentPage===r.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>d(r.currentPage+1),disabled:r.currentPage===r.totalPages,children:e.jsx(T,{})})]})})})}),e.jsx("div",{children:e.jsxs("p",{className:"font-semibold",children:[r.from," - ",r.to," de"," ",r.totalItems," Resultados"]})})]})]})]})]})})]})};export{Qe as default};
