import{r as t,j as e}from"./vendor-react-LJZQRWVP.js";import{G as n}from"./General-ClVW7qxN.js";class r{static shouldShow(t){if("string"==typeof t)return""!==t.trim();if(!t||!1===t.enabled)return!1;if(!t.text||""===t.text.trim())return!1;if(!t.schedule)return!0;const e=new Date,n=this.getCurrentDayKey(e),r=this.getCurrentTimeString(e),s=t.schedule[n];return!(!s||!s.enabled)&&this.isTimeInRange(r,s.start,s.end)}static getCurrentDayKey(t=new Date){return["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][t.getDay()]}static getCurrentTimeString(t=new Date){return t.toTimeString().slice(0,5)}static isTimeInRange(t,e,n){if(!e||!n)return!0;const r=this.timeToMinutes(t),s=this.timeToMinutes(e),i=this.timeToMinutes(n);return i<s?r>=s||r<=i:r>=s&&r<=i}static timeToMinutes(t){const[e,n]=t.split(":").map(Number);return 60*e+n}static filterActiveCintillos(t){return Array.isArray(t)?t.filter(t=>this.shouldShow(t)):[]}static getText(t){return"string"==typeof t?t:t?.text||""}static getDebugInfo(t){const e=new Date,n=this.getCurrentDayKey(e),r=this.getCurrentTimeString(e);if("string"==typeof t)return{type:"legacy",shouldShow:""!==t.trim(),text:t,currentDay:n,currentTime:r};const s=t.schedule?.[n];return{type:"scheduled",enabled:t.enabled,hasText:!(!t.text||!t.text.trim()),currentDay:n,currentTime:r,dayEnabled:s?.enabled||!1,daySchedule:s||null,timeInRange:!s||this.isTimeInRange(r,s.start,s.end),shouldShow:this.shouldShow(t)}}static getNextSchedule(t){if("string"==typeof t||!t.schedule)return null;const e=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],n=["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo"];for(let r=0;r<7;r++){const s=e[r],i=t.schedule[s];if(i&&i.enabled)return`${n[r]}: ${i.start} - ${i.end}`}return"Sin programación activa"}}const s=({className:s=""})=>{const[i,a]=t.useState(0),[l,u]=t.useState(!0),[c,o]=t.useState([]),h=()=>{try{const e=n.get("cintillo");let s=[];if(e)try{s=JSON.parse(e)}catch(t){s=e.split(",").map(t=>t.trim()).filter(t=>t.length>0)}const i=r.filterActiveCintillos(s);o(i),a(t=>t>=i.length?0:t)}catch(e){o([])}};if(t.useEffect(()=>{h();const t=setInterval(h,6e4);return()=>clearInterval(t)},[]),t.useEffect(()=>{if(c.length<=1)return;const t=setInterval(()=>{u(!1),setTimeout(()=>{a(t=>(t+1)%c.length),u(!0)},300)},4e3);return()=>clearInterval(t)},[c.length]),0===c.length)return null;if(1===c.length){const t=r.getText(c[0]);return e.jsx("span",{className:s,children:t})}const d=c[i]?r.getText(c[i]):"";return e.jsx("span",{className:`\n                ${s} \n                transition-all duration-300 ease-in-out\n                ${l?"opacity-100 transform translate-y-0":"opacity-0 transform -translate-y-2"}\n            `,style:{display:"inline-block",minHeight:"1.2em"},title:`Cintillo ${i+1} de ${c.length}`,children:d})},i=()=>{const[e,s]=t.useState(!1),[i,a]=t.useState([]),l=()=>{try{const e=n.get("cintillo");let i=[];if(e)try{i=JSON.parse(e)}catch(t){i=e.split(",").map(t=>t.trim()).filter(t=>t.length>0)}const l=r.filterActiveCintillos(i);a(l),s(l.length>0)}catch(e){a([]),s(!1)}};return t.useEffect(()=>{l();const t=setInterval(l,6e4);return()=>clearInterval(t)},[]),{hasActiveCintillos:e,activeCintillos:i,updateActiveCintillos:l}};export{s as A,i as u};
