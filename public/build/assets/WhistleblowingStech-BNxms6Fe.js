import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as o}from"./index-BOnQTV8N.js";import{I as c}from"./InputForm-Dmyom2PO.js";import{u as V,S as Y}from"./ubigeo-B6DUsdRs.js";import{S as N}from"./SelectForm-BvZde-dr.js";import{C as Q}from"./ComplaintStech-DfVkOvNd.js";import{T as W}from"./ThankYouPage-CFeMQXYh.js";import{R as J}from"./PolicyModal-C80IvD61.js";import{H as U}from"./HtmlContent-ghmllTyl.js";import{t as u}from"./CardProductKatya-ncpmQ0JU.js";import{T as X}from"./triangle-alert-CK-9Xb7r.js";import{M as G}from"./map-pin-Cj3PUWlD.js";import{F as K}from"./file-text-BGNfKLm5.js";import{B as Z}from"./building-2-DSFvhCB-.js";import{S as ee}from"./shield-BR0A2VCY.js";import{X as ae}from"./x-fof_H3Vv.js";import"./index-yBjzXJbu.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./createLucideIcon-DfjclApS.js";import"./chevron-down-uIVDLcM-.js";import"./search-BQ59Robe.js";import"./check-D5vaIe6v.js";import"./index-ngrFHoWO.js";import"./loader-circle-CSFYLd5m.js";import"./refresh-cw-Dp9ubuxa.js";import"./Number2Currency-jIsa99f9.js";import"./General-apRuNwp7.js";import"./circle-check-big-CYWUGR3Z.js";import"./user-BZB1h7Cv.js";import"./package-DBFPPBi1.js";import"./message-square-3fUfiy2J.js";import"./hash-B-gZU8HC.js";import"./arrow-left-n6ltb6Cc.js";import"./index-B6ujFmsw.js";import"./index-Chjiymov.js";import"./index-pSueRYGM.js";function Ie({generals:C=[],data:a}){const[E,m]=o.useState(""),[x,_]=o.useState(!1),[w,k]=o.useState(null),[P,S]=o.useState(!1),[h,q]=o.useState(null),[O,A]=o.useState(null),d=o.useRef();o.useEffect(()=>{A(Math.floor(Date.now()/1e3))},[]);const[t,b]=o.useState({departamento:"",ciudad:"",direccion_exacta:"",ambito:"",relacion_compania:"",empresa:"",que_sucedio:"",quien_implicado:"",cuando_ocurrio:"",dialogo_superior:"",nombre:"",telefono:"",email:"",acepta_politica:!1}),[f,g]=o.useState(!1),i=o.useCallback(s=>{const{name:l,value:r,type:n,checked:p}=s.target;b(y=>({...y,[l]:n==="checkbox"?p:r}))},[]),j=o.useCallback((s,l)=>{b(r=>({...r,[s]:l}))},[]),F=o.useCallback(()=>{b({departamento:"",ciudad:"",direccion_exacta:"",ambito:"",relacion_compania:"",empresa:"",que_sucedio:"",quien_implicado:"",cuando_ocurrio:"",dialogo_superior:"",nombre:"",telefono:"",email:"",acepta_politica:!1}),_(!1),k(null),m(""),d.current&&d.current.reset()},[]),$=o.useCallback((s,l)=>{_(s),k(l),s&&m("")},[]),M=o.useCallback(()=>{S(!1),q(null)},[]),I=s=>{if(s.preventDefault(),g(!0),!x||!w){m("Por favor, completa la verificación de seguridad."),g(!1);return}m("");const l={...t,captcha_verified:!0,recaptcha_token:w,_form_loaded_at:O,_hp:""};fetch("/api/whistleblowings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}).then(r=>{if(!r.ok)throw r;return r.json()}).then(r=>{r.type==="success"?(u.success(r.message),q(r.data),S(!0),F()):(u.error(r.message||"Error al enviar la denuncia"),r.message&&r.message.includes("CAPTCHA")&&(m(r.message),d.current&&d.current.reset()))}).catch(async r=>{if(console.error("Error:",r),r instanceof Response)try{const n=await r.json();u.error(n.message||"Error al enviar la denuncia"),n.message&&n.message.includes("CAPTCHA")&&(m(n.message),d.current&&d.current.reset())}catch{u.error("Error al enviar la denuncia. Por favor, intenta nuevamente.")}else u.error("Hubo un error al enviar la denuncia. Por favor, intenta nuevamente.")}).finally(()=>g(!1))},R=o.useMemo(()=>[...new Set(V.map(l=>l.departamento))].map(l=>({value:l,label:l})),[]),H=o.useMemo(()=>[{value:"Laboral",label:"Laboral"},{value:"Ético",label:"Ético"},{value:"Técnico u operativo",label:"Técnico u operativo"},{value:"Comercial o ventas",label:"Comercial o ventas"},{value:"Seguridad",label:"Seguridad"},{value:"Discriminación o acoso",label:"Discriminación o acoso"},{value:"Otro",label:"Otro"}],[]),L=o.useMemo(()=>[{value:"Empleado",label:"Empleado"},{value:"Proveedor",label:"Proveedor"},{value:"Cliente",label:"Cliente"},{value:"Otro",label:"Otro"}],[]),[z,T]=o.useState(!1),D={privacy_policy:"Política de Privacidad"},B=s=>T(s),v=()=>T(!1);return P&&h?e.jsx(W,{title:"¡Denuncia Recibida!",message:"Tu denuncia ha sido registrada exitosamente y será revisada por nuestro equipo de compliance.",submittedData:{...h,subtitle:`Código de seguimiento: ${h.codigo}`},onBackToForm:M}):e.jsxs("div",{className:`min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 py-12 px-4 ${(a==null?void 0:a.class_base)||""}`,children:[e.jsxs("div",{className:"container mx-auto max-w-5xl",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[e.jsx(X,{className:"w-10 h-10 customtext-primary"}),e.jsx("h1",{className:`text-4xl font-bold customtext-neutral-dark ${(a==null?void 0:a.class_title)||""}`,children:"Canal de Denuncias"})]}),e.jsx("p",{className:"customtext-neutral-light text-lg max-w-2xl mx-auto",children:"Este es un canal confidencial para reportar conductas irregulares o situaciones que consideres inapropiadas. Tu denuncia será tratada con la máxima confidencialidad."})]}),e.jsx("div",{className:"bg-white shadow-2xl rounded-3xl border border-gray-100 overflow-hidden",children:e.jsxs("form",{onSubmit:I,className:"p-8 space-y-12",children:[e.jsx("input",{type:"text",name:"_hp",tabIndex:"-1",autoComplete:"off",style:{position:"absolute",left:"-9999px",width:"1px",height:"1px",opacity:0,pointerEvents:"none"},"aria-hidden":"true"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 pb-4 border-b border-gray-200",children:[e.jsx("div",{className:`flex items-center justify-center w-12 h-12 bg-secondary rounded-full ${(a==null?void 0:a.class_icon)||"shadow-lg customtext-primary"}`,children:e.jsx(G,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:`text-2xl font-bold customtext-neutral-dark ${(a==null?void 0:a.class_title)||""}`,children:"Ubicación del Incidente"}),e.jsx("p",{className:"customtext-neutral-light",children:"¿Dónde ha ocurrido?"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(N,{label:"Departamento",name:"departamento",placeholder:"Selecciona departamento",value:t.departamento,onChange:s=>j("departamento",s),options:R,required:!0}),e.jsx(c,{type:"text",label:"Ciudad",name:"ciudad",value:t.ciudad,onChange:i,placeholder:"Ingresa la ciudad",required:!0})]}),e.jsx(c,{type:"text",label:"Dirección exacta del incidente",name:"direccion_exacta",value:t.direccion_exacta,onChange:i,placeholder:"Ej: Oficina Lima, Av. Principal 123",required:!0})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 pb-4 border-b border-gray-200",children:[e.jsx("div",{className:`flex items-center justify-center w-12 h-12 bg-secondary rounded-full ${(a==null?void 0:a.class_icon)||"shadow-lg customtext-primary"}`,children:e.jsx(K,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:`text-2xl font-bold customtext-neutral-dark ${(a==null?void 0:a.class_title)||""}`,children:"Información del Incidente"}),e.jsx("p",{className:"customtext-neutral-light",children:"Detalles de lo ocurrido"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(N,{label:"Ámbito de la denuncia",name:"ambito",placeholder:"Selecciona ámbito",value:t.ambito,onChange:s=>j("ambito",s),options:H,required:!0}),e.jsx(N,{label:"Tu relación con la compañía",name:"relacion_compania",placeholder:"Selecciona relación",value:t.relacion_compania,onChange:s=>j("relacion_compania",s),options:L,required:!0})]}),e.jsx(c,{type:"text",label:"¿En qué empresa ocurrió?",name:"empresa",value:t.empresa,onChange:i,placeholder:"Nombre de la empresa (opcional)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium customtext-neutral-dark",children:["¿Qué ha sucedido? ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{name:"que_sucedio",value:t.que_sucedio,onChange:i,rows:"5",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Describe detalladamente lo sucedido...",required:!0})]}),e.jsx(c,{type:"text",label:"¿Quién está implicado?",name:"quien_implicado",value:t.quien_implicado,onChange:i,placeholder:"Nombres, cargos o departamentos involucrados",required:!0}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.jsx(c,{type:"date",label:"¿Cuándo ocurrió?",name:"cuando_ocurrio",value:t.cuando_ocurrio,onChange:i,required:!0})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium customtext-neutral-dark",children:"¿Has dialogado con tu superior o con otra persona?"}),e.jsx("textarea",{name:"dialogo_superior",value:t.dialogo_superior,onChange:i,rows:"3",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Si/No y detalles adicionales (opcional)"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 pb-4 border-b border-gray-200",children:[e.jsx("div",{className:`flex items-center justify-center w-12 h-12 bg-secondary rounded-full ${(a==null?void 0:a.class_icon)||"shadow-lg customtext-primary"}`,children:e.jsx(Z,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:`text-2xl font-bold customtext-neutral-dark ${(a==null?void 0:a.class_title)||""}`,children:"Información de Contacto"}),e.jsx("p",{className:"customtext-neutral-light",children:"Tus datos serán tratados confidencialmente"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(c,{type:"text",label:"Nombre",name:"nombre",value:t.nombre,onChange:i,placeholder:"Tu nombre completo",required:!0}),e.jsx(c,{type:"tel",label:"Teléfono",name:"telefono",value:t.telefono,onChange:i,placeholder:"(Opcional)"})]}),e.jsx(c,{type:"email",label:"Email",name:"email",value:t.email,onChange:i,placeholder:"tu@email.com",required:!0})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 pb-4 border-b border-gray-200",children:[e.jsx("div",{className:`flex items-center justify-center w-12 h-12 bg-secondary rounded-full ${(a==null?void 0:a.class_icon)||"shadow-lg customtext-primary"}`,children:e.jsx(ee,{className:"w-6 h-6"})}),e.jsx("div",{children:e.jsx("h2",{className:`text-2xl font-bold customtext-neutral-dark ${(a==null?void 0:a.class_title)||""}`,children:"Validación de Seguridad"})})]}),e.jsx(Q,{ref:d,onVerify:$,error:E})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",name:"acepta_politica",checked:t.acepta_politica,onChange:i,className:"mt-1 w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-2 focus:ring-blue-500",required:!0}),e.jsxs("span",{className:"text-sm customtext-neutral-dark",children:["Acepto la"," ",e.jsx("button",{type:"button",onClick:()=>B(0),className:"customtext-primary underline hover:no-underline",children:"Política de Privacidad"})," ","y autorizo el tratamiento confidencial de mis datos",e.jsx("span",{className:"text-red-500",children:" *"})]})]})}),e.jsx("div",{className:"flex justify-center pt-6",children:e.jsx("button",{type:"submit",disabled:f||!x||!t.acepta_politica,className:`
                                    flex items-center gap-3 px-10 py-4 rounded-2xl text-white font-semibold text-lg
                                    transition-all duration-300 transform hover:scale-105
                                    ${f||!x||!t.acepta_politica?"bg-gray-400 cursor-not-allowed":"bg-primary hover:bg-primary/90 shadow-lg hover:shadow-xl"}
                                `,children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"w-6 h-6"}),"Enviar Denuncia"]})})})]})})]}),Object.keys(D).map((s,l)=>{var p;const r=D[s],n=Array.isArray(C)?((p=C.find(y=>y.correlative==s))==null?void 0:p.description)??"":"";return e.jsx(J,{isOpen:z===l,onRequestClose:v,contentLabel:r,className:"fixed top-0 left-0 right-0 bottom-0 flex items-center justify-center p-4 z-50",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 z-[9999999]",ariaHideApp:!1,children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 pr-4",children:r}),e.jsx("button",{onClick:v,className:"flex-shrink-0 text-gray-400 hover:text-red-500 transition-colors duration-200 p-1 hover:bg-gray-100 rounded-full","aria-label":"Cerrar modal",children:e.jsx(ae,{size:24,strokeWidth:2})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsx("div",{className:"prose prose-gray max-w-none",children:e.jsx(U,{html:n})})}),e.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200",children:e.jsx("button",{onClick:v,className:"px-6 py-2 bg-primary text-white rounded-lg transition-colors duration-200 font-medium",children:"Cerrar"})})]})},l)})]})}export{Ie as default};
