import{r as e,j as s,R as a,I as t}from"./System-Bybt2Brn.js";import"./CardHoverBtn-BJnt3e8M.js";import{L as r}from"./Loading-B56-7KDx.js";import{N as i}from"./NoResult-m-3gmVGS.js";import{S as l}from"./SelectForm-ChOsm-KR.js";import"./sweetalert2.esm.all-DbJpIAEg.js";import{P as n}from"./ProductCardSimple-5sOQ9JKM.js";import{C as c}from"./CardProductBananaLab-oDawj799.js";import{C as o}from"./chevron-down-r_B4RFE6.js";import{F as m}from"./filter-DnzWsNM_.js";import{C as d}from"./chevron-left-DoRUFD_L.js";import{C as u}from"./chevron-right-jU6kkjiT.js";import"./vendor-BiOv2i5T.js";import"./CartModal-Db_dBOJN.js";import"./index-Cmhjy_Bv.js";import"./index-Bx5UHif0.js";import"./CartItemRow-CLpuTcvn.js";import"./Number2Currency-DExzICY3.js";import"./tippy-react.esm-Cpb4mDDh.js";import"./proxy-BmPRG09w.js";import"./trash-2-CDXts6on.js";import"./createLucideIcon-oahCLV50.js";import"./minus-BhdGy6sP.js";import"./plus-4JHYG4O1.js";import"./index-Da4AP4wO.js";import"./eye-DJ5vw54Z.js";import"./search--TD4pUuj.js";import"./check-BqyWwvbE.js";import"./CartModalBananaLab-CzbnPykF.js";import"./x-DWgXNABc.js";import"./shopping-cart-D6rW5WdX.js";import"./arrow-right-CoVebBW_.js";import"./heart-CyPg-ZZw.js";import"./circle-check-big-BzpJOupm.js";const p=new t,x=({items:t,data:x,filteredData:h,cart:g,setCart:f})=>{const{collections:j,priceRanges:b}=h||{collections:[],priceRanges:[]},[y,w]=e.useState([]),[v,N]=e.useState([]),[C,P]=e.useState({collection:!0,marca:!0,precio:!0,categoria:!0,colores:!1}),[k,_]=e.useState({collection_id:[],category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort:[{selector:"created_at",desc:!0}]}),[S,L]=e.useState([]),[M,$]=e.useState(!1),[R,A]=e.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:21,from:0,to:0}),I=async(e=1)=>{var s,a,t,r;$(!0);try{const i={filter:(e=>{const s=[];if(e.collection_id.length>0){const a=e.collection_id.map((e=>["collection_id","=",e]));s.push(["or",...a])}if(e.category_id.length>0){const a=e.category_id.map((e=>["category_id","=",e]));s.push(["or",...a])}if(e.subcategory_id.length>0){const a=e.subcategory_id.map((e=>["subcategory_id","=",e]));s.push(["and",...a])}if(e.brand_id.length>0){const a=e.brand_id.map((e=>["brand_id","=",e]));s.push(["or",...a])}return e.price&&s.push(["and",[["final_price",">=",e.price.min],"and",["final_price","<=",e.price.max]]]),e.name&&s.push(["name","contains",e.name]),s})(k),sort:k.sort,skip:(e-1)*R.itemsPerPage,take:R.itemsPerPage,requireTotalCount:!0},l=await p.paginate(i);l&&l.data&&(L(l.data),A({currentPage:e,totalPages:Math.ceil(l.totalCount/R.itemsPerPage),totalItems:l.totalCount,itemsPerPage:R.itemsPerPage,from:(e-1)*R.itemsPerPage+1,to:Math.min(e*R.itemsPerPage,l.totalCount)}),w(null!=(a=null==(s=null==l?void 0:l.summary)?void 0:s.brands)?a:[]),N(null!=(r=null==(t=null==l?void 0:l.summary)?void 0:t.categories)?r:[]))}catch(i){}finally{$(!1)}};e.useEffect((()=>{I(R.currentPage)}),[k]),e.useEffect((()=>{const e=new URLSearchParams(window.location.search),s=e.get("category");if(s){const e=v.find((e=>e.slug===s));e&&_((s=>({...s,category_id:[e.id]})))}const a=e.get("collection");if(a){const e=j.find((e=>e.slug===a));e&&_((s=>({...s,collection_id:[e.id]})))}const t=e.get("search");t&&_((e=>({...e,name:t})))}),[v,j]);const F=e=>{e>=1&&e<=R.totalPages&&I(e)},z=()=>{const e=[],s=R.totalPages,a=R.currentPage;for(let t=1;t<=s;t++)1===t||t===s||t>=a-2&&t<=a+2?e.push(t):t!==a-2-1&&t!==a+2+1||e.push("...");return e.filter(((e,s,a)=>"..."!==e||"..."!==a[s-1]))},E=(e,s)=>{_((a=>{if("price"===e)return{...a,price:a.price&&a.price.min===s.min&&a.price.max===s.max?null:s};const t=Array.isArray(a[e])?a[e]:[],r=t.includes(s)?t.filter((e=>e!==s)):[...t,s];return{...a,[e]:r}}))},B=e=>{P((s=>({...s,[e]:!s[e]})))},[K,q]=e.useState(""),[D,Z]=e.useState(""),[G,H]=e.useState("");null==j||j.filter((e=>e.name.toLowerCase().includes(D.toLowerCase())));const O=null==v?void 0:v.filter((e=>e.name.toLowerCase().includes(K.toLowerCase())));null==y||y.filter((e=>e.name.toLowerCase().includes(G.toLowerCase())));const[T,U]=e.useState(!1),V=()=>s.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:()=>U(!1)}),s.jsx("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:s.jsxs("div",{className:"inline-block align-bottom bg-white rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 w-full sm:align-middle sm:max-w-lg sm:w-full h-[80vh]",children:[s.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 border-b sticky top-0 z-10",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-bold leading-6 text-gray-900",children:"Filtros"}),s.jsxs("button",{type:"button",className:"text-gray-400 hover:text-gray-500 focus:outline-none",onClick:()=>U(!1),children:[s.jsx("span",{className:"sr-only",children:"Cerrar"}),"✕"]})]})}),s.jsxs("div",{className:"bg-white px-4 pt-2 pb-4 sm:p-6 sm:pb-4 overflow-y-auto h-[calc(100%-60px)]",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>B("categoria"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-bold",children:"Categorias"}),s.jsx(o,{className:"h-5 w-5 transform transition-transform "+(C.categoria?"":"-rotate-180")})]}),C.categoria&&s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"space-y-2",children:null==O?void 0:O.map((e=>{var a;const t=null==(a=k.category_id)?void 0:a.includes(e.id);return s.jsx("div",{className:"group py-2 rounded-md "+(t?"bg-secondary":"bg-transparent"),children:s.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[s.jsx("input",{type:"checkbox",className:"h-4 hidden w-4 rounded border-gray-300",onChange:()=>E("category_id",e.id),checked:t}),s.jsx("span",{children:e.name}),s.jsx("img",{src:`/storage/images/category/${e.image}`,onError:e=>e.target.src="assets/img/noimage/no_imagen_circular.png",alt:e.name,className:"w-8 h-8 rounded-full object-cover",loading:"lazy"})]})},e.id)}))})})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>B("precio"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-medium",children:"Precio"}),s.jsx(o,{className:"h-5 w-5 transform transition-transform "+(C.precio?"":"-rotate-180")})]}),C.precio&&s.jsx("div",{className:"space-y-3",children:null==b?void 0:b.map((e=>s.jsxs("label",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>E("price",e),checked:k.price&&k.price.min===e.min&&k.price.max===e.max}),s.jsx("span",{children:`S/ ${e.min} - S/ ${e.max}`})]},`${e.min}-${e.max}`)))})]})]}),s.jsx("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse sticky bottom-0 border-t",children:s.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-3 bg-primary text-white text-base font-medium hover:bg-primary-dark focus:outline-none sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>U(!1),children:"Aplicar filtros"})})]})})]});return s.jsxs("section",{className:"p-[5%] mx-auto w-full",children:[T&&s.jsx(V,{}),s.jsxs("div",{className:"relative flex flex-col sm:flex-row gap-4",children:[s.jsxs("div",{className:"hidden lg:block w-full sm:w-1/5 bg-white p-4 rounded-lg h-max",children:[s.jsx("div",{className:"sm:hidden flex justify-between items-center mb-4",children:s.jsx("button",{onClick:()=>U(!1),className:"customtext-primary hover:customtext-accent",children:"✕"})}),s.jsx("p",{className:"text-xl font-bold pb-4 mb-4 border-b",children:(null==x?void 0:x.title)||"Filtros"}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>B("categoria"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-bold",children:"Categorias"}),s.jsx(o,{className:"h-5 w-5 transform transition-transform "+(C.categoria?"":"-rotate-180")})]}),C.categoria&&s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"space-y-2",children:null==O?void 0:O.map((e=>{var a;const t=null==(a=k.category_id)?void 0:a.includes(e.id);return s.jsx("div",{className:"group py-2 rounded-md "+(t?"bg-secondary":"bg-transparent"),children:s.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[s.jsx("input",{type:"checkbox",className:"h-4 hidden w-4 rounded border-gray-300",onChange:()=>E("category_id",e.id),checked:t}),s.jsx("span",{children:e.name}),s.jsx("img",{src:`/storage/images/category/${e.image}`,onError:e=>e.target.src="/assets/img/noimage/no_imagen_circular.png",alt:e.name,className:"w-8 h-8 rounded-full object-cover",loading:"lazy"})]})},e.id)}))})})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>B("precio"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-medium",children:"Precio"}),s.jsx(o,{className:"h-5 w-5 transform transition-transform "+(C.precio?"":"-rotate-180")})]}),C.precio&&s.jsx("div",{className:"space-y-3",children:null==b?void 0:b.map((e=>s.jsxs("label",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>E("price",e),checked:k.price&&k.price.min===e.min&&k.price.max===e.max}),s.jsx("span",{children:`S/ ${e.min} - S/ ${e.max}`})]},`${e.min}-${e.max}`)))})]})]}),s.jsxs("div",{className:"w-full sm:w-4/5 py-4",children:[s.jsxs("div",{className:"flex justify-between items-end mb-4 w-full",children:[s.jsxs("div",{className:"flex gap-4  items-start lg:items-center flex-col w-8/12 lg:w-auto lg:flex-row",children:[s.jsx("label",{className:"font-semibold text-sm w-[150px]",children:"Ordenar por"}),s.jsx(l,{options:[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],placeholder:"Recomendados",onChange:e=>{const[s,a]=e.split(":"),t=[{selector:s,desc:"desc"===a}];_((e=>({...e,sort:t})))},labelKey:"label",valueKey:"value",className:"border-primary rounded-full customtext-primary"})]}),s.jsx("div",{className:"lg:hidden flex items-end h-full mb-4",children:s.jsx("button",{onClick:()=>U(!T),className:" h-12 w-12 gap-2 bg-primary text-white flex items-center justify-center  rounded-full lg:hidden",children:s.jsx(m,{size:20})})}),s.jsx("div",{className:"customtext-primary font-semibold hidden lg:block",children:s.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[s.jsx("button",{className:"p-4 inline-flex items-center "+(1===R.currentPage?"opacity-50 cursor-not-allowed":""),onClick:()=>F(R.currentPage-1),disabled:1===R.currentPage,children:s.jsx(d,{})}),z().map(((e,t)=>s.jsx(a.Fragment,{children:"..."===e?s.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):s.jsx("button",{className:"w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 \n                              "+(e===R.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"),onClick:()=>F(e),children:e})},t))),s.jsx("button",{className:"p-4 inline-flex items-center "+(R.currentPage===R.totalPages?"opacity-50 cursor-not-allowed":""),onClick:()=>F(R.currentPage+1),disabled:R.currentPage===R.totalPages,children:s.jsx(u,{})})]})}),s.jsx("div",{children:s.jsxs("p",{className:"font-semibold",children:[R.from," - ",R.to," de ",R.totalItems," Resultados"]})})]})})]}),M?s.jsx(r,{}):s.jsx("div",{className:"flex items-center flex-wrap gap-y-2 lg:gap-y-3 transition-all duration-300 ease-in-out",children:Array.isArray(S)&&S.length>0?S.map((e=>"CardProductBananaLab"===(null==x?void 0:x.card)?s.jsx(c,{product:e,widthClass:"lg:w-1/3",cart:g,setCart:f},e.id):s.jsx(n,{product:e,widthClass:"lg:w-1/3",cart:g,setCart:f},e.id))):s.jsx(i,{})}),s.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[s.jsx("button",{className:"p-4 inline-flex items-center "+(1===R.currentPage?"opacity-50 cursor-not-allowed":""),onClick:()=>F(R.currentPage-1),disabled:1===R.currentPage,children:s.jsx(d,{})}),z().map(((e,t)=>s.jsx(a.Fragment,{children:"..."===e?s.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):s.jsx("button",{className:"w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 \n                          "+(e===R.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"),onClick:()=>F(e),children:e})},t))),s.jsx("button",{className:"p-4 inline-flex items-center "+(R.currentPage===R.totalPages?"opacity-50 cursor-not-allowed":""),onClick:()=>F(R.currentPage+1),disabled:R.currentPage===R.totalPages,children:s.jsx(u,{})})]})}),s.jsx("div",{children:s.jsxs("p",{className:"font-semibold",children:[R.from," - ",R.to," de ",R.totalItems," Resultados"]})})]})]})]})]})};export{x as default};
