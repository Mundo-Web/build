import{r as e,j as s,R as a,I as t}from"./System-Bybt2Brn.js";import"./CardHoverBtn-BJnt3e8M.js";import{L as r}from"./Loading-B56-7KDx.js";import{N as l}from"./NoResult-m-3gmVGS.js";import{S as i}from"./SelectForm-ChOsm-KR.js";import"./sweetalert2.esm.all-DbJpIAEg.js";import{P as n}from"./ProductCardSimple-5sOQ9JKM.js";import{C as c}from"./chevron-down-r_B4RFE6.js";import{S as o}from"./search--TD4pUuj.js";import{C as m}from"./chevron-left-DoRUFD_L.js";import{C as d}from"./chevron-right-jU6kkjiT.js";import"./vendor-BiOv2i5T.js";import"./CartModal-Db_dBOJN.js";import"./index-Cmhjy_Bv.js";import"./index-Bx5UHif0.js";import"./CartItemRow-CLpuTcvn.js";import"./Number2Currency-DExzICY3.js";import"./tippy-react.esm-Cpb4mDDh.js";import"./proxy-BmPRG09w.js";import"./trash-2-CDXts6on.js";import"./createLucideIcon-oahCLV50.js";import"./minus-BhdGy6sP.js";import"./plus-4JHYG4O1.js";import"./index-Da4AP4wO.js";import"./eye-DJ5vw54Z.js";import"./check-BqyWwvbE.js";const u=new t,p=({items:t,data:p,filteredData:x,cart:g,setCart:f})=>{const{collections:h,categories:j,brands:b,priceRanges:y}=x,[w,N]=e.useState({collection:!0,marca:!0,precio:!0,categoria:!0,colores:!1}),[v,P]=e.useState({collection_id:[],category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort_by:"created_at",order:"desc"}),[C,_]=e.useState([]),[k,S]=e.useState(!1),[L,M]=e.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:21,from:0,to:0}),I=async(e=1)=>{S(!0);try{const s={filter:(e=>{const s=[];if(e.collection_id.length>0){const a=e.collection_id.map((e=>["collection_id","=",e]));s.push(["or",...a])}if(e.category_id.length>0){const a=e.category_id.map((e=>["category_id","=",e]));s.push(["or",...a])}if(e.subcategory_id.length>0){const a=e.subcategory_id.map((e=>["subcategory_id","=",e]));s.push(["and",...a])}if(e.brand_id.length>0){const a=e.brand_id.map((e=>["brand_id","=",e]));s.push(["or",...a])}return e.price&&s.push(["and",[["final_price",">=",e.price.min],"and",["final_price","<=",e.price.max]]]),e.name&&s.push(["name","contains",e.name]),s})(v),sort:v.sort,skip:(e-1)*L.itemsPerPage,take:L.itemsPerPage,requireTotalCount:!0},a=await u.paginate(s);_(a.data),M({currentPage:e,totalPages:Math.ceil(a.totalCount/L.itemsPerPage),totalItems:a.totalCount,itemsPerPage:L.itemsPerPage,from:(e-1)*L.itemsPerPage+1,to:Math.min(e*L.itemsPerPage,a.totalCount)})}catch(s){}finally{S(!1)}};e.useEffect((()=>{I(L.currentPage)}),[v]);const R=e=>{e>=1&&e<=L.totalPages&&I(e)},A=()=>{const e=[],s=L.totalPages,a=L.currentPage;for(let t=1;t<=s;t++)1===t||t===s||t>=a-2&&t<=a+2?e.push(t):t!==a-2-1&&t!==a+2+1||e.push("...");return e.filter(((e,s,a)=>"..."!==e||"..."!==a[s-1]))};e.useEffect((()=>{const e=new URLSearchParams(window.location.search),s=e.get("category");if(s){const e=j.find((e=>e.slug===s));e&&P((s=>({...s,category_id:[e.id]})))}const a=e.get("collection");if(a){const e=h.find((e=>e.slug===a));e&&P((s=>({...s,collection_id:[e.id]})))}const t=e.get("search");t&&P((e=>({...e,name:t})))}),[t]);const $=(e,s)=>{P((a=>{if("price"===e)return{...a,price:a.price&&a.price.min===s.min&&a.price.max===s.max?null:s};const t=Array.isArray(a[e])?a[e]:[],r=t.includes(s)?t.filter((e=>e!==s)):[...t,s];return{...a,[e]:r}}))},E=e=>{N((s=>({...s,[e]:!s[e]})))},[F,z]=e.useState(""),[B,q]=e.useState(""),[K,Z]=e.useState(""),D=h.filter((e=>e.name.toLowerCase().includes(B.toLowerCase()))),G=j.filter((e=>e.name.toLowerCase().includes(F.toLowerCase())));return b.filter((e=>e.name.toLowerCase().includes(K.toLowerCase()))),s.jsx("section",{className:"py-6  font-font-general customtext-primary",children:s.jsx("div",{className:"mx-auto px-primary",children:s.jsxs("div",{className:"relative flex flex-col sm:flex-row gap-4",children:[s.jsxs("div",{className:"w-full sm:w-1/5 bg-white p-4 rounded-lg h-max",children:[s.jsx("p",{className:"customtext-primary text-2xl font-bold pb-4 mb-4 border-b",children:"Combina como desees tu sala"}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>E("collection"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-medium",children:"Colecciones"}),s.jsx(c,{className:"h-5 w-5 transform transition-transform "+(w.collection?"":"-rotate-180")})]}),w.collection&&s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"relative",children:[s.jsx(o,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:B,onChange:e=>q(e.target.value)})]}),D.map((e=>{var a,t;const r=null==(a=v.collection_id)?void 0:a.includes(e.id);return s.jsx("div",{className:"group py-1 rounded-md "+(r?"bg-secondary":"bg-transparent"),children:s.jsxs("label",{className:"flex items-center space-x-3 ",children:[s.jsx("input",{type:"checkbox",className:"h-4 hidden w-4 rounded border-gray-300",onChange:()=>$("collection_id",e.id),checked:null==(t=v.collection_id)?void 0:t.includes(e.id)}),s.jsx("img",{src:`/storage/images/collection/${e.image}`,onError:e=>e.target.src="assets/img/noimage/no_imagen_circular.png",alt:e.name,className:"w-8 h-8 rounded-full object-cover",loading:"lazy"}),s.jsx("span",{children:e.name})]})},e.id)}))]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>E("categoria"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-medium",children:"Categorias"}),s.jsx(c,{className:"h-5 w-5 transform transition-transform "+(w.categoria?"":"-rotate-180")})]}),w.categoria&&s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"relative",children:[s.jsx(o,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:F,onChange:e=>z(e.target.value)})]}),G.map((e=>{var a,t;const r=null==(a=v.category_id)?void 0:a.includes(e.id);return s.jsx("div",{className:"group py-2 rounded-md "+(r?"bg-secondary":"bg-transparent"),children:s.jsxs("label",{className:"flex items-center space-x-3 ",children:[s.jsx("input",{type:"checkbox",className:"h-4 hidden w-4 rounded border-gray-300",onChange:()=>$("category_id",e.id),checked:null==(t=v.category_id)?void 0:t.includes(e.id)}),s.jsx("img",{src:`/storage/images/category/${e.image}`,onError:e=>e.target.src="assets/img/noimage/no_imagen_circular.png",alt:e.name,className:"w-8 h-8 rounded-full object-cover",loading:"lazy"}),s.jsx("span",{children:e.name})]})},e.id)}))]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>E("precio"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-medium",children:"Precio"}),s.jsx(c,{className:"h-5 w-5 transform transition-transform "+(w.precio?"":"-rotate-180")})]}),w.precio&&s.jsx("div",{className:"space-y-3",children:y.map((e=>s.jsxs("label",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>$("price",e),checked:v.price&&v.price.min===e.min&&v.price.max===e.max}),s.jsx("span",{children:`S/ ${e.min} - S/ ${e.max}`})]},`${e.min}-${e.max}`)))})]})]}),s.jsxs("div",{className:"w-full sm:w-4/5 py-4",children:[s.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between items-center mb-4 w-full",children:[s.jsxs("div",{className:"flex gap-4 items-center",children:[s.jsx("label",{className:"font-semibold text-sm w-[150px]",children:"Ordenar por"}),s.jsx(i,{options:[{value:"created_at:desc",label:"MÃ¡s reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],placeholder:"Recomendados",onChange:e=>{const[s,a]=e.split(":"),t=[{selector:s,desc:"desc"===a}];P((e=>({...e,sort:t})))},labelKey:"label",valueKey:"value",className:"border-primary rounded-full customtext-primary"})]}),s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsxs("div",{className:"flex justify-between items-center w-full",children:[s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[s.jsx("button",{className:"p-4 inline-flex items-center "+(1===L.currentPage?"opacity-50 cursor-not-allowed":""),onClick:()=>R(L.currentPage-1),disabled:1===L.currentPage,children:s.jsx(m,{})}),A().map(((e,t)=>s.jsx(a.Fragment,{children:"..."===e?s.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):s.jsx("button",{className:"w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 \n                                            "+(e===L.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"),onClick:()=>R(e),children:e})},t))),s.jsx("button",{className:"p-4 inline-flex items-center "+(L.currentPage===L.totalPages?"opacity-50 cursor-not-allowed":""),onClick:()=>R(L.currentPage+1),disabled:L.currentPage===L.totalPages,children:s.jsx(d,{})})]})}),s.jsx("div",{children:s.jsxs("p",{className:"font-semibold",children:[L.from," - ",L.to," ","de ",L.totalItems," ","Resultados"]})})]})})]}),k?s.jsx(r,{}):s.jsx("div",{className:"flex items-center flex-wrap gap-y-2 lg:gap-y-3 transition-all duration-300 ease-in-out",children:Array.isArray(C)&&C.length>0?C.map((e=>s.jsx(n,{product:e,widthClass:"lg:w-1/3",cart:g,setCart:f},e.id))):s.jsx(l,{})}),s.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsx("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[s.jsx("button",{className:"p-4 inline-flex items-center "+(1===L.currentPage?"opacity-50 cursor-not-allowed":""),onClick:()=>R(L.currentPage-1),disabled:1===L.currentPage,children:s.jsx(m,{})}),A().map(((e,t)=>s.jsx(a.Fragment,{children:"..."===e?s.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):s.jsx("button",{className:"w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 \n                                            "+(e===L.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"),onClick:()=>R(e),children:e})},t))),s.jsx("button",{className:"p-4 inline-flex items-center "+(L.currentPage===L.totalPages?"opacity-50 cursor-not-allowed":""),onClick:()=>R(L.currentPage+1),disabled:L.currentPage===L.totalPages,children:s.jsx(d,{})})]})})})}),s.jsx("div",{children:s.jsxs("p",{className:"font-semibold",children:[L.from," - ",L.to," de"," ",L.totalItems," Resultados"]})})]})]})]})})})};export{p as default};
