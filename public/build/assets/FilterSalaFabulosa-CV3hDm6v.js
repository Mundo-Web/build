import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as c,R as G}from"./index-BH53Isel.js";import"./ProductNavigation-CiACPlw8.js";import{I as B}from"./ItemsRest-ocZqzW34.js";import{A as le}from"./ArrayJoin-2k6ba35P.js";import{L as ae}from"./Loading-B-FwDSWi.js";import{N as ie}from"./NoResult-C9qZVva5.js";import{S as ne}from"./SelectForm-G0J6yhhv.js";import"./ProductCard-Ap6bpF1Q.js";import{i as j}from"./tippy-react.esm-BWiGTO87.js";/* empty css              */import{m as x}from"./main-BvVILmTO.js";import{F as oe}from"./filter-Ci9tsc_e.js";import{X as ce}from"./x-DBMwyD6F.js";import{C as $}from"./chevron-up-D78jyEhP.js";import{S as A}from"./search-TwiiKGP5.js";import{C as I}from"./chevron-left-B2s3ZsB7.js";import{C as V}from"./chevron-right-Ckt5D2ka.js";import"./index-yBjzXJbu.js";import"./HeaderSearch-D65n3-ej.js";import"./index-Bv81MoWS.js";import"./index-fNjTmf9T.js";import"./index-Chjiymov.js";import"./CartItemRow-D9z3pFKU.js";import"./Number2Currency-e57Tgsuk.js";import"./proxy-BTYtmp9V.js";import"./trash-2-DK1wnsDn.js";import"./createLucideIcon-Cy5Ya80P.js";import"./minus-jyhodMPN.js";import"./plus-Bot15Khs.js";import"./index-CFtDjG4d.js";import"./eye-CKCH9ORv.js";import"./BasicRest-B3rfI5GY.js";import"./index-CMHsc23u.js";import"./index-rimy3MAc.js";import"./chevron-down-DS-mdh9v.js";import"./check-DQ7QoS0v.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";const me=({product:r,setCart:o,cart:b})=>{const y=new B,[d,p]=c.useState([]),N=async n=>{try{const g={slug:n==null?void 0:n.slug,limit:999},w=await y.getVariations(g);if(!w)return;p(w.variants)}catch{return}};return c.useEffect(()=>{r!=null&&r.id&&N(r)},[r]),b==null||b.find(n=>n.id==(r==null?void 0:r.id)),(r==null?void 0:r.discount)>0?r==null||r.discount:r==null||r.price,e.jsx("div",{className:"group w-full transition-transform duration-300 hover:scale-105 flex-shrink-0 font-font-general customtext-primary cursor-pointer",children:e.jsxs("div",{className:"bg-white p-0 sm:p-4",children:[e.jsx("a",{href:`/item/${r.slug}`,children:e.jsxs("div",{className:"relative",children:[r.discount!=null&&!isNaN(r.discount)&&e.jsxs("span",{className:"absolute top-8 right-0 bg-[#F93232] text-white text-base font-bold px-2 py-1 rounded-l-full",children:["-",Math.abs(Number(100-Number((r==null?void 0:r.discount)*100/(r==null?void 0:r.price)))).toFixed(0),"%"]}),e.jsx("div",{className:"aspect-square rounded-3xl overflow-hidden flex items-center justify-center  bg-secondary border bg-white",children:e.jsx("img",{src:`/storage/images/item/${r.image}`,onError:n=>n.target.src="/assets/img/noimage/no_img.jpg",alt:r.name,className:"w-full h-full object-cover",loading:"lazy"})})]})}),e.jsxs("div",{className:"py-4",children:[e.jsx("p",{className:"text-sm sm:text-base font-normal mb-1",children:r.category.name}),e.jsxs("a",{href:`/item/${r.slug}`,children:[e.jsx("h3",{className:"text-base sm:text-lg lg:text-xl font-bold mb-2 line-clamp-2 leading-tight",children:r.name}),e.jsxs("div",{className:"hidden md:flex gap-2 sm:gap-3 items-center justify-start w-full flex-wrap py-2",children:[d.slice(0,4).map(n=>e.jsx(j,{content:n.color,children:e.jsx("a",{href:`/item/${n.slug}`,className:"variant-option rounded-full border shadow-gray-500 object-fit-cover bg-[#F5F5F5]",children:e.jsx("img",{className:"color-box rounded-full h-7 w-7 sm:h-9 sm:w-9 object-fit-cover",src:`/storage/images/item/${n.texture||n.image}`,alt:n.color,onError:g=>g.target.src="/api/cover/thumbnail/null"})})},n.slug)),d.length>4&&e.jsx(j,{content:`+${d.length-4} colores más`,children:e.jsx("a",{href:`/item/${r.slug}`,className:"variant-option rounded-full border shadow-gray-500 object-fit-cover bg-[#310619] text-white text-xs font-extrabold",children:e.jsxs("div",{className:"color-box rounded-full h-7 w-7 sm:h-9 sm:w-9 flex flex-col justify-center items-center",children:["+",d.length-4]})},r.slug)})]}),e.jsxs("div",{className:"flex md:hidden gap-2 sm:gap-3 items-center justify-start w-full flex-wrap py-2",children:[d.slice(0,3).map(n=>e.jsx(j,{content:n.color,children:e.jsx("a",{href:`/item/${n.slug}`,className:"variant-option rounded-full border shadow-gray-500  object-fit-cover bg-[#F5F5F5]",children:e.jsx("img",{className:"color-box rounded-full h-7 w-7 sm:h-9 sm:w-9 object-fit-cover",src:`/storage/images/item/${n.texture||n.image}`,alt:n.color,onError:g=>g.target.src="/api/cover/thumbnail/null"})})},n.slug)),d.length>3&&e.jsx(j,{content:`+${d.length-3} colores más`,children:e.jsx("a",{href:`/item/${r.slug}`,className:"variant-option rounded-full border shadow-gray-500 object-fit-cover bg-[#310619] text-white text-xs font-extrabold",children:e.jsxs("div",{className:"color-box rounded-full h-7 w-7 sm:h-9 sm:w-9 flex flex-col justify-center items-center",children:["+",d.length-3]})},r.slug)})]}),e.jsxs("div",{className:"flex items-baseline gap-4 mt-4",children:[e.jsxs("span",{className:"text-lg sm:text-xl md:text-2xl font-bold",children:["S/ ",r.final_price]}),r.discount!=null&&!isNaN(r.discount)&&e.jsxs("span",{className:"text-xs sm:text-base font-bold line-through opacity-60",children:["S/ ",r.price]})]})]})]})]})},r.id)},de=new B,Qe=({items:r,data:o,filteredData:b,cart:y,setCart:d})=>{const[p,N]=c.useState([]),[n,g]=c.useState([]),[w,k]=c.useState([]),[O,q]=c.useState([]),[z,K]=c.useState([]),[h,Z]=c.useState({collection:!!(o!=null&&o.collection),marca:!!(o!=null&&o.brand),precio:!0,categoria:!!(o!=null&&o.category),colores:!!(o!=null&&o.color)}),[u,F]=c.useState({collection_id:x.GET.collection?x.GET.collection.split(","):[],category_id:x.GET.category?x.GET.category.split(","):[],brand_id:x.GET.brand?x.GET.brand.split(","):[],subcategory_id:x.GET.subcategory?x.GET.subcategory.split(","):[],price:null,name:x.GET.search||null,sort_by:"created_at",order:"desc"}),[v,D]=c.useState([]),[J,E]=c.useState(!0),[a,U]=c.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:21,from:0,to:0}),X=s=>{const l=[];if(s.collection_id.length>0){const i=s.collection_id.map(t=>["collection.slug","=",t]);l.push([...i])}if(s.category_id.length>0){const i=s.category_id.map(t=>["category.slug","=",t]);l.push([...i])}if(s.subcategory_id.length>0){const i=s.subcategory_id.map(t=>["subcategory.slug","=",t]);l.push([...i])}if(s.brand_id.length>0){const i=s.brand_id.map(t=>["brand.slug","=",t]);l.push([...i])}return s.price&&l.push(["or",[["final_price",">=",s.price.min],"and",["final_price","<=",s.price.max]]]),s.name&&l.push(["name","contains",s.name]),le(l,"and")},R=async(s=1)=>{E(!0);try{const l=X(u);console.log(l);const i={filter:l,sort:u.sort,skip:(s-1)*a.itemsPerPage,take:a.itemsPerPage,requireTotalCount:!0},t=await de.paginate(i);D(t.data),U({currentPage:s,totalPages:Math.ceil(t.totalCount/a.itemsPerPage),totalItems:t.totalCount,itemsPerPage:a.itemsPerPage,from:(s-1)*a.itemsPerPage+1,to:Math.min(s*a.itemsPerPage,t.totalCount)}),console.log(t),N(t==null?void 0:t.summary.collections),g(t==null?void 0:t.summary.brands),q(t==null?void 0:t.summary.categories),k(t==null?void 0:t.summary.subcategories),K(t==null?void 0:t.summary.priceRanges)}catch(l){console.error("Error fetching products:",l)}finally{E(!1)}};c.useEffect(()=>{R(a.currentPage)},[u]);const f=s=>{s>=1&&s<=a.totalPages&&R(s)},L=()=>{const s=[],l=a.totalPages,i=a.currentPage,t=2;for(let m=1;m<=l;m++)m===1||m===l||m>=i-t&&m<=i+t?s.push(m):(m===i-t-1||m===i+t+1)&&s.push("...");return s.filter((m,_,re)=>m!=="..."||re[_-1]!=="...")},C=(s,l)=>{F(i=>{if(s==="price")return{...i,price:i.price&&i.price.min===l.min&&i.price.max===l.max?null:l};const t=Array.isArray(i[s])?i[s]:[],m=t.includes(l)?t.filter(_=>_!==l):[...t,l];return{...i,[s]:m}})},P=s=>{Z(l=>({...l,[s]:!l[s]}))},H=[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],[M,Q]=c.useState(""),[T,W]=c.useState(""),[Y,xe]=c.useState(""),ee=p==null?void 0:p.filter(s=>s.name.toLowerCase().includes(T.toLowerCase())),se=O.filter(s=>s.name.toLowerCase().includes(M.toLowerCase()));n.filter(s=>s.name.toLowerCase().includes(Y.toLowerCase()));const[te,S]=c.useState(!1);return e.jsx("section",{className:"py-6 font-font-general customtext-primary",children:e.jsxs("div",{className:"mx-auto px-primary",children:[e.jsxs("button",{onClick:()=>S(!0),className:"w-auto lg:hidden flex gap-2 items-center mb-4 p-3 bg-white rounded-lg shadow-sm",children:[e.jsx(oe,{className:"h-5 w-5"}),e.jsx("span",{className:"font-semibold",children:"Mostrar filtros"})]}),e.jsxs("div",{className:"relative flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:`${te?"fixed inset-0 z-50 bg-white flex flex-col h-screen":"hidden"} lg:block lg:w-1/4 lg:bg-white lg:p-4 lg:rounded-lg lg:h-max`,children:[e.jsxs("div",{className:"fixed top-0 left-0 right-0 bg-white p-4 border-b z-10 h-16 flex items-center justify-between lg:hidden",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Filtros"}),e.jsx("button",{onClick:()=>S(!1),children:e.jsx(ce,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 mt-16 pb-20 lg:mt-0 lg:pb-0 lg:px-0",children:[e.jsx("p",{className:"customtext-primary text-2xl font-bold pb-4 mb-4 border-b lg:block hidden",children:o==null?void 0:o.title}),(o==null?void 0:o.collection)&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>P("collection"),className:"flex items-center justify-between w-full mb-0 p-2 lg:p-0",children:[e.jsx("span",{className:"font-medium",children:"Colecciones"}),e.jsx($,{className:`h-5 w-5 transform transition-transform ${h.collection?"":"-rotate-180"}`})]}),h.collection&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative hidden md:flex",children:[e.jsx(A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full pl-10 pr-4 py-3 border rounded-xl focus:ring-0 focus:outline-0",value:T,onChange:s=>W(s.target.value)})]}),e.jsx("div",{className:"max-h-[200px] overflow-y-auto space-y-2 p-1",children:ee.map(s=>{var i;const l=(i=u.collection_id)==null?void 0:i.includes(s.slug);return e.jsx("div",{className:`group flex items-center gap-3 p-2 rounded-lg ${l?"bg-secondary":"hover:bg-gray-50"}`,children:e.jsxs("label",{className:"flex items-center gap-2 px-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-300 accent-primary hidden ",onChange:()=>C("collection_id",s.slug),checked:l}),e.jsx("img",{src:`/storage/images/collection/${s.image}`,onError:t=>t.target.src="assets/img/noimage/no_imagen_circular.png",className:"w-8 h-8 rounded-full object-cover",alt:s.name}),e.jsx("span",{className:"text-sm lg:text-base",children:s.name})]})},s.id)})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>P("categoria"),className:"flex items-center justify-between w-full mb-4 p-2 lg:p-0",children:[e.jsx("span",{className:"font-medium",children:"Categorías"}),e.jsx($,{className:`h-5 w-5 transform transition-transform ${h.categoria?"":"-rotate-180"}`})]}),h.categoria&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative hidden md:flex",children:[e.jsx(A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full pl-10 pr-4 py-3 border rounded-xl focus:ring-0 focus:outline-0",value:M,onChange:s=>Q(s.target.value)})]}),e.jsx("div",{className:"max-h-[200px] overflow-y-auto space-y-2 p-1",children:se.map(s=>{var i;const l=(i=u.category_id)==null?void 0:i.includes(s.slug);return e.jsx("div",{className:`group flex items-center gap-3 p-2 rounded-lg ${l?"bg-secondary":"hover:bg-gray-50"}`,children:e.jsxs("label",{className:"flex items-center gap-2 px-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-300 accent-primary hidden",onChange:()=>C("category_id",s.slug),checked:l}),e.jsx("img",{src:`/storage/images/category/${s.image}`,onError:t=>t.target.src="assets/img/noimage/no_imagen_circular.png",className:"w-8 h-8 rounded-full object-cover",alt:s.name}),e.jsx("span",{className:"text-sm lg:text-base",children:s.name})]})},s.id)})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>P("precio"),className:"flex items-center justify-between w-full mb-4 p-2 lg:p-0",children:[e.jsx("span",{className:"font-medium",children:"Precio"}),e.jsx($,{className:`h-5 w-5 transform transition-transform ${h.precio?"":"-rotate-180"}`})]}),h.precio&&e.jsx("div",{className:"space-y-3 p-1",children:z.map(s=>{var l,i;return e.jsxs("label",{className:"flex items-center gap-2 p-2 rounded-lg hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-300 accent-primary",onChange:()=>C("price",s),checked:((l=u.price)==null?void 0:l.min)===s.min&&((i=u.price)==null?void 0:i.max)===s.max}),e.jsx("span",{className:"text-sm lg:text-base",children:`S/ ${s.min} - S/ ${s.max}`})]},`${s.min}-${s.max}`)})})]})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t p-4 h-20 flex items-center lg:hidden",children:e.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-xl font-bold hover:bg-primary-dark transition-colors",onClick:()=>S(!1),children:"Ver resultados"})})]}),e.jsxs("div",{className:"w-full sm:w-3/4 py-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between items-center mb-4 w-full",children:[e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsx("label",{className:"font-semibold text-sm w-[150px]",children:"Ordenar por"}),e.jsx(ne,{options:H,placeholder:"Recomendados",onChange:s=>{const[l,i]=s.split(":"),t=[{selector:l,desc:i==="desc"}];F(m=>({...m,sort:t}))},labelKey:"label",valueKey:"value",className:"border-primary rounded-full customtext-primary"})]}),e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[e.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>f(a.currentPage-1),disabled:a.currentPage===1,children:e.jsx(I,{})}),L().map((s,l)=>e.jsx(G.Fragment,{children:s==="..."?e.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):e.jsx("button",{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                                            ${s===a.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>f(s),children:s})},l)),e.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===a.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>f(a.currentPage+1),disabled:a.currentPage===a.totalPages,children:e.jsx(V,{})})]})}),e.jsx("div",{children:e.jsxs("p",{className:"font-semibold",children:[a.from," - ",a.to," ","de ",a.totalItems," ","Resultados"]})})]})})]}),J?e.jsx(ae,{}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 gap-y-2 lg:gap-y-3 transition-all duration-300 ease-in-out",children:Array.isArray(v)&&v.length>0?v.map(s=>e.jsx(me,{product:s,widthClass:"lg:w-1/3",cart:y,setCart:d},s.id)):e.jsx(ie,{})}),e.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsx("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[e.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>f(a.currentPage-1),disabled:a.currentPage===1,children:e.jsx(I,{})}),L().map((s,l)=>e.jsx(G.Fragment,{children:s==="..."?e.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):e.jsx("button",{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                                            ${s===a.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>f(s),children:s})},l)),e.jsx("button",{className:`p-4 inline-flex items-center ${a.currentPage===a.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>f(a.currentPage+1),disabled:a.currentPage===a.totalPages,children:e.jsx(V,{})})]})})})}),e.jsx("div",{children:e.jsxs("p",{className:"font-semibold",children:[a.from," - ",a.to," de"," ",a.totalItems," Resultados"]})})]})]})]})]})})};export{Qe as default};
