import{r as e,j as a,D as s,bg as r}from"./vendor-react-DD0uBW7s.js";import{S as t}from"./CartKuchara-BG_NtHiU.js";import{e as i}from"./es-ClO7yDf1.js";import"./vendor-swiper-BQwfPLwm.js";const l=({room:l,searchParams:c,cart:n,setCart:o})=>{const[d,m]=e.useState(c?.check_in?new Date(c.check_in):null),[x,h]=e.useState(c?.check_out?new Date(c.check_out):null),[p,g]=e.useState(c?.guests||2),[u,b]=e.useState(!1),[f,j]=e.useState(null),[y,N]=e.useState(0),v=d&&x?Math.ceil((x-d)/864e5):0;e.useEffect(()=>{d&&x&&w()},[d,x]);const w=async()=>{try{const e=await fetch(`/api/hotels/rooms/${l.id}/availability`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({check_in:d.toISOString().split("T")[0],check_out:x.toISOString().split("T")[0]})}),a=await e.json();200===a.status&&j(a.data)}catch(e){}},_=[{url:l.image?`/api/items/media/${l.image}`:"/images/placeholder-room.jpg",alt:l.name}];return l.images&&l.images.length>0&&l.images.forEach(e=>{_.push({url:`/api/items/media/${e.url}`,alt:`${l.name} - Imagen ${_.length}`})}),a.jsxs("div",{className:"py-8 px-[5%] replace-max-w-here mx-auto",children:[a.jsx("nav",{className:"mb-6","aria-label":"breadcrumb",children:a.jsxs("ol",{className:"flex flex-wrap items-center gap-2 text-sm",children:[a.jsx("li",{children:a.jsx("a",{href:"/",className:"text-gray-600 hover:text-primary transition-colors",children:"Inicio"})}),a.jsx("li",{className:"text-gray-400",children:"/"}),a.jsx("li",{children:a.jsx("a",{href:"/habitaciones",className:"text-gray-600 hover:text-primary transition-colors",children:"Habitaciones"})}),a.jsx("li",{className:"text-gray-400",children:"/"}),a.jsx("li",{className:"text-gray-900 font-medium",children:l.name})]})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"lg:col-span-2",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[a.jsxs("div",{className:"relative h-[500px]",children:[a.jsx("img",{src:_[y].url,alt:_[y].alt,className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute top-4 left-4",children:a.jsx("span",{className:"inline-block px-4 py-2 bg-primary text-white rounded-full text-sm font-semibold shadow-lg",children:{standard:"Estándar",suite:"Suite",deluxe:"Deluxe",presidential:"Presidencial",family:"Familiar",executive:"Ejecutiva"}[l.room_type]||l.room_type})}),l.discount>0&&a.jsx("div",{className:"absolute top-4 right-4",children:a.jsxs("span",{className:"inline-block px-4 py-2 bg-red-600 text-white rounded-full text-sm font-bold shadow-lg",children:["-",l.discount_percent,"%"]})})]}),_.length>1&&a.jsx("div",{className:"p-4",children:a.jsx("div",{className:"flex gap-2 overflow-x-auto",children:_.map((e,s)=>a.jsx("button",{className:"flex-shrink-0 w-24 h-20 rounded-lg overflow-hidden border-2 transition-all "+(y===s?"border-primary shadow-md":"border-gray-200 hover:border-gray-300"),onClick:()=>N(s),children:a.jsx("img",{src:e.url,alt:e.alt,className:"w-full h-full object-cover"})},s))})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mt-6",children:[a.jsx("h3",{className:"text-2xl font-bold mb-4 text-gray-900",children:"Descripción"}),l.summary&&a.jsx("p",{className:"text-lg text-gray-600 mb-4",children:l.summary}),l.description&&a.jsx("div",{className:"prose max-w-none text-gray-700",dangerouslySetInnerHTML:{__html:l.description}})]}),l.amenities&&l.amenities.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mt-6",children:[a.jsx("h3",{className:"text-2xl font-bold mb-4 text-gray-900",children:"Amenidades"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.amenities.map(e=>a.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[a.jsx("i",{className:`${e.icon||"fas fa-check-circle"} text-green-600 text-xl`}),a.jsx("span",{className:"font-medium",children:e.name})]},e.id))})]})]}),a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 sticky top-5",children:[a.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-900",children:l.name}),a.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 pb-4 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center text-gray-600",children:[a.jsx("i",{className:"fas fa-users mr-2 text-primary"}),a.jsxs("span",{className:"text-sm",children:[l.max_occupancy," personas"]})]}),a.jsxs("div",{className:"flex items-center text-gray-600",children:[a.jsx("i",{className:"fas fa-bed mr-2 text-green-600"}),a.jsxs("span",{className:"text-sm",children:[l.beds_count," cama",1!==l.beds_count?"s":""]})]}),l.size_m2>0&&a.jsxs("div",{className:"flex items-center text-gray-600",children:[a.jsx("i",{className:"fas fa-ruler-square mr-2 text-blue-600"}),a.jsxs("span",{className:"text-sm",children:[l.size_m2," m²"]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-baseline gap-2 mb-2",children:[l.discount>0&&a.jsxs("span",{className:"text-xl line-through text-gray-400",children:["S/ ",l.price?.toFixed(2)]}),a.jsxs("span",{className:"text-4xl font-bold text-primary",children:["S/ ",l.final_price?.toFixed(2)]}),a.jsx("span",{className:"text-gray-600",children:"/ noche"})]}),f&&v>0&&a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:a.jsxs("p",{className:"text-blue-900",children:[a.jsxs("strong",{children:["Total: S/ ",f.total_price?.toFixed(2)]})," ","por ",v," noche",1!==v?"s":""]})})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[a.jsx("i",{className:"fas fa-calendar-check mr-2 text-green-600"}),"Check-in"]}),a.jsx(s,{selected:d,onChange:e=>{if(m(e),x&&x<=e){const a=new Date(e);a.setDate(a.getDate()+1),h(a)}},minDate:new Date,dateFormat:"dd/MM/yyyy",locale:i,placeholderText:"Selecciona fecha",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[a.jsx("i",{className:"fas fa-calendar-times mr-2 text-red-600"}),"Check-out"]}),a.jsx(s,{selected:x,onChange:h,minDate:d||new Date,dateFormat:"dd/MM/yyyy",locale:i,placeholderText:"Selecciona fecha",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[a.jsx("i",{className:"fas fa-users mr-2 text-blue-600"}),"Huéspedes"]}),a.jsx("select",{className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",value:p,onChange:e=>g(parseInt(e.target.value)),children:[...Array(l.max_occupancy)].map((e,s)=>a.jsxs("option",{value:s+1,children:[s+1," ",s+1===1?"huésped":"huéspedes"]},s+1))})]}),f&&a.jsxs("div",{className:"rounded-lg p-3 mb-4 "+(f.available?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:[a.jsx("i",{className:`fas ${f.available?"fa-check-circle text-green-600":"fa-times-circle text-red-600"} mr-2`}),a.jsx("span",{className:f.available?"text-green-800":"text-red-800",children:f.available?`${f.available_rooms} habitación(es) disponible(s)`:"No disponible para estas fechas"})]}),a.jsx("button",{className:"w-full py-3 px-6 rounded-lg font-semibold text-white transition-all "+(u||!d||!x||f&&!f.available?"bg-gray-400 cursor-not-allowed":"bg-primary hover:bg-primary-dark shadow-lg hover:shadow-xl"),onClick:async()=>{if(d&&x)if(f?.available){b(!0);try{if(n.find(e=>"booking"===e.type&&e.id===l.id&&e.check_in===d.toISOString().split("T")[0]&&e.check_out===x.toISOString().split("T")[0]))return t.fire({icon:"info",title:"Ya en el carrito",text:"Esta reserva ya está en tu carrito",confirmButtonText:"Ir al carrito",showCancelButton:!0,cancelButtonText:"Continuar viendo"}).then(e=>{e.isConfirmed&&r.visit("/carrito")}),void b(!1);const e={id:l.id,type:"booking",name:l.name,image:l.image,price:f.price_per_night||l.final_price,final_price:f.price_per_night||l.final_price,discount:l.discount||0,check_in:d.toISOString().split("T")[0],check_out:x.toISOString().split("T")[0],nights:v,guests:p,max_occupancy:l.max_occupancy,beds_count:l.beds_count,room_type:l.room_type,amenities:l.amenities||[],quantity:1,total_price:f.total_price},a=[...n,e];o(a),await t.fire({icon:"success",title:"¡Agregado al carrito!",html:`\n                    <p class="mb-2">La reserva ha sido agregada al carrito</p>\n                    <p class="text-sm text-gray-600">\n                        ${l.name}<br/>\n                        ${v} noche${1!==v?"s":""} - ${p} huésped${1!==p?"es":""}<br/>\n                        <strong>S/ ${f.total_price.toFixed(2)}</strong>\n                    </p>\n                `,confirmButtonText:"Ir al carrito",showCancelButton:!0,cancelButtonText:"Continuar viendo"}).then(e=>{e.isConfirmed&&r.visit("/carrito")})}catch(e){t.fire({icon:"error",title:"Error",text:e.message||"Ocurrió un error al procesar la reserva"})}finally{b(!1)}}else t.fire({icon:"error",title:"No disponible",text:"Esta habitación no está disponible para las fechas seleccionadas"});else t.fire({icon:"warning",title:"Fechas requeridas",text:"Por favor selecciona las fechas de check-in y check-out"})},disabled:u||!d||!x||f&&!f.available,children:u?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Procesando..."]}):a.jsxs(a.Fragment,{children:[a.jsx("i",{className:"fas fa-calendar-check mr-2"}),"Reservar Ahora"]})}),a.jsxs("p",{className:"text-gray-600 text-center text-xs mt-3",children:[a.jsx("i",{className:"fas fa-shield-alt mr-1"}),"Reserva segura - Cancela hasta 24h antes"]})]})})]})]})};export{l as default};
