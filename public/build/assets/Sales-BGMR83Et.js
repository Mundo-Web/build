var k=Object.defineProperty;var E=(i,r,l)=>r in i?k(i,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[r]=l;var v=(i,r,l)=>E(i,typeof r!="symbol"?r+"":r,l);import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as h}from"./index-BH53Isel.js";import{c as B}from"./ReactAppend-DTVVXReZ.js";import{B as A}from"./Base-CkYSVkcX.js";import{C as D}from"./CreateReactScript-H8Uf0Xeb.js";import{T as F}from"./Table-CP679pea.js";import{D as S}from"./DxButton-CsjWvhyj.js";import{R as P}from"./ReactAppend-D7S498fx.js";import{S as O}from"./ProductCard-C2H10lUi.js";import{B as W}from"./ModalImportItem-BAoaR7zQ.js";import{G as C}from"./Global-CklCDfn9.js";import{N as c}from"./Number2Currency-e57Tgsuk.js";import{M as q}from"./Modal-CIqmjseY.js";import{i as G}from"./tippy-react.esm-BWiGTO87.js";import"./main-BSEyQEJW.js";import"./index-yBjzXJbu.js";import"./index-fNjTmf9T.js";/* empty css              */import"./Logout-CGCqvje3.js";import"./MenuItemContainer-BkmzVQNY.js";import"./index.esm-BE8-iLxT.js";import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";/* empty css               */import"./General-BmbBKdsB.js";import"./LaravelSession-Dz9cpV3l.js";import"./index-rimy3MAc.js";class V extends W{constructor(){super(...arguments);v(this,"path","admin/sales")}}const u=new V,z=({statuses:i=[]})=>{var j,b,f,N,y,g,w;const r=h.useRef(),l=h.useRef(),[t,_]=h.useState(null),[I,M]=h.useState([]),R=async s=>{const{isConfirmed:n}=await O.fire({title:"Anular pedido",text:"¿Estas seguro de anular este pedido?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, anular",cancelButtonText:"Cancelar"});!n||!await u.delete(s)||$(r.current).dxDataGrid("instance").refresh()},p=async s=>{const n=await u.get(s);n&&n.data?(_(n.data),$(l.current).modal("show")):console.error("No se recibieron datos válidos:",n)},T=Number((t==null?void 0:t.amount)??0)+Number((t==null?void 0:t.delivery)??0)-Number((t==null?void 0:t.bundle_discount)??0)-Number((t==null?void 0:t.renewal_discount)??0)-Number((t==null?void 0:t.coupon_discount)??0);return e.jsxs(e.Fragment,{children:[e.jsx(F,{gridRef:r,title:"Pedidos",rest:u,toolBar:s=>{s.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(r.current).dxDataGrid("instance").refresh()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"name",caption:"Orden",width:"250px",cellTemplate:(s,{data:n})=>{s.css("cursor","pointer"),s.on("click",()=>{p(n.id)}),P(s,e.jsxs("p",{className:"mb-0",style:{width:"100%"},children:[e.jsxs("b",{className:"d-block",children:[n.name," ",n.lastname]}),e.jsxs("small",{className:"text-nowrap text-muted",style:{overflow:"hidden",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,fontFamily:"monospace"},children:["#",C.APP_CORRELATIVE,"-",n.code]})]}))}},{dataField:"created_at",caption:"Fecha",dataType:"date",sortOrder:"desc",cellTemplate:(s,{data:n})=>{s.text(moment(n.created_at).fromNow())}},{dataField:"payment_status",caption:"Estado de Pago",dataType:"string",sortOrder:"desc",cellTemplate:(s,{data:n})=>{s.text(n.payment_status)}},{dataField:"amount",caption:"Total",dataType:"number",cellTemplate:(s,{data:n})=>{const m=Number(n.amount)||0,x=Number(n.delivery)||0,o=Number(n.bundle_discount)||0,a=Number(n.renewal_discount)||0,d=Number(n.coupon_discount)||0;s.text(`S/. ${c(m+x-o-a-d)}`)}},{caption:"Acciones",cellTemplate:(s,{data:n})=>{s.append(S({className:"btn btn-xs btn-light",title:"Ver pedido",icon:"fa fa-eye",onClick:()=>p(n.id)})),s.append(S({className:"btn btn-xs btn-soft-danger",title:"Anular pedido",icon:"fa fa-trash",onClick:()=>R(n.id)}))},allowFiltering:!1,allowExporting:!1}]}),e.jsx(q,{modalRef:l,title:t?`Detalles del pedido #${C.APP_CORRELATIVE}-${t.code}`:"Cargando...",size:"lg",bodyStyle:{backgroundColor:"#ebeff2"},hideButtonSubmit:!0,children:t?e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-md-8",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header p-2",children:e.jsx("h5",{className:"card-title mb-0",children:"Detalles de Venta"})}),e.jsx("div",{className:"card-body p-2",children:e.jsx("table",{className:"table table-borderless table-sm mb-0",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:"Nombres:"}),e.jsxs("td",{children:[t==null?void 0:t.name," ",t==null?void 0:t.lastname]})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Email:"}),e.jsx("td",{children:t==null?void 0:t.email})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Dirección:"}),e.jsxs("td",{children:[t==null?void 0:t.address," ",t==null?void 0:t.number,e.jsxs("small",{className:"text-muted d-block",children:[(t==null?void 0:t.province)??(t==null?void 0:t.district),", ",t==null?void 0:t.department,", ",t==null?void 0:t.country," ",(t==null?void 0:t.zip_code)&&e.jsxs(e.Fragment,{children:["- ",t==null?void 0:t.zip_code]})]})]})]}),(t==null?void 0:t.reference)&&e.jsxs("tr",{children:[e.jsx("th",{children:"Referencia:"}),e.jsx("td",{children:t==null?void 0:t.reference})]}),(t==null?void 0:t.comment)&&e.jsxs("tr",{children:[e.jsx("th",{children:"Comentario:"}),e.jsx("td",{children:t==null?void 0:t.comment})]})]})})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header p-2",children:e.jsx("h5",{className:"card-title mb-0",children:"Artículos"})}),e.jsx("div",{className:"card-body p-2 table-responsive",children:e.jsxs("table",{className:"table table-striped table-bordered table-sm table-hover mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Colores"}),e.jsx("th",{children:"Precio"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Subtotal"})]})}),e.jsx("tbody",{children:(j=t==null?void 0:t.details)==null?void 0:j.map((s,n)=>{var o;const m=s.quantity*100/100,x=s.price*s.quantity;return e.jsxs("tr",{children:[e.jsx("td",{children:s.name}),e.jsx("td",{children:(o=s==null?void 0:s.colors)==null?void 0:o.map((a,d)=>e.jsx(G,{content:a.name,children:e.jsx("i",{className:"mdi mdi-circle",style:{color:a.hex,WebkitTextStroke:"1px #808080"}})},d))}),e.jsxs("td",{align:"right",children:["S/",c(s.price)]}),e.jsx("td",{align:"center",children:m}),e.jsxs("td",{align:"right",children:["S/",c(x)]})]},n)})})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header p-2",children:e.jsx("h5",{className:"card-title mb-0",children:"Resumen"})}),e.jsxs("div",{className:"card-body p-2",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("b",{children:"Subtotal:"}),e.jsxs("span",{children:["S/ ",c(t==null?void 0:t.amount)]})]}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("b",{children:"Envío:"}),e.jsxs("span",{children:["S/ ",c(t==null?void 0:t.delivery)]})]}),(t==null?void 0:t.bundle)&&e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("b",{children:["Descuento x paquete:",e.jsxs("small",{className:"d-block text-muted",style:{fontWeight:"lighter"},children:["Elegiste ",(b=t==null?void 0:t.bundle)==null?void 0:b.name," (-",((f=t==null?void 0:t.bundle)==null?void 0:f.percentage)*1e4/100,"%)"]})]}),e.jsxs("span",{children:["S/ -",c(t==null?void 0:t.bundle_discount)]})]}),(t==null?void 0:t.renewal)&&e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("b",{children:["Subscripción:",e.jsxs("small",{className:"d-block text-muted",style:{fontWeight:"lighter"},children:[(N=t==null?void 0:t.renewal)==null?void 0:N.name," (-",((y=t==null?void 0:t.renewal)==null?void 0:y.percentage)*1e4/100,"%)"]})]}),e.jsxs("span",{children:["S/ -",c(t==null?void 0:t.renewal_discount)]})]}),(t==null?void 0:t.coupon)&&e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("b",{children:["Cupón aplicado:",e.jsxs("small",{className:"d-block text-muted",style:{fontWeight:"lighter"},children:[(g=t==null?void 0:t.coupon)==null?void 0:g.name," (-",((w=t==null?void 0:t.coupon)==null?void 0:w.amount)*100/100,"%)"]})]}),e.jsxs("span",{children:["S/ -",c(t==null?void 0:t.coupon_discount)]})]}),e.jsx("hr",{className:"my-2"}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("b",{children:"Total:"}),e.jsx("span",{children:e.jsxs("strong",{children:["S/ ",c(T)]})})]})]})]})]})}):e.jsx("div",{className:"text-center p-4",children:"Cargando detalles del pedido..."})})]})};D((i,r)=>{B.createRoot(i).render(e.jsx(A,{...r,title:"Pedidos",children:e.jsx(z,{...r})}))});
