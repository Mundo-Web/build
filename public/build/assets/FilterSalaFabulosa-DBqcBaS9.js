import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as o,R as v}from"./index-BH53Isel.js";import"./ProductNavigation-C7r2azx3.js";import{I as W}from"./ItemsRest-DBSKIEqF.js";import{A as Y}from"./ArrayJoin-2k6ba35P.js";import{L as ee}from"./Loading-B-FwDSWi.js";import{N as se}from"./NoResult-C9qZVva5.js";import{S as te}from"./SelectForm-G0J6yhhv.js";import"./ProductCard-C2H10lUi.js";import{P as ae}from"./ProductCardColors-BVYYz9f3.js";import{m as n}from"./main-BSEyQEJW.js";import{F as re}from"./filter-Ci9tsc_e.js";import{X as le}from"./x-DBMwyD6F.js";import{C as b}from"./chevron-up-D78jyEhP.js";import{S}from"./search-TwiiKGP5.js";import{C as _}from"./chevron-left-B2s3ZsB7.js";import{C as k}from"./chevron-right-Ckt5D2ka.js";import"./index-yBjzXJbu.js";import"./HeaderSearch-DLU9BXLK.js";import"./PaymentModal-BB1JXzaZ.js";import"./index-fNjTmf9T.js";import"./index-Chjiymov.js";import"./CartItemRow-BhtCHp_j.js";import"./tippy-react.esm-BWiGTO87.js";import"./index-rimy3MAc.js";import"./Number2Currency-e57Tgsuk.js";import"./minus-jyhodMPN.js";import"./createLucideIcon-Cy5Ya80P.js";import"./plus-Bot15Khs.js";import"./BasicRest-DEv02zgs.js";import"./chevron-down-DS-mdh9v.js";import"./check-DQ7QoS0v.js";/* empty css              */import"./___vite-browser-external_commonjs-proxy-0zb4Agf2.js";const ie=new W,De=({items:oe,data:ne,filteredData:ce,cart:$,setCart:E})=>{const[u,F]=o.useState([]),[R,L]=o.useState([]),[me,T]=o.useState([]),[G,M]=o.useState([]),[A,I]=o.useState([]),[m,B]=o.useState({collection:!0,marca:!0,precio:!0,categoria:!0,colores:!1}),[c,j]=o.useState({collection_id:n.GET.collection?n.GET.collection.split(","):[],category_id:n.GET.category?n.GET.category.split(","):[],brand_id:n.GET.brand?n.GET.brand.split(","):[],subcategory_id:n.GET.subcategory?n.GET.subcategory.split(","):[],price:null,name:n.GET.search||null,sort_by:"created_at",order:"desc"}),[p,O]=o.useState([]),[V,y]=o.useState(!0),[r,z]=o.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:21,from:0,to:0}),K=s=>{const a=[];if(s.collection_id.length>0){const l=s.collection_id.map(t=>["collection.slug","=",t]);a.push([...l])}if(s.category_id.length>0){const l=s.category_id.map(t=>["category.slug","=",t]);a.push([...l])}if(s.subcategory_id.length>0){const l=s.subcategory_id.map(t=>["subcategory.slug","=",t]);a.push([...l])}if(s.brand_id.length>0){const l=s.brand_id.map(t=>["brand.slug","=",t]);a.push([...l])}return s.price&&a.push(["or",[["final_price",">=",s.price.min],"and",["final_price","<=",s.price.max]]]),s.name&&a.push(["name","contains",s.name]),Y(a,"and")},N=async(s=1)=>{y(!0);try{const a=K(c);console.log(a);const l={filter:a,sort:c.sort,skip:(s-1)*r.itemsPerPage,take:r.itemsPerPage,requireTotalCount:!0},t=await ie.paginate(l);O(t.data),z({currentPage:s,totalPages:Math.ceil(t.totalCount/r.itemsPerPage),totalItems:t.totalCount,itemsPerPage:r.itemsPerPage,from:(s-1)*r.itemsPerPage+1,to:Math.min(s*r.itemsPerPage,t.totalCount)}),console.log(t),F(t==null?void 0:t.summary.collections),L(t==null?void 0:t.summary.brands),M(t==null?void 0:t.summary.categories),T(t==null?void 0:t.summary.subcategories),I(t==null?void 0:t.summary.priceRanges)}catch(a){console.error("Error fetching products:",a)}finally{y(!1)}};o.useEffect(()=>{N(r.currentPage)},[c]);const d=s=>{s>=1&&s<=r.totalPages&&N(s)},w=()=>{const s=[],a=r.totalPages,l=r.currentPage,t=2;for(let i=1;i<=a;i++)i===1||i===a||i>=l-t&&i<=l+t?s.push(i):(i===l-t-1||i===l+t+1)&&s.push("...");return s.filter((i,f,Q)=>i!=="..."||Q[f-1]!=="...")},x=(s,a)=>{j(l=>{if(s==="price")return{...l,price:l.price&&l.price.min===a.min&&l.price.max===a.max?null:a};const t=Array.isArray(l[s])?l[s]:[],i=t.includes(a)?t.filter(f=>f!==a):[...t,a];return{...l,[s]:i}})},g=s=>{B(a=>({...a,[s]:!a[s]}))},Z=[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],[C,q]=o.useState(""),[P,D]=o.useState(""),[J,de]=o.useState(""),U=u==null?void 0:u.filter(s=>s.name.toLowerCase().includes(P.toLowerCase())),X=G.filter(s=>s.name.toLowerCase().includes(C.toLowerCase()));R.filter(s=>s.name.toLowerCase().includes(J.toLowerCase()));const[H,h]=o.useState(!1);return e.jsx("section",{className:"py-6 font-font-general customtext-primary",children:e.jsxs("div",{className:"mx-auto px-primary",children:[e.jsxs("button",{onClick:()=>h(!0),className:"w-auto lg:hidden flex gap-2 items-center mb-4 p-3 bg-white rounded-lg shadow-sm",children:[e.jsx(re,{className:"h-5 w-5"}),e.jsx("span",{className:"font-semibold",children:"Mostrar filtros"})]}),e.jsxs("div",{className:"relative flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:`${H?"fixed inset-0 z-50 bg-white flex flex-col h-screen":"hidden"} lg:block lg:w-1/4 lg:bg-white lg:p-4 lg:rounded-lg lg:h-max`,children:[e.jsxs("div",{className:"fixed top-0 left-0 right-0 bg-white p-4 border-b z-10 h-16 flex items-center justify-between lg:hidden",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Filtros"}),e.jsx("button",{onClick:()=>h(!1),children:e.jsx(le,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 mt-16 pb-20 lg:mt-0 lg:pb-0 lg:px-0",children:[e.jsx("p",{className:"customtext-primary text-2xl font-bold pb-4 mb-4 border-b lg:block hidden",children:"Combina como desees tu sala"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>g("collection"),className:"flex items-center justify-between w-full mb-0 p-2 lg:p-0",children:[e.jsx("span",{className:"font-medium",children:"Colecciones"}),e.jsx(b,{className:`h-5 w-5 transform transition-transform ${m.collection?"":"-rotate-180"}`})]}),m.collection&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative hidden md:flex",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full pl-10 pr-4 py-3 border rounded-xl focus:ring-0 focus:outline-0",value:P,onChange:s=>D(s.target.value)})]}),e.jsx("div",{className:"max-h-[200px] overflow-y-auto space-y-2 p-1",children:U.map(s=>{var l;const a=(l=c.collection_id)==null?void 0:l.includes(s.slug);return e.jsx("div",{className:`group flex items-center gap-3 p-2 rounded-lg ${a?"bg-secondary":"hover:bg-gray-50"}`,children:e.jsxs("label",{className:"flex items-center gap-2 px-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-300 accent-primary hidden ",onChange:()=>x("collection_id",s.slug),checked:a}),e.jsx("img",{src:`/storage/images/collection/${s.image}`,onError:t=>t.target.src="assets/img/noimage/no_imagen_circular.png",className:"w-8 h-8 rounded-full object-cover",alt:s.name}),e.jsx("span",{className:"text-sm lg:text-base",children:s.name})]})},s.id)})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>g("categoria"),className:"flex items-center justify-between w-full mb-4 p-2 lg:p-0",children:[e.jsx("span",{className:"font-medium",children:"Categorías"}),e.jsx(b,{className:`h-5 w-5 transform transition-transform ${m.categoria?"":"-rotate-180"}`})]}),m.categoria&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative hidden md:flex",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full pl-10 pr-4 py-3 border rounded-xl focus:ring-0 focus:outline-0",value:C,onChange:s=>q(s.target.value)})]}),e.jsx("div",{className:"max-h-[200px] overflow-y-auto space-y-2 p-1",children:X.map(s=>{var l;const a=(l=c.category_id)==null?void 0:l.includes(s.slug);return e.jsx("div",{className:`group flex items-center gap-3 p-2 rounded-lg ${a?"bg-secondary":"hover:bg-gray-50"}`,children:e.jsxs("label",{className:"flex items-center gap-2 px-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-300 accent-primary hidden",onChange:()=>x("category_id",s.slug),checked:a}),e.jsx("img",{src:`/storage/images/category/${s.image}`,onError:t=>t.target.src="assets/img/noimage/no_imagen_circular.png",className:"w-8 h-8 rounded-full object-cover",alt:s.name}),e.jsx("span",{className:"text-sm lg:text-base",children:s.name})]})},s.id)})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>g("precio"),className:"flex items-center justify-between w-full mb-4 p-2 lg:p-0",children:[e.jsx("span",{className:"font-medium",children:"Precio"}),e.jsx(b,{className:`h-5 w-5 transform transition-transform ${m.precio?"":"-rotate-180"}`})]}),m.precio&&e.jsx("div",{className:"space-y-3 p-1",children:A.map(s=>{var a,l;return e.jsxs("label",{className:"flex items-center gap-2 p-2 rounded-lg hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",className:"h-5 w-5 rounded border-gray-300 accent-primary",onChange:()=>x("price",s),checked:((a=c.price)==null?void 0:a.min)===s.min&&((l=c.price)==null?void 0:l.max)===s.max}),e.jsx("span",{className:"text-sm lg:text-base",children:`S/ ${s.min} - S/ ${s.max}`})]},`${s.min}-${s.max}`)})})]})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t p-4 h-20 flex items-center lg:hidden",children:e.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-xl font-bold hover:bg-primary-dark transition-colors",onClick:()=>h(!1),children:"Ver resultados"})})]}),e.jsxs("div",{className:"w-full sm:w-3/4 py-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between items-center mb-4 w-full",children:[e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsx("label",{className:"font-semibold text-sm w-[150px]",children:"Ordenar por"}),e.jsx(te,{options:Z,placeholder:"Recomendados",onChange:s=>{const[a,l]=s.split(":"),t=[{selector:a,desc:l==="desc"}];j(i=>({...i,sort:t}))},labelKey:"label",valueKey:"value",className:"border-primary rounded-full customtext-primary"})]}),e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[e.jsx("button",{className:`p-4 inline-flex items-center ${r.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>d(r.currentPage-1),disabled:r.currentPage===1,children:e.jsx(_,{})}),w().map((s,a)=>e.jsx(v.Fragment,{children:s==="..."?e.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):e.jsx("button",{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                                            ${s===r.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>d(s),children:s})},a)),e.jsx("button",{className:`p-4 inline-flex items-center ${r.currentPage===r.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>d(r.currentPage+1),disabled:r.currentPage===r.totalPages,children:e.jsx(k,{})})]})}),e.jsx("div",{children:e.jsxs("p",{className:"font-semibold",children:[r.from," - ",r.to," ","de ",r.totalItems," ","Resultados"]})})]})})]}),V?e.jsx(ee,{}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 gap-y-2 lg:gap-y-3 transition-all duration-300 ease-in-out",children:Array.isArray(p)&&p.length>0?p.map(s=>e.jsx(ae,{product:s,widthClass:"lg:w-1/3",cart:$,setCart:E},s.id)):e.jsx(se,{})}),e.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsx("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:e.jsx("div",{className:"customtext-primary font-semibold",children:e.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[e.jsx("button",{className:`p-4 inline-flex items-center ${r.currentPage===1?"opacity-50 cursor-not-allowed":""}`,onClick:()=>d(r.currentPage-1),disabled:r.currentPage===1,children:e.jsx(_,{})}),w().map((s,a)=>e.jsx(v.Fragment,{children:s==="..."?e.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):e.jsx("button",{className:`w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 
                                            ${s===r.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"}`,onClick:()=>d(s),children:s})},a)),e.jsx("button",{className:`p-4 inline-flex items-center ${r.currentPage===r.totalPages?"opacity-50 cursor-not-allowed":""}`,onClick:()=>d(r.currentPage+1),disabled:r.currentPage===r.totalPages,children:e.jsx(k,{})})]})})})}),e.jsx("div",{children:e.jsxs("p",{className:"font-semibold",children:[r.from," - ",r.to," de"," ",r.totalItems," Resultados"]})})]})]})]})]})})};export{De as default};
