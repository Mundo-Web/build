var me=Object.defineProperty;var ye=(n,t,s)=>t in n?me(n,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[t]=s;var V=(n,t,s)=>ye(n,typeof t!="symbol"?t+"":t,s);import{c as B}from"./createLucideIcon-DfjclApS.js";import{j as a}from"./AboutSimple-Cf8x2fCZ.js";import{r as d}from"./index-BOnQTV8N.js";import{S as g}from"./sparkles-DvmvZ6mJ.js";import{C as k}from"./Number2Currency-D9Rjvh76.js";import{P as ge}from"./package-DBFPPBi1.js";import{M as be}from"./minus-Db6MFKEO.js";import{P as ve}from"./plus-CTIomuuF.js";import{T as je}from"./trash-2-DU7LB6-f.js";import{a as Ne}from"./index-BQJyKPGC.js";import{X as we}from"./x-fof_H3Vv.js";import{a as _e,b as f,h as Se,c as E,d as ke,u as Ce,S as Oe,_ as Ae}from"./useStateManager-7e1e8489.esm-JZ1pGKcX.js";import"./index-pSueRYGM.js";import{m as q}from"./main-B6F2O9-U.js";import"./CardProductKatya-ncpmQ0JU.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=B("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=B("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=B("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Ze=({children:n,className:t="",loading:s=!1,disabled:r=!1,...e})=>a.jsxs("button",{type:"button",disabled:r||s,className:`w-full bg-primary font-bold  py-3 px-4 hover:opacity-90 hover:shadow-md transition-all duration-300 focus:outline-none active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed rounded-xl flex items-center justify-center gap-2 ${t}`,...e,children:[s&&a.jsx(Pe,{className:"w-4 h-4 animate-spin"}),n]}),ea=({children:n,className:t="",...s})=>a.jsx("a",{className:`w-full block border-primary cursor-pointer border-2 text-center font-bold customtext-primary py-3 px-4  hover:opacity-90 hover:shadow-md transition-all duration-300 focus:outline-none active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed rounded-xl ${t}`,...s,children:n});function Ee({onClick:n,className:t=""}){return a.jsxs("div",{className:`relative ${t}`,children:[a.jsx(g,{size:12,className:"absolute -top-1 -left-1 text-yellow-400 animate-ping",style:{animationDelay:"0s"}}),a.jsx(g,{size:10,className:"absolute -top-2 -right-1 text-pink-400 animate-ping",style:{animationDelay:"0.5s"}}),a.jsx(g,{size:8,className:"absolute -bottom-1 -left-2 text-blue-400 animate-ping",style:{animationDelay:"1s"}}),a.jsx(g,{size:14,className:"absolute -bottom-2 -right-2 text-purple-400 animate-ping",style:{animationDelay:"1.5s"}}),a.jsxs("button",{onClick:n,className:"relative group bg-primary p-2 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 animate-bounce cursor-pointer",style:{animationDuration:"2s",animationIterationCount:"infinite"},children:[a.jsx("div",{className:"absolute inset-0 bg-primary rounded-xl opacity-0 group-hover:opacity-50 transition-opacity duration-300 blur-lg"}),a.jsx(I,{size:24,className:"text-white relative z-10 drop-shadow-sm"}),a.jsx("div",{className:"absolute inset-0 bg-primary rounded-xl animate-pulse opacity-30"})]}),a.jsx("div",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-20",children:"Â¡PromociÃ³n disponible!"})]})}const aa=({setCart:n,hasPromotion:t,onPromotionClick:s,categorias:r,...e})=>{var v,h,m,O,j,A;const c=r==null?void 0:r.find(u=>u.id===(e==null?void 0:e.category_id)),o=e.type==="combo",i=()=>{n(u=>u.filter(l=>o?!(l.id===(e==null?void 0:e.id)&&l.type==="combo"):l.id!==(e==null?void 0:e.id)))},x=()=>{n(u=>u.map(l=>o?l.id===(e==null?void 0:e.id)&&l.type==="combo"?{...l,quantity:(l.quantity||1)+1}:l:l.id===(e==null?void 0:e.id)?{...l,quantity:(l.quantity||1)+1}:l))},C=()=>{n(u=>u.map(l=>{if(o?l.id===(e==null?void 0:e.id)&&l.type==="combo":l.id===(e==null?void 0:e.id)){const N=(l.quantity||1)-1;return N<=0?(i(),null):{...l,quantity:N}}return l}).filter(Boolean))},z=o?e.final_price||e.price:e.final_price,b=e.price;return a.jsx("div",{className:"w-full bg-white rounded-lg shadow p-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center  justify-between gap-4 w-full",children:[a.jsxs("div",{className:"flex items-center gap-4 flex-grow",children:[a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:o?e!=null&&e.image?`/storage/images/combo/${e.image}`:`/storage/images/item/${e.image}`:`/storage/images/item/${e==null?void 0:e.image}`,alt:e==null?void 0:e.name,className:"w-20 h-20 object-cover rounded flex-shrink-0",onError:u=>u.target.src="/api/cover/thumbnail/null"}),o&&a.jsx("div",{className:"absolute -top-1 -right-1 bg-primary text-white rounded-full p-1",children:a.jsx(ge,{size:12})}),t&&a.jsx("div",{className:"absolute -top-2 -right-2",children:a.jsx(Ee,{onClick:()=>s(e),className:"group"})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-medium text-lg mb-2 line-clamp-2",children:e==null?void 0:e.name}),o&&a.jsxs("p",{className:"text-xs customtext-primary font-medium mb-1",children:["Combo (",((v=e.combo_items)==null?void 0:v.length)||0," productos)"]}),o&&e.combo_items&&a.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:["Incluye: ",e.combo_items.map(u=>u.name).join(", ")]}),((h=e==null?void 0:e.brand)==null?void 0:h.name)||((m=e==null?void 0:e.category)==null?void 0:m.name)&&a.jsxs("p",{className:"text-sm customtext-neutral-dark",children:[(O=e==null?void 0:e.brand)!=null&&O.name?"Marca: ":"CategorÃ­a: ",a.jsx("span",{className:"customtext-neutral-dark",children:(j=e==null?void 0:e.brand)!=null&&j.name?(A=e==null?void 0:e.brand)==null?void 0:A.name:c==null?void 0:c.name})]}),!o&&a.jsxs(a.Fragment,{children:[a.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Disponibilidad: ",a.jsxs("span",{className:"customtext-neutral-dark",children:[(e==null?void 0:e.stock)>=(e==null?void 0:e.quantity)?"En stock":"Agotado"," "]})]}),a.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["SKU: ",a.jsx("span",{className:"customtext-neutral-dark",children:e==null?void 0:e.sku})]})]})]})]}),a.jsxs("div",{className:"flex flex-row justify-between md:flex-col items-end md:items-end gap-4 mt-4 md:mt-0 flex-shrink-0",children:[a.jsxs("div",{className:"text-right",children:[o&&e.discount>0&&a.jsxs("div",{className:"text-xs text-gray-500 line-through",children:[k()," ",Number(b*(e==null?void 0:e.quantity)).toFixed(2)]}),!o&&(e==null?void 0:e.discount)>0&&(e==null?void 0:e.price)>(e==null?void 0:e.final_price)&&a.jsxs("div",{className:"text-xs text-gray-500 line-through",children:[k()," ",Number(b*(e==null?void 0:e.quantity)).toFixed(2)]}),a.jsxs("div",{className:"font-bold text-lg",children:[k()," ",Number(z*(e==null?void 0:e.quantity)).toFixed(2)]}),o&&e.discount>0&&a.jsxs("div",{className:"text-xs text-red-500",children:["-",e.discount_percent,"% OFF"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"flex items-center border border-gray-200 rounded-lg overflow-hidden shadow-sm",children:[a.jsx("button",{type:"button",onClick:C,className:"p-2 text-gray-600 hover:bg-gray-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Decrease quantity",children:a.jsx(be,{size:16})}),a.jsx("div",{className:"w-12 h-8 flex justify-center items-center bg-white",children:a.jsx("span",{className:"font-semibold text-sm",children:(e==null?void 0:e.quantity)||1})}),a.jsx("button",{type:"button",onClick:x,className:"p-2 text-gray-600 hover:bg-gray-100 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Increase quantity",children:a.jsx(ve,{size:16})})]}),a.jsx("button",{onClick:i,className:"p-2 text-gray-400 hover:text-red-500 transition-colors duration-200 rounded-full hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-200","aria-label":"Remove item",children:a.jsx(je,{size:18})})]})]})]})},e==null?void 0:e.id)},Ie="/api";class sa{static async applyToCart(t,s,r=null){var e;try{if(console.log("ðŸ›’ Applying discount rules to cart:",{cartItems:t,totalAmount:s,customerEmail:r}),!Array.isArray(t)||t.length===0)return{success:!1,error:"Carrito vacÃ­o o invÃ¡lido",data:null};const c={cart_items:t.map(i=>{const x={item_id:String(i.item_id||i.id||""),quantity:parseInt(i.quantity)||1,price:parseFloat(i.price||i.final_price||0),name:String(i.name||i.description||"Producto sin nombre"),category_id:i.category_id?String(i.category_id):null,type:i.type||"item",combo_id:i.type==="combo"?i.id:null};return console.log("ðŸ“¦ Processing cart item:",x),x}),total_amount:parseFloat(s)||0,customer_email:r||null};console.log("ðŸ“¤ Sending payload to API:",c);const o=await Ne.post(`${Ie}/discount-rules/apply-to-cart`,c);return o.data.status===200?{success:!0,data:o.data.data,message:o.data.message}:{success:!1,error:o.data.message||"Error al aplicar descuentos",data:null}}catch(c){return console.error("Error applying discount rules:",c),(e=c.response)!=null&&e.data?{success:!1,error:c.response.data.message||"Error del servidor",data:c.response.data.data||null}:{success:!1,error:"Error de conexiÃ³n",data:null}}}static formatDiscounts(t){return!t||!Array.isArray(t)?[]:t.map(s=>({id:s.rule_id,name:s.rule_name||"Descuento automÃ¡tico",description:s.description||"",amount:parseFloat(s.discount_amount||0),type:s.discount_type||"fixed",promotion_type:s.promotion_type||null,free_items:s.free_items||[],formatted_amount:s.discount_type==="percentage"?`${s.discount_amount}%`:`${k()} ${parseFloat(s.discount_amount||0).toFixed(2)}`}))}static getFreeItems(t){if(!t||!Array.isArray(t))return[];const s=[];return t.forEach(r=>{r.free_items&&Array.isArray(r.free_items)&&s.push(...r.free_items)}),s}static calculateTotalDiscount(t){return!t||!Array.isArray(t)?0:t.reduce((s,r)=>s+parseFloat(r.discount_amount||0),0)}}function ta({isOpen:n,onClose:t,suggestion:s,onAddToCart:r,productName:e}){const[c,o]=d.useState(!1);if(!n||!s)return null;const i=async()=>{o(!0);try{console.log("Modal - suggestion data:",s),await r(s),t()}catch(x){console.error("Error adding promotional item:",x)}finally{o(!1)}};return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity duration-300",onClick:t}),a.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:a.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-md w-full mx-auto transform transition-all duration-300 scale-100",children:[a.jsx("button",{onClick:t,className:"absolute top-4 right-4 p-2 text-gray-400 hover:text-gray-600 transition-colors rounded-full hover:bg-gray-100",children:a.jsx(we,{size:20})}),a.jsxs("div",{className:"text-center pt-8 pb-6 px-6",children:[a.jsxs("div",{className:"relative inline-block mb-4",children:[a.jsx("div",{className:"animate-bounce",children:a.jsx(I,{size:48,className:"customtext-primary mx-auto"})}),a.jsx(g,{size:20,className:"absolute -top-2 -right-2 text-yellow-400 animate-pulse"}),a.jsx(g,{size:16,className:"absolute -bottom-1 -left-2 text-yellow-400 animate-pulse delay-300"})]}),a.jsx("h2",{className:"text-2xl font-bold customtext-neutral-dark mb-2",children:"ðŸŽ‰ Â¡PromociÃ³n Especial!"}),a.jsx("p",{className:"text-gray-600",children:"Tienes un producto que califica para una promociÃ³n"})]}),a.jsxs("div",{className:"px-6 pb-6",children:[a.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-4 mb-6",children:a.jsxs("div",{className:"text-center",children:[a.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Al tener  ",a.jsxs("span",{className:"font-semibold customtext-primary",children:[s.current_quantity," ",e]})," en tu carrito"]}),a.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[a.jsx("p",{className:"font-bold text-lg customtext-primary mb-1",children:s.rule_name}),a.jsx("p",{className:"text-sm customtext-neutral-light",children:s.description||"ObtÃ©n un producto gratis"})]})]})}),a.jsx("div",{className:"border-2 border-dashed rounded-xl p-4 mb-6 bg-green-50",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3 w-9/12",children:[a.jsx("div",{className:"w-12 h-12  rounded-full flex items-center justify-center",children:a.jsx(I,{className:"customtext-primary",size:24})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold customtext-neutral-dark",children:s.item_name}),a.jsxs("p",{className:"text-sm customtext-primary",children:["Cantidad: ",s.suggested_quantity]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-lg font-bold customtext-primary",children:"Â¡GRATIS!"}),a.jsxs("p",{className:"text-xs text-gray-500 line-through",children:[k()," ",Number(s.value||0).toFixed(2)]})]})]})}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("button",{onClick:i,disabled:c,className:"w-full bg-primary text-white font-semibold py-3 px-6 rounded-xl hover:from-green-600 hover:to-green-700 transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:transform-none shadow-lg",children:c?a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a.jsx("span",{children:"Agregando..."})]}):a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx(I,{size:20}),a.jsx("span",{children:"Â¡Agregar Regalo!"})]})}),a.jsx("button",{onClick:t,className:"w-full bg-gray-100 customtext-neutral-light font-medium py-3 px-6 rounded-xl hover:bg-gray-200 transition-colors duration-200",children:"Tal vez despuÃ©s"})]}),a.jsx("p",{className:"text-xs text-gray-500 text-center mt-4",children:"* PromociÃ³n vÃ¡lida mientras tengas los productos requeridos en tu carrito"})]})]})})]})}var qe=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"];function ze(n){var t=n.defaultOptions,s=t===void 0?!1:t,r=n.cacheOptions,e=r===void 0?!1:r,c=n.loadOptions;n.options;var o=n.isLoading,i=o===void 0?!1:o,x=n.onInputChange,C=n.filterOption,z=C===void 0?null:C,b=_e(n,qe),v=b.inputValue,h=d.useRef(void 0),m=d.useRef(!1),O=d.useState(Array.isArray(s)?s:void 0),j=f(O,2),A=j[0],u=j[1],l=d.useState(typeof v<"u"?v:""),F=f(l,2),N=F[0],M=F[1],Z=d.useState(s===!0),G=f(Z,2),ee=G[0],w=G[1],ae=d.useState(void 0),J=f(ae,2),$=J[0],L=J[1],se=d.useState([]),U=f(se,2),te=U[0],T=U[1],re=d.useState(!1),H=f(re,2),ne=H[0],P=H[1],oe=d.useState({}),K=f(oe,2),_=K[0],Q=K[1],le=d.useState(void 0),W=f(le,2),ie=W[0],ce=W[1],de=d.useState(void 0),X=f(de,2),ue=X[0],pe=X[1];e!==ue&&(Q({}),pe(e)),s!==ie&&(u(Array.isArray(s)?s:void 0),ce(s)),d.useEffect(function(){return m.current=!0,function(){m.current=!1}},[]);var R=d.useCallback(function(S,y){if(!c)return y();var p=c(S,y);p&&typeof p.then=="function"&&p.then(y,function(){return y()})},[c]);d.useEffect(function(){s===!0&&R(N,function(S){m.current&&(u(S||[]),w(!!h.current))})},[]);var xe=d.useCallback(function(S,y){var p=Se(S,y,x);if(!p){h.current=void 0,M(""),L(""),T([]),w(!1),P(!1);return}if(e&&_[p])M(p),L(p),T(_[p]),w(!1),P(!1);else{var he=h.current={};M(p),w(!0),P(!$),R(p,function(D){m&&he===h.current&&(h.current=void 0,w(!1),L(p),T(D||[]),P(!1),Q(D?E(E({},_),{},ke({},p,D)):_))})}},[e,R,$,_,x]),fe=ne?[]:N&&$?te:A||[];return E(E({},b),{},{options:fe,isLoading:ee||i,onInputChange:xe,filterOption:z})}var Fe=d.forwardRef(function(n,t){var s=ze(n),r=Ce(s);return d.createElement(Oe,Ae({ref:t},r))}),ra=Fe;class Y{}V(Y,"getShippingCost",async t=>{try{const{status:s,result:r}=await q.Fetch("./api/delivery-prices",{method:"POST",body:JSON.stringify(t)});if(!s)throw new Error((r==null?void 0:r.message)||"Error al obtener datos");return r}catch{return!1}}),V(Y,"getCosts",async t=>{try{const{status:s,result:r}=await q.Fetch("./api/prices-type",{method:"POST"});if(!s)throw new Error((r==null?void 0:r.message)||"Error al obtener datos");return r}catch{return!1}});class na{static async validateCoupon(t){try{const{status:s,result:r}=await q.Fetch("./api/coupons/validate",{method:"POST",body:JSON.stringify(t)});if(!s)throw new Error((r==null?void 0:r.message)||"Error al validar cupÃ³n");return r}catch(s){throw s}}static async generateCode(){try{const{status:t,result:s}=await q.Fetch("./api/coupons/generate-code",{method:"GET"});if(!t)throw new Error((s==null?void 0:s.message)||"Error al generar cÃ³digo");return s}catch(t){throw t}}}const oa=({title:n,description:t,selected:s,onSelect:r,disabled:e})=>a.jsxs("div",{className:`flex w-full items-center gap-3 p-4 border rounded-xl cursor-pointer transition-all duration-300 customtext-neutral-dark 
                }`,onClick:r,children:[a.jsx("div",{className:`w-5 h-5 border-2 rounded-full flex items-center justify-center ${s?"border-primary":""}`,children:s&&a.jsx("div",{className:"w-3 h-3 bg-primary rounded-full"})}),a.jsxs("div",{className:"customtext-neutral-light",children:[a.jsx("h4",{className:"text-sm ",children:n}),a.jsx("p",{className:"text-xs",children:t})]})]});export{ra as A,Ze as B,aa as C,sa as D,Ye as I,oa as O,ta as P,ea as a,Y as b,na as c};
