import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{B as bs}from"./Base-DSZ3J1Re.js";import{S as q}from"./SwitchFormGroup-DXN0cwVk.js";import{T as js}from"./TextareaFormGroup-CliirJM1.js";import{r as n}from"./index-BOnQTV8N.js";import{c as vs}from"./ReactAppend-QR5TrZfj.js";import{s as fe}from"./server.browser-Bf4gQIc7.js";import{S as J}from"./ProductCard-D_AgkLlk.js";import{I as $e}from"./ItemsRest-BelP-LFB.js";import{M as Ie}from"./Modal-xDw9ufjg.js";import{T as ys}from"./Table-bW0uinRR.js";import{I as ue}from"./ImageFormGroup-40MuGzez.js";import{I as E}from"./InputFormGroup-iZIO11ZN.js";import{Q as Ns}from"./QuillFormGroup-BXX8qnUc.js";import{S as Ee}from"./SelectAPIFormGroup-BZe8H0Ph.js";import{S as K}from"./SelectFormGroup-X8WqJHHl.js";import{D as Fe}from"./DxButton-DV0H-ZcL.js";import{C as ws,F as m}from"./CreateReactScript-B_EwXk3P.js";import{C as Te,N as _e}from"./Number2Currency-jIsa99f9.js";import{R as G}from"./ReactAppend-Vm5G2nof.js";import{S as Pe}from"./SetSelectValue-UxyCmHse.js";import"./main-B6F2O9-U.js";import{t as Rs}from"./CardProductKatya-ncpmQ0JU.js";import"./index-yBjzXJbu.js";import"./Global-CazroCzF.js";import"./tippy-react.esm-DmkRJDEW.js";import"./index-pSueRYGM.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-B6ujFmsw.js";/* empty css              */import"./Logout-BpuTJ_83.js";import"./MenuItemContainer-DwXwpKCn.js";import"./index.esm-D6GvEWn_.js";import"./index-BQJyKPGC.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./CanAccess-DwCGzUAc.js";import"./BasicRest-BML1C-ua.js";import"./BooleanLimit-D-OsQsek.js";/* empty css               */import"./General-apRuNwp7.js";import"./LaravelSession-Dz9cpV3l.js";const Ae=({label:F,structure:b,value:D=[],onChange:T,typeOptions:z=[]})=>{const[j,g]=n.useState([]),h=typeof b=="object"&&!Array.isArray(b);n.useEffect(()=>{g(h?D.map(c=>{var o,d;return{...c,type:((o=c.type)==null?void 0:o.charAt(0).toUpperCase())+((d=c.type)==null?void 0:d.slice(1).toLowerCase())}}):D.map(c=>typeof c=="object"?c.feature||"":c))},[D]);const _=()=>{const c=h?{...b}:"",o=[...j,c];g(o),T(o)},x=c=>{const o=j.filter((d,p)=>p!==c);g(o),T(o)},v=(c,o,d)=>{const p=[...j];h?p[c][o]=o==="type"?d.charAt(0).toUpperCase()+d.slice(1).toLowerCase():d:p[c]=d,g(p),T(p)},P=(c,o)=>o==="Icono"?"Url de icono":c;return e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"form-label fw-semibold text-dark mb-3",children:[e.jsx("i",{className:`fas ${h?"fa-cogs":"fa-list-ul"} me-2 text-primary`}),F]}),e.jsxs("div",{className:"dynamic-fields-container",children:[j.map((c,o)=>e.jsx("div",{className:"dynamic-field-item mb-3 p-3 border rounded-3 bg-light position-relative",style:{borderLeft:"4px solid #0d6efd",transition:"all 0.3s ease",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:h?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row g-3 mb-2",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label small text-muted text-uppercase fw-bold mb-1",children:"Tipo"}),e.jsxs("select",{className:"form-select form-select-sm border-0 bg-white shadow-sm",value:c.type||"",onChange:d=>v(o,"type",d.target.value),style:{fontSize:"0.9rem"},children:[e.jsx("option",{value:"",children:"Seleccionar tipo..."}),z.map(d=>e.jsx("option",{value:d,children:d},d))]})]}),e.jsxs("div",{className:"col-md-8",children:[e.jsx("label",{className:"form-label small text-muted text-uppercase fw-bold mb-1",children:"Título"}),e.jsx("input",{type:"text",className:"form-control form-control-sm border-0 bg-white shadow-sm",value:c.title||"",onChange:d=>v(o,"title",d.target.value),placeholder:P("title",c.type),style:{fontSize:"0.9rem"}})]})]}),e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col",children:[e.jsx("label",{className:"form-label small text-muted text-uppercase fw-bold mb-1",children:"Descripción"}),e.jsx("input",{type:"text",className:"form-control form-control-sm border-0 bg-white shadow-sm",value:c.description||"",onChange:d=>v(o,"description",d.target.value),placeholder:"Descripción de la especificación",style:{fontSize:"0.9rem"}})]}),e.jsx("div",{className:"col-auto d-flex align-items-end",children:e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm rounded-circle d-flex align-items-center justify-content-center",onClick:()=>x(o),style:{width:"32px",height:"32px"},title:"Eliminar especificación",children:e.jsx("i",{className:"fas fa-times"})})})]})]}):e.jsx("div",{className:"row g-3",children:e.jsx("div",{className:"col",children:e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsx("input",{type:"text",className:"form-control border-0 shadow-sm flex-grow-1",value:c,onChange:d=>v(o,null,d.target.value),placeholder:"Escriba la característica del producto...",style:{fontSize:"0.95rem"}}),e.jsx("button",{type:"button",className:"btn btn-outline-danger rounded-circle d-flex align-items-center justify-content-center flex-shrink-0",onClick:()=>x(o),title:"Eliminar característica",style:{width:"40px",height:"40px"},children:e.jsx("i",{className:"fas fa-times"})})]})})})},o)),j.length===0&&e.jsxs("div",{className:"text-center py-4 text-muted",children:[e.jsx("i",{className:`fas ${h?"fa-cogs":"fa-list-ul"} fa-2x mb-2 opacity-50`}),e.jsxs("p",{className:"mb-0",children:["No hay ",h?"especificaciones":"características"," agregadas"]}),e.jsx("small",{children:'Haga clic en "Agregar" para comenzar'})]}),e.jsx("div",{className:"text-center mt-3",children:e.jsxs("button",{type:"button",className:"btn btn-primary btn-sm px-4 py-2 rounded-pill shadow-sm",onClick:_,style:{border:"none",fontWeight:"500"},children:[e.jsx("i",{className:"fas fa-plus me-2"}),"Agregar ",h?"Especificación":"Característica"]})})]})]})},Ds=new $e,Ss=({gridRef:F,modalRef:b})=>{const[D,T]=n.useState(null),[z,j]=n.useState(!1),[g,h]=n.useState(""),[_,x]=n.useState(!1),v=c=>{T(c.target.files[0])},P=async()=>{var o,d;if(!D){h("Por favor, selecciona un archivo."),x(!0);return}const c=new FormData;c.append("file",D),j(!0);try{const p=await Ds.importData(c);if(p.error){const B=Array.isArray(p.error)?p.error.join(`
`):p.error;h(`Error en la importación:
${B}`),x(!0)}else h(p.message),x(!1),$(F.current).dxDataGrid("instance").refresh(),$(b.current).modal("hide"),Rs.success("Importacion completada con exito",{description:"Todos tus productos han sido importados correctamente.",duration:3e3,position:"bottom-center",richColors:!0})}catch(p){h("Error al importar: "+(((d=(o=p.response)==null?void 0:o.data)==null?void 0:d.error)||p.message)),x(!0)}j(!1)};return e.jsx("div",{className:"bg-white",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("div",{className:"mb-1",children:e.jsx("a",{href:"/assets/img/salafabulosa/formato_import_products.xlsx",download:!0,children:"Descargar formato .xlsx"})}),e.jsx("div",{children:e.jsx("input",{className:"form-control",type:"file",accept:".xlsx",onChange:v})}),e.jsx("button",{onClick:P,disabled:z,className:"btn btn-primary mt-2",type:"button",children:z?"Subiendo...":"Subir Archivo"}),g&&e.jsx("div",{className:`alert ${_?"alert-danger":"alert-success"} mt-2`,role:"alert",children:e.jsx("div",{className:"alert-message",children:g})})]})})},V=new $e,ks=({categories:F,brands:b,collections:D,stores:T})=>{//!FALTA EDIT AND DELETEDE GALERIA
const[z,j]=n.useState([]),g=n.useRef(),h=n.useRef(),_=n.useRef(),x=n.useRef(),v=n.useRef(),P=n.useRef(),c=n.useRef(),o=n.useRef(),d=n.useRef(),p=n.useRef(),B=n.useRef(),X=n.useRef(),Y=n.useRef(),Z=n.useRef(),y=n.useRef(),N=n.useRef(),w=n.useRef(),ee=n.useRef(),se=n.useRef(),te=n.useRef(),W=n.useRef(),Oe=n.useRef([]),Le=n.useRef([]),re=n.useRef(),[Me,pe]=n.useState(!1),[Ge,Ve]=n.useState(null),[Cs,ze]=n.useState(null),[Is,Be]=n.useState(null),[R,S]=n.useState([]),he=n.useRef(),[k,A]=n.useState([]),ge=n.useRef(),[C,O]=n.useState([]),ae=n.useRef(),We=s=>{const r=Array.from(s.target.files).map(l=>({file:l,url:URL.createObjectURL(l)}));S(l=>[...l,...r])},Ue=s=>{s.preventDefault();const r=Array.from(s.dataTransfer.files).map(l=>({file:l,url:URL.createObjectURL(l)}));S(l=>[...l,...r])},qe=s=>{s.preventDefault()},Je=(s,t)=>{s.preventDefault(),R[t].id?S(l=>l.map((a,f)=>f===t?{...a,toDelete:!0}:a)):S(l=>l.filter((a,f)=>f!==t))},[I,le]=n.useState(null),He=(s,t)=>{le(t),s.dataTransfer.effectAllowed="move"},Qe=()=>{le(null)},Ke=s=>{s.preventDefault(),s.dataTransfer.dropEffect="move"},Xe=(s,t)=>{if(s.preventDefault(),I===null||I===t)return;const r=[...R],l=r[I];r.splice(I,1),r.splice(t,0,l),S(r),le(null)},Ye=s=>{const r=Array.from(s.target.files).map(l=>({file:l,name:l.name,url:URL.createObjectURL(l)}));A(l=>[...l,...r])},Ze=(s,t)=>{s.preventDefault();const r=k[t];r.url&&!r.file?A(l=>l.map((a,f)=>f===t?{...a,toDelete:!0}:a)):A(l=>l.filter((a,f)=>f!==t))},[L,ie]=n.useState(null),es=(s,t)=>{ie(t),s.dataTransfer.effectAllowed="move"},ss=()=>{ie(null)},ts=s=>{s.preventDefault(),s.dataTransfer.dropEffect="move"},rs=(s,t)=>{if(s.preventDefault(),L===null||L===t)return;const r=[...k],l=r[L];r.splice(L,1),r.splice(t,0,l),A(r),ie(null)},as=s=>{s.preventDefault();const t=ae.current.value.trim();t&&(O(r=>[...r,{url:t,order:r.length+1}]),ae.current.value="")},ls=(s,t)=>{s.preventDefault();const r=C[t];r.order&&!r.new?O(l=>l.map((a,f)=>f===t?{...a,toDelete:!0}:a)):O(l=>l.filter((a,f)=>f!==t))},[M,ne]=n.useState(null),is=(s,t)=>{ne(t),s.dataTransfer.effectAllowed="move"},ns=()=>{ne(null)},cs=s=>{s.preventDefault(),s.dataTransfer.dropEffect="move"},os=(s,t)=>{if(s.preventDefault(),M===null||M===t)return;const r=[...C],l=r[M];r.splice(M,1),r.splice(t,0,l),O(r),ne(null)},xe=s=>{var t,r,l;if(j(s||null),s!=null&&s.id?pe(!0):pe(!1),_.current.value=(s==null?void 0:s.id)||"",$(x.current).val((s==null?void 0:s.category_id)||null).trigger("change"),$(v.current).val((s==null?void 0:s.collection_id)||null).trigger("change"),Pe(P.current,(t=s==null?void 0:s.subcategory)==null?void 0:t.id,(r=s==null?void 0:s.subcategory)==null?void 0:r.name),$(c.current).val((s==null?void 0:s.brand_id)||null).trigger("change"),$(W.current).val(s!=null&&s.store_id&&s.store_id!==""?s.store_id:"").trigger("change"),o.current.value=(s==null?void 0:s.name)||"",se.current.value=(s==null?void 0:s.sku)||"",d.current.value=(s==null?void 0:s.color)||"",p.current.value=(s==null?void 0:s.size)||"",B.current.value=(s==null?void 0:s.summary)||"",X.current.value=(s==null?void 0:s.price)||0,Y.current.value=(s==null?void 0:s.discount)||0,re.current.value=(s==null?void 0:s.weight)||0,Pe(Z.current,(s==null?void 0:s.tags)??[],"id","name"),y.current.value=null,N.current.value=null,y.image.src=s!=null&&s.banner?`/storage/images/item/${s.banner}`:"",N.image.src=s!=null&&s.image?`/storage/images/item/${s.image}`:"",w.image.src=s!=null&&s.texture?`/storage/images/item/${s.texture}`:"",ee.editor.root.innerHTML=(s==null?void 0:s.description)??"",s!=null&&s.pdf&&Array.isArray(s.pdf)){const a=s.pdf.map(f=>({url:f.url?`/storage/images/item/${f.url}`:f,name:f.name||"Documento.pdf",order:f.order||0}));A(a)}else A([]);if(s!=null&&s.linkvideo&&Array.isArray(s.linkvideo)?O(s.linkvideo.map(a=>({url:a.url||a,order:a.order||0}))):O([]),s!=null&&s.images){const a=s.images.map(f=>({id:f.id,url:`/storage/images/item/${f.url}`}));S(a)}else S([]);s!=null&&s.specifications?ce(s.specifications.map(a=>({type:a.type,title:a.title,description:a.description,image:a.image||""}))):ce([]),je(((l=s==null?void 0:s.features)==null?void 0:l.map(a=>typeof a=="object"?a:{feature:a}))||[]),te.current.value=s==null?void 0:s.stock,y.deleteRef&&(y.deleteRef.value=""),N.deleteRef&&(N.deleteRef.value=""),w.deleteRef&&(w.deleteRef.value=""),$(h.current).modal("show")},ds=async s=>{s.preventDefault();const t=be.filter(i=>{var u;return typeof i=="string"?i.trim()!=="":typeof i=="object"?((u=i.feature)==null?void 0:u.trim())!=="":!1}),r=ve.filter(i=>i.title&&i.title.trim()!==""||i.description&&i.description.trim()!==""),l={id:_.current.value||void 0,category_id:x.current.value,collection_id:v.current.value||null,subcategory_id:P.current.value,brand_id:c.current.value,name:o.current.value,sku:se.current.value,color:d.current.value,size:p.current.value,summary:B.current.value,price:X.current.value,discount:Y.current.value,tags:$(Z.current).val(),description:ee.current.value,stock:te.current.value||0,features:t,specifications:r,weight:re.current.value||0,store_id:W.current.value&&W.current.value!==""?W.current.value:null},a=new FormData;for(const i in l)if(i==="features"||i==="specifications")a.append(i,JSON.stringify(l[i]));else if(i==="tags"){const u=l[i];Array.isArray(u)?u.forEach((gs,xs)=>{a.append(`tags[${xs}]`,gs)}):u&&a.append("tags[0]",u)}else a.append(i,l[i]);const f=N.current.files[0];f&&a.append("image",f);const U=w.current.files[0];U&&a.append("texture",U);const ye=y.current.files[0];ye&&a.append("banner",ye);const Ne=k.filter(i=>!i.toDelete);let we=0;Ne.forEach(i=>{i.file&&(a.append(`pdf[${we}]`,i.file),we++)});const Re=Ne.map((i,u)=>({index:u,order:u+1,name:i.name||"Documento.pdf"}));Re.length>0&&a.append("pdf_order",JSON.stringify(Re));const De=k.map((i,u)=>i.toDelete?u:null).filter(i=>i!==null);De.length>0&&a.append("deleted_pdfs",JSON.stringify(De));const Se=C.filter(i=>!i.toDelete).map((i,u)=>({url:i.url,order:u+1}));Se.length>0&&a.append("linkvideo",JSON.stringify(Se));const ke=C.map((i,u)=>i.toDelete?u:null).filter(i=>i!==null);ke.length>0&&a.append("deleted_videos",JSON.stringify(ke)),y.getDeleteFlag&&y.getDeleteFlag()&&a.append("banner_delete","DELETE"),N.getDeleteFlag&&N.getDeleteFlag()&&a.append("image_delete","DELETE"),w.getDeleteFlag&&w.getDeleteFlag()&&a.append("texture_delete","DELETE");let de=0,me=0;const Q=[];R.forEach((i,u)=>{i.toDelete||(i.file?(a.append(`gallery[${de}]`,i.file),Q.push({type:"new",index:de}),de++):(a.append(`gallery_ids[${me}]`,i.id),Q.push({type:"existing",id:i.id,index:me}),me++))}),Q.length>0&&a.append("gallery_order",JSON.stringify(Q));const Ce=R.filter(i=>i.toDelete).map(i=>i.id);Ce.length>0&&Ce.forEach((i,u)=>{a.append(`deleted_images[${u}]`,i)});for(let[i,u]of a.entries());await V.save(a)&&(y.resetDeleteFlag&&y.resetDeleteFlag(),N.resetDeleteFlag&&N.resetDeleteFlag(),w.resetDeleteFlag&&w.resetDeleteFlag(),$(g.current).dxDataGrid("instance").refresh(),$(h.current).modal("hide"),S([]),A([]),O([]))},ms=async({id:s,value:t})=>{await V.boolean({id:s,field:"visible",value:t})&&$(g.current).dxDataGrid("instance").refresh()},H=async({id:s,field:t,value:r})=>{await V.boolean({id:s,field:t,value:r})&&$(g.current).dxDataGrid("instance").refresh()},fs=async s=>{const{isConfirmed:t}=await J.fire({title:"Eliminar item",text:"¿Estás seguro de eliminar este item?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!t||!await V.delete(s)||$(g.current).dxDataGrid("instance").refresh()},[be,je]=n.useState([]),[ve,ce]=n.useState([]),us=["Principal","General"],[Es,Fs]=n.useState(!1),oe=n.useRef(),ps=()=>{$(oe.current).modal("show")},hs=async()=>{try{J.fire({title:"Exportando items...",text:"Por favor espere",allowOutsideClick:!1,didOpen:()=>{J.showLoading()}}),await V.exportData(),J.fire({icon:"success",title:"Exportación exitosa",text:"El archivo se ha descargado correctamente",timer:2e3})}catch(s){console.error("Error al exportar:",s),J.fire({icon:"error",title:"Error",text:s.message||"No se pudo exportar los items. Por favor intente nuevamente."})}};return e.jsxs(e.Fragment,{children:[e.jsx(ys,{gridRef:g,title:"Items",rest:V,toolBar:s=>{s.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(g.current).dxDataGrid("instance").refresh()}}),s.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Agregar",hint:"Agregar",onClick:()=>xe()}}),s.unshift({widget:"dxButton",location:"after",options:{icon:"upload",text:"Importar Datos",hint:"Importar Datos",onClick:()=>ps()}}),s.unshift({widget:"dxButton",location:"after",options:{icon:"download",text:"Exportar Items",hint:"Exportar Items (Formato Excel)",onClick:()=>hs()}})},exportable:!0,exportableName:"Items",columns:[{dataField:"id",caption:"ID",visible:!1},m.has("items","category_id")&&{dataField:"category.name",caption:"Categoría",width:"120px",cellTemplate:(s,{data:t})=>{var r,l,a;s.html(fe.renderToString(e.jsxs(e.Fragment,{children:[e.jsx("b",{className:"d-block fst-italic text-muted",children:(r=t.collection)==null?void 0:r.name}),e.jsx("b",{className:"d-block",children:(l=t.category)==null?void 0:l.name}),e.jsx("small",{className:"text-muted",children:(a=t.subcategory)==null?void 0:a.name})]})))}},m.has("items","subcategory_id")&&{dataField:"subcategory.name",caption:"Subcategoría",visible:!1},m.has("items","brand_id")&&{dataField:"brand.name",caption:"Marca",width:"120px"},{dataField:"name",caption:"Nombre",minWidth:"300px",cellTemplate:(s,{data:t})=>{const l=((a,f)=>{if(!a)return"";const U=a.split(" ");return U.length>f?U.slice(0,f).join(" ")+"...":a})(t.summary,12);s.html(fe.renderToString(e.jsxs(e.Fragment,{children:[e.jsx("b",{children:t.name}),e.jsx("br",{}),e.jsx("span",{children:l})]})))}},{dataField:"final_price",caption:"Precio",dataType:"number",width:"75px",cellTemplate:(s,{data:t})=>{s.html(fe.renderToString(e.jsxs(e.Fragment,{children:[t.discount>0&&e.jsxs("small",{className:"d-block text-muted",style:{textDecoration:"line-through"},children:[Te()," ",_e(t.price)]}),e.jsxs("span",{children:[Te()," ",_e(t.discount>0?t.discount:t.price)]})]})))}},m.has("items","weight")&&{dataField:"weight",caption:"Peso",dataType:"number",width:"75px"},{dataField:"image",caption:"Imagen",width:"90px",allowFiltering:!1,cellTemplate:(s,{data:t})=>{G(s,e.jsx("img",{src:`/storage/images/item/${t.image}`,style:{width:"80px",height:"48px",objectFit:"cover",objectPosition:"center",borderRadius:"4px"},onError:r=>r.target.src="/api/cover/thumbnail/null"}))}},m.has("items","is_new")&&{dataField:"is_new",caption:"Nuevo",dataType:"boolean",width:"80px",cellTemplate:(s,{data:t})=>{const r=t.is_new===1||t.is_new==="1"||t.is_new===!0;G(s,e.jsx(q,{checked:r,onChange:l=>H({id:t.id,field:"is_new",value:l.target.checked?1:0})}))}},m.has("items","offering")&&{dataField:"offering",caption:"En oferta",dataType:"boolean",width:"80px",cellTemplate:(s,{data:t})=>{const r=t.offering===1||t.offering==="1"||t.offering===!0;G(s,e.jsx(q,{checked:r,onChange:l=>H({id:t.id,field:"offering",value:l.target.checked?1:0})}))}},m.has("items","recommended")&&{dataField:"recommended",caption:"Recomendado",dataType:"boolean",width:"80px",cellTemplate:(s,{data:t})=>{const r=t.recommended===1||t.recommended==="1"||t.recommended===!0;G(s,e.jsx(q,{checked:r,onChange:l=>H({id:t.id,field:"recommended",value:l.target.checked?1:0})}))}},m.has("items","featured")&&{dataField:"featured",caption:"Destacado",dataType:"boolean",width:"80px",cellTemplate:(s,{data:t})=>{const r=t.featured===1||t.featured==="1"||t.featured===!0;G(s,e.jsx(q,{checked:r,onChange:l=>H({id:t.id,field:"featured",value:l.target.checked?1:0})}))}},m.has("items","visible")&&{dataField:"visible",caption:"Visible",dataType:"boolean",width:"80px",cellTemplate:(s,{data:t})=>{G(s,e.jsx(q,{checked:t.visible,onChange:r=>ms({id:t.id,value:r.target.checked})}))}},{caption:"Acciones",width:"100px",cellTemplate:(s,{data:t})=>{s.css("text-overflow","unset"),s.append(Fe({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>xe(t)})),s.append(Fe({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>fs(t.id)}))},allowFiltering:!1,allowExporting:!1}]}),e.jsx(Ie,{modalRef:h,title:Me?"Editar item":"Agregar item",onSubmit:ds,size:"xl",children:e.jsxs("div",{id:"principal-container",children:[e.jsx("input",{ref:_,type:"hidden"}),e.jsxs("ul",{className:"nav nav-pills nav-justified mb-4",role:"tablist",style:{backgroundColor:"#f8f9fa",borderRadius:"8px",padding:"4px",border:"1px solid #e9ecef"},children:[e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsxs("button",{className:"nav-link active",id:"basic-info-tab","data-bs-toggle":"pill","data-bs-target":"#basic-info",type:"button",role:"tab","aria-controls":"basic-info","aria-selected":"true",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[e.jsx("i",{className:"fas fa-info-circle me-2"}),"Información Básica"]})}),e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsxs("button",{className:"nav-link",id:"pricing-tab","data-bs-toggle":"pill","data-bs-target":"#pricing",type:"button",role:"tab","aria-controls":"pricing","aria-selected":"false",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[e.jsx("i",{className:"fas fa-dollar-sign me-2"}),"Precios y Stock"]})}),e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsxs("button",{className:"nav-link",id:"multimedia-tab","data-bs-toggle":"pill","data-bs-target":"#multimedia",type:"button",role:"tab","aria-controls":"multimedia","aria-selected":"false",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[e.jsx("i",{className:"fas fa-images me-2"}),"Multimedia"]})}),e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsxs("button",{className:"nav-link",id:"features-tab","data-bs-toggle":"pill","data-bs-target":"#features",type:"button",role:"tab","aria-controls":"features","aria-selected":"false",style:{borderRadius:"6px",fontWeight:"500",transition:"all 0.3s ease"},children:[e.jsx("i",{className:"fas fa-list-ul me-2"}),"Características"]})})]}),e.jsxs("div",{className:"tab-content",children:[e.jsx("div",{className:"tab-pane fade show active",id:"basic-info",role:"tabpanel","aria-labelledby":"basic-info-tab",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-tag me-2"}),"Identificación"]})}),e.jsxs("div",{className:"card-body",children:[e.jsx(E,{eRef:se,label:"SKU",required:!0,hidden:!m.has("items","sku")}),e.jsx(E,{eRef:o,label:"Nombre del Producto",required:!0,hidden:!m.has("items","name")}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsx(E,{eRef:d,label:"Color",required:!0,hidden:!m.has("items","color")})}),e.jsx("div",{className:"col-md-6",children:e.jsx(E,{eRef:p,label:"Talla",required:!0,hidden:!m.has("items","size")})}),e.jsx("div",{className:"col-md-6",children:e.jsx(E,{eRef:re,label:"Peso",hidden:!m.has("items","weight")})})]})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-sitemap me-2"}),"Categorización"]})}),e.jsxs("div",{className:"card-body",children:[e.jsx(K,{eRef:x,label:"Categoría",required:!0,dropdownParent:"#principal-container",onChange:s=>Ve(s.target.value),hidden:!m.has("items","category_id"),children:F.map((s,t)=>e.jsx("option",{value:s.id,children:s.name},t))}),e.jsx(K,{eRef:v,label:"Colección",dropdownParent:"#principal-container",onChange:s=>ze(s.target.value),hidden:!m.has("items","collection_id"),children:D.map((s,t)=>e.jsx("option",{value:s.id,children:s.name},t))}),e.jsx(Ee,{eRef:P,label:"Subcategoría",searchAPI:"/api/admin/subcategories/paginate",searchBy:"name",filter:["category_id","=",Ge],dropdownParent:"#principal-container",hidden:!m.has("items","subcategory_id")}),e.jsx(K,{eRef:c,label:"Marca",dropdownParent:"#principal-container",hidden:!m.has("items","brand_id"),children:b.map((s,t)=>e.jsx("option",{value:s.id,children:s.name},t))})]})]})}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card border-0 shadow-sm",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-align-left me-2"}),"Descripción"]})}),e.jsxs("div",{className:"card-body",children:[e.jsx(js,{eRef:B,label:"Resumen",rows:3,hidden:!m.has("items","summary")}),e.jsxs(K,{eRef:W,label:"Tienda",dropdownParent:"#principal-container",onChange:s=>Be(s.target.value),hidden:!m.has("items","store_id"),children:[e.jsx("option",{value:"",children:"Seleccionar tienda (opcional)"}),T.map((s,t)=>e.jsx("option",{value:s.id,children:s.name},t))]}),e.jsx(Ee,{id:"tags",eRef:Z,searchAPI:"/api/admin/tags/paginate",searchBy:"name",label:"Tags",dropdownParent:"#principal-container",tags:!0,multiple:!0})]})]})})]})}),e.jsx("div",{className:"tab-pane fade",id:"pricing",role:"tabpanel","aria-labelledby":"pricing-tab",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-dollar-sign me-2"}),"Precios"]})}),e.jsxs("div",{className:"card-body",children:[e.jsx(E,{eRef:X,label:"Precio Regular",type:"number",step:"0.01",required:!0,hidden:!m.has("items","price")}),e.jsx(E,{eRef:Y,label:"Precio con Descuento",type:"number",step:"0.01"})]})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-boxes me-2"}),"Inventario"]})}),e.jsx("div",{className:"card-body",children:e.jsx(E,{label:"Stock Disponible",eRef:te,type:"number",required:!0,hidden:!m.has("items","stock")})})]})})]})}),e.jsx("div",{className:"tab-pane fade",id:"multimedia",role:"tabpanel","aria-labelledby":"multimedia-tab",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-image me-2"}),"Imágenes Principales"]})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsx(ue,{eRef:y,name:"banner",label:"Banner",aspect:2/1,col:"col-12",hidden:!m.has("items","banner")}),e.jsx(ue,{eRef:N,name:"image",label:"Imagen Principal",aspect:1,col:"col-md-6",hidden:!m.has("items","image")}),e.jsx(ue,{eRef:w,name:"texture",label:"Textura",aspect:1,col:"col-md-6",hidden:!m.has("items","texture")})]})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-photo-video me-2"}),"Galería y Multimedia"]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{className:"form-label fw-semibold text-dark mb-3",children:[e.jsx("i",{className:"fas fa-images me-2 text-primary"}),"Galería de Imágenes",R.filter(s=>!s.toDelete).length>0&&e.jsx("span",{className:"badge bg-primary ms-2",children:R.filter(s=>!s.toDelete).length})]}),e.jsx("input",{id:"input-item-gallery",ref:he,type:"file",multiple:!0,accept:"image/*",hidden:!0,onChange:We}),e.jsxs("div",{className:"gallery-container",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"16px",padding:"16px",backgroundColor:"#f8f9fa",borderRadius:"12px",border:"2px dashed #dee2e6",minHeight:"160px"},children:[R.filter(s=>!s.toDelete).map((s,t)=>{const r=R.findIndex(a=>a===s),l=t+1;return e.jsxs("div",{className:"gallery-item position-relative",draggable:!0,onDragStart:a=>He(a,r),onDragEnd:Qe,onDragOver:Ke,onDrop:a=>Xe(a,r),style:{aspectRatio:"1",borderRadius:"12px",overflow:"hidden",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",transition:"all 0.3s ease",cursor:"grab",transform:I===r?"scale(1.05)":"scale(1)",opacity:I===r?.8:1,border:"3px solid transparent",background:"white"},onMouseEnter:a=>{I===null&&(a.currentTarget.style.transform="scale(1.02)",a.currentTarget.style.boxShadow="0 6px 20px rgba(0,0,0,0.15)")},onMouseLeave:a=>{I===null&&(a.currentTarget.style.transform="scale(1)",a.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)")},children:[e.jsx("div",{className:"position-absolute top-0 start-0 m-2",children:e.jsx("span",{className:"badge bg-primary rounded-circle d-flex align-items-center justify-content-center",style:{width:"24px",height:"24px",fontSize:"11px",fontWeight:"bold"},children:l})}),e.jsx("img",{src:s.url,alt:`Imagen ${l}`,className:"w-100 h-100",style:{objectFit:"cover",pointerEvents:"none"}}),e.jsx("div",{className:"position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{background:"rgba(0,0,0,0.7)",opacity:0,transition:"opacity 0.3s ease"},onMouseEnter:a=>a.currentTarget.style.opacity=1,onMouseLeave:a=>a.currentTarget.style.opacity=0,children:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-light btn-sm rounded-circle d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},title:"Mover imagen",children:e.jsx("i",{className:"fas fa-arrows-alt text-dark"})}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm rounded-circle d-flex align-items-center justify-content-center",style:{width:"32px",height:"32px"},onClick:a=>Je(a,r),title:"Eliminar imagen",children:e.jsx("i",{className:"fas fa-trash text-white"})})]})})]},r)}),e.jsx("div",{className:"gallery-add-button d-flex flex-column align-items-center justify-content-center",style:{aspectRatio:"1",border:"3px dashed #71b6f9",borderRadius:"12px",backgroundColor:"rgba(13, 110, 253, 0.05)",cursor:"pointer",transition:"all 0.3s ease",minHeight:"120px"},onClick:()=>he.current.click(),onDrop:Ue,onDragOver:qe,onMouseEnter:s=>{s.currentTarget.style.backgroundColor="rgba(13, 110, 253, 0.1)",s.currentTarget.style.borderColor="#0056b3",s.currentTarget.style.transform="scale(1.02)"},onMouseLeave:s=>{s.currentTarget.style.backgroundColor="rgba(13, 110, 253, 0.05)",s.currentTarget.style.borderColor="#0d6efd",s.currentTarget.style.transform="scale(1)"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-2 bg-primary",style:{width:"48px",height:"48px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto"},children:e.jsx("i",{className:"fas fa-plus text-white fa-lg"})}),e.jsx("p",{className:"mb-0 text-primary fw-semibold",style:{fontSize:"12px"},children:"Agregar Imagen"}),e.jsx("small",{className:"text-muted",style:{fontSize:"10px"},children:"Arrastra o haz clic"})]})})]}),R.filter(s=>!s.toDelete).length===0&&e.jsxs("div",{className:"text-center py-4 text-muted",children:[e.jsx("i",{className:"fas fa-images fa-3x mb-3 opacity-50"}),e.jsx("p",{className:"mb-1",children:"No hay imágenes en la galería"}),e.jsx("small",{children:'Arrastra archivos aquí o haz clic en "Agregar Imagen"'})]})]}),e.jsxs("div",{className:"mb-4",hidden:!m.has("items","pdf"),children:[e.jsxs("label",{className:"form-label fw-semibold text-dark mb-3",children:[e.jsx("i",{className:"fas fa-file-pdf me-2 text-danger"}),"Archivos PDF (Manuales / Catálogos)",k.filter(s=>!s.toDelete).length>0&&e.jsx("span",{className:"badge bg-danger ms-2",children:k.filter(s=>!s.toDelete).length})]}),e.jsx("input",{ref:ge,type:"file",multiple:!0,accept:".pdf",hidden:!0,onChange:Ye}),e.jsx("div",{className:"list-group mb-3",children:k.filter(s=>!s.toDelete).map((s,t)=>{const r=k.findIndex(l=>l===s);return e.jsxs("div",{draggable:!0,onDragStart:l=>es(l,r),onDragEnd:ss,onDragOver:ts,onDrop:l=>rs(l,r),className:"list-group-item d-flex align-items-center justify-content-between",style:{cursor:"grab",opacity:L===r?.5:1,backgroundColor:L===r?"#f8f9fa":"white",transition:"all 0.2s ease"},children:[e.jsxs("div",{className:"d-flex align-items-center flex-grow-1",style:{minWidth:0},children:[e.jsx("span",{className:"badge bg-danger me-3",style:{minWidth:"28px"},children:t+1}),e.jsx("i",{className:"fas fa-grip-vertical text-muted me-3"}),e.jsx("i",{className:"fas fa-file-pdf text-danger me-2"}),e.jsx("span",{className:"text-truncate",style:{maxWidth:"250px"},children:s.name})]}),e.jsxs("div",{className:"d-flex gap-2 flex-shrink-0",children:[!s.file&&e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-outline-primary",children:e.jsx("i",{className:"fas fa-eye"})}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:l=>Ze(l,r),children:e.jsx("i",{className:"fas fa-trash"})})]})]},r)})}),e.jsxs("button",{type:"button",className:"btn btn-outline-danger w-100",onClick:()=>ge.current.click(),children:[e.jsx("i",{className:"fas fa-plus me-2"}),"Agregar PDFs"]})]}),e.jsxs("div",{className:"mb-3",hidden:!m.has("items","linkvideo"),children:[e.jsxs("label",{className:"form-label fw-semibold text-dark mb-3",children:[e.jsx("i",{className:"fas fa-video me-2 text-success"}),"Links de Videos",C.filter(s=>!s.toDelete).length>0&&e.jsx("span",{className:"badge bg-success ms-2",children:C.filter(s=>!s.toDelete).length})]}),e.jsx("div",{className:"list-group mb-3",children:C.filter(s=>!s.toDelete).map((s,t)=>{const r=C.findIndex(l=>l===s);return e.jsxs("div",{draggable:!0,onDragStart:l=>is(l,r),onDragEnd:ns,onDragOver:cs,onDrop:l=>os(l,r),className:"list-group-item d-flex align-items-center justify-content-between",style:{cursor:"grab",opacity:M===r?.5:1,backgroundColor:M===r?"#f8f9fa":"white",transition:"all 0.2s ease"},children:[e.jsxs("div",{className:"d-flex align-items-center flex-grow-1",style:{minWidth:0,overflow:"hidden"},children:[e.jsx("span",{className:"badge bg-success me-3 flex-shrink-0",style:{minWidth:"28px"},children:t+1}),e.jsx("i",{className:"fas fa-grip-vertical text-muted me-3 flex-shrink-0"}),e.jsx("i",{className:"fas fa-video text-success me-2 flex-shrink-0"}),e.jsx("span",{className:"small",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%"},title:s.url,children:s.url})]}),e.jsxs("div",{className:"d-flex gap-2 flex-shrink-0 ms-2",children:[e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-outline-primary",children:e.jsx("i",{className:"fas fa-external-link-alt"})}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:l=>ls(l,r),children:e.jsx("i",{className:"fas fa-trash"})})]})]},r)})}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{ref:ae,type:"url",className:"form-control",placeholder:"https://youtube.com/watch?v=..."}),e.jsxs("button",{type:"button",className:"btn btn-success",onClick:as,children:[e.jsx("i",{className:"fas fa-plus me-2"}),"Agregar"]})]})]})]})]})})]})}),e.jsx("div",{className:"tab-pane fade",id:"features",role:"tabpanel","aria-labelledby":"features-tab",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-list-ul me-2"}),"Características"]})}),e.jsx("div",{className:"card-body",children:e.jsx(Ae,{ref:Oe,label:"Lista de Características",structure:"",value:be,onChange:je})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-cogs me-2"}),"Especificaciones"]})}),e.jsx("div",{className:"card-body",children:e.jsx(Ae,{ref:Le,label:"Especificaciones Técnicas",structure:{type:"",title:"",description:""},value:ve,onChange:ce,typeOptions:us})})]})}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card border-0 shadow-sm",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h6",{className:"mb-0",children:[e.jsx("i",{className:"fas fa-edit me-2"}),"Descripción Detallada"]})}),e.jsx("div",{className:"card-body",children:e.jsx(Ns,{eRef:ee,label:"Descripción Completa"})})]})})]})})]})]})}),e.jsx(Ie,{modalRef:oe,title:"Importar Datos",size:"sm",children:e.jsx(Ss,{gridRef:g,modalRef:oe})})]})};ws((F,b)=>{vs.createRoot(F).render(e.jsx(bs,{...b,title:"Items",children:e.jsx(ks,{...b})}))});
