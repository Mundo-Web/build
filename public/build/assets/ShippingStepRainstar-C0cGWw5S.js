import{r as e,j as a,f as s,ci as t,X as r,au as l,be as c,m as n,b6 as i}from"./vendor-react-SBvaUJTK.js";import{t as o}from"./OpenPayCardModal-C0HhlOHJ.js";import{G as p}from"./Footer-BligNWSa.js";import{C as d,N as x}from"./Number2Currency-BX4epFEo.js";import{G as b}from"./General-ClVW7qxN.js";import{S as m}from"./SalesRest-vA4KDG2S.js";import{B as u}from"./BancDropDown-FaFwF0Mb.js";import"./vendor-swiper-Cr_RrIb_.js";import"./BasicRest-Cgj77E-j.js";import"./BooleanLimit-q2Ad9fGY.js";const h=new m;function f({isOpen:i,onClose:m,cart:u=[],subTotal:f,igv:j,envio:g,totalFinal:N,request:k,coupon:v=null,descuentofinal:w=0,autoDiscounts:y=[],autoDiscountTotal:A=0}){const[R,C]=e.useState(!1),[_,E]=e.useState(null),O=e.useRef(null),S=()=>{_?T():O.current?.click()},T=async()=>{if(!R)if(_){C(!0);try{const e={...k,payment_proof:_,delivery_type:k.delivery_type||"domicilio",applied_promotions:k.applied_promotions?"string"==typeof k.applied_promotions?k.applied_promotions:JSON.stringify(k.applied_promotions):null},a=new FormData;Object.keys(e).forEach(s=>{let t=e[s];null!=t&&("object"!=typeof t||t instanceof File||(t=JSON.stringify(t)),a.append(s,t))});const s=await h.save(a);s&&(n.Local.delete(`${p.APP_CORRELATIVE}_cart`),location.href=`${location.origin}/cart?code=${s.code}`)}catch(e){o.error("Error al procesar el pago",{description:"Ocurrió un error al procesar tu pago"})}finally{C(!1)}}else o.error("Error al subir comprobante",{description:"Por favor, sube tu comprobante de pago"})};return a.jsx(s,{isOpen:i,onRequestClose:m,className:"absolute left-1/2 -translate-x-1/2 bg-white border-4 border-black shadow-[16px_16px_0px_0px_rgba(0,0,0,1)] w-[95%] max-w-4xl top-1/2 -translate-y-1/2 overflow-hidden outline-none",overlayClassName:"fixed inset-0 bg-white/80 backdrop-blur-sm z-[100]",ariaHideApp:!1,children:a.jsxs("div",{className:"flex flex-col md:flex-row min-h-[500px]",children:[a.jsxs("div",{className:"md:w-5/12 bg-black text-white p-8 flex flex-col relative overflow-hidden",children:[a.jsxs("div",{className:"relative z-10 flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx(t,{size:32,className:"text-white"}),a.jsxs("h2",{className:"text-3xl font-black uppercase tracking-tighter leading-none italic",children:["ESCANEA ",a.jsx("br",{})," EL"," ",a.jsx("span",{className:"text-neutral-500",children:"QR"})]})]}),a.jsx("div",{className:"flex justify-center mb-8 p-4 bg-white border-4 border-neutral-800",children:a.jsx("img",{src:`/assets/resources/${b.get("checkout_dwallet_qr")}`,alt:b.get("checkout_dwallet_name"),className:"h-48 w-auto object-contain",onError:e=>{e.currentTarget.src="/assets/img/salafabulosa/logoyape.png"}})}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-sm font-black uppercase tracking-[0.2em] text-neutral-500",children:"Detalle de Pago"}),a.jsxs("div",{className:"space-y-2 border-l-2 border-neutral-800 pl-4",children:[a.jsxs("div",{className:"flex justify-between text-[11px] font-black uppercase tracking-widest",children:[a.jsx("span",{children:"Subtotal"}),a.jsxs("span",{children:[d()," ",x(f)]})]}),a.jsxs("div",{className:"flex justify-between text-[11px] font-black uppercase tracking-widest",children:[a.jsx("span",{children:"Envío"}),a.jsxs("span",{children:[d()," ",x(g)]})]}),w>0&&a.jsxs("div",{className:"flex justify-between text-[11px] font-black uppercase tracking-widest text-red-500",children:[a.jsx("span",{children:"Descuento"}),a.jsxs("span",{children:["-",d()," ",x(w+A)]})]}),a.jsxs("div",{className:"flex justify-between text-lg font-black uppercase tracking-tight pt-2 border-t border-neutral-800 italic",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:[d()," ",x(N)]})]})]})]})]}),a.jsx("div",{className:"relative z-10 mt-8 text-[9px] font-black uppercase tracking-[0.3em] opacity-40",children:"RAINSTAR PROCESO DE PAGO SEGURO"}),a.jsx("div",{className:"absolute -bottom-10 -right-10 text-[100px] font-black opacity-[0.03] select-none pointer-events-none italic leading-none rotate-12",children:"YAPE"})]}),a.jsxs("div",{className:"flex-1 p-8 md:p-12 relative flex flex-col justify-center",children:[a.jsx("button",{onClick:m,className:"absolute top-8 right-8 text-black/20 hover:text-black transition-colors",children:a.jsx(r,{size:24})}),a.jsxs("div",{className:"mb-10",children:[a.jsx("h3",{className:"text-2xl font-black uppercase tracking-tight mb-2",children:b.get("checkout_dwallet_name")}),a.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-neutral-400",children:b.get("checkout_dwallet_description")||"REALIZA EL PAGO Y ADJUNTA LA CAPTURA DE PANTALLA"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsx("input",{type:"file",ref:O,onChange:e=>{const a=e.target.files[0];a&&E(a)},accept:"image/png, image/jpeg, application/pdf",className:"hidden"}),_?a.jsxs("div",{className:"relative bg-white border-4 border-black p-4 group",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-black text-white",children:a.jsx(c,{size:20})}),a.jsx("span",{className:"font-black uppercase tracking-tight text-sm truncate max-w-[200px]",children:_.name})]}),a.jsx("button",{onClick:()=>{E(null),O.current&&(O.current.value="")},className:"p-2 hover:bg-red-500 hover:text-white border-2 border-transparent hover:border-black transition-all",children:a.jsx(r,{size:20})})]}),_.type.startsWith("image/")&&a.jsx("div",{className:"border-2 border-black/5 p-2 overflow-hidden",children:a.jsx("img",{src:URL.createObjectURL(_),alt:"Voucher preview",className:"w-full h-48 object-contain"})})]}):a.jsxs("button",{onClick:S,className:"w-full aspect-video border-4 border-dashed border-black/10 hover:border-black hover:bg-neutral-50 transition-all flex flex-col items-center justify-center gap-4 group",children:[a.jsx("div",{className:"p-4 bg-neutral-100 group-hover:bg-black group-hover:text-white transition-colors border-2 border-black",children:a.jsx(l,{size:32})}),a.jsx("span",{className:"font-black uppercase tracking-widest text-xs",children:"Subir captura de pago"})]}),a.jsxs("div",{className:"flex flex-col gap-4 pt-6",children:[a.jsx("button",{onClick:S,disabled:R,className:"h-16 bg-black text-white px-8 flex items-center justify-center gap-4 group transition-all "+(R?"opacity-30 cursor-not-allowed":"hover:shadow-[8px_8px_0px_0px_rgba(0,0,0,0.2)]"),children:a.jsx("span",{className:"font-black uppercase tracking-widest italic",children:R?"PROCESANDO...":_?"CONFIRMAR PAGO":"SUBIR CAPTURA"})}),a.jsx("button",{onClick:m,disabled:R,className:"h-16 px-8 border-2 border-black font-black uppercase tracking-widest hover:bg-neutral-50 transition-colors italic",children:"CANCELAR"})]})]})]})]})})}const j=new m;function g({isOpen:t,onClose:b,cart:m=[],subTotal:h,igv:f,envio:g,totalFinal:N,request:k,contacts:v=[],coupon:w=null,descuentofinal:y=0,autoDiscounts:A=[],autoDiscountTotal:R=0}){const[C,_]=e.useState(!1),[E,O]=e.useState(null),S=e.useRef(null),T=()=>{E?P():S.current?.click()},P=async()=>{if(!C)if(E){_(!0);try{const e={...k,payment_proof:E},a=new FormData;Object.keys(e).forEach(s=>{let t=e[s];null!=t&&("object"!=typeof t||t instanceof File||(t=JSON.stringify(t)),a.append(s,t))});const s=await j.save(a);s&&(n.Local.delete(`${p.APP_CORRELATIVE}_cart`),location.href=`${location.origin}/cart?code=${s.code}`)}catch(e){o.error("Error al procesar el pago",{description:"Ocurrió un error al procesar tu pago"})}finally{_(!1)}}else o.error("Error al subir comprobante",{description:"Por favor, sube tu comprobante de pago"})};return a.jsx(s,{isOpen:t,onRequestClose:b,className:"absolute left-1/2 -translate-x-1/2 bg-white border-4 border-black shadow-[16px_16px_0px_0px_rgba(0,0,0,1)] w-[95%] max-w-4xl top-1/2 -translate-y-1/2 overflow-hidden outline-none font-paragraph",overlayClassName:"fixed inset-0 bg-white/80 backdrop-blur-sm z-[100]",ariaHideApp:!1,children:a.jsxs("div",{className:"flex flex-col md:flex-row min-h-[500px]",children:[a.jsxs("div",{className:"md:w-5/12 bg-black text-white p-8 flex flex-col relative overflow-hidden",children:[a.jsxs("div",{className:"relative z-10 flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx(i,{size:32,className:"text-white"}),a.jsxs("h2",{className:"text-3xl font-black uppercase tracking-tighter leading-none italic",children:["CUENTAS ",a.jsx("br",{})," DE"," ",a.jsx("span",{className:"text-neutral-500",children:"TRANSF."})]})]}),a.jsxs("div",{className:"mb-8 brutalist-banc-dropdown",children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"\n                                .brutalist-banc-dropdown select {\n                                    background: white !important;\n                                    color: black !important;\n                                    border: 4px solid #444 !important;\n                                    border-radius: 0 !important;\n                                    font-weight: 900 !important;\n                                    text-transform: uppercase !important;\n                                    font-size: 11px !important;\n                                    letter-spacing: 0.1em !important;\n                                }\n                                .brutalist-banc-dropdown div {\n                                    border-radius: 0 !important;\n                                }\n                            "}}),a.jsx(u,{contacts:v})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-sm font-black uppercase tracking-[0.2em] text-neutral-500",children:"Resumen de Venta"}),a.jsxs("div",{className:"space-y-2 border-l-2 border-neutral-800 pl-4",children:[a.jsxs("div",{className:"flex justify-between text-[11px] font-black uppercase tracking-widest",children:[a.jsx("span",{children:"Subtotal"}),a.jsxs("span",{children:[d()," ",x(h)]})]}),a.jsxs("div",{className:"flex justify-between text-[11px] font-black uppercase tracking-widest",children:[a.jsx("span",{children:"Envío"}),a.jsxs("span",{children:[d()," ",x(g)]})]}),a.jsxs("div",{className:"flex justify-between text-lg font-black uppercase tracking-tight pt-2 border-t border-neutral-800 italic",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:[d()," ",x(N)]})]})]})]})]}),a.jsx("div",{className:"relative z-10 mt-8 text-[9px] font-black uppercase tracking-[0.3em] opacity-40",children:"TRANSACCIÓN PROTEGIDA POR RAINSTAR"})]}),a.jsxs("div",{className:"flex-1 p-8 md:p-12 relative flex flex-col justify-center",children:[a.jsx("button",{onClick:b,className:"absolute top-8 right-8 text-black/20 hover:text-black transition-colors",children:a.jsx(r,{size:24})}),a.jsxs("div",{className:"mb-10",children:[a.jsx("h3",{className:"text-2xl font-black uppercase tracking-tight mb-2",children:"CONFIRMA TU PAGO"}),a.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-neutral-400",children:"ADJUNTA EL COMPROBANTE DE TU DEPÓSITO O TRANSFERENCIA"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsx("input",{type:"file",ref:S,onChange:e=>{const a=e.target.files[0];a&&O(a)},accept:"image/png, image/jpeg, application/pdf",className:"hidden"}),E?a.jsxs("div",{className:"relative bg-white border-4 border-black p-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3 text-sm font-black uppercase",children:[a.jsx(c,{size:24,className:"text-black"}),a.jsx("span",{className:"truncate max-w-[180px]",children:E.name})]}),a.jsx("button",{onClick:()=>{O(null),S.current&&(S.current.value="")},className:"hover:bg-black hover:text-white p-1 transition-colors",children:a.jsx(r,{size:20})})]}),E.type.startsWith("image/")&&a.jsx("img",{src:URL.createObjectURL(E),className:"w-full h-32 object-contain bg-neutral-50 p-2"})]}):a.jsxs("button",{onClick:T,className:"w-full h-48 border-4 border-dashed border-black/10 hover:border-black hover:bg-neutral-50 transition-all flex flex-col items-center justify-center gap-4 group",children:[a.jsx("div",{className:"p-4 bg-neutral-100 group-hover:bg-black group-hover:text-white transition-colors border-2 border-black",children:a.jsx(l,{size:32})}),a.jsx("span",{className:"font-black uppercase tracking-widest text-xs",children:"VINCULAR VOUCHER"})]}),a.jsxs("div",{className:"flex flex-col gap-4 pt-4",children:[a.jsx("button",{onClick:T,disabled:C,className:"h-16 bg-black text-white px-8 flex items-center justify-center transition-all "+(C?"opacity-30 cursor-not-allowed":"hover:shadow-[8px_8px_0px_0px_rgba(0,0,0,0.2)]"),children:a.jsx("span",{className:"font-black uppercase tracking-widest italic text-lg",children:C?"VALIDANDO...":E?"FINALIZAR COMPRA":"SUBIR VOUCHER"})}),a.jsx("button",{onClick:b,disabled:C,className:"h-16 px-8 border-2 border-black font-black uppercase tracking-widest hover:bg-neutral-100 transition-colors italic",children:"CANCELAR"})]})]})]})]})})}export{f as U,g as a};
