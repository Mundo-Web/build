import{r as e,j as s,i as r,s as a,m as l}from"./vendor-react-C1oWoR6m.js";import{C as t,N as n}from"./Number2Currency-BX4epFEo.js";import{L as i}from"./LaravelSession-ByQnaUD3.js";import{G as c}from"./General-ClVW7qxN.js";import{S as d}from"./SalesRest-COI9LL-D.js";import{S as o}from"./CartKuchara-BuGNrbqJ.js";import{G as m}from"./Footer-Cr_V_wDJ.js";import"./vendor-swiper-Cr_RrIb_.js";import"./BasicRest-DnRFj80Z.js";import"./OpenPayCardModal-DoDTV5Bn.js";import"./BooleanLimit-q2Ad9fGY.js";const x=new d,p=({data:d,cart:p,setCart:u,items:h,prefixes:b})=>{const[g,j]=e.useState("express"),[f,y]=e.useState({name:i.name,lastname:i.lastname,email:i.email,phone_prefix:i.phone_prefix||"51",phone:i.phone}),[N,v]=e.useState({departamento:"",provincia:"",distrito:"",calle:"",numero:"",referencia:""}),[w,k]=e.useState({type:"boleta",number:"",fullname:"",name:"",lastname:""}),[C,_]=e.useState("true"==c.get("checkout_culqi")?"culqi":"true"==c.get("checkout_dwallet")?"dwallet":"true"==c.get("checkout_transfer")?"transfer":null),[S,q]=e.useState(null),P=p.reduce((e,s)=>e+(s.discount>0?Math.min(s.price,s.discount):s.price)*s.quantity,0),B=e=>{const{name:s,value:r}=e.target;y(e=>({...e,[s]:r}))},[F,L]=e.useState(0),I=e=>{const{name:s,value:r}=e.target;v(e=>({...e,[s]:r})),"distrito"===s&&L((e=>{if("pickup"===g)return 0;const s=M.find(s=>s.id==e);return s?null===s.price?"destination":0===s.price?0:s.price:null})(r))};e.useEffect(()=>{const e=e=>{const r=e.element.dataset.code,l=e.element.dataset.flag;return a.renderToString(s.jsxs("span",{children:[s.jsx("span",{className:"inline-block w-8 font-emoji text-center",children:l}),s.jsx("b",{className:"me-1",children:e.text}),s.jsx("span",{className:"text-sm text-opacity-20",children:r})]}))};$(".select2-prefix-selector").select2({dropdownCssClass:"py-1",containerCssClass:"!border !border-gray-300 !rounded p-2 !h-[42px]",arrowCssClass:'!text-primary top-1/2 -translate-y-1/2"',templateResult:function(s){return s.id?$(e(s)):s.text},templateSelection:function(s){return s.id?$(e(s)):s.text}})},[f.phone_prefix]);const D=[...new Set(h.map(e=>e.data?.region))],E=[...new Set(h.filter(e=>e.data?.region==N.departamento).map(e=>e.data?.provincia))],M=[...new Set(h.filter(e=>e.data?.region==N.departamento&&e.data?.provincia==N.provincia).map(e=>({id:e.data?.reniec,name:e.data?.distrito,price:null===e.price?null:Number(e.price)})))];e.useEffect(()=>{0==p.length&&(location.href="/")},[]);const R=Number(c.igv_checkout)/100,T=P+("number"==typeof F?F:0);return s.jsx("form",{id:d?.element_id||null,className:"bg-white",onSubmit:async e=>{e.preventDefault();const{isConfirmed:s}=await o.fire({title:"¿Confirmar pedido?",text:"¿Estás seguro de realizar este pedido? Revise que todos los datos estén correctos antes de confirmar el pedido.",icon:"question",showCancelButton:!0,confirmButtonText:"Sí, confirmar",cancelButtonText:"Cancelar"});if(!s)return;const r={user_id:i.id,name:f.name,lastname:f.lastname,email:f.email,phone:f.phone,phone_prefix:f.phone_prefix,country:"Perú",delivery_type:g,ubigeo:"express"==g?N.distrito:null,address:N.calle,number:N.numero,reference:N.referencia,payment_method:C,invoiceType:w.type,documentType:"factura"===w.type?"ruc":"dni",document:w.number,businessName:w.fullname,details:JSON.stringify(p.map(e=>({id:e.id,quantity:e.quantity}))),payment_proof:S},a=new FormData;Object.keys(r).forEach(e=>{a.append(e,r[e])});const t=await x.save(a);t&&(u([]),l.Local.delete(`${m.APP_CORRELATIVE}_cart`),location.href=`${location.origin}/${d.url_thanks}/${t.code}`)},children:s.jsx("div",{className:"container mx-auto px-[5%] py-[2.5%]",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsxs("div",{className:"lg:col-span-2",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Información del contacto"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"name",className:"block text-sm mb-1",children:["Nombre ",s.jsx("b",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",id:"name",name:"name",value:f.name,onChange:B,className:"w-full p-2 border border-gray-300 rounded",placeholder:"Nombre",required:!0})]}),s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"lastname",className:"block text-sm mb-1",children:["Apellido ",s.jsx("b",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",id:"lastname",name:"lastname",value:f.lastname,onChange:B,className:"w-full p-2 border border-gray-300 rounded",placeholder:"Apellido",required:!0})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("label",{htmlFor:"email",className:"block text-sm mb-1",children:["E-mail ",s.jsx("b",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"email",id:"email",name:"email",value:f.email,onChange:B,className:"w-full p-2 border border-gray-300 rounded",placeholder:"Correo electrónico",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"phone",className:"block text-sm mb-1",children:"Celular"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("select",{className:"select2-prefix-selector w-[200px] p-2 border border-gray-300 rounded",onChange:e=>setSelectedPrefix(e.target.value),name:"phone_prefix",value:f.phone_prefix,children:[s.jsx("option",{value:"",children:"Selecciona un país"}),b.sort((e,s)=>e.country.localeCompare(s.country)).map((e,r)=>s.jsx("option",{value:e.realCode,"data-code":e.beautyCode,"data-flag":e.flag,children:e.country},r))]}),s.jsx("input",{type:"text",id:"phone",name:"phone",value:f.phone,onChange:B,className:"flex-1 p-2 border border-gray-300 rounded",placeholder:"000 000 000"})]})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Dirección de envío"}),"express"===g&&s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"departamento",className:"block text-sm mb-1",children:["Departamento ",s.jsx("b",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("select",{id:"departamento",name:"departamento",value:N.departamento,onChange:I,className:"w-full p-2 border border-gray-300 rounded appearance-none pr-8",required:"express"===g,children:[s.jsx("option",{value:"",children:"Selecciona un Departamento"}),D.sort((e,s)=>e.localeCompare(s)).map((e,r)=>s.jsx("option",{value:e,children:e},r))]}),s.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]}),s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"provincia",className:"block text-sm mb-1",children:["Provincia ",s.jsx("b",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("select",{id:"provincia",name:"provincia",value:N.provincia,onChange:I,className:"w-full p-2 border border-gray-300 rounded appearance-none pr-8",required:"express"===g,children:[s.jsx("option",{value:"",children:"Selecciona un Provincia"}),E.sort((e,s)=>e.localeCompare(s)).map((e,r)=>s.jsx("option",{value:e,children:e},r))]}),s.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]}),s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"distrito",className:"block text-sm mb-1",children:["Distrito ",s.jsx("b",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("select",{id:"distrito",name:"distrito",value:N.distrito,onChange:I,className:"w-full p-2 border border-gray-300 rounded appearance-none pr-8",required:"express"===g,children:[s.jsx("option",{value:"",children:"Selecciona un distrito"}),M.sort((e,s)=>e.name.localeCompare(s)).map((e,r)=>s.jsx("option",{value:e.id,"data-price":e.price,children:e.name},r))]}),s.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("label",{htmlFor:"calle",className:"block text-sm mb-1",children:["Avenida / Calle / Jirón ",s.jsx("b",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",id:"calle",name:"calle",value:N.calle,onChange:I,className:"w-full p-2 border border-gray-300 rounded",placeholder:"Ingresa el nombre de la calle",required:"express"===g})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{htmlFor:"numero",className:"block text-sm mb-1",children:["Número ",s.jsx("b",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"text",id:"numero",name:"numero",value:N.numero,onChange:I,className:"w-full p-2 border border-gray-300 rounded",placeholder:"Ingresa el número de la calle",required:"express"===g})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"referencia",className:"block text-sm mb-1",children:"Dpto./ Interior/ Piso/ Lote/ Bloque (opcional)"}),s.jsx("input",{type:"text",id:"referencia",name:"referencia",value:N.referencia,onChange:I,className:"w-full p-2 border border-gray-300 rounded",placeholder:"Ejem. Casa 3, Dpto 101"})]})]})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mt-6",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Método de pago"}),s.jsxs("div",{className:"space-y-3",children:["true"==c.get("checkout_culqi")&&s.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-2 rounded-lg cursor-pointer "+("culqi"===C?"border-primary bg-gray-100":"border-gray-200"),onClick:()=>_("culqi"),children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center "+("culqi"===C?"border-primary":"border-gray-400"),children:"culqi"===C&&s.jsx("div",{className:"w-3 h-3 rounded-full bg-primary"})}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{children:"Pago con tarjeta"}),s.jsx("small",{className:"text-xs text-opacity-60 text-black",children:"Formulario Culqi"})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("img",{src:"/build/PaymentMethods.svg",alt:"Métodos de pago - Culqi",className:"h-[25px]"})})]}),"true"==c.get("checkout_dwallet")&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-2 rounded-lg cursor-pointer "+("dwallet"===C?"border-primary bg-gray-100":"border-gray-200"),onClick:()=>_("dwallet"),children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center "+("dwallet"===C?"border-primary":"border-gray-400"),children:"dwallet"===C&&s.jsx("div",{className:"w-3 h-3 rounded-full bg-primary"})}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{children:"Yape / Plin"}),s.jsx("small",{className:"text-xs text-opacity-60 text-black",children:"Billeteras digitales"})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(r,{content:"Yape BCP",children:s.jsx("img",{src:"/assets/img/banks/yape.png",alt:"Yape BCP",className:"h-6"})}),s.jsx(r,{content:"Plin Interbank",children:s.jsx("img",{src:"/assets/img/banks/plin.png",alt:"Plin Interbank",className:"h-6"})})]})]}),"dwallet"===C&&s.jsx("div",{className:"mt-4 p-4 bg-white rounded-lg",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("img",{src:`/assets/resources/${c.get("checkout_dwallet_qr")}`,alt:c.get("checkout_dwallet_name"),className:"w-full lg:w-48 border rounded"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-xl font-semibold mb-2",children:c.get("checkout_dwallet_name")}),s.jsx("p",{className:"text-gray-600 mb-4",children:c.get("checkout_dwallet_description")}),s.jsx("input",{type:"file",accept:"image/*",onChange:e=>q(e.target.files[0]),className:"block w-full text-sm text-gray-800\n                              file:mr-4 file:py-2 file:px-4\n                              file:rounded-full file:border-0\n                              file:text-sm file:font-semibold\n                              file:bg-primary file:text-white\n                              hover:file:bg-primary/90 cursor-pointer"})]})]})})]}),"true"==c.get("checkout_transfer")&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-2 rounded-lg cursor-pointer "+("transfer"===C?"border-primary bg-gray-100":"border-gray-200"),onClick:()=>_("transfer"),children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center "+("transfer"===C?"border-primary":"border-gray-400"),children:"transfer"===C&&s.jsx("div",{className:"w-3 h-3 rounded-full bg-primary"})}),s.jsx("span",{children:"Transferencia"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("img",{src:"/assets/img/banks/bcp.svg",alt:"BCP",className:"h-4"}),s.jsx("img",{src:"/assets/img/banks/interbank.svg",alt:"Interbank",className:"h-4"}),s.jsx("img",{src:"/assets/img/banks/bbva.svg",alt:"BBVA",className:"h-4"})]})]}),"transfer"===C&&s.jsxs("div",{className:"mt-4 p-4 bg-white rounded-lg",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"font-medium mb-0",children:c.get("checkout_transfer_name")}),s.jsx("p",{className:"text-gray-600 mb-4",children:c.get("checkout_transfer_description")}),s.jsx("p",{className:"text-sm",children:"Código de Cuenta Interbancario (CCI)"}),s.jsx("p",{className:"font-mono bg-gray-50 p-2 rounded select-all",children:c.get("checkout_transfer_cci")}),s.jsx("a",{href:"#",className:"text-primary text-sm hover:underline",children:"Envía tu comprobante"})]}),s.jsx("div",{className:"mt-4",children:s.jsx("input",{type:"file",accept:"image/*",onChange:e=>q(e.target.files[0]),className:"block w-full text-sm text-gray-500\n                            file:mr-4 file:py-2 file:px-4\n                            file:rounded-full file:border-0\n                            file:text-sm file:font-semibold\n                            file:bg-primary file:text-white\n                            hover:file:bg-primary/90"})})]})]})]}),s.jsxs("div",{className:"space-y-3 mt-6 border-t pt-6",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Datos de facturación"}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex gap-2 w-full",children:[s.jsxs("label",{className:"flex-1",children:[s.jsx("input",{type:"radio",name:"document_type",value:"boleta",checked:"boleta"==w.type,className:"hidden",onChange:e=>k(s=>({...s,type:e.target.value}))}),s.jsxs("div",{className:`w-full flex gap-3 items-center text-center py-3 px-4 rounded-lg border-2 cursor-pointer transition-all ${"boleta"==w.type?"border-primary bg-gray-100":"border-gray-200"} `,children:[s.jsx("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center "+("boleta"===w.type?"border-primary":"border-gray-400"),children:"boleta"===w.type&&s.jsx("div",{className:"w-3 h-3 rounded-full bg-primary"})}),s.jsx("span",{children:"Boleta"})]})]}),s.jsxs("label",{className:"flex-1",children:[s.jsx("input",{type:"radio",name:"document_type",value:"factura",checked:"factura"==w.type,className:"hidden",onChange:e=>k(s=>({...s,type:e.target.value}))}),s.jsxs("div",{className:`w-full flex gap-3 items-center text-center py-3 px-4 rounded-lg border-2 cursor-pointer transition-all ${"factura"==w.type?"border-primary bg-gray-100":"border-gray-200"} `,children:[s.jsx("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center "+("factura"===w.type?"border-primary":"border-gray-400"),children:"factura"===w.type&&s.jsx("div",{className:"w-3 h-3 rounded-full bg-primary"})}),s.jsx("span",{children:"Factura"})]})]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("label",{className:"block text-sm mb-1",children:[s.jsxs("span",{children:["Número de ","factura"==w.type?"RUC":"DNI"]}),s.jsx("b",{className:"text-red-500 ms-1",children:"*"})]}),s.jsx("input",{type:"text",className:"w-full p-2 border border-gray-300 rounded",placeholder:"factura"==w.type?"00000000000":"00000000",maxLength:"factura"==w.type?11:8,required:!0,value:w.number,onChange:e=>k(s=>({...s,number:e.target.value}))})]}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("label",{className:"block text-sm mb-1",children:["factura"==w.type?"Razón Social":"Nombre completo",s.jsx("b",{className:"text-red-500 ms-1",children:"*"})]}),s.jsx("input",{type:"text",className:"w-full p-2 border border-gray-300 rounded",placeholder:"Nombre de razón social",value:w.fullname,onChange:e=>k(s=>({...s,fullname:e.target.value})),required:!0})]})]})]})]})]}),s.jsx("div",{className:"lg:col-span-1",children:s.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 sticky top-6",children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Resumen del pedido"}),s.jsx("div",{className:"space-y-6 mb-6",children:p.map((e,r)=>s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"w-16",children:s.jsx("img",{src:`/storage/images/item/${e.image}`,onError:e=>e.target.src="/assets/img/noimage/no_img.jpg",alt:e.name,className:"w-16 object-cover object-center aspect-[4/3] rounded"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-medium line-clamp-2 leading-none mb-2",children:e.name||`Producto ${r+1}`}),s.jsxs("p",{className:"text-xs text-gray-500",children:["SKU: ",e.sku]}),s.jsxs("div",{className:"flex justify-between items-center mt-2",children:[s.jsx("div",{className:"border border-gray-300 rounded w-12 text-center py-0.5 text-sm bg-white",children:e.quantity.toString().padStart(2,"0")}),s.jsxs("div",{className:"leading-none text-end",children:[e.discount_percent>0&&s.jsxs("small",{className:"line-through text-xs text-gray-500",children:[t()," ",n(e.price)]}),s.jsxs("span",{className:"font-medium block",children:[t()," ",n(e.final_price)]})]})]})]})]},r))}),s.jsxs("div",{className:"space-y-3 pt-4 border-t border-gray-200",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("p",{children:"Envío"}),s.jsxs("span",{className:"text-primary font-medium",children:["pickup"===g&&"Gratis","express"===g&&(0===F?"Gratis":null===F?"No disponible":"destination"===F?"Pago en destino":`{CurrencySymbol()} ${n(F)}`)]})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("p",{children:"Subtotal"}),s.jsxs("span",{children:[t()," ",n(R>0?T*(1-R):T)]})]}),R>0&&s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("p",{children:["IGV (",(100*R).toFixed(2),"%)"]}),s.jsxs("span",{children:[t()," ",n(T*R)]})]}),s.jsxs("div",{className:"flex justify-between items-center font-semibold text-lg pt-2 border-t border-gray-200",children:[s.jsx("p",{children:"Total"}),s.jsxs("span",{children:[t()," ",n(T)]})]}),s.jsxs("button",{className:"text-white w-full px-4 py-3 rounded-full cursor-pointer inline-block text-center font-medium mt-4 "+("express"!==g||null!==F&&"destination"!==F?"bg-primary":"bg-gray-400 cursor-not-allowed"),children:["Pagar (",t()," ",n(P+("number"==typeof F?F:0)),")"]})]})]})})]})})})};export{p as default};
