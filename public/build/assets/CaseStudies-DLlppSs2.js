var e=Object.defineProperty,a=(a,s,i)=>((a,s,i)=>s in a?e(a,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[s]=i)(a,"symbol"!=typeof s?s+"":s,i);import{c as s,j as i,r as t}from"./vendor-react-CtPXetfm.js";import{B as r}from"./Base-B2hVq4yw.js";import{S as l}from"./SwitchFormGroup-CB0qoXn0.js";import{T as o}from"./TextareaFormGroup-DXMahSF1.js";import{S as n}from"./CartKuchara-Bi-J8T1O.js";import{B as d}from"./BasicRest-DtgqEuc9.js";import{I as c}from"./ImageFormGroup-Cr7oEweG.js";import{I as m}from"./InputFormGroup-CRGKsLQr.js";import{M as u}from"./Modal-CUkY7A3F.js";import{T as p}from"./Table-CjNT5pP4.js";import{D as h}from"./DxButton-C6FT_beP.js";import{C as f}from"./CreateReactScript-Cjoo020C.js";import{R as b}from"./ReactAppend-RIOEhuYO.js";import{g as x}from"./getYTVideoId-Y8XMBBj_.js";import"./vendor-swiper-Cr_RrIb_.js";import"./Footer-coriRrmf.js";import"./TippyButton-Dqi9Vaf_.js";import"./Logout-DQyEsGXW.js";import"./MenuItemContainer-UDNHvqM7.js";import"./Menu-BjIZNCK0.js";import"./OpenPayCardModal-CbSnHq7o.js";import"./BooleanLimit-q2Ad9fGY.js";import"./General-ClVW7qxN.js";import"./LaravelSession-ByQnaUD3.js";const j=new class extends d{constructor(){super(...arguments),a(this,"path","admin/case-studies"),a(this,"hasFiles",!0)}},v=()=>{const e=t.useRef(),a=t.useRef(),s=t.useRef(),r=t.useRef(),d=t.useRef(),f=t.useRef(),v=t.useRef(),[g,w]=t.useState(!1),[N,y]=t.useState(""),R=e=>{w(!!e?.id),v.resetDeleteFlag&&v.resetDeleteFlag(),s.current.value=e?.id??"",r.current.value=e?.name??"",d.current.value=e?.description??"",f.current.value=e?.video_url??"",y(x(e?.video_url)||""),v.image.src=e?.image?`/storage/images/case_study/${e.image}`:"",v.current.value=null,$(a.current).modal("show")};return i.jsxs(i.Fragment,{children:[i.jsx(p,{gridRef:e,title:"Casos Reales (Videos)",rest:j,rowDragging:{allowReordering:!0,onReorder:async e=>{const a=e.toIndex;try{await j.reorder(e.itemData.id,a)&&await e.component.refresh()}catch(s){}},dropFeedbackMode:"push"},sorting:{mode:"single"},toolBar:a=>{a.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(e.current).dxDataGrid("instance").refresh()}}),a.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo video",hint:"Nuevo video",onClick:()=>R()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"order_index",caption:"Orden",visible:!1,sortOrder:"asc",sortIndex:0},{dataField:"image",caption:"Imagen",width:"120px",allowFiltering:!1,cellTemplate:(e,{data:a})=>{const s=x(a.video_url),t=a.image?`/storage/images/case_study/${a.image}`:s?`https://img.youtube.com/vi/${s}/mqdefault.jpg`:null;t?b(e,i.jsx("img",{src:t,style:{width:"100px",height:"56px",objectFit:"cover",borderRadius:"4px"},alt:a.name})):e.text("Sin imagen")}},{dataField:"video_url",caption:"Video",width:"80px",allowFiltering:!1,cellTemplate:(e,{data:a})=>{const s=x(a.video_url);s||a.video_url?e.append(h({className:"btn btn-xs btn-soft-success",title:"Reproducir video",icon:"fa fa-play",onClick:()=>{const e=`https://www.youtube.com/embed/${s}?autoplay=1`;n.fire({html:`\n                                                    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">\n                                                        <iframe \n                                                            src="${e}"\n                                                            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0;"\n                                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"\n                                                            allowfullscreen\n                                                        ></iframe>\n                                                    </div>\n                                                `,title:a.name,width:"800px",showCloseButton:!0,showConfirmButton:!1})}})):e.text("Sin video")}},{dataField:"name",caption:"Título",width:"30%"},{dataField:"description",caption:"Descripción",width:"40%"},{dataField:"visible",caption:"Visible",dataType:"boolean",cellTemplate:(a,{data:s})=>{$(a).empty(),b(a,i.jsx(l,{checked:1==s.visible,onChange:()=>(async({id:a,value:s})=>{await j.boolean({id:a,field:"visible",value:s})&&$(e.current).dxDataGrid("instance").refresh()})({id:s.id,value:!s.visible})}))}},{caption:"Acciones",cellTemplate:(a,{data:s})=>{a.css("text-overflow","unset"),a.append(h({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>R(s)})),a.append(h({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>(async a=>{const{isConfirmed:s}=await n.fire({title:"Eliminar registro",text:"¿Estas seguro de eliminar este registro?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});if(!s)return;await j.delete(a.id)&&$(e.current).dxDataGrid("instance").refresh()})(s)}))},allowFiltering:!1,allowExporting:!1}]}),i.jsxs(u,{modalRef:a,title:i.jsxs("div",{className:"d-flex align-items-center",children:[i.jsx("i",{className:`fas ${g?"fa-edit":"fa-plus-circle"} me-2 text-primary`}),g?"Editar Caso Real":"Nuevo Caso Real"]}),onSubmit:async i=>{i.preventDefault();const t={id:s.current.value||void 0,name:r.current.value,description:d.current.value,video_url:f.current.value},l=new FormData;for(const e in t)l.append(e,t[e]);const o=v.current.files[0];o&&l.append("image",o),v.getDeleteFlag&&v.getDeleteFlag()&&l.append("image_delete","DELETE");await j.save(l)&&(v.resetDeleteFlag&&v.resetDeleteFlag(),$(e.current).dxDataGrid("instance").refresh(),$(a.current).modal("hide"))},size:"xl",children:[i.jsx("input",{ref:s,type:"hidden"}),i.jsxs("ul",{className:"nav nav-pills nav-justified bg-light rounded mb-3 p-2",role:"tablist",children:[i.jsx("li",{className:"nav-item",children:i.jsxs("a",{className:"nav-link active","data-bs-toggle":"tab",href:"#info-tab",role:"tab",children:[i.jsx("i",{className:"fas fa-info-circle me-1"}),i.jsx("span",{className:"d-none d-sm-inline",children:"Información"})]})}),i.jsx("li",{className:"nav-item",children:i.jsxs("a",{className:"nav-link","data-bs-toggle":"tab",href:"#video-tab",role:"tab",children:[i.jsx("i",{className:"fas fa-video me-1"}),i.jsx("span",{className:"d-none d-sm-inline",children:"Video"})]})}),i.jsx("li",{className:"nav-item",children:i.jsxs("a",{className:"nav-link","data-bs-toggle":"tab",href:"#image-tab",role:"tab",children:[i.jsx("i",{className:"fas fa-image me-1"}),i.jsx("span",{className:"d-none d-sm-inline",children:"Thumbnail"})]})})]}),i.jsxs("div",{className:"tab-content",children:[i.jsx("div",{className:"tab-pane fade show active",id:"info-tab",role:"tabpanel",children:i.jsxs("div",{className:"card border-0 shadow-sm mb-3",children:[i.jsxs("div",{className:"card-header bg-primary text-white",children:[i.jsx("i",{className:"fas fa-file-alt me-2"}),"Datos del Caso"]}),i.jsxs("div",{className:"card-body",children:[i.jsx(m,{eRef:r,label:i.jsxs("span",{children:[i.jsx("i",{className:"fas fa-heading text-primary me-1"}),"Título del Caso"]}),required:!0,placeholder:"Ej: Manga Gástrica - María perdió 45kg en 8 meses",helpText:"Un título descriptivo y atractivo para el caso de éxito"}),i.jsx(o,{eRef:d,label:i.jsxs("span",{children:[i.jsx("i",{className:"fas fa-align-left text-primary me-1"}),"Descripción del Caso"]}),rows:4,placeholder:"Describe la historia del paciente, procedimiento realizado, resultados obtenidos...",helpText:"Una descripción detallada ayuda a inspirar confianza en futuros pacientes"})]})]})}),i.jsx("div",{className:"tab-pane fade",id:"video-tab",role:"tabpanel",children:i.jsxs("div",{className:"card border-0 shadow-sm mb-3",children:[i.jsxs("div",{className:"card-header bg-danger text-white",children:[i.jsx("i",{className:"fab fa-youtube me-2"}),"Video Testimonio"]}),i.jsxs("div",{className:"card-body",children:[i.jsx(m,{eRef:f,label:i.jsxs("span",{children:[i.jsx("i",{className:"fas fa-link text-danger me-1"}),"URL del Video"]}),placeholder:"https://www.youtube.com/watch?v=...",onChange:e=>y(x(e.target.value)||""),helpText:"Pega la URL completa del video de YouTube o Vimeo (opcional si subes imagen)"}),N&&i.jsxs("div",{className:"mt-3",children:[i.jsxs("label",{className:"form-label fw-bold",children:[i.jsx("i",{className:"fas fa-eye text-info me-1"}),"Vista Previa del Video"]}),i.jsx("div",{className:"ratio ratio-16x9 rounded overflow-hidden shadow-sm border",children:i.jsx("iframe",{src:`https://www.youtube.com/embed/${N}`,title:"Vista previa del video",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})]}),!N&&i.jsxs("div",{className:"alert alert-info mt-3",children:[i.jsx("i",{className:"fas fa-info-circle me-2"}),"Ingresa una URL de video para ver la vista previa"]})]})]})}),i.jsx("div",{className:"tab-pane fade",id:"image-tab",role:"tabpanel",children:i.jsxs("div",{className:"card border-0 shadow-sm mb-3",children:[i.jsxs("div",{className:"card-header bg-success text-white",children:[i.jsx("i",{className:"fas fa-image me-2"}),"Imagen Personalizada"]}),i.jsxs("div",{className:"card-body",children:[i.jsxs("div",{className:"alert alert-warning",children:[i.jsx("i",{className:"fas fa-lightbulb me-2"}),i.jsx("strong",{children:"Recomendación:"})," Sube una imagen de alta calidad (1280x720px) para mejorar la presentación del caso"]}),i.jsx(c,{eRef:v,label:i.jsxs("span",{children:[i.jsx("i",{className:"fas fa-upload text-success me-1"}),"Thumbnail Personalizado"]}),helpText:"Esta imagen se mostrará en lugar del thumbnail de YouTube. Formato recomendado: JPG o PNG, 1280x720px",aspect:16/9}),i.jsxs("div",{className:"mt-3 p-3 bg-light rounded",children:[i.jsxs("h6",{className:"text-muted mb-2",children:[i.jsx("i",{className:"fas fa-question-circle me-1"}),"¿Cuándo usar imagen personalizada?"]}),i.jsxs("ul",{className:"small text-muted mb-0",children:[i.jsx("li",{children:"Cuando quieras un thumbnail más profesional que el de YouTube"}),i.jsx("li",{children:"Para mantener consistencia visual en tu sitio"}),i.jsx("li",{children:"Si el thumbnail automático de YouTube no se ve bien"}),i.jsx("li",{children:"Para casos sin video (solo testimonial con foto)"})]})]})]})]})})]}),i.jsxs("div",{className:"alert alert-secondary border-0 shadow-sm",children:[i.jsx("i",{className:"mdi mdi-information-outline me-2"}),i.jsx("strong",{children:"Nota:"})," Puedes agregar solo video, solo imagen, o ambos. La imagen personalizada tendrá prioridad sobre el thumbnail de YouTube."]})]})]})};f((e,a)=>{s.createRoot(e).render(i.jsx(r,{...a,title:"Casos Reales (Videos)",children:i.jsx(v,{...a})}))});
