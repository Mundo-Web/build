var e=Object.defineProperty,t=(t,o,a)=>((t,o,a)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[o]=a)(t,"symbol"!=typeof o?o+"":o,a);import{c as o,j as a,r as n,s as l}from"./vendor-react-LJZQRWVP.js";import{B as r}from"./Base-DKNVGqY6.js";import{C as i}from"./CreateReactScript-1qFalD4_.js";import{T as s}from"./Table-_Mka0EYb.js";import{R as c}from"./ReactAppend-DwMsYvyu.js";import{D as d}from"./DxButton-C6FT_beP.js";import{S as m}from"./SwitchFormGroup-DmF3CemX.js";import{S as p}from"./CartKuchara-B42NOSvQ.js";import{B as f}from"./BasicRest-BX2nxOrK.js";import"./vendor-swiper-Cr_RrIb_.js";import"./Footer-DCwBNfoi.js";import"./TippyButton-CwI1PIG0.js";import"./Logout-CZL0vZGv.js";import"./MenuItemContainer-Bn3kuPvp.js";import"./Menu-CEdT8p4D.js";import"./General-ClVW7qxN.js";import"./LaravelSession-ByQnaUD3.js";import"./BooleanLimit-q2Ad9fGY.js";import"./Modal-vo2KOb7R.js";import"./OpenPayCardModal-CIqEZuEl.js";const u=new class extends f{constructor(){super(...arguments),t(this,"path","admin/clients"),t(this,"hasFiles",!1)}async promote(e){return await this.post(`${this.path}/${e}/promote`)}},b=({})=>{const e=n.useRef();return a.jsx(a.Fragment,{children:a.jsx(s,{gridRef:e,title:"Clientes",rest:u,toolBar:t=>{t.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(e.current).dxDataGrid("instance").refresh()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"name",caption:"Cliente",width:"25%",cellTemplate:(e,{data:t})=>{c(e,a.jsxs("div",{children:[a.jsxs("strong",{children:[t.name," ",t.lastname||""]}),a.jsx("br",{}),a.jsx("small",{className:"text-muted",children:t.email})]}))}},{dataField:"phone",caption:"Teléfono",cellTemplate:(e,{data:t})=>{t.phone?c(e,a.jsxs("span",{children:[t.phone_prefix||"+51"," ",t.phone]})):c(e,a.jsx("span",{className:"text-muted",children:"- Sin teléfono -"}))}},{dataField:"document_number",caption:"Documento",cellTemplate:(e,{data:t})=>{t.document_number?c(e,a.jsx("div",{children:a.jsxs("span",{children:[t.document_type||"DOC",": ",t.document_number]})})):c(e,a.jsx("span",{className:"text-muted",children:"- Sin documento -"}))}},{dataField:"city",caption:"Ubicación",cellTemplate:(e,{data:t})=>{const o=[t.city,t.department].filter(Boolean).join(", ");c(e,o?a.jsx("span",{children:o}):a.jsx("span",{className:"text-muted",children:"- Sin ubicación -"}))}},{dataField:"created_at",caption:"Registro",dataType:"date",cellTemplate:(e,{data:t})=>{const o=new Date(t.created_at);e.html(l.renderToString(a.jsxs(a.Fragment,{children:[a.jsx("div",{children:o.toLocaleDateString("es-ES")}),a.jsx("small",{className:"text-muted",children:o.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})})]})))}},{dataField:"status",caption:"Estado",dataType:"boolean",width:"120px",cellTemplate:(t,{data:o})=>{c(t,a.jsx(m,{checked:1==o.status,onChange:t=>(async({id:t,value:o})=>{const{isConfirmed:a}=await p.fire({title:o?"Activar cliente":"Desactivar cliente",text:`¿Estás seguro de ${o?"activar":"desactivar"} este cliente?`,icon:"question",showCancelButton:!0,confirmButtonText:"Sí, continuar",cancelButtonText:"Cancelar"});if(!a)return void $(e.current).dxDataGrid("instance").refresh();await u.boolean({id:t,field:"status",value:o})&&$(e.current).dxDataGrid("instance").refresh()})({id:o.id,value:t.target.checked})}))}},{caption:"Acciones",cellTemplate:(t,{data:o})=>{t.css("text-overflow","unset"),t.append(d({className:"btn btn-xs btn-soft-info",title:"Ver detalles",icon:"fa fa-eye",onClick:()=>(e=>{const t=new Date(e.created_at),o=t.toLocaleDateString("es-ES")+" "+t.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"});p.fire({title:"Detalles del Cliente",html:`\n        <div style="text-align: left; max-width: 100%;">\n          <form style="padding: 20px 0;">\n            <div class="row">\n              \n              \x3c!-- Columna Izquierda --\x3e\n              <div class="col-md-6">\n                <div class="form-group mb-3">\n                  <label class="form-label" style="font-weight: 600; color: #495057; margin-bottom: 5px;">Nombre Completo</label>\n                  <input type="text" class="form-control" value="${e.name} ${e.lastname||""}" readonly style="background-color: #f8f9fa;">\n                </div>\n                \n                <div class="form-group mb-3">\n                  <label class="form-label" style="font-weight: 600; color: #495057; margin-bottom: 5px;">Email</label>\n                  <input type="email" class="form-control" value="${e.email||""}" readonly style="background-color: #f8f9fa;" placeholder="No especificado">\n                </div>\n                \n                <div class="form-group mb-3">\n                  <label class="form-label" style="font-weight: 600; color: #495057; margin-bottom: 5px;">Teléfono</label>\n                  <input type="text" class="form-control" value="${e.phone?(e.phone_prefix||"+51")+" "+e.phone:""}" readonly style="background-color: #f8f9fa;" placeholder="No especificado">\n                </div>\n                \n                ${e.alternate_phone?`\n                <div class="form-group mb-3">\n                  <label class="form-label" style="font-weight: 600; color: #495057; margin-bottom: 5px;">Teléfono Alternativo</label>\n                  <input type="text" class="form-control" value="${e.alternate_phone}" readonly style="background-color: #f8f9fa;">\n                </div>\n                `:""}\n                \n                <div class="form-group mb-3">\n                  <label class="form-label" style="font-weight: 600; color: #495057; margin-bottom: 5px;">Tipo de Documento</label>\n                  <input type="text" class="form-control" value="${e.document_type||""}" readonly style="background-color: #f8f9fa;" placeholder="No especificado">\n                </div>\n              </div>\n              \n              \x3c!-- Columna Derecha --\x3e\n              <div class="col-md-6">\n                <div class="form-group mb-3">\n                  <label class="form-label" style="font-weight: 600; color: #495057; margin-bottom: 5px;">Número de Documento</label>\n                  <input type="text" class="form-control" value="${e.document_number||""}" readonly style="background-color: #f8f9fa;" placeholder="No especificado">\n                </div>\n                \n                <div class="form-group mb-3">\n                  <label class="form-label" style="font-weight: 600; color: #495057; margin-bottom: 5px;">Dirección</label>\n                  <input type="text" class="form-control" value="${e.address||""}" readonly style="background-color: #f8f9fa;" placeholder="No especificada">\n                </div>\n                \n                <div class="form-group mb-3">\n                  <label class="form-label" style="font-weight: 600; color: #495057; margin-bottom: 5px;">Distrito</label>\n                  <input type="text" class="form-control" value="${e.district||""}" readonly style="background-color: #f8f9fa;" placeholder="No especificado">\n                </div>\n                \n                <div class="form-group mb-3">\n                  <label class="form-label" style="font-weight: 600; color: #495057; margin-bottom: 5px;">Provincia</label>\n                  <input type="text" class="form-control" value="${e.province||""}" readonly style="background-color: #f8f9fa;" placeholder="No especificado">\n                </div>\n                \n                <div class="form-group mb-3">\n                  <label class="form-label" style="font-weight: 600; color: #495057; margin-bottom: 5px;">Departamento</label>\n                  <input type="text" class="form-control" value="${e.department||""}" readonly style="background-color: #f8f9fa;" placeholder="No especificado">\n                </div>\n              </div>\n              \n              \x3c!-- Fila completa para campos adicionales --\x3e\n              <div class="col-12">\n                ${e.reference?`\n                <div class="form-group mb-3">\n                  <label class="form-label" style="font-weight: 600; color: #495057; margin-bottom: 5px;">Referencia</label>\n                  <textarea class="form-control" readonly style="background-color: #f8f9fa; resize: none;" rows="2">${e.reference}</textarea>\n                </div>\n                `:""}\n                \n                <div class="row">\n                  <div class="col-md-6">\n                    <div class="form-group mb-3">\n                      <label class="form-label" style="font-weight: 600; color: #495057; margin-bottom: 5px;">Estado</label>\n                      <input type="text" class="form-control ${1==e.status?"border-success":"border-danger"}" \n                             value="${1==e.status?"Activo":"Inactivo"}" readonly \n                             style="background-color: ${1==e.status?"#d4edda":"#f8d7da"}; \n                                    color: ${1==e.status?"#155724":"#721c24"}; \n                                    font-weight: 600;">\n                    </div>\n                  </div>\n                  <div class="col-md-6">\n                    <div class="form-group mb-3">\n                      <label class="form-label" style="font-weight: 600; color: #495057; margin-bottom: 5px;">Fecha de Registro</label>\n                      <input type="text" class="form-control" value="${o}" readonly style="background-color: #f8f9fa;">\n                    </div>\n                  </div>\n                </div>\n              </div>\n              \n            </div>\n          </form>\n        </div>\n      `,width:"800px",showConfirmButton:!0,confirmButtonText:"Cerrar",confirmButtonColor:"#6c757d",allowOutsideClick:!0,allowEscapeKey:!0,customClass:{popup:"client-details-modal"},didOpen:()=>{const e=document.createElement("style");e.innerHTML="\n          .client-details-modal {\n            border-radius: 8px !important;\n          }\n          .client-details-modal .swal2-title {\n            color: #495057 !important;\n            font-size: 1.5rem !important;\n            font-weight: 600 !important;\n            margin-bottom: 10px !important;\n          }\n          .client-details-modal .swal2-html-container {\n            margin: 0 !important;\n            padding: 0 20px 20px 20px !important;\n          }\n          .client-details-modal .form-control:read-only {\n            cursor: default !important;\n          }\n          .client-details-modal .form-label {\n            font-size: 0.9rem !important;\n          }\n        ",document.head.appendChild(e)}})})(o)})),t.append(d({className:"btn btn-xs btn-soft-warning",title:"Convertir en Proveedor",icon:"fa fa-user-tie",onClick:async()=>{const{isConfirmed:t}=await p.fire({title:"¿Convertir en Proveedor?",text:`"${o.name}" perderá su rol de Cliente y se convertirá en Proveedor. Tendrá su propio código de referido UUID.`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, convertir",cancelButtonText:"Cancelar"});if(!t)return;await u.promote(o.id)&&($(e.current).dxDataGrid("instance").refresh(),p.fire("¡Éxito!","El usuario ahora es un Proveedor","success"))}}))},allowFiltering:!1,allowExporting:!1}]})})};i((e,t)=>{o.createRoot(e).render(a.jsx(r,{...t,title:"Clientes",children:a.jsx(b,{...t})}))});
