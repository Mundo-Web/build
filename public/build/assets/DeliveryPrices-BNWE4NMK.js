import{c as e,j as t,r,s as i}from"./vendor-react-CIhVE-fi.js";import{D as a}from"./DeliveryPricesRest-BV6kTizR.js";import{C as o}from"./CreateReactScript-CJuSZN_P.js";import{S as n}from"./CartKuchara-Dxib2Hfv.js";import{B as s}from"./Base-Dwd-EVOk.js";import{D as l}from"./DxButton-CkntFyfB.js";import{M as c}from"./Modal-Cuv1yX0O.js";import{T as d}from"./Table-z3FQB1jx.js";import{I as p}from"./InputFormGroup-DMBz8i6i.js";import{S as u}from"./SelectFormGroup-B7LggFsz.js";import{S as m}from"./SwitchFormGroup-Co6umssC.js";import{T as x}from"./TextareaFormGroup-BnU7pT8D.js";import{C as f,N as h}from"./Number2Currency-BX4epFEo.js";import"./vendor-swiper-Cr_RrIb_.js";import"./BasicRest-CNjqr-ae.js";import"./OpenPayCardModal-K84_M_7u.js";import"./BooleanLimit-q2Ad9fGY.js";import"./Footer-hpJm2-lL.js";import"./TippyButton-Cw7YfGyL.js";import"./General-ClVW7qxN.js";import"./LaravelSession-ByQnaUD3.js";import"./Menu-CIJEwm1o.js";import"./Logout-DNvBtC9t.js";import"./MenuItemContainer-CJkb6HO0.js";const j=new a,g=({ubigeo:e=[]})=>{const a=r.useRef(),o=r.useRef(),s=r.useRef(),g=r.useRef(),v=r.useRef(),b=r.useRef(),[w,C]=r.useState(!1),[y,R]=r.useState(!1),B=e=>{C(!!e?.id),s.current.value=e?.id??"",$(g.current).val(e?.ubigeo??null).trigger("change"),R(null===e?.price),v.current.value=e?.price??0,b.current.value=e?.description??"",$(o.current).modal("show")},E=e=>$(i.renderToString(t.jsxs("span",{children:[t.jsx("span",{className:"d-block w-100 text-truncate",children:e.text.replace(e.id,"")}),t.jsxs("small",{className:"d-block",children:["Ubigeo: ",e.id]})]})));return t.jsxs(t.Fragment,{children:[t.jsx("input",{id:"file-input",type:"file",accept:".xlsx, .xls",style:{display:"none"},onChange:async e=>{const t=e.target.files[0];if(!t)return;e.target.value=null;const r=new FormData;r.append("excel",t);await j.upload(r)&&$(a.current).dxDataGrid("instance").refresh()}}),t.jsx("a",{id:"excel-download-link",href:"/ruta/a/tu/archivo.xlsx",download:!0,style:{display:"none"}}),t.jsx(d,{gridRef:a,title:"Costos de envío",rest:j,exportable:!0,exportableName:"delivery.prices",toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"upload",hint:"Cargar archivo Excel",onClick:()=>document.getElementById("file-input").click()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(a.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo registro",hint:"Nuevo registro",onClick:()=>B()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"export",hint:"Exportar todo a Excel",onClick:()=>{document.getElementById("excel-download-link").click()}}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"ubigeo",caption:"Ubigeo (RENIEC)",width:"150px"},{dataField:"name",caption:"Envío a",width:"200px",allowExporting:!1},{dataField:"description",caption:"Descripción",cellTemplate:(e,{data:t})=>{e.html(t.description||'<i class="text-muted">- Sin descripción -</i>')}},{dataField:"price",caption:"Precio",dataType:"number",width:"150px",cellTemplate:(e,{data:r})=>{null===r.price?e.html(i.renderToString(t.jsx("span",{className:"text-muted",children:"Pago en destino"}))):r.price>0?e.html(i.renderToString(t.jsxs("span",{children:[f()," ",h(r.price)]}))):e.text("Gratis")}},{caption:"Acciones",width:"100px",cellTemplate:(e,{data:t})=>{e.css("text-overflow","unset"),e.append(l({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>B(t)})),e.append(l({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>(async e=>{const{isConfirmed:t}=await n.fire({title:"Eliminar registro",text:"¿Estas seguro de eliminar este registro?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});if(!t)return;await j.delete(e)&&$(a.current).dxDataGrid("instance").refresh()})(t.id)}))},allowFiltering:!1,allowExporting:!1}]}),t.jsxs(c,{modalRef:o,title:w?"Editar Costo de envío":"Agregar Costo de envío",onSubmit:async t=>{t.preventDefault();const r=e.find(e=>e.reniec==g.current.value),i={id:s.current.value||void 0,name:`${r.distrito}, ${r.departamento}`.toTitleCase(),price:y?null:v.current.value,description:b.current.value,ubigeo:g.current.value};await j.save(i)&&($(a.current).dxDataGrid("instance").refresh(),$(o.current).modal("hide"))},size:"sm",children:[t.jsx("input",{ref:s,type:"hidden"}),t.jsxs("div",{id:"form-container",className:"row",children:[t.jsx(u,{eRef:g,label:"Distrito/Ubigeo",templateResult:E,templateSelection:E,dropdownParent:"#form-container",required:!0,children:e.map((e,r)=>t.jsxs("option",{value:e.reniec,children:[e.reniec," ",e.distrito," ",e.provincia," ",e.departamento]},r))}),t.jsx(m,{label:"Pago en destino",col:"col-6",onChange:e=>R(e.target.checked),checked:y,refreshable:[y]}),t.jsx("div",{className:"col-6",hidden:y,children:t.jsx(p,{eRef:v,label:"Costo de envío",col:"col-12",type:"number",step:.01,required:!0})}),t.jsx(x,{eRef:b,label:"Descripción",rows:2})]})]})]})};o((r,i)=>{e.createRoot(r).render(t.jsx(s,{...i,title:"Costos de envio",children:t.jsx(g,{...i})}))});
