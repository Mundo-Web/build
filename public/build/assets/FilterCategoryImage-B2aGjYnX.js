import{r as e,j as s,C as a,bd as t,E as r,R as i,J as n}from"./vendor-react-CIhVE-fi.js";import"./ProductDetailB-3k-URiSY.js";import{I as l}from"./ItemsRest-3tin5YGG.js";import{L as c}from"./Loading-ChLofGGn.js";import{N as o}from"./NoResult-Cg718ok7.js";import{S as m}from"./SelectForm-BH2ejc5U.js";import{C as d}from"./Number2Currency-BX4epFEo.js";import"./CartKuchara-Dxib2Hfv.js";import u from"./ProductCardSimple-BbombP77.js";import p from"./CardProductBananaLab-v-t-Glgy.js";import"./vendor-swiper-Cr_RrIb_.js";import"./OpenPayCardModal-K84_M_7u.js";import"./CartModal-DEGaGNoe.js";import"./CartItemRow-COcyJucy.js";import"./vendor-motion-iF4wNZTr.js";import"./Footer-hpJm2-lL.js";import"./BasicRest-CNjqr-ae.js";import"./BooleanLimit-q2Ad9fGY.js";import"./General-ClVW7qxN.js";import"./CartModalBananaLab-BuQz01So.js";import"./TippyButton-Cw7YfGyL.js";const x=new l,g=({items:l,data:g,filteredData:h,cart:f,setCart:b})=>{const{collections:j,priceRanges:y}=h||{collections:[],priceRanges:[]},[w,N]=e.useState([]),[v,P]=e.useState([]),[C,_]=e.useState({collection:!0,marca:!0,precio:!0,categoria:!0,colores:!1}),[k,S]=e.useState({collection_id:[],category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort:[{selector:"created_at",desc:!0}]}),[$,L]=e.useState([]),[M,R]=e.useState(!1),[A,B]=e.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:21,from:0,to:0}),I=async(e=1)=>{R(!0);try{const s={filter:(e=>{const s=[];if(e.collection_id.length>0){const a=e.collection_id.map(e=>["collection_id","=",e]);s.push(["or",...a])}if(e.category_id.length>0){const a=e.category_id.map(e=>["category_id","=",e]);s.push(["or",...a])}if(e.subcategory_id.length>0){const a=e.subcategory_id.map(e=>["subcategory_id","=",e]);s.push(["and",...a])}if(e.brand_id.length>0){const a=e.brand_id.map(e=>["brand_id","=",e]);s.push(["or",...a])}return e.price&&s.push(["and",[["final_price",">=",e.price.min],"and",["final_price","<=",e.price.max]]]),e.name&&s.push(["name","contains",e.name]),s})(k),sort:k.sort,skip:(e-1)*A.itemsPerPage,take:A.itemsPerPage,requireTotalCount:!0},a=await x.paginate(s);a&&a.data&&(L(a.data),B({currentPage:e,totalPages:Math.ceil(a.totalCount/A.itemsPerPage),totalItems:a.totalCount,itemsPerPage:A.itemsPerPage,from:(e-1)*A.itemsPerPage+1,to:Math.min(e*A.itemsPerPage,a.totalCount)}),N(a?.summary?.brands??[]),P(a?.summary?.categories??[]))}catch(s){}finally{R(!1)}};e.useEffect(()=>{I(A.currentPage)},[k]),e.useEffect(()=>{const e=new URLSearchParams(window.location.search),s=e.get("category");if(s){const e=v.find(e=>e.slug===s);e&&S(s=>({...s,category_id:[e.id]}))}const a=e.get("collection");if(a){const e=j.find(e=>e.slug===a);e&&S(s=>({...s,collection_id:[e.id]}))}const t=e.get("search");t&&S(e=>({...e,name:t}))},[v,j]);const z=e=>{e>=1&&e<=A.totalPages&&I(e)},E=()=>{const e=[],s=A.totalPages,a=A.currentPage;for(let t=1;t<=s;t++)1===t||t===s||t>=a-2&&t<=a+2?e.push(t):t!==a-2-1&&t!==a+2+1||e.push("...");return e.filter((e,s,a)=>"..."!==e||"..."!==a[s-1])},F=(e,s)=>{S(a=>{if("price"===e)return{...a,price:a.price&&a.price.min===s.min&&a.price.max===s.max?null:s};const t=Array.isArray(a[e])?a[e]:[],r=t.includes(s)?t.filter(e=>e!==s):[...t,s];return{...a,[e]:r}})},D=e=>{_(s=>({...s,[e]:!s[e]}))},[K,O]=e.useState(""),[G,T]=e.useState(""),[Z,q]=e.useState("");j?.filter(e=>e.name.toLowerCase().includes(G.toLowerCase()));const J=v?.filter(e=>e.name.toLowerCase().includes(K.toLowerCase()));w?.filter(e=>e.name.toLowerCase().includes(Z.toLowerCase()));const[U,H]=e.useState(!1),Q=()=>s.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:()=>H(!1)}),s.jsx("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:s.jsxs("div",{className:"inline-block align-bottom bg-white rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 w-full sm:align-middle sm:max-w-lg sm:w-full h-[80vh]",children:[s.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 border-b sticky top-0 z-10",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-bold leading-6 text-gray-900",children:"Filtros"}),s.jsxs("button",{type:"button",className:"text-gray-400 hover:text-gray-500 focus:outline-none",onClick:()=>H(!1),children:[s.jsx("span",{className:"sr-only",children:"Cerrar"}),"✕"]})]})}),s.jsxs("div",{className:"bg-white px-4 pt-2 pb-4 sm:p-6 sm:pb-4 overflow-y-auto h-[calc(100%-60px)]",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>D("categoria"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-bold",children:"Categorías"}),s.jsx(a,{className:"h-5 w-5 transform transition-transform "+(C.categoria?"":"-rotate-180")})]}),C.categoria&&s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"space-y-2",children:J?.map(e=>{const a=k.category_id?.includes(e.id);return s.jsx("div",{className:"group py-2 rounded-md "+(a?"bg-secondary":"bg-transparent"),children:s.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[s.jsx("input",{type:"checkbox",className:"h-4 hidden w-4 rounded border-gray-300",onChange:()=>F("category_id",e.id),checked:a}),s.jsx("span",{children:e.name}),s.jsx("img",{src:`/storage/images/category/${e.image}`,onError:e=>e.target.src="assets/img/noimage/no_imagen_circular.png",alt:e.name,className:"w-8 h-8 rounded-full object-cover",loading:"lazy"})]})},e.id)})})})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>D("precio"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-medium",children:"Precio"}),s.jsx(a,{className:"h-5 w-5 transform transition-transform "+(C.precio?"":"-rotate-180")})]}),C.precio&&s.jsx("div",{className:"space-y-3",children:y?.map(e=>s.jsxs("label",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>F("price",e),checked:k.price&&k.price.min===e.min&&k.price.max===e.max}),s.jsx("span",{children:`${d()} ${e.min} - ${d()} ${e.max}`})]},`${e.min}-${e.max}`))})]})]}),s.jsx("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse sticky bottom-0 border-t",children:s.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-3 bg-primary text-white text-base font-medium hover:bg-primary-dark focus:outline-none sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>H(!1),children:"Aplicar filtros"})})]})})]});return s.jsxs("section",{id:g?.element_id||null,className:"p-[5%] mx-auto w-full",children:[U&&s.jsx(Q,{}),s.jsxs("div",{className:"relative flex flex-col sm:flex-row gap-4",children:[s.jsxs("div",{className:"hidden lg:block w-full sm:w-1/5 bg-white p-4 rounded-lg h-max",children:[s.jsx("div",{className:"sm:hidden flex justify-between items-center mb-4",children:s.jsx("button",{onClick:()=>H(!1),className:"customtext-primary hover:customtext-accent",children:"✕"})}),s.jsx("p",{className:"text-xl font-bold pb-4 mb-4 border-b",children:g?.title||"Filtros"}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>D("categoria"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-bold",children:"Categorías"}),s.jsx(a,{className:"h-5 w-5 transform transition-transform "+(C.categoria?"":"-rotate-180")})]}),C.categoria&&s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"space-y-2",children:J?.map(e=>{const a=k.category_id?.includes(e.id);return s.jsx("div",{className:"group py-2 rounded-md "+(a?"bg-secondary":"bg-transparent"),children:s.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[s.jsx("input",{type:"checkbox",className:"h-4 hidden w-4 rounded border-gray-300",onChange:()=>F("category_id",e.id),checked:a}),s.jsx("span",{children:e.name}),s.jsx("img",{src:`/storage/images/category/${e.image}`,onError:e=>e.target.src="/assets/img/noimage/no_imagen_circular.png",alt:e.name,className:"w-8 h-8 rounded-full object-cover",loading:"lazy"})]})},e.id)})})})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:()=>D("precio"),className:"flex items-center justify-between w-full mb-4",children:[s.jsx("span",{className:"font-medium",children:"Precio"}),s.jsx(a,{className:"h-5 w-5 transform transition-transform "+(C.precio?"":"-rotate-180")})]}),C.precio&&s.jsx("div",{className:"space-y-3",children:y?.map(e=>s.jsxs("label",{className:"flex items-center space-x-3",children:[s.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>F("price",e),checked:k.price&&k.price.min===e.min&&k.price.max===e.max}),s.jsx("span",{children:`${d()} ${e.min} - ${d()} ${e.max}`})]},`${e.min}-${e.max}`))})]})]}),s.jsxs("div",{className:"w-full sm:w-4/5 py-4",children:[s.jsxs("div",{className:"flex justify-between items-end mb-4 w-full",children:[s.jsxs("div",{className:"flex gap-4  items-start lg:items-center flex-col w-8/12 lg:w-auto lg:flex-row",children:[s.jsx("label",{className:"font-semibold text-sm w-[150px]",children:"Ordenar por"}),s.jsx(m,{options:[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"final_price:asc",label:"Precio: Menor a Mayor"},{value:"final_price:desc",label:"Precio: Mayor a Menor"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],placeholder:"Recomendados",onChange:e=>{const[s,a]=e.split(":"),t=[{selector:s,desc:"desc"===a}];S(e=>({...e,sort:t}))},labelKey:"label",valueKey:"value",className:"border-primary rounded-full customtext-primary"})]}),s.jsx("div",{className:"lg:hidden flex items-end h-full mb-4",children:s.jsx("button",{onClick:()=>H(!U),className:" h-12 w-12 gap-2 bg-primary text-white flex items-center justify-center  rounded-full lg:hidden",children:s.jsx(t,{size:20})})}),s.jsx("div",{className:"customtext-primary font-semibold hidden lg:block",children:s.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[s.jsx("button",{className:"p-4 inline-flex items-center "+(1===A.currentPage?"opacity-50 cursor-not-allowed":""),onClick:()=>z(A.currentPage-1),disabled:1===A.currentPage,children:s.jsx(r,{})}),E().map((e,a)=>s.jsx(i.Fragment,{children:"..."===e?s.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):s.jsx("button",{className:"w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 \n                              "+(e===A.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"),onClick:()=>z(e),children:e})},a)),s.jsx("button",{className:"p-4 inline-flex items-center "+(A.currentPage===A.totalPages?"opacity-50 cursor-not-allowed":""),onClick:()=>z(A.currentPage+1),disabled:A.currentPage===A.totalPages,children:s.jsx(n,{})})]})}),s.jsx("div",{children:s.jsxs("p",{className:"font-semibold",children:[A.from," - ",A.to," de ",A.totalItems," Resultados"]})})]})})]}),M?s.jsx(c,{}):s.jsx("div",{className:"flex items-center flex-wrap gap-y-2 lg:gap-y-3 transition-all duration-300 ease-in-out",children:Array.isArray($)&&$.length>0?$.map(e=>"CardProductBananaLab"===g?.card?s.jsx(p,{product:e,widthClass:"lg:w-1/3",cart:f,setCart:b},e.id):s.jsx(u,{product:e,widthClass:"lg:w-1/3",cart:f,setCart:b},e.id)):s.jsx(o,{})}),s.jsxs("div",{className:"flex justify-between items-center mb-4 w-full mt-8",children:[s.jsx("div",{className:"customtext-primary font-semibold",children:s.jsxs("nav",{className:"flex items-center gap-x-2 min-w-max",children:[s.jsx("button",{className:"p-4 inline-flex items-center "+(1===A.currentPage?"opacity-50 cursor-not-allowed":""),onClick:()=>z(A.currentPage-1),disabled:1===A.currentPage,children:s.jsx(r,{})}),E().map((e,a)=>s.jsx(i.Fragment,{children:"..."===e?s.jsx("span",{className:"w-10 h-10 bg-transparent p-2 inline-flex items-center justify-center rounded-full",children:"..."}):s.jsx("button",{className:"w-10 h-10 p-2 inline-flex items-center justify-center rounded-full transition-all duration-300 \n                          "+(e===A.currentPage?"bg-primary text-white":"bg-transparent hover:text-white hover:bg-primary"),onClick:()=>z(e),children:e})},a)),s.jsx("button",{className:"p-4 inline-flex items-center "+(A.currentPage===A.totalPages?"opacity-50 cursor-not-allowed":""),onClick:()=>z(A.currentPage+1),disabled:A.currentPage===A.totalPages,children:s.jsx(n,{})})]})}),s.jsx("div",{children:s.jsxs("p",{className:"font-semibold",children:[A.from," - ",A.to," de ",A.totalItems," Resultados"]})})]})]})]})]})};export{g as default};
