var e=Object.defineProperty,a=(a,s,r)=>((a,s,r)=>s in a?e(a,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[s]=r)(a,"symbol"!=typeof s?s+"":s,r);import{m as s,d as r,r as t,j as i,I as n}from"./System-Bybt2Brn.js";import"./CardHoverBtn-BJnt3e8M.js";import{N as l}from"./NoResult-m-3gmVGS.js";import{P as c}from"./ProductCardScraping-vvPVhHdD.js";import{C as o}from"./chevron-left-DoRUFD_L.js";import{C as d}from"./chevron-right-jU6kkjiT.js";import{F as m}from"./filter-DnzWsNM_.js";import{C as u}from"./chevron-down-r_B4RFE6.js";import{S as p}from"./search--TD4pUuj.js";import"./vendor-BiOv2i5T.js";import"./sweetalert2.esm.all-DbJpIAEg.js";import"./CartModal-Db_dBOJN.js";import"./index-Cmhjy_Bv.js";import"./index-Bx5UHif0.js";import"./CartItemRow-CLpuTcvn.js";import"./Number2Currency-DExzICY3.js";import"./tippy-react.esm-Cpb4mDDh.js";import"./proxy-BmPRG09w.js";import"./trash-2-CDXts6on.js";import"./createLucideIcon-oahCLV50.js";import"./minus-BhdGy6sP.js";import"./plus-4JHYG4O1.js";import"./index-Da4AP4wO.js";import"./eye-DJ5vw54Z.js";class x{}a(x,"getProducts",(async e=>{try{const{query:a,proveedor:r,page:t,limit:i=12}=e,{status:n,result:l}=await s.Fetch("./api/scrap",{method:"POST",body:JSON.stringify({query:a,proveedor:r,page:t,limit:i})});return n?(s.Notify.add({icon:"/assets/img/icon.svg",title:"Operación correcta",body:"Se obtuvieron los productos correctamente"}),{data:l.data||[],filters:l.filters||[],hasMore:l.data.length===i}):{data:[],hasMore:!1}}catch(a){return s.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:a.message,type:"danger"}),{data:[],filters:[],hasMore:!1}}})),a(x,"getPaginatedProducts",(async e=>{try{const{query:a,proveedor:r,page:t,limit:i=10}=e,{status:n,result:l}=await s.Fetch("./api/scrap",{method:"POST",body:JSON.stringify({query:a,proveedor:r,page:t,limit:i})});return n?{data:l.data||[],hasMore:l.data.length===i}:{data:[],hasMore:!1}}catch(a){return s.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:a.message,type:"danger"}),{data:[],hasMore:!1}}})),r(),new n;const h=()=>i.jsx("div",{className:"group font-font-general animate-pulse w-full transition-transform duration-300 hover:scale-105  sm:w-1/3 flex-shrink-0 font-font-general customtext-primary cursor-pointer",children:i.jsx("div",{className:" px-4",children:i.jsx("div",{className:"bg-white rounded-3xl",children:i.jsx("div",{className:"relative",children:i.jsx("div",{className:"aspect-square bg-gray-300 rounded-3xl overflow-hidden flex items-center justify-center  bg-secondary",children:i.jsx("svg",{class:"w-10 h-10 text-gray-200 ","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 18",children:i.jsx("path",{d:"M18 0H2a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2Zm-5.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm4.376 10.481A1 1 0 0 1 16 15H4a1 1 0 0 1-.895-1.447l3.5-7A1 1 0 0 1 7.468 6a.965.965 0 0 1 .9.5l2.775 4.757 1.546-1.887a1 1 0 0 1 1.618.1l2.541 4a1 1 0 0 1 .028 1.011Z"})})})})})})}),f=({items:e,data:a,filteredData:s,cart:r,setCart:n})=>{const{categories:f,brands:g,priceRanges:j}=s,[y,b]=t.useState({marca:!0,precio:!0,categoria:!0,colores:!1}),[v,w]=t.useState({category_id:[],brand_id:[],subcategory_id:[],price:null,name:null,sort_by:"created_at",order:"desc"}),[N,C]=t.useState([]),[S,k]=t.useState(!1),[P,_]=t.useState({currentPage:1,totalPages:1}),A=async(e,a,s=1)=>{if(e){k(!0);try{const r=await x.getProducts({query:e,proveedor:a,page:s});C(1===s?r.data:e=>[...e,...r.data]),_({currentPage:r.currentPage,totalPages:r.lastPage})}catch(r){alert("Hubo un error al realizar la búsqueda. Por favor, intenta nuevamente.")}finally{k(!1)}}else alert("Por favor, ingresa un término de búsqueda")},[M,q]=t.useState(""),[F,L]=t.useState("nike");t.useEffect((()=>{const e=new URLSearchParams(window.location.search),a=e.get("category");if(a){const e=f.find((e=>e.slug===a));e&&w((a=>({...a,category_id:[e.id]})))}q(e.get("search")),L(e.get("provider")),M&&A(M,F)}),[e]);const O=(e,a)=>{w((s=>{if("price"===e)return{...s,price:s.price&&s.price.min===a.min&&s.price.max===a.max?null:a};const r=Array.isArray(s[e])?s[e]:[],t=r.includes(a)?r.filter((e=>e!==a)):[...r,a];return{...s,[e]:t}}))},B=e=>{b((a=>({...a,[e]:!a[e]})))},[H,I]=t.useState(""),[R,Z]=t.useState(""),$=f.filter((e=>e.name.toLowerCase().includes(H.toLowerCase()))),E=g.filter((e=>e.name.toLowerCase().includes(R.toLowerCase()))),[T,z]=t.useState(1),J=12*T,V=J-12,D=Array.isArray(N)?N.slice(V,J):[],U=Math.ceil(N.length/12);return i.jsx("section",{className:"py-12 bg-[#F7F9FB] font-font-general",children:i.jsxs("div",{className:"mx-auto px-primary",children:[i.jsxs("div",{className:"flex justify-between items-center mb-8 pb-4 border-b-2",children:[i.jsx("h2",{className:"text-4xl font-bold w-6/12",children:"Todos los productos"}),i.jsx("div",{className:"flex items-center gap-4 w-5/12",children:i.jsx("div",{className:"flex justify-end items-center mb-4 w-full",children:i.jsx("div",{className:"customtext-neutral-dark font-semibold",children:i.jsxs("nav",{class:"flex items-center gap-x-2 min-w-max",children:[i.jsx("button",{class:" p-4 inline-flex items-center",onClick:()=>{z(T-1)},disabled:1===T,children:i.jsx(o,{})}),i.jsx("ul",{className:"list-none flex gap-2",children:[...Array(U).keys()].map((e=>i.jsx("li",{className:"page-item "+(T===e+1?"active":""),children:i.jsx("button",{onClick:()=>z(e+1),class:"w-10 h-10  p-2 inline-flex items-center justify-center rounded-full transition-all duration-300  hover:text-white hover:bg-primary "+(T===e+1?"bg-primary text-white":" bg-transparent"),"aria-current":"page",children:e+1})},e+1)))}),i.jsx("button",{class:" p-4 inline-flex items-center ",onClick:()=>{const e=T+1;e<=U?z(e):(z(e),A(M,F,e))},disabled:T===U&&"invictastores"===F,children:i.jsx(d,{})})]})})})})]}),i.jsxs("div",{className:"relative flex gap-4",children:[i.jsxs("div",{className:"w-3/12 bg-white p-4 rounded-lg h-max",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h2",{className:"text-xl font-bold",children:"Filtros"}),i.jsx(m,{className:"h-5 w-5"})]}),i.jsxs("div",{className:"mb-6",children:[i.jsxs("button",{onClick:()=>B("marca"),className:"flex items-center justify-between w-full mb-4",children:[i.jsx("span",{className:"font-medium",children:"Marca"}),i.jsx(u,{className:"h-5 w-5 transform transition-transform "+(y.marca?"":"-rotate-180")})]}),y.marca&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx(p,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:R,onChange:e=>Z(e.target.value)})]}),i.jsx("div",{className:"space-y-3",children:E.map((e=>i.jsxs("label",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>O("brand_id",e.id)}),i.jsx("span",{children:e.name})]},e.id)))})]})]}),i.jsxs("div",{className:"mb-6",children:[i.jsxs("button",{onClick:()=>B("precio"),className:"flex items-center justify-between w-full mb-4",children:[i.jsx("span",{className:"font-medium",children:"Precio"}),i.jsx(u,{className:"h-5 w-5 transform transition-transform "+(y.precio?"":"-rotate-180")})]}),y.precio&&i.jsx("div",{className:"space-y-3",children:j.map((e=>i.jsxs("label",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",name:"precio",className:"h-4 w-4 rounded border-gray-300",onChange:()=>O("price",e),checked:v.price&&v.price.min===e.min&&v.price.max===e.max}),i.jsx("span",{children:`S/ ${e.min} - S/ ${e.max}`})]},`${e.min}-${e.max}`)))})]}),i.jsxs("div",{className:"mb-6",children:[i.jsxs("button",{onClick:()=>B("categoria"),className:"flex items-center justify-between w-full mb-4",children:[i.jsx("span",{className:"font-medium",children:"Categoría"}),i.jsx(u,{className:"h-5 w-5 transform transition-transform "+(y.categoria?"":"-rotate-180")})]}),y.categoria&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx(p,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"Buscar",className:"w-full px-4 pl-10 py-3 border customtext-neutral-dark  border-neutral-ligth rounded-xl focus:ring-0 focus:outline-0   transition-all duration-300",value:H,onChange:e=>I(e.target.value)})]}),$.map((e=>{var a,s,r;return i.jsxs("div",{children:[i.jsxs("label",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>O("category_id",e.id),checked:null==(a=v.category_id)?void 0:a.includes(e.id)}),i.jsx("span",{children:e.name})]}),(null==(s=v.category_id)?void 0:s.includes(e.id))&&(null==(r=e.subcategories)?void 0:r.length)>0&&i.jsx("ul",{className:"ml-6 mt-2 space-y-2",children:e.subcategories.map((e=>{var a;return i.jsxs("label",{className:"flex items-center space-x-3",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300",onChange:()=>O("subcategory_id",e.id),checked:null==(a=v.subcategory_id)?void 0:a.includes(e.id)}),i.jsx("span",{children:e.name})]},e.id)}))})]},e.id)}))]})]}),i.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-xl hover:brightness-90 transition-colors text-sm font-bold",children:"Aplicar Filtro"})]}),i.jsx("div",{className:"w-9/12",children:S?i.jsx("div",{className:"flex items-center flex-wrap gap-y-8 transition-all duration-300 ease-in-out",children:[1,2,3,4,5,6,7,8,9,10,11,12].map((e=>i.jsx(h,{},e)))}):i.jsx("div",{className:"flex items-center flex-wrap gap-y-8 transition-all duration-300 ease-in-out",children:Array.isArray(N)&&N.length>0?D.map(((e,a)=>i.jsx(c,{product:e,widthClass:"lg:w-1/3",cart:r,setCart:n},a))):i.jsx(l,{})})})]})]})})};export{f as default};
