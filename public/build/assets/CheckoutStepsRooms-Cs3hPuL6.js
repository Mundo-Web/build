var ts=Object.defineProperty;var as=(u,n,l)=>n in u?ts(u,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):u[n]=l;var ce=(u,n,l)=>as(u,typeof n!="symbol"?n+"":n,l);import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as m}from"./index-BOnQTV8N.js";import{R as ue}from"./PolicyModal-C80IvD61.js";import{H as rs}from"./HtmlContent-ghmllTyl.js";import{C as E,N as $}from"./Number2Currency-jIsa99f9.js";import{U as xe}from"./users-w-WaEtvX.js";import{M as Oe}from"./moon-BU5XInRR.js";import{c as ns}from"./createLucideIcon-DfjclApS.js";import{C as te}from"./calendar-BSC6xbA7.js";import{X as pe}from"./x-fof_H3Vv.js";import{f as ye}from"./format-B6vr9H0z.js";import{e as Ne}from"./es-QTeD0CGG.js";import{O as os,p as ls,a as cs}from"./OpenPayCardModal-n1KG45qI.js";import{C as is,p as ds,B as ms}from"./culqiPayment-BOuHXhF8.js";import{P as xs}from"./PaymentModal-BoE8tjmm.js";import{G as q}from"./Global-Bz6gVLc5.js";import{G as Y}from"./General-apRuNwp7.js";import{m as J}from"./main-B6F2O9-U.js";import{t as z}from"./CardProductKatya-ncpmQ0JU.js";import{U as Le}from"./upload-GO9GDST_.js";import{C as A}from"./circle-x-5vreeYph.js";import{B as us}from"./building-2-DSFvhCB-.js";import{C as Fe}from"./check-D5vaIe6v.js";import{C as Me}from"./copy-BnGV3h9k.js";import{S as ps}from"./react-select.esm-H4wpMl-h.js";import{C as hs}from"./credit-card-MgdEzS7h.js";import{C as ie}from"./circle-check-big-CYWUGR3Z.js";import{U as gs}from"./user-round-x-C2OImLTZ.js";import{M as je}from"./mail-drJGpT4k.js";import{P as bs}from"./phone-ZNY-sPqk.js";import{M as fs}from"./map-pin-Cj3PUWlD.js";import"./index-yBjzXJbu.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-B6ujFmsw.js";import"./index-Chjiymov.js";import"./loader-circle-CSFYLd5m.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";import"./index-pSueRYGM.js";import"./useStateManager-7e1e8489.esm-C6DnWqDr.js";import"./hoist-non-react-statics.cjs-Dk09vysS.js";import"./floating-ui.dom-CID5cQpR.js";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=ns("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),ys=({setCart:u,...n})=>{const l=()=>{u(a=>a.filter(p=>p.id!==n.id||p.check_in!==n.check_in))},v=a=>{if(!a)return"";try{const p=new Date(a+"T00:00:00");return ye(p,"dd 'de' MMMM",{locale:Ne})}catch{return a}},y=n.final_price||n.price,M=n.nights||1,i=y*M,C=n.guests||2,B=a=>({standard:"Estándar",suite:"Suite",deluxe:"Deluxe",presidential:"Presidencial",family:"Familiar",executive:"Ejecutiva",single:"Individual",double:"Doble"})[a]||a;return e.jsx("div",{className:"bg-white border border-gray-200 rounded-2xl overflow-hidden hover:shadow-lg transition-all duration-300 font-paragraph",children:e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsxs("div",{className:"md:w-64 h-48 md:h-auto relative flex-shrink-0",children:[e.jsx("img",{src:`/storage/images/item/${n.image}`,alt:n.name,className:"w-full h-full object-cover",onError:a=>a.target.src="/assets/img/noimage/no_img.jpg"}),n.room_type&&e.jsx("div",{className:"absolute top-3 left-3 bg-white/95 backdrop-blur-sm px-3 py-1 rounded-full text-xs font-semibold text-gray-700 shadow-md",children:B(n.room_type)})]}),e.jsxs("div",{className:"flex-1 p-5 md:p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900 mb-2",children:n.name}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(xe,{size:16,className:"text-blue-600"}),e.jsxs("span",{children:[C," ",C===1?"huésped":"huéspedes"]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Oe,{size:16,className:"text-indigo-600"}),e.jsxs("span",{children:[M," ",M===1?"noche":"noches"]})]}),n.amenities&&n.amenities.includes("wifi")&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(js,{size:16,className:"text-green-600"}),e.jsx("span",{children:"WiFi"})]})]}),e.jsxs("div",{className:"inline-flex items-center gap-3 bg-gray-50 rounded-xl px-4 py-2.5 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{size:16,className:"text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Check-in"}),e.jsx("div",{className:"font-semibold text-gray-900",children:v(n.check_in)})]})]}),e.jsx("div",{className:"w-8 h-px bg-gray-300"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{size:16,className:"text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Check-out"}),e.jsx("div",{className:"font-semibold text-gray-900",children:v(n.check_out)})]})]})]})]}),e.jsx("button",{onClick:l,className:"ml-4 p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all","aria-label":"Eliminar reserva",title:"Eliminar reserva",children:e.jsx(pe,{size:20})})]}),e.jsxs("div",{className:"flex items-end justify-between pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Precio por noche:"}),e.jsxs("span",{className:"text-lg font-semibold text-gray-900",children:[E()," ",y.toFixed(2)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Total a pagar"}),e.jsxs("div",{className:"text-2xl font-bold text-primary",children:[E()," ",i.toFixed(2)]})]})]})]})]})})};function Ns({data:u,cart:n,setCart:l,onContinue:v,subTotal:y,igv:M,totalFinal:i,openModal:C,totalWithoutDiscounts:B}){const a=n.length===0;return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 font-paragraph",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-2",children:a?"Tu carrito está vacío":"Revisa tu reserva"}),!a&&e.jsxs("p",{className:"text-gray-600",children:[n.length," ",n.length===1?"habitación seleccionada":"habitaciones seleccionadas"]})]}),e.jsx("div",{className:"space-y-4",children:a?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 bg-gray-50 rounded-2xl",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No hay habitaciones seleccionadas"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Explora nuestras opciones de alojamiento"}),e.jsx("a",{href:"/habitaciones",className:"px-8 py-3 bg-primary hover:bg-secondary text-white rounded-full hover:shadow-xl transition-all duration-300 font-bold hover:scale-105 active:scale-95",children:"Ver habitaciones disponibles"})]}):n.map((p,F)=>e.jsx(ys,{...p,setCart:l},`${p.id}-${p.checkIn}-${F}`))})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl shadow-sm p-6 sticky top-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Resumen de reserva"}),!a&&e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3 pb-6 border-b",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:n.length}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:n.length===1?"Habitación":"Habitaciones"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:n.reduce((p,F)=>p+(F.nights||1),0)}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Noches"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:n.reduce((p,F)=>p+(F.guests||2),0)}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Huéspedes"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotal"}),e.jsxs("span",{className:"font-medium text-gray-900",children:[E()," ",$(y)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Impuestos y cargos"}),e.jsxs("span",{className:"font-medium text-gray-900",children:[E()," ",$(M)]})]})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900",children:"Total"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-primary",children:[E()," ",$(i)]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Incluye impuestos"})]})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:v,disabled:a,className:`w-full py-4 px-6 rounded-full font-bold text-base transition-all duration-300 shadow-lg ${a?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-primary hover:bg-secondary text-white hover:shadow-2xl hover:scale-[1.02] active:scale-[0.98]"} ${(u==null?void 0:u.class_button)||""}`,children:a?"Carrito vacío":"Continuar con la reserva"}),e.jsx("a",{href:"/habitaciones",className:"block w-full py-3 px-6 text-center rounded-full font-semibold customtext-primary border-2 border-accent hover:bg-accent hover:text-white transition-all duration-300 shadow-md hover:shadow-lg",children:a?"Explorar habitaciones":"Agregar más habitaciones"})]}),e.jsx("div",{className:"mt-6 pt-6 border-t",children:e.jsxs("p",{className:"text-xs text-gray-500 leading-relaxed",children:["Al proceder, aceptas nuestros"," ",e.jsx("button",{onClick:()=>C&&C(1),className:"text-primary font-medium hover:underline",children:"Términos y Condiciones"})," ","y"," ",e.jsx("button",{onClick:()=>C&&C(0),className:"text-primary font-medium hover:underline",children:"Política de Privacidad"}),"."]})})]})})]})}class ze{constructor(){ce(this,"checkout",async n=>{try{const l=await fetch(`${this.baseUrl}/checkout`,{method:"POST",body:n}),v=await l.json();if(!l.ok||v.status>=400)throw new Error(v.message||"Error al procesar la reserva");return v}catch(l){throw console.error("Error en checkout de booking:",l),l}});ce(this,"search",async n=>{try{return await J.Fetch("/api/hotels/rooms/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})}catch(l){throw console.error("Error buscando habitaciones:",l),l}});ce(this,"track",async n=>{try{return await J.Fetch(`${this.baseUrl}/${n}/track`,{method:"GET"})}catch(l){throw console.error("Error rastreando reserva:",l),l}});ce(this,"create",async n=>{try{return await J.Fetch(this.baseUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})}catch(l){throw console.error("Error creando reserva:",l),l}});this.baseUrl="/api/hotels/bookings"}}const vs=new ze;function ws({isOpen:u,onClose:n,cart:l=[],subTotal:v,igv:y,totalFinal:M,request:i,coupon:C=null,descuentofinal:B=0,setCode:a,setBooking:p,onContinue:F}){const[f,T]=m.useState(!1),[S,j]=m.useState(null),w=m.useRef(null),O=o=>{const x=o.target.files[0];x&&j(x)},D=()=>{j(null),w.current&&(w.current.value="")},H=async()=>{if(!f){if(!S){z.error("Error al subir comprobante",{description:"Por favor, sube tu comprobante de pago",icon:e.jsx(A,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"});return}T(!0);try{const o=new FormData;Object.keys(i).forEach(k=>{i[k]!==null&&i[k]!==void 0&&o.append(k,i[k])}),o.append("payment_proof",S);const x=await vs.checkout(o);console.log("✅ Respuesta del checkout:",x),x&&x.data&&x.data.code?(J.Local.set(`${q.APP_CORRELATIVE}_cart`,(J.Local.get(`${q.APP_CORRELATIVE}_cart`)||[]).filter(k=>k.type!=="booking")),p(x.data.sale||x.data),a(x.data.code),n(),F()):(console.error("❌ Respuesta inválida del servidor:",x),z.error("Error al procesar la reserva",{description:(x==null?void 0:x.message)||"No se recibió el código de confirmación",icon:e.jsx(A,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"}))}catch(o){console.error("Error al procesar el pago:",o),z.error("Error al procesar el pago",{description:o.message||"Ocurrió un error al procesar tu pago",icon:e.jsx(A,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"})}finally{T(!1)}}},Q=l.reduce((o,x)=>o+(x.nights||1),0),X=l.reduce((o,x)=>o+(x.guests||2),0);return e.jsx(ue,{isOpen:u,onRequestClose:n,className:"absolute left-1/2 -translate-x-1/2 bg-[#f5f5f5] rounded-2xl shadow-lg w-[95%] max-w-lg top-1/2 -translate-y-1/2 overflow-hidden font-paragraph",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 z-50",ariaHideApp:!1,children:e.jsxs("div",{className:"py-6 px-6 md:px-10 flex flex-col gap-4 max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("img",{src:`/assets/resources/logo.png?v=${crypto.randomUUID()}`,alt:q.APP_NAME,className:"h-12 object-contain",onError:o=>{o.target.onerror=null,o.target.src="/assets/img/logo-bk.svg"}})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:Y.get("checkout_dwallet_name")||"Pago con Yape / Plin"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:Y.get("checkout_dwallet_description")||"Sube tu comprobante de pago para confirmar tu reserva"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 space-y-3",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(te,{size:18}),"Resumen de tu reserva"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 text-center",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-lg font-bold text-primary",children:l.length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Habitación(es)"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-lg font-bold text-primary",children:Q}),e.jsx("div",{className:"text-xs text-gray-500",children:"Noche(s)"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-lg font-bold text-primary",children:X}),e.jsx("div",{className:"text-xs text-gray-500",children:"Huésped(es)"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Escanea el código QR para pagar"}),Y.get("checkout_dwallet_qr")?e.jsx("img",{src:`/assets/resources/${Y.get("checkout_dwallet_qr")}`,alt:Y.get("checkout_dwallet_name")||"QR Yape",className:"mx-auto max-w-[200px] rounded-lg",onError:o=>{o.currentTarget.src="/assets/img/salafabulosa/logoyape.png"}}):e.jsx("div",{className:"w-[200px] h-[200px] mx-auto bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-gray-400 text-sm",children:"QR no configurado"})}),Y.get("checkout_dwallet_phone")&&e.jsxs("p",{className:"mt-3 text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"O transfiere a: "}),e.jsx("span",{className:"font-bold text-primary",children:Y.get("checkout_dwallet_phone")})]})]}),e.jsxs("div",{className:"bg-primary text-white rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-sm opacity-90",children:"Total a pagar"}),e.jsxs("p",{className:"text-2xl font-bold",children:[E()," ",$(M)]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Sube tu comprobante de pago *"}),e.jsx("input",{type:"file",ref:w,onChange:O,accept:"image/*",className:"hidden"}),S?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:URL.createObjectURL(S),alt:"Comprobante",className:"w-full max-h-48 object-contain rounded-lg"}),e.jsx("button",{type:"button",onClick:D,className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:e.jsx(pe,{size:16})})]}):e.jsxs("button",{type:"button",onClick:()=>{var o;return(o=w.current)==null?void 0:o.click()},className:"w-full border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-primary transition-colors",children:[e.jsx(Le,{className:"mx-auto h-8 w-8 text-gray-400"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Haz clic para subir tu comprobante"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"PNG, JPG hasta 5MB"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:H,disabled:f||!S,className:`w-full py-3 px-6 rounded-full font-semibold text-white transition-all ${f||!S?"bg-gray-400 cursor-not-allowed":"bg-primary hover:opacity-90"}`,children:f?"Procesando...":"Confirmar Reserva"}),e.jsx("button",{onClick:n,disabled:f,className:"w-full py-3 px-6 rounded-full font-semibold border border-gray-300 text-gray-700 hover:bg-gray-50 transition-all",children:"Cancelar"})]})]})})}const Cs=new ze;function ks({isOpen:u,onClose:n,cart:l=[],subTotal:v,igv:y,totalFinal:M,request:i,contacts:C=[],coupon:B=null,descuentofinal:a=0,setCode:p,setBooking:F,onContinue:f}){const[T,S]=m.useState(!1),[j,w]=m.useState(null),[O,D]=m.useState(null),H=m.useRef(null),Q=b=>{const g=b.target.files[0];g&&w(g)},X=()=>{w(null),H.current&&(H.current.value="")},o=(b,g)=>{navigator.clipboard.writeText(b),D(g),setTimeout(()=>D(null),2e3)},x=async()=>{if(!T){if(!j){z.error("Error al subir comprobante",{description:"Por favor, sube tu comprobante de pago",icon:e.jsx(A,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"});return}S(!0);try{const b=new FormData;Object.keys(i).forEach(c=>{i[c]!==null&&i[c]!==void 0&&b.append(c,i[c])}),b.append("payment_proof",j);const g=await Cs.checkout(b);console.log("✅ Respuesta del checkout:",g),g&&g.data&&g.data.code?(J.Local.set(`${q.APP_CORRELATIVE}_cart`,(J.Local.get(`${q.APP_CORRELATIVE}_cart`)||[]).filter(c=>c.type!=="booking")),F(g.data.sale||g.data),p(g.data.code),n(),f()):(console.error("❌ Respuesta inválida del servidor:",g),z.error("Error al procesar la reserva",{description:(g==null?void 0:g.message)||"No se recibió el código de confirmación",icon:e.jsx(A,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"}))}catch(b){console.error("Error al procesar el pago:",b),z.error("Error al procesar el pago",{description:b.message||"Ocurrió un error al procesar tu pago",icon:e.jsx(A,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"top-right"})}finally{S(!1)}}},k=b=>{var g;return((g=C.find(c=>c.correlative===b))==null?void 0:g.description)||""},t=l.reduce((b,g)=>b+(g.nights||1),0),U=l.reduce((b,g)=>b+(g.guests||2),0),K=k("checkout_bank_name")||"Banco",R=k("checkout_account_number"),ae=k("checkout_cci_number"),se=k("checkout_account_holder");return e.jsx(ue,{isOpen:u,onRequestClose:n,className:"absolute left-1/2 -translate-x-1/2 bg-[#f5f5f5] rounded-2xl shadow-lg w-[95%] max-w-lg top-1/2 -translate-y-1/2 overflow-hidden font-paragraph",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 z-50",ariaHideApp:!1,children:e.jsxs("div",{className:"py-6 px-6 md:px-10 flex flex-col gap-4 max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("img",{src:`/assets/resources/logo.png?v=${crypto.randomUUID()}`,alt:q.APP_NAME,className:"h-12 object-contain",onError:b=>{b.target.onerror=null,b.target.src="/assets/img/logo-bk.svg"}})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Pago por Transferencia"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Realiza la transferencia y sube tu comprobante"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 space-y-3",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(te,{size:18}),"Resumen de tu reserva"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 text-center",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-lg font-bold text-primary",children:l.length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Habitación(es)"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-lg font-bold text-primary",children:t}),e.jsx("div",{className:"text-xs text-gray-500",children:"Noche(s)"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-lg font-bold text-primary",children:U}),e.jsx("div",{className:"text-xs text-gray-500",children:"Huésped(es)"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 space-y-3",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(us,{size:18}),"Datos para transferencia"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded-lg",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Banco"}),e.jsx("p",{className:"font-medium text-gray-800",children:K})]})}),R&&e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Número de cuenta"}),e.jsx("p",{className:"font-medium text-gray-800",children:R})]}),e.jsx("button",{onClick:()=>o(R,"account"),className:"p-2 hover:bg-gray-200 rounded-lg transition-colors",children:O==="account"?e.jsx(Fe,{size:18,className:"text-green-500"}):e.jsx(Me,{size:18,className:"text-gray-400"})})]}),ae&&e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"CCI (Interbancario)"}),e.jsx("p",{className:"font-medium text-gray-800",children:ae})]}),e.jsx("button",{onClick:()=>o(ae,"cci"),className:"p-2 hover:bg-gray-200 rounded-lg transition-colors",children:O==="cci"?e.jsx(Fe,{size:18,className:"text-green-500"}):e.jsx(Me,{size:18,className:"text-gray-400"})})]}),se&&e.jsx("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded-lg",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Titular"}),e.jsx("p",{className:"font-medium text-gray-800",children:se})]})})]})]}),e.jsxs("div",{className:"bg-primary text-white rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-sm opacity-90",children:"Total a transferir"}),e.jsxs("p",{className:"text-2xl font-bold",children:[E()," ",$(M)]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Sube tu comprobante de transferencia *"}),e.jsx("input",{type:"file",ref:H,onChange:Q,accept:"image/*",className:"hidden"}),j?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:URL.createObjectURL(j),alt:"Comprobante",className:"w-full max-h-48 object-contain rounded-lg"}),e.jsx("button",{type:"button",onClick:X,className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:e.jsx(pe,{size:16})})]}):e.jsxs("button",{type:"button",onClick:()=>{var b;return(b=H.current)==null?void 0:b.click()},className:"w-full border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-primary transition-colors",children:[e.jsx(Le,{className:"mx-auto h-8 w-8 text-gray-400"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Haz clic para subir tu comprobante"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"PNG, JPG hasta 5MB"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:x,disabled:T||!j,className:`w-full py-3 px-6 rounded-full font-semibold text-white transition-all ${T||!j?"bg-gray-400 cursor-not-allowed":"bg-primary hover:opacity-90"}`,children:T?"Procesando...":"Confirmar Reserva"}),e.jsx("button",{onClick:n,disabled:T,className:"w-full py-3 px-6 rounded-full font-semibold border border-gray-300 text-gray-700 hover:bg-gray-50 transition-all",children:"Cancelar"})]})]})})}function _s({cart:u,setBooking:n,setCode:l,setCart:v,onContinue:y,noContinue:M,subTotal:i,igv:C,totalFinal:B,user:a,prefixes:p=[],ubigeos:F=[],contacts:f=[],totalPrice:T,data:S,openModal:j,setCouponDiscount:w,setCouponCode:O,totalWithoutDiscounts:D}){const H=(s,r)=>r?r.startsWith(s)?r:`${s}${r}`:"",Q=(s,r)=>s?s.startsWith(r)?s.substring(r.length):s:"",X=m.useRef(null),[o,x]=m.useState(null),k=[{value:"dni",label:"DNI"},{value:"ruc",label:"RUC"},{value:"ce",label:"CE"},{value:"pasaporte",label:"Pasaporte"}],[t,U]=m.useState(()=>{var h;const s=(a==null?void 0:a.phone_prefix)||"51",r=Q((a==null?void 0:a.phone)||"",s);return{name:(a==null?void 0:a.name)||"",lastname:(a==null?void 0:a.lastname)||"",email:(a==null?void 0:a.email)||"",phone_prefix:s,phone:r,documentType:((h=a==null?void 0:a.document_type)==null?void 0:h.toLowerCase())||"dni",document:(a==null?void 0:a.document_number)||"",comment:"",specialRequests:"",invoiceType:(a==null?void 0:a.invoiceType)||"boleta",businessName:(a==null?void 0:a.businessName)||""}});m.useEffect(()=>{if(a){const s=a.phone_prefix||"51",r=Q(a.phone||"",s);U(h=>{var _;return{...h,name:a.name||"",lastname:a.lastname||"",email:a.email||"",phone_prefix:s,phone:r,documentType:((_=a.document_type)==null?void 0:_.toLowerCase())||"dni",document:a.document_number||"",invoiceType:a.invoiceType||"boleta",businessName:a.businessName||""}})}},[a]);const K=(()=>{const s=f==null?void 0:f.find(_=>_.correlative==="checkout_mercadopago"),r=f==null?void 0:f.find(_=>_.correlative==="checkout_openpay"),h=f==null?void 0:f.find(_=>_.correlative==="checkout_culqi");return(s==null?void 0:s.description)==="true"||(r==null?void 0:r.description)==="true"||(h==null?void 0:h.description)==="true"||Y.get("checkout_dwallet")==="true"||Y.get("checkout_transfer")==="true"})(),R=s=>{const{name:r,value:h}=s.target;U(_=>({..._,[r]:h})),r==="invoiceType"&&U(_=>({..._,documentType:h==="factura"?"ruc":"dni",document:"",businessName:h==="factura"?_.businessName:""}))},[ae,se]=m.useState(!1),[b,g]=m.useState(!1),[c,P]=m.useState({}),[G,Z]=m.useState(""),[N,de]=m.useState(null),[Ts,Ss]=m.useState(0),[ve,we]=m.useState(!1),[Ce,re]=m.useState(""),[Ie,ke]=m.useState(!1),[ne,Ae]=m.useState(0),[Ue,qe]=m.useState(null),L=s=>Math.round((s+Number.EPSILON)*100)/100,V=(()=>{if(!N)return 0;const s=L(i+C);if(N.discount_type==="percentage"){const r=parseFloat(N.discount_value)||0;return L(s*(r/100))}else return L(parseFloat(N.discount_value)||0)})(),ee=L(i+C),he=(()=>{if(!Ue||ne<=0)return 0;const s=Math.max(0,L(ee-V));return L(s*(ne/100))})(),me=(()=>{const s=L(ee),r=Math.max(0,L(s-V)),h=L(r+he);return Math.max(0,h)})(),Be=()=>{const s={};return t.name||(s.name="Nombre es requerido"),t.lastname||(s.lastname="Apellido es requerido"),t.email||(s.email="Email es requerido"),t.phone||(s.phone="Teléfono es requerido"),t.document||(s.document="Documento es requerido"),t.email&&!/\S+@\S+\.\S+/.test(t.email)&&(s.email="Email inválido"),t.document&&(t.documentType==="dni"&&t.document.length!==8?s.document="DNI debe tener 8 dígitos":t.documentType==="ruc"&&t.document.length!==11&&(s.document="RUC debe tener 11 dígitos")),t.invoiceType==="factura"&&!t.businessName&&(s.businessName="Razón social es requerida para factura"),P(s),Object.keys(s).length===0},He=s=>{const r=Object.keys(s)[0];setTimeout(()=>{let h=document.querySelector(`[name="${r}"]`);h&&(h.classList.add("highlight-error"),setTimeout(()=>h.classList.remove("highlight-error"),2e3),h.scrollIntoView({behavior:"smooth",block:"center"}),["INPUT","SELECT","TEXTAREA"].includes(h.tagName)&&h.focus())},100)},Ve=async()=>{if(!G.trim()){re("Ingresa un código de cupón");return}we(!0),re("");try{const s=await is.validate({code:G,total:ee});if(s.valid){if(de(s.coupon),x(s.coupon),w)if(s.coupon.discount_type==="percentage"){const r=ee*(parseFloat(s.coupon.discount_value)/100);w(L(r))}else w(L(parseFloat(s.coupon.discount_value)));O&&O(G),z.success("Cupón aplicado",{description:`Descuento de ${s.coupon.discount_type==="percentage"?s.coupon.discount_value+"%":E()+" "+s.coupon.discount_value}`,icon:e.jsx(ie,{className:"h-5 w-5 text-green-500"}),duration:3e3,position:"top-right"})}else re(s.message||"Cupón no válido")}catch(s){console.error("Error validating coupon:",s),re("Error al validar el cupón")}finally{we(!1)}},De=()=>{de(null),x(null),Z(""),re(""),w&&w(0),O&&O(null)},_e=s=>{if(!s)return"";try{const r=new Date(s+"T00:00:00");return ye(r,"dd MMM yyyy",{locale:Ne})}catch{return s}},[Ge,ge]=m.useState(!1),[We,be]=m.useState(!1),[Rs,$s]=m.useState(null),[Je,Pe]=m.useState(!1),[Qe,Ee]=m.useState(!1),[Fs,Xe]=m.useState(null),[Te,fe]=m.useState(null),Ye=s=>{if(s.preventDefault(),!Be()){He(c);return}ge(!0)},Ke=async s=>{try{let r=0;switch(s){case"tarjeta":r=parseFloat(q.get("checkout_mercadopago_commission")||0);break;case"culqi":r=parseFloat(q.get("checkout_culqi_commission")||0);break;case"openpay":r=parseFloat(q.get("checkout_openpay_commission")||0);break;case"yape":r=parseFloat(q.get("checkout_dwallet_commission")||0);break;case"transferencia":r=parseFloat(q.get("checkout_transfer_commission")||0);break;default:r=0}if(Ae(r),qe(s),ge(!1),Xe(s),s==="openpay"){be(!0);return}const h=L((ee-V)*(r/100)),_=L(ee-V+h),W=u.map(d=>({id:d.id,name:d.name,room_type:d.room_type,check_in:d.check_in||d.checkIn,check_out:d.check_out||d.checkOut,nights:d.nights||1,guests:d.guests||2,adults:d.adults||d.guests||2,children:d.children||0,price:d.price,final_price:d.final_price||d.price,image:d.image})),I={user_id:(a==null?void 0:a.id)||"",name:(t==null?void 0:t.name)||"",lastname:(t==null?void 0:t.lastname)||"",fullname:`${t==null?void 0:t.name} ${t==null?void 0:t.lastname}`,phone_prefix:(t==null?void 0:t.phone_prefix)||"51",email:(t==null?void 0:t.email)||"",phone:H(t.phone_prefix||"51",t.phone),country:"Perú",comment:(t==null?void 0:t.comment)||"",special_requests:(t==null?void 0:t.specialRequests)||"",amount:_||0,delivery_type:"domicilio",details:JSON.stringify(W),cart:W,booking_type:"rooms",invoiceType:t.invoiceType||"",documentType:t.documentType||"",document:t.document||"",businessName:t.businessName||"",payment_method:s||null,coupon_id:N?N.id:null,coupon_discount:V||0,payment_commission:h||0,payment_commission_percentage:r||0,total_amount:_||0};if(fe(I),s==="tarjeta"){if(!window.MercadoPago){console.error("❌ MercadoPago aún no se ha cargado.");return}try{const oe=await ls(I);oe.status?(n(oe.sale),l(oe.code),y()):z.error("Error en el Pago",{description:"El pago ha sido rechazado",icon:e.jsx(A,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"bottom-center"})}catch{z.error("Error en el Pago",{description:"No se llegó a procesar el pago",icon:e.jsx(A,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"bottom-center"})}}else if(s==="culqi"){g(!0);try{if(!q.CULQI_ENABLED){z.error("Método de pago no disponible",{description:"El procesamiento de pagos con Culqi está temporalmente deshabilitado",icon:e.jsx(A,{className:"h-5 w-5 text-red-500"}),duration:4e3,position:"top-center"}),g(!1);return}const d=await ds(I);d.status?(n(d.sale),l(d.code),y()):z.error("Error en el Pago",{description:d.message||"El pago ha sido rechazado",icon:e.jsx(A,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"bottom-center"})}catch{z.error("Error en el Pago",{description:"No se llegó a procesar el pago",icon:e.jsx(A,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"bottom-center"})}finally{g(!1)}}else s==="yape"?(fe(I),Pe(!0)):s==="transferencia"&&(fe(I),Ee(!0))}catch(r){console.error("Error en pago:",r),z.error("Error",{description:"Ocurrió un error inesperado",icon:e.jsx(A,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"bottom-center"})}},Ze=async s=>{be(!1);try{const r=L((ee-V)*(ne/100)),h=L(ee-V+r),_=u.map(d=>({id:d.id,name:d.name,room_type:d.room_type,checkIn:d.checkIn,checkOut:d.checkOut,nights:d.nights||1,guests:d.guests||2,adults:d.adults||d.guests||2,children:d.children||0,price:d.price,final_price:d.final_price||d.price,image:d.image})),W={...s,user_id:(a==null?void 0:a.id)||"",name:(t==null?void 0:t.name)||"",lastname:(t==null?void 0:t.lastname)||"",fullname:`${t==null?void 0:t.name} ${t==null?void 0:t.lastname}`,phone_prefix:(t==null?void 0:t.phone_prefix)||"51",email:(t==null?void 0:t.email)||"",phone:H(t.phone_prefix||"51",t.phone),country:"Perú",comment:(t==null?void 0:t.comment)||"",special_requests:(t==null?void 0:t.specialRequests)||"",amount:h||0,cart:_,booking_type:"rooms",invoiceType:t.invoiceType||"",documentType:t.documentType||"",document:t.document||"",businessName:t.businessName||"",payment_method:"openpay",coupon_id:N?N.id:null,coupon_discount:V||0,payment_commission:r||0,payment_commission_percentage:ne||0,total_amount:h||0},I=await cs(W);I.status?(n(I.sale),l(I.code),y()):z.error("Error en el Pago",{description:I.message||"El pago ha sido rechazado",icon:e.jsx(A,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"bottom-center"})}catch(r){console.error("Error en pago OpenPay:",r),z.error("Error en el Pago",{description:"No se llegó a procesar el pago",icon:e.jsx(A,{className:"h-5 w-5 text-red-500"}),duration:3e3,position:"bottom-center"})}},es=u.reduce((s,r)=>s+(r.nights||1),0),ss=u.reduce((s,r)=>s+(r.guests||2),0);return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 font-paragraph",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold customtext-neutral-dark mb-2",children:"Datos de la reserva"}),e.jsx("p",{className:"customtext-neutral-light",children:"Completa tus datos para confirmar la reserva"})]}),u.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-primary/5 to-secondary/5 border border-primary/20 rounded-xl p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold customtext-neutral-dark mb-3 flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4 customtext-primary"}),"Resumen de tu reserva"]}),e.jsx("div",{className:"space-y-2",children:u.map((s,r)=>e.jsxs("div",{className:"flex items-center gap-3 text-sm bg-white/50 rounded-lg p-2",children:[e.jsx("img",{src:`/storage/images/item/${s.image}`,alt:s.name,className:"w-12 h-12 object-cover rounded-lg flex-shrink-0",onError:h=>h.target.src="/assets/img/noimage/no_img.jpg"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-semibold customtext-neutral-dark truncate",children:s.name}),e.jsxs("div",{className:"text-xs customtext-neutral-light",children:[_e(s.check_in)," - ",_e(s.check_out)," · ",s.nights," ",s.nights===1?"noche":"noches"," · ",s.guests," ",s.guests===1?"huésped":"huéspedes"]})]})]},`${s.id}-${s.check_in}-${r}`))})]}),e.jsxs("div",{className:"bg-white border border-sections-color rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-semibold customtext-neutral-dark mb-4 flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5 customtext-primary"}),"Datos del huésped principal"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium customtext-neutral-dark mb-1",children:["Nombre ",e.jsx("span",{className:"customtext-danger",children:"*"})]}),e.jsx("input",{type:"text",name:"name",value:t.name,onChange:R,className:`w-full border ${c.name?"border-danger":"border-sections-color"} rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all`,placeholder:"Tu nombre"}),c.name&&e.jsx("p",{className:"customtext-danger text-xs mt-1",children:c.name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium customtext-neutral-dark mb-1",children:["Apellido ",e.jsx("span",{className:"customtext-danger",children:"*"})]}),e.jsx("input",{type:"text",name:"lastname",value:t.lastname,onChange:R,className:`w-full border ${c.lastname?"border-danger":"border-sections-color"} rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all`,placeholder:"Tu apellido"}),c.lastname&&e.jsx("p",{className:"customtext-danger text-xs mt-1",children:c.lastname})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium customtext-neutral-dark mb-1",children:["Email ",e.jsx("span",{className:"customtext-danger",children:"*"})]}),e.jsx("input",{type:"email",name:"email",value:t.email,onChange:R,className:`w-full border ${c.email?"border-danger":"border-sections-color"} rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all`,placeholder:"tu@email.com"}),c.email&&e.jsx("p",{className:"customtext-danger text-xs mt-1",children:c.email})]}),e.jsxs("div",{className:"w-full",children:[e.jsxs("label",{htmlFor:"phone",className:"block text-sm font-medium customtext-neutral-dark mb-1",children:["Celular ",e.jsx("span",{className:"customtext-danger",children:"*"})]}),e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx("div",{className:"max-w-[120px]",children:e.jsx(ps,{name:"phone_prefix",value:p.find(s=>s.realCode===t.phone_prefix)?{value:p.find(s=>s.realCode===t.phone_prefix).realCode,label:`${p.find(s=>s.realCode===t.phone_prefix).beautyCode}`,flag:p.find(s=>s.realCode===t.phone_prefix).flag,code:p.find(s=>s.realCode===t.phone_prefix).beautyCode,country:p.find(s=>s.realCode===t.phone_prefix).country}:null,onChange:s=>U(r=>({...r,phone_prefix:(s==null?void 0:s.value)||""})),options:p.sort((s,r)=>s.country.localeCompare(r.country)).map(s=>({value:s.realCode,label:s.beautyCode,flag:s.flag,code:s.beautyCode,country:s.country})),formatOptionLabel:({flag:s,code:r,country:h})=>{var Se,Re;const _=p.find(le=>le.country===h),W=((Re=(Se=_==null?void 0:_.isoCode)==null?void 0:Se.ISO1)==null?void 0:Re.toLowerCase())||h.toLowerCase().substring(0,2),I=[`https://flagsapi.com/${W.toUpperCase()}/flat/24.png`,`https://flagcdn.com/${W}.svg`,`https://purecatamphetamine.github.io/country-flag-icons/3x2/${W.toUpperCase()}.svg`,`https://cdn.jsdelivr.net/gh/hampusborgos/country-flags@main/svg/${W}.svg`,`https://raw.githubusercontent.com/lipis/flag-icons/main/flags/4x3/${W}.svg`];let d=0;const oe=le=>{if(d++,d<I.length)le.target.src=I[d];else{le.target.style.display="none";const $e=le.target.parentNode.querySelector(".flag-fallback");$e&&($e.style.display="flex")}};return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:I[0],alt:`Bandera de ${h}`,className:"w-6 h-4 object-cover rounded-sm flex-shrink-0 border border-gray-200",onError:oe,style:{minWidth:"24px",minHeight:"16px"}}),e.jsx("div",{className:"flag-fallback w-6 h-4 bg-gray-200 rounded-sm flex items-center justify-center flex-shrink-0 border border-gray-300",style:{display:"none",minWidth:"24px",minHeight:"16px"},children:e.jsx("span",{className:"text-xs text-gray-500",children:W.toUpperCase()})}),e.jsx("span",{className:"font-medium text-sm",children:r})]})},placeholder:"País",isClearable:!1,isSearchable:!0,styles:{control:s=>({...s,minHeight:"48px",border:"1px solid #d1d5db",borderRadius:"0.75rem",fontSize:"14px","&:hover":{borderColor:"#9ca3af"},"&:focus-within":{borderColor:"#3b82f6",boxShadow:"0 0 0 2px rgba(59, 130, 246, 0.1)"}}),option:(s,r)=>({...s,backgroundColor:r.isSelected?"#3b82f6":r.isFocused?"#f3f4f6":"white",color:r.isSelected?"white":"#374151",padding:"8px 12px"}),singleValue:s=>({...s,display:"flex",alignItems:"center",gap:"6px"}),menu:s=>({...s,zIndex:9999})},filterOption:(s,r)=>s.data.country.toLowerCase().includes(r.toLowerCase())||s.data.code.toLowerCase().includes(r.toLowerCase())})}),e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"tel",id:"phone",name:"phone",value:t.phone,onChange:R,className:`w-full border ${c.phone?"border-danger":"border-sections-color"} rounded-xl px-4 py-3 focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all`,placeholder:"000 000 000"})})]}),c.phone&&e.jsx("p",{className:"customtext-danger text-xs mt-1",children:c.phone})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium customtext-neutral-dark mb-1",children:["Tipo de documento ",e.jsx("span",{className:"customtext-danger",children:"*"})]}),e.jsx("select",{name:"documentType",value:t.documentType,onChange:R,className:"w-full border border-sections-color rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all",children:k.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium customtext-neutral-dark mb-1",children:["Número de documento ",e.jsx("span",{className:"customtext-danger",children:"*"})]}),e.jsx("input",{type:"text",name:"document",value:t.document,onChange:R,className:`w-full border ${c.document?"border-danger":"border-sections-color"} rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all`,placeholder:t.documentType==="dni"?"12345678":"Número de documento",maxLength:t.documentType==="dni"?8:t.documentType==="ruc"?11:20}),c.document&&e.jsx("p",{className:"customtext-danger text-xs mt-1",children:c.document})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium customtext-neutral-dark mb-1",children:"Solicitudes especiales (opcional)"}),e.jsx("textarea",{name:"specialRequests",value:t.specialRequests,onChange:R,rows:3,className:"w-full border border-sections-color rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all resize-none",placeholder:"¿Tienes alguna solicitud especial? (cama extra, llegada tarde, etc.)"})]})]}),e.jsxs("div",{className:"bg-white border border-sections-color rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-semibold customtext-neutral-dark mb-4 flex items-center gap-2",children:[e.jsx(hs,{className:"w-5 h-5 customtext-primary"}),"Comprobante de pago"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("label",{className:`flex items-center gap-3 p-4 border-2 rounded-xl cursor-pointer transition-all ${t.invoiceType==="boleta"?"border-accent bg-accent/5":"border-sections-color hover:border-accent"}`,children:[e.jsx("input",{type:"radio",name:"invoiceType",value:"boleta",checked:t.invoiceType==="boleta",onChange:R,className:"text-accent focus:ring-accent"}),e.jsx("span",{className:"font-medium customtext-neutral-dark",children:"Boleta"})]}),e.jsxs("label",{className:`flex items-center gap-3 p-4 border-2 rounded-xl cursor-pointer transition-all ${t.invoiceType==="factura"?"border-accent bg-accent/5":"border-sections-color hover:border-accent"}`,children:[e.jsx("input",{type:"radio",name:"invoiceType",value:"factura",checked:t.invoiceType==="factura",onChange:R,className:"text-accent focus:ring-accent"}),e.jsx("span",{className:"font-medium",children:"Factura"})]})]}),t.invoiceType==="factura"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium customtext-neutral-dark mb-1",children:["Razón Social ",e.jsx("span",{className:"customtext-danger",children:"*"})]}),e.jsx("input",{type:"text",name:"businessName",value:t.businessName,onChange:R,className:`w-full border ${c.businessName?"border-danger":"border-sections-color"} rounded-lg px-4 py-2.5 focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all`,placeholder:"Nombre de la empresa"}),c.businessName&&e.jsx("p",{className:"customtext-danger text-xs mt-1",children:c.businessName})]})]}),e.jsx("div",{className:"lg:hidden",children:e.jsx("button",{onClick:M,className:"w-full py-3 px-6 text-center rounded-full font-semibold customtext-neutral-dark border-2 border-accent hover:bg-accent hover:text-white transition-all duration-300",children:"Volver al carrito"})})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white border border-sections-color rounded-2xl shadow-md p-6 sticky top-4",children:[e.jsx("h3",{className:"text-xl font-bold customtext-neutral-dark mb-6",children:"Resumen de pago"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 pb-6 border-b border-sections-color mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold customtext-primary",children:u.length}),e.jsx("div",{className:"text-xs customtext-neutral-light mt-1",children:u.length===1?"Habitación":"Habitaciones"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold customtext-primary",children:es}),e.jsx("div",{className:"text-xs customtext-neutral-light mt-1",children:"Noches"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold customtext-primary",children:ss}),e.jsx("div",{className:"text-xs customtext-neutral-light mt-1",children:"Huéspedes"})]})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"customtext-neutral-light",children:"Subtotal"}),e.jsxs("span",{className:"font-medium customtext-neutral-dark",children:[E()," ",$(i)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"customtext-neutral-light",children:"Impuestos y cargos"}),e.jsxs("span",{className:"font-medium customtext-neutral-dark",children:[E()," ",$(C)]})]}),N&&V>0&&e.jsxs("div",{className:"flex justify-between text-sm customtext-success",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ie,{size:14}),"Cupón (",N.code,")"]}),e.jsxs("span",{className:"font-medium",children:["-",E()," ",$(V)]})]}),he>0&&e.jsxs("div",{className:"flex justify-between text-sm customtext-warning",children:[e.jsxs("span",{children:["Comisión (",ne,"%)"]}),e.jsxs("span",{className:"font-medium",children:["+",E()," ",$(he)]})]})]}),e.jsxs("div",{className:"mb-6 pb-6 border-b border-sections-color",children:[e.jsx("label",{className:"block text-sm font-medium customtext-neutral-dark mb-2",children:"¿Tienes un cupón?"}),N?e.jsxs("div",{className:"flex items-center justify-between bg-success/10 border border-success rounded-lg px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{size:18,className:"customtext-success"}),e.jsx("span",{className:"font-medium customtext-success",children:N.code})]}),e.jsx("button",{onClick:De,className:"customtext-danger hover:text-danger text-sm font-medium",children:"Quitar"})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",ref:X,value:G,onChange:s=>Z(s.target.value.toUpperCase()),placeholder:"Código de cupón",className:"flex-1 border border-gray-300 rounded-full px-4 py-2.5 text-sm focus:ring-2 focus:ring-accent focus:border-transparent outline-none transition-all"}),e.jsx("button",{onClick:Ve,disabled:ve,className:"px-6 py-2.5 bg-accent hover:bg-secondary text-white rounded-full text-sm font-bold hover:shadow-lg transition-all duration-300 disabled:opacity-50 hover:scale-105 active:scale-95",children:ve?"...":"Aplicar"})]}),Ce&&e.jsx("p",{className:"customtext-danger text-xs mt-2",children:Ce})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-bold customtext-neutral-dark",children:"Total a pagar"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold customtext-primary",children:[E()," ",$(me)]}),e.jsx("div",{className:"text-xs customtext-neutral-light",children:"Incluye impuestos"})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:Ye,disabled:b||!K,className:`w-full py-4 px-6 rounded-full font-bold text-base transition-all duration-300 bg-primary hover:bg-secondary text-white hover:shadow-2xl hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed shadow-lg ${(S==null?void 0:S.class_button)||""}`,children:b?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Procesando..."]}):"Confirmar y pagar"}),e.jsx("button",{onClick:M,className:"hidden lg:block w-full py-3 px-6 text-center rounded-full font-semibold customtext-primary border-2 border-accent hover:bg-accent hover:text-white transition-all duration-300 shadow-md hover:shadow-lg",children:"Volver al carrito"})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-sections-color",children:e.jsxs("p",{className:"text-xs customtext-neutral-light leading-relaxed",children:["Al proceder, aceptas nuestros"," ",e.jsx("button",{onClick:()=>j&&j(1),className:"customtext-accent font-medium hover:underline",children:"Términos y Condiciones"})," ","y"," ",e.jsx("button",{onClick:()=>j&&j(0),className:"customtext-accent font-medium hover:underline",children:"Política de Privacidad"})]})})]})}),e.jsx(ue,{isOpen:Ie,onRequestClose:()=>ke(!1),contentLabel:"Iniciar sesión",className:"fixed top-0 left-0 right-0 bottom-0 flex items-center justify-center p-4 z-50",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 z-[999]",ariaHideApp:!1,children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx(gs,{className:"w-16 h-16 customtext-neutral-light mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold customtext-neutral-dark mb-2",children:"Inicia sesión"}),e.jsx("p",{className:"customtext-neutral-light",children:"Para continuar con tu reserva, necesitas iniciar sesión o crear una cuenta."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("a",{href:"/iniciar-sesion",className:"block w-full py-4 px-6 text-center rounded-full font-bold bg-primary hover:bg-secondary text-white hover:shadow-xl transition-all duration-300 shadow-lg hover:scale-105 active:scale-95",children:"Iniciar sesión"}),e.jsx("a",{href:"/register",className:"block w-full py-3 px-6 text-center rounded-full font-semibold customtext-primary border-2 border-accent hover:bg-accent hover:text-white transition-all duration-300 shadow-md hover:shadow-lg",children:"Crear cuenta"}),e.jsx("button",{onClick:()=>ke(!1),className:"block w-full py-2 text-center customtext-neutral-light hover:customtext-neutral-dark text-sm font-medium transition-colors",children:"Cancelar"})]})]})}),e.jsx(xs,{isOpen:Ge,contacts:f,cart:u,totalFinal:N?me:B,onClose:()=>ge(!1),onPaymentComplete:Ke}),e.jsx(os,{isOpen:We,onClose:()=>be(!1),onTokenCreated:Ze}),e.jsx(ws,{isOpen:Je,cart:u,subTotal:i,igv:C,totalFinal:N?me:B,request:Te,onClose:()=>Pe(!1),contacts:f,coupon:N,descuentofinal:V,setCode:l,setBooking:n,onContinue:y}),e.jsx(ks,{isOpen:Qe,cart:u,subTotal:i,igv:C,totalFinal:N?me:B,contacts:f,request:Te,onClose:()=>Ee(!1),coupon:N,descuentofinal:V,setCode:l,setBooking:n,onContinue:y})]})}const Ps=({code:u})=>new Promise(async(n,l)=>{try{console.log("Codigo de reserva:",u);const{status:v,result:y}=await J.Fetch("./api/hotels/bookings/order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:u})});if(!v||!y.order){J.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:(y==null?void 0:y.message)||"Error: no se pudo cargar la reserva",type:"danger"}),l((y==null?void 0:y.message)||"Error: no se pudo cargar la reserva");return}n(y)}catch(v){console.error("Error en recoveryBookingData:",v),J.Notify.add({icon:"/assets/img/icon.svg",title:"Error",body:v.message||"Error al cargar los datos de la reserva",type:"danger"}),l(v.message||"Error al cargar los datos de la reserva")}});function Es({setCart:u,cart:n,code:l,data:v,couponDiscount:y=0,couponCode:M=null}){var X;const[i,C]=m.useState(null),[B,a]=m.useState(!0),[p,F]=m.useState(null);m.useEffect(()=>{l&&((async()=>{try{const x=await Ps({code:l});C(x.order)}catch(x){F(x.message||x)}finally{a(!1)}})(),J.Local.delete(`${q.APP_CORRELATIVE}_cart`))},[l]);const f=o=>{if(!o)return"";try{const x=new Date(o+"T00:00:00");return ye(x,"dd 'de' MMMM, yyyy",{locale:Ne})}catch{return o}},T=o=>({standard:"Estándar",suite:"Suite",deluxe:"Deluxe",presidential:"Presidencial",family:"Familiar",executive:"Ejecutiva",single:"Individual",double:"Doble"})[o]||o;if(B)return e.jsx("div",{className:"mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 font-paragraph text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{children:"Cargando detalles de tu reserva..."})]})});if(p)return e.jsx("div",{className:"mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6 font-paragraph text-center text-red-500",children:e.jsxs("p",{children:["Error al cargar la reserva: ",p]})})});if(!i)return e.jsx("div",{className:"mx-auto",children:e.jsx("div",{className:"bg-white rounded-lg shadow p-6 font-paragraph text-center",children:e.jsx("p",{children:"No se encontraron datos de la reserva"})})});const S=((X=i==null?void 0:i.items)==null?void 0:X.reduce((o,x)=>{const k=x.final_price||x.price||0,t=x.nights||1;return o+k*t},0))||0,j=parseFloat((S/1.18).toFixed(2)),w=parseFloat((S-j).toFixed(2)),O=parseFloat(i.coupon_discount||0),D=parseFloat(i.payment_commission||0),Q=parseFloat(j)+parseFloat(w)-O+D;return e.jsx("div",{className:"max-w-4xl mx-auto font-paragraph",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-success p-8 text-white text-center",children:[e.jsx(ie,{className:"w-16 h-16 mx-auto mb-4"}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"¡Reserva Confirmada!"}),e.jsxs("p",{className:"text-lg opacity-90",children:["Código de reserva: ",e.jsx("span",{className:"font-mono font-bold",children:i.code})]})]}),e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5 customtext-primary"}),"Información del Huésped"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 bg-sections-color rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(je,{className:"w-5 h-5 text-gray-400 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Nombre completo"}),e.jsxs("p",{className:"font-semibold",children:[i.name," ",i.lastname]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(je,{className:"w-5 h-5 text-gray-400 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Email"}),e.jsx("p",{className:"font-semibold",children:i.email})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(bs,{className:"w-5 h-5 text-gray-400 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Teléfono"}),e.jsxs("p",{className:"font-semibold",children:["+",i.phone_prefix," ",i.phone]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(fs,{className:"w-5 h-5 text-gray-400 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Documento"}),e.jsx("p",{className:"font-semibold",children:i.document})]})]})]})]}),e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Habitaciones Reservadas"}),e.jsx("div",{className:"space-y-4",children:i.items&&i.items.map((o,x)=>{const k=o.final_price||o.price||0,t=o.nights||1,U=k*t,K=o.guests||2;return e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:o.image?`/storage/images/item/${o.image}`:"/assets/img/noimage/no_img.jpg",alt:o.name,className:"w-24 h-24 object-cover rounded-lg",onError:R=>R.target.src="/assets/img/noimage/no_img.jpg"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:o.name}),o.room_type&&e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Tipo: ",T(o.room_type)]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{size:16,className:"customtext-info"}),e.jsx("span",{className:"text-gray-600",children:"Check-in:"}),e.jsx("span",{className:"font-semibold",children:f(o.check_in)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{size:16,className:"customtext-danger"}),e.jsx("span",{className:"text-gray-600",children:"Check-out:"}),e.jsx("span",{className:"font-semibold",children:f(o.check_out)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{size:16,className:"customtext-secondary"}),e.jsx("span",{className:"text-gray-600",children:"Noches:"}),e.jsx("span",{className:"font-semibold",children:t})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{size:16,className:"customtext-success"}),e.jsx("span",{className:"text-gray-600",children:"Huéspedes:"}),e.jsx("span",{className:"font-semibold",children:K})]})]}),e.jsxs("div",{className:"mt-3 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Precio por noche"}),e.jsxs("p",{className:"font-semibold",children:[E()," ",$(k)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Total habitación"}),e.jsxs("p",{className:"font-bold text-lg customtext-primary",children:[E()," ",$(U)]})]})]})]})]})},x)})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Resumen de Pago"}),e.jsxs("div",{className:"space-y-3 bg-sections-color rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:[E()," ",$(j)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"customtext-neutral-dark",children:"IGV (18%)"}),e.jsxs("span",{className:"font-semibold",children:[E()," ",$(w)]})]}),i.coupon_id&&e.jsxs("div",{className:"flex justify-between items-center customtext-success border-t pt-2",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(ie,{size:16}),"Cupón aplicado (",i.coupon_code,")"]}),e.jsxs("span",{className:"font-semibold",children:["-",E()," ",$(O)]})]}),D>0&&e.jsxs("div",{className:"flex justify-between items-center customtext-warning border-t pt-2",children:[e.jsxs("span",{className:"text-sm",children:["Comisión método de pago (",i.payment_commission_percentage||0,"%)"]}),e.jsxs("span",{className:"font-semibold",children:["+",E()," ",$(D)]})]}),e.jsxs("div",{className:"flex justify-between items-center font-bold text-xl border-t-2 pt-3 mt-3",children:[e.jsx("span",{children:"Total Pagado"}),e.jsxs("span",{className:"customtext-primary",children:[E()," ",$(Q)]})]}),i.payment_method&&e.jsxs("div",{className:"text-center text-sm text-gray-600 pt-2",children:["Método de pago: ",e.jsx("span",{className:"font-semibold capitalize",children:i.payment_method})]})]})]}),e.jsx("div",{className:"p-6 bg-sections-color border-t border-info",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(je,{className:"w-5 h-5 customtext-info mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold customtext-primary mb-2",children:"Confirmación enviada por email"}),e.jsxs("p",{className:"text-sm customtext-neutral-dark",children:["Hemos enviado un correo electrónico a ",e.jsx("span",{className:"font-semibold",children:i.email})," con todos los detalles de tu reserva. Por favor, revisa tu bandeja de entrada y la carpeta de spam."]})]})]})}),i.comment&&e.jsxs("div",{className:"p-6 bg-sections-color border-t border-warning",children:[e.jsx("h3",{className:"font-semibold customtext-primary mb-2",children:"Comentarios adicionales"}),e.jsx("p",{className:"text-sm customtext-neutral-dark",children:i.comment})]}),e.jsx("div",{className:"p-6 border-t border-gray-200",children:e.jsx(ms,{href:"/habitaciones",className:`w-full !rounded-full py-4 text-white ${v==null?void 0:v.class_button}`,children:"Ver más habitaciones"})}),e.jsxs("div",{className:"p-6 bg-sections-color text-center text-sm text-gray-600",children:[e.jsx("p",{children:"Si tienes alguna pregunta sobre tu reserva, no dudes en contactarnos."}),e.jsxs("p",{className:"mt-2",children:[e.jsx("span",{className:"font-semibold",children:"Código de reserva:"})," ",i.code]})]})]})})}function vt({cart:u,setCart:n,user:l,prefixes:v,ubigeos:y,items:M,contacts:i,data:C,generals:B=[]}){const[a,p]=m.useState(1),F=m.useMemo(()=>u.filter(c=>c.type==="booking"),[u]),f=c=>{n(P=>{const G=P.filter(N=>N.type!=="booking"),Z=typeof c=="function"?c(P.filter(N=>N.type==="booking")):c;return[...G,...Z]})},T=F.reduce((c,P)=>{const G=P.final_price||P.price,Z=P.nights||1;return c+G*Z},0),S=parseFloat(Y.igv_checkout||0);let j,w;S>0?(j=T,w=parseFloat((T*(S/100)).toFixed(2))):(j=parseFloat((T/1.18).toFixed(2)),w=parseFloat((T-j).toFixed(2)));const[O,D]=m.useState(0),[H,Q]=m.useState(null),[X,o]=m.useState(null),x=c=>o(c),k=()=>o(null),t={privacy_policy:"Políticas de privacidad",terms_conditions:"Términos y condiciones",saleback_policy:"Políticas de cancelación y cambios"},U=j+w,K=Math.max(0,U-O),[R,ae]=m.useState([]),[se,b]=m.useState([]);m.useEffect(()=>{const P=new URLSearchParams(window.location.search).get("code");P&&(b(P),p(3))},[window.location.search]),m.useEffect(()=>{se&&n(c=>c.filter(P=>P.type!=="booking"))},[se]),m.useEffect(()=>{(()=>{const P=document.createElement("script");P.src="https://sdk.mercadopago.com/js/v2",P.async=!0,document.body.appendChild(P)})()},[]);const g=c=>{p(c),window.scrollTo({top:0,behavior:"smooth"})};return e.jsx("div",{className:"bg-sections-color",children:e.jsxs("div",{className:"min-h-screen  py-4 md:py-12 px-2 sm:px-primary 2xl:px-0 2xl:max-w-7xl mx-auto",children:[e.jsxs("div",{className:"bg-white p-3 md:p-8 rounded-xl md:rounded-3xl shadow-sm",children:[e.jsx("div",{className:"mb-6 md:mb-10",children:e.jsxs("div",{className:"flex items-center justify-between gap-1 md:gap-4 max-w-3xl mx-auto",children:[e.jsxs("div",{className:`flex flex-col items-center md:flex-row md:items-center gap-1 md:gap-2 transition-all duration-300 ${a>=1?"customtext-primary font-bold":"customtext-neutral-light"}`,children:[e.jsx("span",{className:`w-10 h-10 md:w-12 md:h-12 rounded-full border-2 flex items-center justify-center text-sm md:text-base font-bold shadow-lg transition-all duration-300 ${a>=1?"bg-primary text-white border-primary scale-110":"bg-white customtext-neutral-light border-gray-300"}`,children:"1"}),e.jsx("span",{className:"text-[10px] md:text-sm font-semibold text-center",children:"Carrito"})]}),e.jsx("div",{className:"mb-4 lg:mb-0 flex-1 h-1 bg-gray-200 relative rounded-full overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 transition-all duration-700 bg-gradient-to-r from-primary to-secondary shadow-md",style:{width:a>1?"100%":"0%"}})}),e.jsxs("div",{className:`flex flex-col items-center md:flex-row md:items-center gap-1 md:gap-2 transition-all duration-300 ${a>1?"customtext-primary font-bold":"customtext-neutral-light"}`,children:[e.jsx("span",{className:`w-10 h-10 md:w-12 md:h-12 rounded-full border-2 flex items-center justify-center text-sm md:text-base font-bold shadow-lg transition-all duration-300 ${a>1?"bg-primary text-white border-primary scale-110":"bg-white customtext-neutral-light border-gray-300"}`,children:"2"}),e.jsx("span",{className:"text-[10px] md:text-sm font-semibold text-center",children:"Pago"})]}),e.jsx("div",{className:"mb-4 lg:mb-0 flex-1 h-1 bg-gray-200 relative rounded-full overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 transition-all duration-700 bg-gradient-to-r from-primary to-secondary shadow-md",style:{width:a>2?"100%":"0%"}})}),e.jsxs("div",{className:`flex flex-col items-center md:flex-row md:items-center gap-1 md:gap-2 transition-all duration-300 ${a===3?"customtext-primary font-bold":"customtext-neutral-light"}`,children:[e.jsx("span",{className:`w-10 h-10 md:w-12 md:h-12 rounded-full border-2 flex items-center justify-center text-sm md:text-base font-bold shadow-lg transition-all duration-300 ${a===3?"bg-success text-white border-success scale-110":"bg-white customtext-neutral-light border-gray-300"}`,children:"3"}),e.jsx("span",{className:"text-[10px] md:text-sm font-semibold text-center",children:"Confirmación"})]})]})}),a===1&&e.jsx(Ns,{data:C,cart:F,setCart:f,onContinue:()=>g(2),subTotal:j,totalPrice:T,igv:w,totalFinal:K,openModal:x,totalWithoutDiscounts:U}),a===2&&e.jsx(_s,{data:C,setCode:b,cart:F,setBooking:ae,setCart:f,onContinue:()=>g(3),noContinue:()=>g(1),subTotal:j,totalPrice:T,igv:w,totalFinal:K,user:l,prefixes:v,contacts:i,ubigeos:y,items:M,openModal:x,setCouponDiscount:D,setCouponCode:Q,totalWithoutDiscounts:U}),a===3&&e.jsx(Es,{data:C,code:se,setCart:f,cart:R,subTotal:j,totalPrice:T,igv:w,totalFinal:K,couponDiscount:O,couponCode:H,totalWithoutDiscounts:U})]}),Object.keys(t).map((c,P)=>{var N;const G=t[c],Z=((N=B.find(de=>de.correlative==c))==null?void 0:N.description)??"";return e.jsx(ue,{isOpen:X===P,onRequestClose:k,contentLabel:G,className:"fixed top-0 left-0 right-0 bottom-0 flex items-center justify-center p-4 z-50",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 z-[999]",ariaHideApp:!1,children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col animate-fadeIn",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-primary to-secondary",children:[e.jsx("h2",{className:"text-2xl font-bold text-white pr-4",children:G}),e.jsx("button",{onClick:k,className:"flex-shrink-0 w-10 h-10 rounded-full bg-white/20 hover:bg-white/30 text-white transition-all duration-300 flex items-center justify-center hover:scale-110 shadow-lg","aria-label":"Cerrar modal",children:e.jsx(pe,{size:20,strokeWidth:2.5})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsx("div",{className:"prose prose-gray max-w-none",children:e.jsx(rs,{html:Z})})}),e.jsx("div",{className:"flex justify-end gap-3 p-6 border-t border-gray-200 bg-sections-color",children:e.jsx("button",{onClick:k,className:"px-8 py-3 bg-primary hover:bg-secondary text-white rounded-full transition-all duration-300 font-bold shadow-lg hover:shadow-xl hover:scale-105 active:scale-95",children:"Cerrar"})})]})},P)})]})})}export{vt as default};
