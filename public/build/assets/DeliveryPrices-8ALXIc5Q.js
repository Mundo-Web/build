import{c as e,j as t,r,s as i}from"./vendor-react-SBvaUJTK.js";import{D as o}from"./DeliveryPricesRest-dHotiiJG.js";import{C as a}from"./CreateReactScript-BZ6xEkMS.js";import{S as n}from"./CartKuchara-8a8jAeu-.js";import{B as s}from"./Base-BQaY-qII.js";import{D as l}from"./DxButton-CkntFyfB.js";import{M as c}from"./Modal-ClgvT3ku.js";import{T as d}from"./Table-Bf8C5yZH.js";import{I as p}from"./InputFormGroup-DuKrUAYJ.js";import{S as u}from"./SelectFormGroup-DX2Z_QEH.js";import{S as m}from"./SwitchFormGroup-DGsB37aq.js";import{T as x}from"./TextareaFormGroup-B0EP8gtW.js";import{C as f,N as h}from"./Number2Currency-BX4epFEo.js";import"./vendor-swiper-Cr_RrIb_.js";import"./BasicRest-Cgj77E-j.js";import"./OpenPayCardModal-C0HhlOHJ.js";import"./BooleanLimit-q2Ad9fGY.js";import"./Footer-BligNWSa.js";import"./TippyButton-C4KoE0lc.js";import"./General-ClVW7qxN.js";import"./LaravelSession-ByQnaUD3.js";import"./Menu-CqnWUuE2.js";import"./Logout-BgttE_VN.js";import"./MenuItemContainer-CwLbZhxp.js";const b=new o,j=({ubigeo:e=[]})=>{const o=r.useRef(),a=r.useRef(),s=r.useRef(),j=r.useRef(),g=r.useRef(),v=r.useRef(),[w,C]=r.useState(!1),[y,R]=r.useState(!1),B=e=>{C(!!e?.id),s.current.value=e?.id??"",$(j.current).val(e?.ubigeo??null).trigger("change"),R(null===e?.price),g.current.value=e?.price??0,v.current.value=e?.description??"",$(a.current).modal("show")},S=e=>$(i.renderToString(t.jsxs("span",{children:[t.jsx("span",{className:"d-block w-100 text-truncate",children:e.text.replace(e.id,"")}),t.jsxs("small",{className:"d-block",children:["Ubigeo: ",e.id]})]})));return t.jsxs(t.Fragment,{children:[t.jsx("input",{id:"file-input",type:"file",accept:".xlsx, .xls",style:{display:"none"},onChange:async e=>{const t=e.target.files[0];if(!t)return;e.target.value=null;const r=new FormData;r.append("excel",t);await b.upload(r)&&$(o.current).dxDataGrid("instance").refresh()}}),t.jsx("a",{id:"excel-download-link",href:"/ruta/a/tu/archivo.xlsx",download:!0,style:{display:"none"}}),t.jsx(d,{gridRef:o,title:"Costos de envío",rest:b,exportable:!0,exportableName:"delivery.prices",toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"upload",hint:"Cargar archivo Excel",onClick:()=>document.getElementById("file-input").click()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(o.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo registro",hint:"Nuevo registro",onClick:()=>B()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"export",hint:"Exportar todo a Excel",onClick:()=>{document.getElementById("excel-download-link").click()}}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"ubigeo",caption:"Ubigeo (RENIEC)",width:"150px"},{dataField:"name",caption:"Envío a",width:"200px",allowExporting:!1},{dataField:"description",caption:"Descripción",cellTemplate:(e,{data:t})=>{e.html(t.description||'<i class="text-muted">- Sin descripción -</i>')}},{dataField:"price",caption:"Precio",dataType:"number",width:"150px",cellTemplate:(e,{data:r})=>{null===r.price?e.html(i.renderToString(t.jsx("span",{className:"text-muted",children:"Pago en destino"}))):r.price>0?e.html(i.renderToString(t.jsxs("span",{children:[f()," ",h(r.price)]}))):e.text("Gratis")}},{caption:"Acciones",width:"100px",cellTemplate:(e,{data:t})=>{e.css("text-overflow","unset"),e.append(l({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>B(t)})),e.append(l({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>(async e=>{const{isConfirmed:t}=await n.fire({title:"Eliminar registro",text:"¿Estas seguro de eliminar este registro?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});if(!t)return;await b.delete(e)&&$(o.current).dxDataGrid("instance").refresh()})(t.id)}))},allowFiltering:!1,allowExporting:!1}]}),t.jsxs(c,{modalRef:a,title:w?"Editar Costo de envío":"Agregar Costo de envío",onSubmit:async t=>{t.preventDefault();const r=e.find(e=>e.reniec==j.current.value),i={id:s.current.value||void 0,name:`${r.distrito}, ${r.departamento}`.toTitleCase(),price:y?null:g.current.value,description:v.current.value,ubigeo:j.current.value};await b.save(i)&&($(o.current).dxDataGrid("instance").refresh(),$(a.current).modal("hide"))},size:"sm",children:[t.jsx("input",{ref:s,type:"hidden"}),t.jsxs("div",{id:"form-container",className:"row",children:[t.jsx(u,{eRef:j,label:"Distrito/Ubigeo",templateResult:S,templateSelection:S,dropdownParent:"#form-container",required:!0,children:e.map((e,r)=>t.jsxs("option",{value:e.reniec,children:[e.reniec," ",e.distrito," ",e.provincia," ",e.departamento]},r))}),t.jsx(m,{label:"Pago en destino",col:"col-6",onChange:e=>R(e.target.checked),checked:y,refreshable:[y]}),t.jsx("div",{className:"col-6",hidden:y,children:t.jsx(p,{eRef:g,label:"Costo de envío",col:"col-12",type:"number",step:.01,required:!0})}),t.jsx(x,{eRef:v,label:"Descripción",rows:2})]})]})]})};a((r,i)=>{e.createRoot(r).render(t.jsx(s,{...i,title:"Costos de envio",children:t.jsx(j,{...i})}))});
