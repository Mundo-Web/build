import{j as e}from"./AboutSimple-Cf8x2fCZ.js";import{r as n}from"./index-BOnQTV8N.js";import{C as ue}from"./HeaderSearch-j9L8kXPt.js";import{C as F}from"./Number2Currency-jIsa99f9.js";import{m as C}from"./proxy-B0QLMKEh.js";import{S as xe}from"./shopping-cart-DLRnxGTD.js";import{I as he}from"./ItemsRest-Dp5IKigO.js";import{A as p}from"./ArrayJoin-2k6ba35P.js";import{N as pe}from"./NoResult-DlL_OOrq.js";import{S as W}from"./SelectForm-BvLefn0w.js";import{m as l}from"./main-B6F2O9-U.js";import{a as fe}from"./index-ngrFHoWO.js";import{A as be}from"./index-BZvh78jk.js";import"./index-yBjzXJbu.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./PolicyModal-C80IvD61.js";import"./index-B6ujFmsw.js";import"./index-Chjiymov.js";import"./CartItemRow-Dd2JdCJX.js";import"./tippy-react.esm-DmkRJDEW.js";import"./index-pSueRYGM.js";import"./package-DBFPPBi1.js";import"./createLucideIcon-DfjclApS.js";import"./trash-2-DU7LB6-f.js";import"./minus-Db6MFKEO.js";import"./plus-CTIomuuF.js";import"./General-apRuNwp7.js";import"./BasicRest-BML1C-ua.js";import"./CardProductKatya-ncpmQ0JU.js";import"./BooleanLimit-D-OsQsek.js";import"./chevron-down-uIVDLcM-.js";import"./search-BQ59Robe.js";import"./check-D5vaIe6v.js";import"./___vite-browser-external_commonjs-proxy-DDYoOVPM.js";const ye=({data:I,product:i,setCart:d,cart:v})=>{var T,w;const[E,u]=n.useState(!1),N=b=>{b.preventDefault(),b.stopPropagation();const x=structuredClone(v),_=x.findIndex(P=>P.id==i.id);_==-1?x.push({...i,quantity:1}):x[_].quantity++,d(x),u(!0),setTimeout(()=>u(!1),3e3)},f=Number(i.final_price)===0;return e.jsxs(e.Fragment,{children:[e.jsxs(C.a,{href:`/product/${i.slug}`,className:"group flex flex-col h-full bg-transparent rounded-2xl border-0 transition-all duration-300 overflow-hidden",initial:{opacity:0,y:20},animate:{opacity:1,y:0},whileHover:{y:-5},children:[e.jsxs("div",{className:"relative aspect-[4/3] overflow-hidden  rounded-2xl",children:[i.discount>0&&e.jsxs("span",{className:"absolute top-3 right-3 z-10 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full shadow-sm",children:["-",Math.round((i.price-i.discount)/i.price*100),"%"]}),e.jsx(C.img,{src:`/storage/images/item/${i.image}`,onError:b=>b.target.src="/api/cover/thumbnail/null",alt:i.name,className:"w-full h-full object-cover aspect-square object-center transition-transform duration-500 group-hover:scale-110",loading:"lazy"})]}),e.jsxs("div",{className:"flex flex-col flex-grow p-5  rounded-b-2xl",children:[e.jsx("div",{className:"text-xs font-medium customtext-primary  mb-2 uppercase tracking-wide",children:((T=i.brand)==null?void 0:T.name)||((w=i.category)==null?void 0:w.name)}),e.jsx("h3",{className:"text-xl  text-white mb-2 line-clamp-2 min-h-[2.5rem]",children:i.name}),e.jsx("div",{className:"text-base text-white mb-4 line-clamp-2 min-h-10",dangerouslySetInnerHTML:{__html:i.description}}),!f&&e.jsx("div",{className:"mt-auto mb-4",children:i.static_price?e.jsxs("div",{className:"flex flex-col items-start gap-1",children:[e.jsx("span",{className:"text-xl text-white",children:i.static_price}),i.discount>0&&e.jsxs("span",{className:"text-sm text-gray-400 line-through",children:[F()," ",i.price]})]}):e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-xl font-bold text-white",children:[F()," ",i.final_price]}),i.discount>0&&e.jsxs("span",{className:"text-sm text-gray-400 line-through",children:[F()," ",i.price]})]})}),e.jsx("div",{className:`mt-auto ${f?"pt-4":""}`,children:f?e.jsx("button",{className:"w-full flex items-center justify-center gap-2 bg-transparent border-2 border-primary customtext-primary py-3 px-4  font-semibold hover:bg-primary hover:text-white transition-all duration-300",children:"Ver más"}):e.jsxs("button",{onClick:N,className:"w-full flex items-center justify-center gap-2 bg-transparent border-2 border-primary customtext-primary py-3 px-4  font-semibold hover:bg-primary hover:text-white transition-all duration-300",children:[e.jsx(xe,{size:18}),"Agregar al carrito"]})})]})]}),e.jsx(ue,{data:I,cart:v,setCart:d,modalOpen:E,setModalOpen:u})]})},Z=new he,ct=({items:I,data:i,filteredData:d,cart:v,setCart:E})=>{var L,q;const u=[{value:"created_at:desc",label:"Más reciente"},{value:"created_at:asc",label:"Mas antiguo"},{value:"name:asc",label:"Nombre: A-Z"},{value:"name:desc",label:"Nombre: Z-A"}],[N,f]=n.useState([]),[T,w]=n.useState([]),[b,x]=n.useState([]),[_,P]=n.useState([]),[je,$]=n.useState([]),[we,V]=n.useState([]),[h,J]=n.useState({category:null,current_subcategory:null,subcategories:[],banners:[]}),[ve,Ne]=n.useState(()=>typeof window<"u"&&window.innerWidth>=1024?{marca:!1,precio:!1,categoria:!1,subcategoria:!1,colores:!1,coleccion:!1}:{marca:!1,precio:!1,categoria:!1,subcategoria:!1,colores:!1,coleccion:!1}),[y,M]=n.useState({collection_id:[],category_id:[],brand_id:[],subcategory_id:[],tag_id:l.GET.tag?l.GET.tag.split(","):[],price:[],name:l.GET.search||null,sort:(()=>{if(l.GET.sortBy){const t=l.GET.sortBy;let s=u.find(a=>a.value===t);if(s||(s=u.find(a=>a.label.toLowerCase()===t.toLowerCase())),s){const[a,r]=s.value.split(":");return[{selector:a,desc:r==="desc"}]}}return[{selector:"final_price",desc:!0}]})()}),[O,D]=n.useState([]),[Q,R]=n.useState(!0),[_e,B]=n.useState(!1),[U,X]=n.useState(!1),[Y,G]=n.useState(!1),[m,ee]=n.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:24,from:0,to:0}),te=async()=>{try{const t={};if(l.GET.subcategory&&(t.subcategory=l.GET.subcategory),l.GET.category&&(t.category=l.GET.category),l.GET.brand&&(t.brand=l.GET.brand),Object.keys(t).length>0){const s=await fe.get("/api/catalog/context",{params:t});s.data&&J(s.data)}}catch(t){console.error("Error fetching context data:",t)}},se=async()=>{try{const t={};if(l.GET.category&&(t.category_slugs=l.GET.category),l.GET.brand&&(t.brand_slugs=l.GET.brand),l.GET.subcategory&&(t.subcategory_slugs=l.GET.subcategory),l.GET.collection&&(t.collection_slugs=l.GET.collection),Object.keys(t).length>0){const s=await Z.convertSlugs(t);s.status===200&&M(a=>({...a,category_id:Array.isArray(s.data.category_ids)?s.data.category_ids:s.data.category_ids?[s.data.category_ids]:[],brand_id:l.GET.brand?[l.GET.brand]:[],subcategory_id:Array.isArray(s.data.subcategory_ids)?s.data.subcategory_ids:s.data.subcategory_ids?[s.data.subcategory_ids]:[],collection_id:Array.isArray(s.data.collection_ids)?s.data.collection_ids:s.data.collection_ids?[s.data.collection_ids]:[]}))}}catch(t){console.error("Error converting slugs to IDs:",t)}},ae=t=>{const s=[];if(t.sort&&Array.isArray(t.sort)){const a=["featured","offering","is_new","recommended"];t.sort.forEach(r=>{a.includes(r.selector)&&s.push([r.selector,"=",1])})}if(t.collection_id.length>0){const a=t.collection_id.map(r=>{var c;return["collection.id","=",((c=_.find(g=>g.slug===r))==null?void 0:c.id)||r]});s.push(p(a,"or"))}if(t.category_id.length>0){const a=t.category_id.map(r=>["category.id","=",r]);s.push(p(a,"or"))}if(t.subcategory_id.length>0){const a=t.subcategory_id.map(r=>["subcategory.id","=",r]);s.push(p(a,"or"))}if(t.brand_id.length>0){const a=t.brand_id.map(r=>{const c=N.find(g=>g.slug===r);return c?["brand.slug","=",c.slug]:["brand.slug","=",r]});s.push(p(a,"or"))}if(t.tag_id&&t.tag_id.length>0){const a=t.tag_id.map(r=>["item_tag.tag_id","=",r]);s.push(p(a,"or"))}if(t.price&&t.price.length>0){const a=t.price.map(r=>["and",[["final_price",">=",r.min],"and",["final_price","<=",r.max]]]);s.push(p(a,"or"))}if(t.name){const a=[["name","contains",t.name],"or",["summary","contains",t.name],"or",["description","contains",t.name]];s.push(a)}return p(s,"and")},A=async(t=1,s=!1)=>{var a,r,c,g,z,K;G(!1),s?B(!0):R(!0);try{const k=ae(y),j=24,ne=["featured","offering","is_new","recommended"],H=y.sort.filter(ge=>!ne.includes(ge.selector)),ce=H.length>0?H:[{selector:"final_price",desc:!0}],de={filter:k,sort:ce,skip:(t-1)*j,take:j,requireTotalCount:!0,with:"category,brand"},o=await Z.paginate(de);if(o.status!==200)throw new Error(`API returned status ${o.status}`);D(o.data||[]),X(!0),(!o.data||o.data.length===0)&&setTimeout(()=>G(!0),300);const S=o.totalCount||0,me=Math.ceil(S/j);ee({currentPage:t,totalPages:me,totalItems:S,itemsPerPage:j,from:S>0?(t-1)*j+1:0,to:Math.min(t*j,S)}),f(((a=o==null?void 0:o.summary)==null?void 0:a.brands)||[]),x(((r=o==null?void 0:o.summary)==null?void 0:r.categories)||[]),w(((c=o==null?void 0:o.summary)==null?void 0:c.subcategories)||[]),P(((g=o==null?void 0:o.summary)==null?void 0:g.collections)||[]),$(((z=o==null?void 0:o.summary)==null?void 0:z.priceRanges)||[]),V(((K=o==null?void 0:o.summary)==null?void 0:K.tags)||[])}catch(k){console.error("Error fetching products:",k),setTimeout(()=>G(!0),300)}finally{R(!1),B(!1)}};n.useEffect(()=>{d&&(x(d.categories||[]),f(d.brands||[]),w(d.subcategories||[]),$(d.priceRanges||[])),se(),te(),A(1,!1)},[d]),n.useEffect(()=>{A(1,U)},[y]);const re=t=>{t>=1&&t<=m.totalPages&&t!==m.currentPage&&(window.scrollTo({top:0,behavior:"smooth"}),A(t,!1))},[ie,Se]=n.useState(""),[oe,Ce]=n.useState(""),[Ee,Te]=n.useState(!1);b.filter(t=>t.name.toLowerCase().includes(ie.toLowerCase())),N.filter(t=>t.name.toLowerCase().includes(oe.toLowerCase()));const le=()=>{const t=s=>s?s.split(/(\*[^*]+\*)/g).map((r,c)=>{if(r.startsWith("*")&&r.endsWith("*")){const g=r.slice(1,-1);return e.jsx("span",{className:"customtext-primary",children:g},c)}return e.jsx("span",{children:r},c)}):null;return h.banners&&h.banners.length>0?e.jsx("div",{className:"",children:h.banners.map((s,a)=>{if(a===0)return e.jsxs("div",{className:"relative overflow-hidden h-[500px] lg:h-[600px] flex items-center justify-center -mx-4 md:-mx-6 lg:-mx-8",children:[s.image&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0",children:e.jsx("img",{src:`/storage/images/category/${s.image}`,alt:s.title||"Banner",className:"w-full h-full object-cover"})}),e.jsx("div",{className:"absolute inset-0 bg-black/50"})]}),e.jsx("div",{className:"relative z-10 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[s.title&&e.jsx("h1",{className:"text-4xl md:text-5xl lg:text-6xl font-bold mb-6 leading-tight text-white",children:t(s.title)}),s.description&&e.jsx("p",{className:"text-lg md:text-xl lg:text-2xl text-white mb-8 max-w-2xl mx-auto",children:s.description}),s.button_text&&s.button_link&&e.jsx("a",{href:s.button_link,className:"inline-flex items-center gap-2 px-8 py-4 bg-transparent border-2 border-primary customtext-primary text-lg font-bold hover:bg-primary hover:text-white transition-all duration-300",children:e.jsx("span",{children:s.button_text})})]})})]},a);const r=a%2===1;return e.jsx("div",{className:"w-full rounded-2xl overflow-hidden shadow-xl",children:e.jsxs("div",{className:"grid lg:grid-cols-2 min-h-[400px] lg:min-h-[500px] bg-white",children:[e.jsx("div",{className:`bg-primary flex items-center justify-center px-8 md:px-12 lg:px-16 xl:px-20 py-12 lg:py-16 ${r?"order-2 lg:order-1":"order-2"}`,children:e.jsxs("div",{className:"max-w-2xl w-full space-y-6",children:[s.title&&e.jsx("h2",{className:"text-3xl md:text-4xl lg:text-5xl font-bold text-white leading-tight",children:t(s.title)}),s.description&&e.jsx("p",{className:"text-lg md:text-xl text-white/90 leading-relaxed",children:s.description}),s.button_text&&s.button_link&&e.jsx("div",{className:"pt-4",children:e.jsx("a",{href:s.button_link,className:"inline-flex items-center justify-center gap-3 px-8 py-4 bg-white text-primary font-bold text-lg rounded-lg hover:bg-white/90 transition-all duration-300 hover:scale-105 shadow-xl",children:e.jsx("span",{children:s.button_text})})})]})}),e.jsx("div",{className:`relative h-64 lg:h-auto ${r?"order-1 lg:order-2":"order-1"}`,children:s.image&&e.jsxs(e.Fragment,{children:[e.jsx("img",{src:`/storage/images/category/${s.image}`,alt:s.title||"Banner",className:"absolute inset-0 w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/30 to-transparent lg:hidden"})]})})]})},a)})}):e.jsx(C.div,{className:"flex flex-col md:flex-row md:justify-between items-start md:items-center mb-6 lg:mb-8 lg:pb-6 lg:border-b-2 border-gradient-to-r from-blue-200 via-indigo-200 to-purple-200",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsx("div",{className:"md:w-6/12",children:e.jsx("h2",{className:"text-2xl lg:text-[32px] md:text-4xl font-bold customtext-primary lg:mb-2",children:(i==null?void 0:i.title)||"Catálogo"})})})};return e.jsxs(e.Fragment,{children:[le(),e.jsx("section",{className:"py-4 lg:py-12 bg-secondary",children:e.jsxs("div",{className:"mx-auto px-primary 2xl:px-0 2xl:max-w-7xl",children:[e.jsxs("div",{className:"mb-6 flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[h.current_subcategory&&h.subcategories.length>0&&e.jsx("div",{className:"w-full md:w-auto md:min-w-[280px]",children:e.jsx(W,{options:h.subcategories,valueKey:"slug",labelKey:"name",value:h.current_subcategory.slug,placeholder:"Seleccionar subcategoría",className:"bg-primary text-white border-primary",onChange:t=>{window.location.href=`/catalogo?subcategory=${t}`}})}),e.jsx("div",{className:"w-full md:w-auto md:min-w-[280px]",children:e.jsx(W,{options:u,valueKey:"value",labelKey:"label",value:(q=(L=y.sort)==null?void 0:L[0])!=null&&q.selector?`${y.sort[0].selector}:${y.sort[0].desc?"desc":"asc"}`:"final_price:desc",placeholder:"Ordenar por",className:"bg-primary text-white border-primary",onChange:t=>{const[s,a]=t.split(":");M(r=>({...r,sort:[{selector:s,desc:a==="desc"}]}))}})})]}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"text-white",children:m.totalItems>0&&e.jsxs("p",{className:"text-sm",children:["Mostrando ",e.jsx("span",{className:"font-semibold text-white",children:m.from})," - ",e.jsx("span",{className:"font-semibold text-white",children:m.to})," de ",e.jsx("span",{className:"font-semibold text-white",children:m.totalItems})," productos"]})})}),e.jsxs("div",{className:"w-full",children:[Q?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[...Array(8)].map((t,s)=>e.jsx("div",{className:"bg-white rounded-2xl h-[400px] animate-pulse"},s))}):O.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:e.jsx(be,{children:O.map((t,s)=>e.jsx(C.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{delay:s*.05},className:"h-full",children:e.jsx(ye,{product:t,cart:v,setCart:E,data:i})},t.id))})}):Y&&e.jsx(pe,{}),m.totalPages>1&&e.jsx("div",{className:"mt-12 flex justify-center gap-2",children:Array.from({length:m.totalPages},(t,s)=>s+1).map(t=>e.jsx("button",{onClick:()=>re(t),className:`w-10 h-10 rounded-xl font-bold transition-all ${m.currentPage===t?"bg-primary text-white shadow-lg scale-110":"bg-white text-white hover:bg-gray-50"}`,children:t},t))})]})]})})]})};export{ct as default};
